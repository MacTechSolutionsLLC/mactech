import { z } from 'zod'

export const cveAnalysisSchema = z.object({
  softwareName: z.string(),
  version: z.string(),
  vendor: z.string().optional(),
  metadata: z.record(z.any()).optional(),
})

export type CVEAnalysis = z.infer<typeof cveAnalysisSchema> & {
  id: string
  status: 'pending' | 'analyzing' | 'completed' | 'failed'
  cves: CVE[]
  riskLevel: 'low' | 'medium' | 'high' | 'critical'
  recommendation: 'approve' | 'approve-with-conditions' | 'reject' | 'requires-review'
  createdAt: string
  completedAt?: string
}

export interface CVE {
  id: string
  title: string
  description: string
  severity: 'low' | 'medium' | 'high' | 'critical'
  cvssScore: number
  publishedDate: string
  affectedVersions: string[]
  remediation: string
  status: 'new' | 'mitigated' | 'accepted'
}

export interface VulnerabilityScan {
  id: string
  systemId: string
  scanType: 'hbss' | 'evss' | 'stig' | 'custom'
  status: 'pending' | 'running' | 'completed' | 'failed'
  findings: VulnerabilityFinding[]
  startedAt: string
  completedAt?: string
}

export interface VulnerabilityFinding {
  id: string
  title: string
  severity: 'low' | 'medium' | 'high' | 'critical'
  description: string
  remediation: string
  status: 'open' | 'mitigated' | 'accepted' | 'false-positive'
  assignedTo?: string
  dueDate?: string
}

export interface VulnerabilityMetrics {
  totalScans: number
  activeFindings: number
  criticalFindings: number
  averageRemediationTime: number
  bySeverity: Record<string, number>
  byStatus: Record<string, number>
}

