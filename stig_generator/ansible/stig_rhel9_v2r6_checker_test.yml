# Generated checker playbook for rhel9
# Total Controls: 447

# Validation usage:
#   - Validate automatable controls only:
#       ansible-playbook checker.yml --tags validate_automatable
#   - Validate manual controls only:
#       ansible-playbook checker.yml --tags validate_manual
#   - Validate both:
#       ansible-playbook checker.yml

- name: Validate RHEL9 STIG controls
  hosts: all
  become: yes
  vars:
    # Place any tunable defaults here if needed later
  tasks:

    - name: 'SV-257777r991589_rule | RHEL 9 must be a vendor-supported release.'
      shell:
        cmd: cat /etc/redhat-release
      register: SV_257777r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257777r991589_rule

    - name: 'SV-257777r991589_rule | Display check result'
      debug:
        var: SV_257777r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257777r991589_rule


    - name: 'SV-257778r1134892_rule | RHEL 9 vendor packaged system security patches and updates must be installed and'
      shell:
        cmd: dnf history list | more
      register: SV_257778r1134892_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257778r1134892_rule

    - name: 'SV-257778r1134892_rule | Display check result'
      debug:
        var: SV_257778r1134892_rule_check.stdout
      tags:
        - stig_check
        - SV-257778r1134892_rule


    - name: 'SV-257779r958390_rule | RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before '
      shell:
        cmd: cat /etc/issue
      register: SV_257779r958390_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257779r958390_rule

    - name: 'SV-257779r958390_rule | Display check result'
      debug:
        var: SV_257779r958390_rule_check.stdout
      tags:
        - stig_check
        - SV-257779r958390_rule


    - name: 'SV-257781r991589_rule | The graphical display manager must not be the default target on RHEL 9 unless ap'
      shell:
        cmd: systemctl get-default
      register: SV_257781r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257781r991589_rule

    - name: 'SV-257781r991589_rule | Display check result'
      debug:
        var: SV_257781r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257781r991589_rule


    - name: 'SV-257782r991589_rule | RHEL 9 must enable the hardware random number generator entropy gatherer service'
      shell:
        cmd: systemctl is-active rngd
      register: SV_257782r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257782r991589_rule

    - name: 'SV-257782r991589_rule | Display check result'
      debug:
        var: SV_257782r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257782r991589_rule


    - name: 'SV-257783r991562_rule | RHEL 9 systemd-journald service must be enabled.'
      shell:
        cmd: systemctl is-active systemd-journald
      register: SV_257783r991562_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257783r991562_rule

    - name: 'SV-257783r991562_rule | Display check result'
      debug:
        var: SV_257783r991562_rule_check.stdout
      tags:
        - stig_check
        - SV-257783r991562_rule


    - name: 'SV-257784r1044832_rule | The systemd Ctrl-Alt-Delete burst key sequence in RHEL 9 must be disabled.'
      shell:
        cmd: grep -i ctrl /etc/systemd/system.conf
      register: SV_257784r1044832_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257784r1044832_rule

    - name: 'SV-257784r1044832_rule | Display check result'
      debug:
        var: SV_257784r1044832_rule_check.stdout
      tags:
        - stig_check
        - SV-257784r1044832_rule


    - name: 'SV-257785r1044833_rule | The x86 Ctrl-Alt-Delete key sequence must be disabled on RHEL 9.'
      shell:
        cmd: systemctl status ctrl-alt-del.target
      register: SV_257785r1044833_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257785r1044833_rule

    - name: 'SV-257785r1044833_rule | Display check result'
      debug:
        var: SV_257785r1044833_rule_check.stdout
      tags:
        - stig_check
        - SV-257785r1044833_rule


    - name: 'SV-257786r1044834_rule | RHEL 9 debug-shell systemd service must be disabled.'
      shell:
        cmd: systemctl status debug-shell.service
      register: SV_257786r1044834_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257786r1044834_rule

    - name: 'SV-257786r1044834_rule | Display check result'
      debug:
        var: SV_257786r1044834_rule_check.stdout
      tags:
        - stig_check
        - SV-257786r1044834_rule


    - name: 'SV-257787r1117265_rule | RHEL 9 must require a boot loader superuser password.'
      shell:
        cmd: grep password_pbkdf2 /etc/grub2.cfg
      register: SV_257787r1117265_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257787r1117265_rule

    - name: 'SV-257787r1117265_rule | Display check result'
      debug:
        var: SV_257787r1117265_rule_check.stdout
      tags:
        - stig_check
        - SV-257787r1117265_rule


    - name: 'SV-257788r1044838_rule | RHEL 9 must disable the ability of systemd to spawn an interactive boot process.'
      shell:
        cmd: grubby --info=ALL | grep args | grep 'systemd.confirm_spawn'
      register: SV_257788r1044838_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257788r1044838_rule

    - name: 'SV-257788r1044838_rule | Display check result'
      debug:
        var: SV_257788r1044838_rule_check.stdout
      tags:
        - stig_check
        - SV-257788r1044838_rule


    - name: 'SV-257789r1134895_rule | RHEL 9 must require a unique superusers name upon booting into single-user and m'
      shell:
        cmd: grep -A1 "superusers" /etc/grub2.cfg
      register: SV_257789r1134895_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257789r1134895_rule

    - name: 'SV-257789r1134895_rule | Display check result'
      debug:
        var: SV_257789r1134895_rule_check.stdout
      tags:
        - stig_check
        - SV-257789r1134895_rule


    - name: 'SV-257790r991589_rule | RHEL 9 /boot/grub2/grub.cfg file must be group-owned by root.'
      shell:
        cmd: stat -c "%G %n" /boot/grub2/grub.cfg
      register: SV_257790r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257790r991589_rule

    - name: 'SV-257790r991589_rule | Display check result'
      debug:
        var: SV_257790r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257790r991589_rule


    - name: 'SV-257791r991589_rule | RHEL 9 /boot/grub2/grub.cfg file must be owned by root.'
      shell:
        cmd: stat -c "%U %n" /boot/grub2/grub.cfg
      register: SV_257791r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257791r991589_rule

    - name: 'SV-257791r991589_rule | Display check result'
      debug:
        var: SV_257791r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257791r991589_rule


    - name: 'SV-257792r1044842_rule | RHEL 9 must disable virtual system calls.'
      shell:
        cmd: grubby --info=ALL | grep args | grep -v 'vsyscall=none'
      register: SV_257792r1044842_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257792r1044842_rule

    - name: 'SV-257792r1044842_rule | Display check result'
      debug:
        var: SV_257792r1044842_rule_check.stdout
      tags:
        - stig_check
        - SV-257792r1044842_rule


    - name: 'SV-257793r1044843_rule | RHEL 9 must clear the page allocator to prevent use-after-free attacks.'
      shell:
        cmd: grubby --info=ALL | grep args | grep -v 'page_poison=1'
      register: SV_257793r1044843_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257793r1044843_rule

    - name: 'SV-257793r1044843_rule | Display check result'
      debug:
        var: SV_257793r1044843_rule_check.stdout
      tags:
        - stig_check
        - SV-257793r1044843_rule


    - name: 'SV-257794r1069362_rule | RHEL 9 must clear memory when it is freed to prevent use-after-free attacks.'
      shell:
        cmd: grep -i grub_cmdline_linux /etc/default/grub
      register: SV_257794r1069362_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257794r1069362_rule

    - name: 'SV-257794r1069362_rule | Display check result'
      debug:
        var: SV_257794r1069362_rule_check.stdout
      tags:
        - stig_check
        - SV-257794r1069362_rule


    - name: 'SV-257795r1044845_rule | RHEL 9 must enable mitigations against processor-based vulnerabilities.'
      shell:
        cmd: grubby --info=ALL | grep args | grep -v 'pti=on'
      register: SV_257795r1044845_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257795r1044845_rule

    - name: 'SV-257795r1044845_rule | Display check result'
      debug:
        var: SV_257795r1044845_rule_check.stdout
      tags:
        - stig_check
        - SV-257795r1044845_rule


    - name: 'SV-257796r1044847_rule | RHEL 9 must enable auditing of processes that start prior to the audit daemon.'
      shell:
        cmd: grubby --info=ALL | grep args | grep -v 'audit=1'
      register: SV_257796r1044847_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257796r1044847_rule

    - name: 'SV-257796r1044847_rule | Display check result'
      debug:
        var: SV_257796r1044847_rule_check.stdout
      tags:
        - stig_check
        - SV-257796r1044847_rule


    - name: 'SV-257797r1117266_rule | RHEL 9 must restrict access to the kernel message buffer.'
      shell:
        cmd: sysctl kernel.dmesg_restrict
      register: SV_257797r1117266_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257797r1117266_rule

    - name: 'SV-257797r1117266_rule | Display check result'
      debug:
        var: SV_257797r1117266_rule_check.stdout
      tags:
        - stig_check
        - SV-257797r1117266_rule


    - name: 'SV-257798r1117266_rule | RHEL 9 must prevent kernel profiling by nonprivileged users.'
      shell:
        cmd: sysctl kernel.perf_event_paranoid
      register: SV_257798r1117266_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257798r1117266_rule

    - name: 'SV-257798r1117266_rule | Display check result'
      debug:
        var: SV_257798r1117266_rule_check.stdout
      tags:
        - stig_check
        - SV-257798r1117266_rule


    - name: 'SV-257799r1106273_rule | RHEL 9 must prevent the loading of a new kernel for later execution.'
      shell:
        cmd: sysctl kernel.kexec_load_disabled
      register: SV_257799r1106273_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257799r1106273_rule

    - name: 'SV-257799r1106273_rule | Display check result'
      debug:
        var: SV_257799r1106273_rule_check.stdout
      tags:
        - stig_check
        - SV-257799r1106273_rule


    - name: 'SV-257800r1117266_rule | RHEL 9 must restrict exposed kernel pointer addresses access.'
      shell:
        cmd: sysctl kernel.kptr_restrict
      register: SV_257800r1117266_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257800r1117266_rule

    - name: 'SV-257800r1117266_rule | Display check result'
      debug:
        var: SV_257800r1117266_rule_check.stdout
      tags:
        - stig_check
        - SV-257800r1117266_rule


    - name: 'SV-257801r1106279_rule | RHEL 9 must enable kernel parameters to enforce discretionary access control on '
      shell:
        cmd: sysctl fs.protected_hardlinks
      register: SV_257801r1106279_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257801r1106279_rule

    - name: 'SV-257801r1106279_rule | Display check result'
      debug:
        var: SV_257801r1106279_rule_check.stdout
      tags:
        - stig_check
        - SV-257801r1106279_rule


    - name: 'SV-257802r1106282_rule | RHEL 9 must enable kernel parameters to enforce discretionary access control on '
      shell:
        cmd: sysctl fs.protected_symlinks
      register: SV_257802r1106282_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257802r1106282_rule

    - name: 'SV-257802r1106282_rule | Display check result'
      debug:
        var: SV_257802r1106282_rule_check.stdout
      tags:
        - stig_check
        - SV-257802r1106282_rule


    - name: 'SV-257803r1106429_rule | RHEL 9 must disable the kernel.core_pattern.'
      shell:
        cmd: sysctl kernel.core_pattern
      register: SV_257803r1106429_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257803r1106429_rule

    - name: 'SV-257803r1106429_rule | Display check result'
      debug:
        var: SV_257803r1106429_rule_check.stdout
      tags:
        - stig_check
        - SV-257803r1106429_rule


    - name: 'SV-257804r1044853_rule | RHEL 9 must be configured to disable the Asynchronous Transfer Mode kernel modul'
      shell:
        cmd: grep -r atm /etc/modprobe.conf /etc/modprobe.d/*
      register: SV_257804r1044853_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257804r1044853_rule

    - name: 'SV-257804r1044853_rule | Display check result'
      debug:
        var: SV_257804r1044853_rule_check.stdout
      tags:
        - stig_check
        - SV-257804r1044853_rule


    - name: 'SV-257805r1044856_rule | RHEL 9 must be configured to disable the Controller Area Network kernel module.'
      shell:
        cmd: grep -r can /etc/modprobe.conf /etc/modprobe.d/*
      register: SV_257805r1044856_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257805r1044856_rule

    - name: 'SV-257805r1044856_rule | Display check result'
      debug:
        var: SV_257805r1044856_rule_check.stdout
      tags:
        - stig_check
        - SV-257805r1044856_rule


    - name: 'SV-257806r1044859_rule | RHEL 9 must be configured to disable the FireWire kernel module.'
      shell:
        cmd: grep -r firewire-core /etc/modprobe.conf /etc/modprobe.d/*
      register: SV_257806r1044859_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257806r1044859_rule

    - name: 'SV-257806r1044859_rule | Display check result'
      debug:
        var: SV_257806r1044859_rule_check.stdout
      tags:
        - stig_check
        - SV-257806r1044859_rule


    - name: 'SV-257807r1044862_rule | RHEL 9 must disable the Stream Control Transmission Protocol (SCTP) kernel modul'
      shell:
        cmd: grep -r sctp /etc/modprobe.conf /etc/modprobe.d/*
      register: SV_257807r1044862_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257807r1044862_rule

    - name: 'SV-257807r1044862_rule | Display check result'
      debug:
        var: SV_257807r1044862_rule_check.stdout
      tags:
        - stig_check
        - SV-257807r1044862_rule


    - name: 'SV-257808r1044865_rule | RHEL 9 must disable the Transparent Inter Process Communication (TIPC) kernel mo'
      shell:
        cmd: grep -r tipc /etc/modprobe.conf /etc/modprobe.d/*
      register: SV_257808r1044865_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257808r1044865_rule

    - name: 'SV-257808r1044865_rule | Display check result'
      debug:
        var: SV_257808r1044865_rule_check.stdout
      tags:
        - stig_check
        - SV-257808r1044865_rule


    - name: 'SV-257809r1106288_rule | RHEL 9 must implement address space layout randomization (ASLR) to protect its m'
      shell:
        cmd: sysctl kernel.randomize_va_space
      register: SV_257809r1106288_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257809r1106288_rule

    - name: 'SV-257809r1106288_rule | Display check result'
      debug:
        var: SV_257809r1106288_rule_check.stdout
      tags:
        - stig_check
        - SV-257809r1106288_rule


    - name: 'SV-257810r1117266_rule | RHEL 9 must disable access to network bpf system call from nonprivileged process'
      shell:
        cmd: sysctl kernel.unprivileged_bpf_disabled
      register: SV_257810r1117266_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257810r1117266_rule

    - name: 'SV-257810r1117266_rule | Display check result'
      debug:
        var: SV_257810r1117266_rule_check.stdout
      tags:
        - stig_check
        - SV-257810r1117266_rule


    - name: 'SV-257811r1117266_rule | RHEL 9 must restrict usage of ptrace to descendant processes.'
      shell:
        cmd: sysctl kernel.yama.ptrace_scope
      register: SV_257811r1117266_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257811r1117266_rule

    - name: 'SV-257811r1117266_rule | Display check result'
      debug:
        var: SV_257811r1117266_rule_check.stdout
      tags:
        - stig_check
        - SV-257811r1117266_rule


    - name: 'SV-257812r1134897_rule | RHEL 9 must disable core dump backtraces.'
      shell:
        cmd: grep -i ProcessSizeMax /etc/systemd/coredump.conf
      register: SV_257812r1134897_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257812r1134897_rule

    - name: 'SV-257812r1134897_rule | Display check result'
      debug:
        var: SV_257812r1134897_rule_check.stdout
      tags:
        - stig_check
        - SV-257812r1134897_rule


    - name: 'SV-257813r1134899_rule | RHEL 9 must disable storing core dumps.'
      shell:
        cmd: grep -i storage /etc/systemd/coredump.conf
      register: SV_257813r1134899_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257813r1134899_rule

    - name: 'SV-257813r1134899_rule | Display check result'
      debug:
        var: SV_257813r1134899_rule_check.stdout
      tags:
        - stig_check
        - SV-257813r1134899_rule


    - name: 'SV-257814r1134901_rule | RHEL 9 must disable core dumps for all users.'
      shell:
        cmd: grep -r -s core /etc/security/limits.conf /etc/security/limits.d/*.conf
      register: SV_257814r1134901_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257814r1134901_rule

    - name: 'SV-257814r1134901_rule | Display check result'
      debug:
        var: SV_257814r1134901_rule_check.stdout
      tags:
        - stig_check
        - SV-257814r1134901_rule


    - name: 'SV-257815r1134903_rule | RHEL 9 must disable acquiring, saving, and processing core dumps.'
      shell:
        cmd: systemctl status systemd-coredump.socket
      register: SV_257815r1134903_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257815r1134903_rule

    - name: 'SV-257815r1134903_rule | Display check result'
      debug:
        var: SV_257815r1134903_rule_check.stdout
      tags:
        - stig_check
        - SV-257815r1134903_rule


    - name: 'SV-257816r1106435_rule | RHEL 9 must disable the use of user namespaces.'
      shell:
        cmd: sysctl user.max_user_namespaces
      register: SV_257816r1106435_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257816r1106435_rule

    - name: 'SV-257816r1106435_rule | Display check result'
      debug:
        var: SV_257816r1106435_rule_check.stdout
      tags:
        - stig_check
        - SV-257816r1106435_rule


    - name: 'SV-257817r1069383_rule | RHEL 9 must implement nonexecutable data to protect its memory from unauthorized'
      shell:
        cmd: grep ^flags /proc/cpuinfo | grep -Ev '([^[:alnum:]])(nx)([^[:alnum:]]|$)'
      register: SV_257817r1069383_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257817r1069383_rule

    - name: 'SV-257817r1069383_rule | Display check result'
      debug:
        var: SV_257817r1069383_rule_check.stdout
      tags:
        - stig_check
        - SV-257817r1069383_rule


    - name: 'SV-257818r1044876_rule | The kdump service on RHEL 9 must be disabled.'
      shell:
        cmd: systemctl is-enabled kdump
      register: SV_257818r1044876_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257818r1044876_rule

    - name: 'SV-257818r1044876_rule | Display check result'
      debug:
        var: SV_257818r1044876_rule_check.stdout
      tags:
        - stig_check
        - SV-257818r1044876_rule


    - name: 'SV-257819r1015075_rule | RHEL 9 must ensure cryptographic verification of vendor software packages.'
      shell:
        cmd: rpm -q --queryformat "%{SUMMARY}\n" gpg-pubkey | grep -i "red hat"
      register: SV_257819r1015075_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257819r1015075_rule

    - name: 'SV-257819r1015075_rule | Display check result'
      debug:
        var: SV_257819r1015075_rule_check.stdout
      tags:
        - stig_check
        - SV-257819r1015075_rule


    - name: 'SV-257820r1044878_rule | RHEL 9 must check the GPG signature of software packages originating from extern'
      shell:
        cmd: grep -w gpgcheck /etc/dnf/dnf.conf
      register: SV_257820r1044878_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257820r1044878_rule

    - name: 'SV-257820r1044878_rule | Display check result'
      debug:
        var: SV_257820r1044878_rule_check.stdout
      tags:
        - stig_check
        - SV-257820r1044878_rule


    - name: 'SV-257821r1015077_rule | RHEL 9 must check the GPG signature of locally installed software packages befor'
      shell:
        cmd: grep localpkg_gpgcheck /etc/dnf/dnf.conf
      register: SV_257821r1015077_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257821r1015077_rule

    - name: 'SV-257821r1015077_rule | Display check result'
      debug:
        var: SV_257821r1015077_rule_check.stdout
      tags:
        - stig_check
        - SV-257821r1015077_rule


    - name: 'SV-257822r1044880_rule | RHEL 9 must have GPG signature verification enabled for all software repositorie'
      shell:
        cmd: grep -w gpgcheck /etc/yum.repos.d/*.repo | more
      register: SV_257822r1044880_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257822r1044880_rule

    - name: 'SV-257822r1044880_rule | Display check result'
      debug:
        var: SV_257822r1044880_rule_check.stdout
      tags:
        - stig_check
        - SV-257822r1044880_rule


    - name: 'SV-257823r1051231_rule | RHEL 9 must be configured so that the cryptographic hashes of system files match'
      shell:
        cmd: rpm -Va --noconfig | awk '$1 ~ /..5/ && $2 != "c"'
      register: SV_257823r1051231_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257823r1051231_rule

    - name: 'SV-257823r1051231_rule | Display check result'
      debug:
        var: SV_257823r1051231_rule_check.stdout
      tags:
        - stig_check
        - SV-257823r1051231_rule


    - name: 'SV-257824r1044886_rule | RHEL 9 must remove all software components after updated versions have been inst'
      shell:
        cmd: grep -i clean_requirements_on_remove /etc/dnf/dnf.conf
      register: SV_257824r1044886_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257824r1044886_rule

    - name: 'SV-257824r1044886_rule | Display check result'
      debug:
        var: SV_257824r1044886_rule_check.stdout
      tags:
        - stig_check
        - SV-257824r1044886_rule


    - name: 'SV-257825r1044888_rule | RHEL 9 subscription-manager package must be installed.'
      shell:
        cmd: dnf list --installed subscription-manager
      register: SV_257825r1044888_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257825r1044888_rule

    - name: 'SV-257825r1044888_rule | Display check result'
      debug:
        var: SV_257825r1044888_rule_check.stdout
      tags:
        - stig_check
        - SV-257825r1044888_rule


    - name: 'SV-257826r1106299_rule | RHEL 9 must not have a File Transfer Protocol (FTP) server package installed.'
      shell:
        cmd: dnf list --installed vsftpd
      register: SV_257826r1106299_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257826r1106299_rule

    - name: 'SV-257826r1106299_rule | Display check result'
      debug:
        var: SV_257826r1106299_rule_check.stdout
      tags:
        - stig_check
        - SV-257826r1106299_rule


    - name: 'SV-257827r1044892_rule | RHEL 9 must not have the sendmail package installed.'
      shell:
        cmd: dnf list --installed sendmail
      register: SV_257827r1044892_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257827r1044892_rule

    - name: 'SV-257827r1044892_rule | Display check result'
      debug:
        var: SV_257827r1044892_rule_check.stdout
      tags:
        - stig_check
        - SV-257827r1044892_rule


    - name: 'SV-257828r1044894_rule | RHEL 9 must not have the nfs-utils package installed.'
      shell:
        cmd: dnf list --installed nfs-utils
      register: SV_257828r1044894_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257828r1044894_rule

    - name: 'SV-257828r1044894_rule | Display check result'
      debug:
        var: SV_257828r1044894_rule_check.stdout
      tags:
        - stig_check
        - SV-257828r1044894_rule


    - name: 'SV-257829r1044896_rule | RHEL 9 must not have the ypserv package installed.'
      shell:
        cmd: dnf list --installed ypserv
      register: SV_257829r1044896_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257829r1044896_rule

    - name: 'SV-257829r1044896_rule | Display check result'
      debug:
        var: SV_257829r1044896_rule_check.stdout
      tags:
        - stig_check
        - SV-257829r1044896_rule


    - name: 'SV-257830r1134906_rule | RHEL 9 must not install packages from the Extra Packages for Enterprise Linux (E'
      shell:
        cmd: dnf repolist
      register: SV_257830r1134906_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257830r1134906_rule

    - name: 'SV-257830r1134906_rule | Display check result'
      debug:
        var: SV_257830r1134906_rule_check.stdout
      tags:
        - stig_check
        - SV-257830r1134906_rule


    - name: 'SV-257831r1044898_rule | RHEL 9 must not have the telnet-server package installed.'
      shell:
        cmd: dnf list --installed telnet-server
      register: SV_257831r1044898_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257831r1044898_rule

    - name: 'SV-257831r1044898_rule | Display check result'
      debug:
        var: SV_257831r1044898_rule_check.stdout
      tags:
        - stig_check
        - SV-257831r1044898_rule


    - name: 'SV-257832r1044900_rule | RHEL 9 must not have the gssproxy package installed.'
      shell:
        cmd: dnf list --installed gssproxy
      register: SV_257832r1044900_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257832r1044900_rule

    - name: 'SV-257832r1044900_rule | Display check result'
      debug:
        var: SV_257832r1044900_rule_check.stdout
      tags:
        - stig_check
        - SV-257832r1044900_rule


    - name: 'SV-257833r1044902_rule | RHEL 9 must not have the iprutils package installed.'
      shell:
        cmd: dnf list --installed iprutils
      register: SV_257833r1044902_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257833r1044902_rule

    - name: 'SV-257833r1044902_rule | Display check result'
      debug:
        var: SV_257833r1044902_rule_check.stdout
      tags:
        - stig_check
        - SV-257833r1044902_rule


    - name: 'SV-257834r1044904_rule | RHEL 9 must not have the tuned package installed.'
      shell:
        cmd: dnf list --installed tuned
      register: SV_257834r1044904_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257834r1044904_rule

    - name: 'SV-257834r1044904_rule | Display check result'
      debug:
        var: SV_257834r1044904_rule_check.stdout
      tags:
        - stig_check
        - SV-257834r1044904_rule


    - name: 'SV-257835r1102037_rule | RHEL 9 must not have a Trivial File Transfer Protocol (TFTP) server package inst'
      shell:
        cmd: dnf list --installed tftp-server
      register: SV_257835r1102037_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257835r1102037_rule

    - name: 'SV-257835r1102037_rule | Display check result'
      debug:
        var: SV_257835r1102037_rule_check.stdout
      tags:
        - stig_check
        - SV-257835r1102037_rule


    - name: 'SV-257836r1044908_rule | RHEL 9 must not have the quagga package installed.'
      shell:
        cmd: dnf list --installed quagga
      register: SV_257836r1044908_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257836r1044908_rule

    - name: 'SV-257836r1044908_rule | Display check result'
      debug:
        var: SV_257836r1044908_rule_check.stdout
      tags:
        - stig_check
        - SV-257836r1044908_rule


    - name: 'SV-257837r1044910_rule | A graphical display manager must not be installed on RHEL 9 unless approved.'
      shell:
        cmd: dnf list --installed "xorg-x11-server-common"
      register: SV_257837r1044910_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257837r1044910_rule

    - name: 'SV-257837r1044910_rule | Display check result'
      debug:
        var: SV_257837r1044910_rule_check.stdout
      tags:
        - stig_check
        - SV-257837r1044910_rule


    - name: 'SV-257838r1044912_rule | RHEL 9 must have the openssl-pkcs11 package installed.'
      shell:
        cmd: dnf list --installed openssl-pkcs11
      register: SV_257838r1044912_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257838r1044912_rule

    - name: 'SV-257838r1044912_rule | Display check result'
      debug:
        var: SV_257838r1044912_rule_check.stdout
      tags:
        - stig_check
        - SV-257838r1044912_rule


    - name: 'SV-257839r991589_rule | RHEL 9 must have the gnutls-utils package installed.'
      shell:
        cmd: dnf list --installed gnutls-utils
      register: SV_257839r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257839r991589_rule

    - name: 'SV-257839r991589_rule | Display check result'
      debug:
        var: SV_257839r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257839r991589_rule


    - name: 'SV-257840r991589_rule | RHEL 9 must have the nss-tools package installed.'
      shell:
        cmd: dnf list --installed nss-tools
      register: SV_257840r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257840r991589_rule

    - name: 'SV-257840r991589_rule | Display check result'
      debug:
        var: SV_257840r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257840r991589_rule


    - name: 'SV-257841r1044914_rule | RHEL 9 must have the rng-tools package installed.'
      shell:
        cmd: dnf list --installed rng-tools
      register: SV_257841r1044914_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257841r1044914_rule

    - name: 'SV-257841r1044914_rule | Display check result'
      debug:
        var: SV_257841r1044914_rule_check.stdout
      tags:
        - stig_check
        - SV-257841r1044914_rule


    - name: 'SV-257842r1044916_rule | RHEL 9 must have the s-nail package installed.'
      shell:
        cmd: dnf list --installed s-nail
      register: SV_257842r1044916_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257842r1044916_rule

    - name: 'SV-257842r1044916_rule | Display check result'
      debug:
        var: SV_257842r1044916_rule_check.stdout
      tags:
        - stig_check
        - SV-257842r1044916_rule


    - name: 'SV-257843r991589_rule | A separate RHEL 9 file system must be used for user home directories (such as /h'
      shell:
        cmd: mount | grep /home
      register: SV_257843r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257843r991589_rule

    - name: 'SV-257843r991589_rule | Display check result'
      debug:
        var: SV_257843r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257843r991589_rule


    - name: 'SV-257844r1044918_rule | RHEL 9 must use a separate file system for /tmp.'
      shell:
        cmd: mount | grep /tmp
      register: SV_257844r1044918_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257844r1044918_rule

    - name: 'SV-257844r1044918_rule | Display check result'
      debug:
        var: SV_257844r1044918_rule_check.stdout
      tags:
        - stig_check
        - SV-257844r1044918_rule


    - name: 'SV-257845r1044920_rule | RHEL 9 must use a separate file system for /var.'
      shell:
        cmd: mount | grep /var
      register: SV_257845r1044920_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257845r1044920_rule

    - name: 'SV-257845r1044920_rule | Display check result'
      debug:
        var: SV_257845r1044920_rule_check.stdout
      tags:
        - stig_check
        - SV-257845r1044920_rule


    - name: 'SV-257846r1044922_rule | RHEL 9 must use a separate file system for /var/log.'
      shell:
        cmd: mount | grep /var/log
      register: SV_257846r1044922_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257846r1044922_rule

    - name: 'SV-257846r1044922_rule | Display check result'
      debug:
        var: SV_257846r1044922_rule_check.stdout
      tags:
        - stig_check
        - SV-257846r1044922_rule


    - name: 'SV-257847r1044924_rule | RHEL 9 must use a separate file system for the system audit data path.'
      shell:
        cmd: mount | grep /var/log/audit
      register: SV_257847r1044924_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257847r1044924_rule

    - name: 'SV-257847r1044924_rule | Display check result'
      debug:
        var: SV_257847r1044924_rule_check.stdout
      tags:
        - stig_check
        - SV-257847r1044924_rule


    - name: 'SV-257848r1044926_rule | RHEL 9 must use a separate file system for /var/tmp.'
      shell:
        cmd: mount | grep /var/tmp
      register: SV_257848r1044926_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257848r1044926_rule

    - name: 'SV-257848r1044926_rule | Display check result'
      debug:
        var: SV_257848r1044926_rule_check.stdout
      tags:
        - stig_check
        - SV-257848r1044926_rule


    - name: 'SV-257849r1044928_rule | RHEL 9 file system automount function must be disabled unless required.'
      shell:
        cmd: systemctl is-enabled autofs
      register: SV_257849r1044928_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257849r1044928_rule

    - name: 'SV-257849r1044928_rule | Display check result'
      debug:
        var: SV_257849r1044928_rule_check.stdout
      tags:
        - stig_check
        - SV-257849r1044928_rule


    - name: 'SV-257850r1044930_rule | RHEL 9 must prevent device files from being interpreted on file systems that con'
      shell:
        cmd: mount | grep /home
      register: SV_257850r1044930_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257850r1044930_rule

    - name: 'SV-257850r1044930_rule | Display check result'
      debug:
        var: SV_257850r1044930_rule_check.stdout
      tags:
        - stig_check
        - SV-257850r1044930_rule


    - name: 'SV-257851r1044932_rule | RHEL 9 must prevent files with the setuid and setgid bit set from being executed'
      shell:
        cmd: mount | grep /home
      register: SV_257851r1044932_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257851r1044932_rule

    - name: 'SV-257851r1044932_rule | Display check result'
      debug:
        var: SV_257851r1044932_rule_check.stdout
      tags:
        - stig_check
        - SV-257851r1044932_rule


    - name: 'SV-257852r991589_rule | RHEL 9 must prevent code from being executed on file systems that contain user h'
      shell:
        cmd: mount | grep /home
      register: SV_257852r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257852r991589_rule

    - name: 'SV-257852r991589_rule | Display check result'
      debug:
        var: SV_257852r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257852r991589_rule


    - name: 'SV-257854r1044934_rule | RHEL 9 must prevent special devices on file systems that are imported via Networ'
      shell:
        cmd: grep nfs /etc/fstab
      register: SV_257854r1044934_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257854r1044934_rule

    - name: 'SV-257854r1044934_rule | Display check result'
      debug:
        var: SV_257854r1044934_rule_check.stdout
      tags:
        - stig_check
        - SV-257854r1044934_rule


    - name: 'SV-257855r1044936_rule | RHEL 9  must prevent code from being executed on file systems that are imported '
      shell:
        cmd: grep nfs /etc/fstab
      register: SV_257855r1044936_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257855r1044936_rule

    - name: 'SV-257855r1044936_rule | Display check result'
      debug:
        var: SV_257855r1044936_rule_check.stdout
      tags:
        - stig_check
        - SV-257855r1044936_rule


    - name: 'SV-257856r1044938_rule | RHEL 9 must prevent files with the setuid and setgid bit set from being executed'
      shell:
        cmd: grep nfs /etc/fstab
      register: SV_257856r1044938_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257856r1044938_rule

    - name: 'SV-257856r1044938_rule | Display check result'
      debug:
        var: SV_257856r1044938_rule_check.stdout
      tags:
        - stig_check
        - SV-257856r1044938_rule


    - name: 'SV-257857r991589_rule | RHEL 9 must prevent code from being executed on file systems that are used with '
      debug:
        msg: "SV-257857r991589_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-257857r991589_rule


    - name: 'SV-257858r991589_rule | RHEL 9 must prevent special devices on file systems that are used with removable'
      debug:
        msg: "SV-257858r991589_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-257858r991589_rule


    - name: 'SV-257859r991589_rule | RHEL 9 must prevent files with the setuid and setgid bit set from being executed'
      debug:
        msg: "SV-257859r991589_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-257859r991589_rule


    - name: 'SV-257860r1044940_rule | RHEL 9 must mount /boot with the nodev option.'
      shell:
        cmd: mount | grep '\s/boot\s'
      register: SV_257860r1044940_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257860r1044940_rule

    - name: 'SV-257860r1044940_rule | Display check result'
      debug:
        var: SV_257860r1044940_rule_check.stdout
      tags:
        - stig_check
        - SV-257860r1044940_rule


    - name: 'SV-257861r1044941_rule | RHEL 9 must prevent files with the setuid and setgid bit set from being executed'
      shell:
        cmd: mount | grep '\s/boot\s'
      register: SV_257861r1044941_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257861r1044941_rule

    - name: 'SV-257861r1044941_rule | Display check result'
      debug:
        var: SV_257861r1044941_rule_check.stdout
      tags:
        - stig_check
        - SV-257861r1044941_rule


    - name: 'SV-257862r1134908_rule | RHEL 9 must prevent files with the setuid and setgid bit set from being executed'
      shell:
        cmd: mount | grep '\s/boot/efi\s'
      register: SV_257862r1134908_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257862r1134908_rule

    - name: 'SV-257862r1134908_rule | Display check result'
      debug:
        var: SV_257862r1134908_rule_check.stdout
      tags:
        - stig_check
        - SV-257862r1134908_rule


    - name: 'SV-257863r958804_rule | RHEL 9 must mount /dev/shm with the nodev option.'
      shell:
        cmd: mount | grep /dev/shm
      register: SV_257863r958804_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257863r958804_rule

    - name: 'SV-257863r958804_rule | Display check result'
      debug:
        var: SV_257863r958804_rule_check.stdout
      tags:
        - stig_check
        - SV-257863r958804_rule


    - name: 'SV-257864r1106304_rule | RHEL 9 must mount /dev/shm with the noexec option.'
      shell:
        cmd: findmnt /dev/shm
      register: SV_257864r1106304_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257864r1106304_rule

    - name: 'SV-257864r1106304_rule | Display check result'
      debug:
        var: SV_257864r1106304_rule_check.stdout
      tags:
        - stig_check
        - SV-257864r1106304_rule


    - name: 'SV-257865r1044946_rule | RHEL 9 must mount /dev/shm with the nosuid option.'
      shell:
        cmd: mount | grep /dev/shm
      register: SV_257865r1044946_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257865r1044946_rule

    - name: 'SV-257865r1044946_rule | Display check result'
      debug:
        var: SV_257865r1044946_rule_check.stdout
      tags:
        - stig_check
        - SV-257865r1044946_rule


    - name: 'SV-257866r958804_rule | RHEL 9 must mount /tmp with the nodev option.'
      shell:
        cmd: mount | grep /tmp
      register: SV_257866r958804_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257866r958804_rule

    - name: 'SV-257866r958804_rule | Display check result'
      debug:
        var: SV_257866r958804_rule_check.stdout
      tags:
        - stig_check
        - SV-257866r958804_rule


    - name: 'SV-257867r958804_rule | RHEL 9 must mount /tmp with the noexec option.'
      shell:
        cmd: mount | grep /tmp
      register: SV_257867r958804_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257867r958804_rule

    - name: 'SV-257867r958804_rule | Display check result'
      debug:
        var: SV_257867r958804_rule_check.stdout
      tags:
        - stig_check
        - SV-257867r958804_rule


    - name: 'SV-257868r958804_rule | RHEL 9 must mount /tmp with the nosuid option.'
      shell:
        cmd: mount | grep /tmp
      register: SV_257868r958804_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257868r958804_rule

    - name: 'SV-257868r958804_rule | Display check result'
      debug:
        var: SV_257868r958804_rule_check.stdout
      tags:
        - stig_check
        - SV-257868r958804_rule


    - name: 'SV-257869r1102009_rule | RHEL 9 must mount /var with the nodev option.'
      shell:
        cmd: mount | grep /var
      register: SV_257869r1102009_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257869r1102009_rule

    - name: 'SV-257869r1102009_rule | Display check result'
      debug:
        var: SV_257869r1102009_rule_check.stdout
      tags:
        - stig_check
        - SV-257869r1102009_rule


    - name: 'SV-257870r958804_rule | RHEL 9 must mount /var/log with the nodev option.'
      shell:
        cmd: mount | grep /var/log
      register: SV_257870r958804_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257870r958804_rule

    - name: 'SV-257870r958804_rule | Display check result'
      debug:
        var: SV_257870r958804_rule_check.stdout
      tags:
        - stig_check
        - SV-257870r958804_rule


    - name: 'SV-257871r958804_rule | RHEL 9 must mount /var/log with the noexec option.'
      shell:
        cmd: mount | grep /var/log
      register: SV_257871r958804_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257871r958804_rule

    - name: 'SV-257871r958804_rule | Display check result'
      debug:
        var: SV_257871r958804_rule_check.stdout
      tags:
        - stig_check
        - SV-257871r958804_rule


    - name: 'SV-257872r958804_rule | RHEL 9 must mount /var/log with the nosuid option.'
      shell:
        cmd: mount | grep /var/log
      register: SV_257872r958804_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257872r958804_rule

    - name: 'SV-257872r958804_rule | Display check result'
      debug:
        var: SV_257872r958804_rule_check.stdout
      tags:
        - stig_check
        - SV-257872r958804_rule


    - name: 'SV-257873r958804_rule | RHEL 9 must mount /var/log/audit with the nodev option.'
      shell:
        cmd: mount | grep /var/log/audit
      register: SV_257873r958804_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257873r958804_rule

    - name: 'SV-257873r958804_rule | Display check result'
      debug:
        var: SV_257873r958804_rule_check.stdout
      tags:
        - stig_check
        - SV-257873r958804_rule


    - name: 'SV-257874r958804_rule | RHEL 9 must mount /var/log/audit with the noexec option.'
      shell:
        cmd: mount | grep /var/log/audit
      register: SV_257874r958804_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257874r958804_rule

    - name: 'SV-257874r958804_rule | Display check result'
      debug:
        var: SV_257874r958804_rule_check.stdout
      tags:
        - stig_check
        - SV-257874r958804_rule


    - name: 'SV-257875r958804_rule | RHEL 9 must mount /var/log/audit with the nosuid option.'
      shell:
        cmd: mount | grep /var/log/audit
      register: SV_257875r958804_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257875r958804_rule

    - name: 'SV-257875r958804_rule | Display check result'
      debug:
        var: SV_257875r958804_rule_check.stdout
      tags:
        - stig_check
        - SV-257875r958804_rule


    - name: 'SV-257876r958804_rule | RHEL 9 must mount /var/tmp with the nodev option.'
      shell:
        cmd: mount | grep /var/tmp
      register: SV_257876r958804_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257876r958804_rule

    - name: 'SV-257876r958804_rule | Display check result'
      debug:
        var: SV_257876r958804_rule_check.stdout
      tags:
        - stig_check
        - SV-257876r958804_rule


    - name: 'SV-257877r958804_rule | RHEL 9 must mount /var/tmp with the noexec option.'
      shell:
        cmd: mount | grep /var/tmp
      register: SV_257877r958804_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257877r958804_rule

    - name: 'SV-257877r958804_rule | Display check result'
      debug:
        var: SV_257877r958804_rule_check.stdout
      tags:
        - stig_check
        - SV-257877r958804_rule


    - name: 'SV-257878r958804_rule | RHEL 9 must mount /var/tmp with the nosuid option.'
      shell:
        cmd: mount | grep /var/tmp
      register: SV_257878r958804_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257878r958804_rule

    - name: 'SV-257878r958804_rule | Display check result'
      debug:
        var: SV_257878r958804_rule_check.stdout
      tags:
        - stig_check
        - SV-257878r958804_rule


    - name: 'SV-257879r1045454_rule | RHEL 9 local disk partitions must implement cryptographic mechanisms to prevent '
      shell:
        cmd: lsblk --tree
      register: SV_257879r1045454_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257879r1045454_rule

    - name: 'SV-257879r1045454_rule | Display check result'
      debug:
        var: SV_257879r1045454_rule_check.stdout
      tags:
        - stig_check
        - SV-257879r1045454_rule


    - name: 'SV-257880r1044951_rule | RHEL 9 must disable mounting of cramfs.'
      shell:
        cmd: grep -r cramfs /etc/modprobe.conf /etc/modprobe.d/*
      register: SV_257880r1044951_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257880r1044951_rule

    - name: 'SV-257880r1044951_rule | Display check result'
      debug:
        var: SV_257880r1044951_rule_check.stdout
      tags:
        - stig_check
        - SV-257880r1044951_rule


    - name: 'SV-257881r991589_rule | RHEL 9 must prevent special devices on non-root local partitions.'
      shell:
        cmd: mount | grep '^/dev\S* on /\S' | grep --invert-match 'nodev'
      register: SV_257881r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257881r991589_rule

    - name: 'SV-257881r991589_rule | Display check result'
      debug:
        var: SV_257881r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257881r991589_rule


    - name: 'SV-257882r991560_rule | RHEL 9 system commands must have mode 755 or less permissive.'
      shell:
        cmd: find -L /bin /sbin /usr/bin /usr/sbin /usr/libexec /usr/local/bin /usr/local/sbin -perm /022 -exec ls -l {} \
      register: SV_257882r991560_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257882r991560_rule

    - name: 'SV-257882r991560_rule | Display check result'
      debug:
        var: SV_257882r991560_rule_check.stdout
      tags:
        - stig_check
        - SV-257882r991560_rule


    - name: 'SV-257883r991560_rule | RHEL 9 library directories must have mode 755 or less permissive.'
      shell:
        cmd: find -L /lib /lib64 /usr/lib /usr/lib64 -perm /022 -type d -exec ls -l {} \
      register: SV_257883r991560_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257883r991560_rule

    - name: 'SV-257883r991560_rule | Display check result'
      debug:
        var: SV_257883r991560_rule_check.stdout
      tags:
        - stig_check
        - SV-257883r991560_rule


    - name: 'SV-257884r1106306_rule | RHEL 9 library files must have mode 755 or less permissive.'
      shell:
        cmd: find /lib /lib64 /usr/lib /usr/lib64 -type f -name '*.so*' -perm /022 -exec stat -c "%n %a" {} +
      register: SV_257884r1106306_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257884r1106306_rule

    - name: 'SV-257884r1106306_rule | Display check result'
      debug:
        var: SV_257884r1106306_rule_check.stdout
      tags:
        - stig_check
        - SV-257884r1106306_rule


    - name: 'SV-257885r1044953_rule | RHEL 9 /var/log directory must have mode 0755 or less permissive.'
      shell:
        cmd: stat -c '%a %n' /var/log
      register: SV_257885r1044953_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257885r1044953_rule

    - name: 'SV-257885r1044953_rule | Display check result'
      debug:
        var: SV_257885r1044953_rule_check.stdout
      tags:
        - stig_check
        - SV-257885r1044953_rule


    - name: 'SV-257886r1044955_rule | RHEL 9 /var/log/messages file must have mode 0640 or less permissive.'
      shell:
        cmd: stat -c '%a %n' /var/log/messages
      register: SV_257886r1044955_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257886r1044955_rule

    - name: 'SV-257886r1044955_rule | Display check result'
      debug:
        var: SV_257886r1044955_rule_check.stdout
      tags:
        - stig_check
        - SV-257886r1044955_rule


    - name: 'SV-257887r991557_rule | RHEL 9 audit tools must have a mode of 0755 or less permissive.'
      shell:
        cmd: stat -c "%a %n" /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/rsyslogd /sbin/augenrules
      register: SV_257887r991557_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257887r991557_rule

    - name: 'SV-257887r991557_rule | Display check result'
      debug:
        var: SV_257887r991557_rule_check.stdout
      tags:
        - stig_check
        - SV-257887r991557_rule


    - name: 'SV-257888r1134910_rule | RHEL 9 permissions of cron configuration files and directories must not be modif'
      shell:
        cmd: rpm --verify cronie crontabs | awk '! ($2 == "c" && $1 ~ /^.\..\.\.\.\..\./) {print $0}'
      register: SV_257888r1134910_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257888r1134910_rule

    - name: 'SV-257888r1134910_rule | Display check result'
      debug:
        var: SV_257888r1134910_rule_check.stdout
      tags:
        - stig_check
        - SV-257888r1134910_rule


    - name: 'SV-257889r1044959_rule | All RHEL 9 local initialization files must have mode 0740 or less permissive.'
      shell:
        cmd: find /home/bingwa/.[^.]* -maxdepth 0 -perm -740 -exec stat -c "%a %n" {} \; | more
      register: SV_257889r1044959_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257889r1044959_rule

    - name: 'SV-257889r1044959_rule | Display check result'
      debug:
        var: SV_257889r1044959_rule_check.stdout
      tags:
        - stig_check
        - SV-257889r1044959_rule


    - name: 'SV-257890r1044961_rule | All RHEL 9 local interactive user home directories must have mode 0750 or less p'
      shell:
        cmd: stat -L -c '%a %n' $(awk -F: '($3>=1000)&&($7 !~ /nologin/){print $6}' /etc/passwd) 2>/dev/null
      register: SV_257890r1044961_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257890r1044961_rule

    - name: 'SV-257890r1044961_rule | Display check result'
      debug:
        var: SV_257890r1044961_rule_check.stdout
      tags:
        - stig_check
        - SV-257890r1044961_rule


    - name: 'SV-257891r991589_rule | RHEL 9 /etc/group file must have mode 0644 or less permissive to prevent unautho'
      shell:
        cmd: stat -c "%a %n" /etc/group
      register: SV_257891r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257891r991589_rule

    - name: 'SV-257891r991589_rule | Display check result'
      debug:
        var: SV_257891r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257891r991589_rule


    - name: 'SV-257892r991589_rule | RHEL 9 /etc/group- file must have mode 0644 or less permissive to prevent unauth'
      shell:
        cmd: stat -c "%a %n" /etc/group-
      register: SV_257892r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257892r991589_rule

    - name: 'SV-257892r991589_rule | Display check result'
      debug:
        var: SV_257892r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257892r991589_rule


    - name: 'SV-257893r991589_rule | RHEL 9 /etc/gshadow file must have mode 0000 or less permissive to prevent unaut'
      shell:
        cmd: stat -c "%a %n" /etc/gshadow
      register: SV_257893r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257893r991589_rule

    - name: 'SV-257893r991589_rule | Display check result'
      debug:
        var: SV_257893r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257893r991589_rule


    - name: 'SV-257894r991589_rule | RHEL 9 /etc/gshadow- file must have mode 0000 or less permissive to prevent unau'
      shell:
        cmd: stat -c "%a %n" /etc/gshadow-
      register: SV_257894r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257894r991589_rule

    - name: 'SV-257894r991589_rule | Display check result'
      debug:
        var: SV_257894r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257894r991589_rule


    - name: 'SV-257895r991589_rule | RHEL 9 /etc/passwd file must have mode 0644 or less permissive to prevent unauth'
      shell:
        cmd: stat -c "%a %n" /etc/passwd
      register: SV_257895r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257895r991589_rule

    - name: 'SV-257895r991589_rule | Display check result'
      debug:
        var: SV_257895r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257895r991589_rule


    - name: 'SV-257896r991589_rule | RHEL 9 /etc/passwd- file must have mode 0644 or less permissive to prevent unaut'
      shell:
        cmd: stat -c "%a %n" /etc/passwd-
      register: SV_257896r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257896r991589_rule

    - name: 'SV-257896r991589_rule | Display check result'
      debug:
        var: SV_257896r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257896r991589_rule


    - name: 'SV-257897r991589_rule | RHEL 9 /etc/shadow- file must have mode 0000 or less permissive to prevent unaut'
      shell:
        cmd: stat -c "%a %n" /etc/shadow-
      register: SV_257897r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257897r991589_rule

    - name: 'SV-257897r991589_rule | Display check result'
      debug:
        var: SV_257897r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257897r991589_rule


    - name: 'SV-257898r991589_rule | RHEL 9 /etc/group file must be owned by root.'
      shell:
        cmd: stat -c "%U %n" /etc/group
      register: SV_257898r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257898r991589_rule

    - name: 'SV-257898r991589_rule | Display check result'
      debug:
        var: SV_257898r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257898r991589_rule


    - name: 'SV-257899r991589_rule | RHEL 9 /etc/group file must be group-owned by root.'
      shell:
        cmd: stat -c "%G %n" /etc/group
      register: SV_257899r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257899r991589_rule

    - name: 'SV-257899r991589_rule | Display check result'
      debug:
        var: SV_257899r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257899r991589_rule


    - name: 'SV-257900r991589_rule | RHEL 9 /etc/group- file must be owned by root.'
      shell:
        cmd: stat -c "%U %n" /etc/group-
      register: SV_257900r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257900r991589_rule

    - name: 'SV-257900r991589_rule | Display check result'
      debug:
        var: SV_257900r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257900r991589_rule


    - name: 'SV-257901r991589_rule | RHEL 9 /etc/group- file must be group-owned by root.'
      shell:
        cmd: stat -c "%G %n" /etc/group-
      register: SV_257901r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257901r991589_rule

    - name: 'SV-257901r991589_rule | Display check result'
      debug:
        var: SV_257901r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257901r991589_rule


    - name: 'SV-257902r991589_rule | RHEL 9 /etc/gshadow file must be owned by root.'
      shell:
        cmd: stat -c "%U %n" /etc/gshadow
      register: SV_257902r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257902r991589_rule

    - name: 'SV-257902r991589_rule | Display check result'
      debug:
        var: SV_257902r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257902r991589_rule


    - name: 'SV-257903r991589_rule | RHEL 9 /etc/gshadow file must be group-owned by root.'
      shell:
        cmd: stat -c "%G %n" /etc/gshadow
      register: SV_257903r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257903r991589_rule

    - name: 'SV-257903r991589_rule | Display check result'
      debug:
        var: SV_257903r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257903r991589_rule


    - name: 'SV-257904r991589_rule | RHEL 9 /etc/gshadow- file must be owned by root.'
      shell:
        cmd: stat -c "%U %n" /etc/gshadow-
      register: SV_257904r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257904r991589_rule

    - name: 'SV-257904r991589_rule | Display check result'
      debug:
        var: SV_257904r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257904r991589_rule


    - name: 'SV-257905r991589_rule | RHEL 9 /etc/gshadow- file must be group-owned by root.'
      shell:
        cmd: stat -c "%G %n" /etc/gshadow-
      register: SV_257905r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257905r991589_rule

    - name: 'SV-257905r991589_rule | Display check result'
      debug:
        var: SV_257905r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257905r991589_rule


    - name: 'SV-257906r991589_rule | RHEL 9 /etc/passwd file must be owned by root.'
      shell:
        cmd: stat -c "%U %n" /etc/passwd
      register: SV_257906r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257906r991589_rule

    - name: 'SV-257906r991589_rule | Display check result'
      debug:
        var: SV_257906r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257906r991589_rule


    - name: 'SV-257907r991589_rule | RHEL 9 /etc/passwd file must be group-owned by root.'
      shell:
        cmd: stat -c "%G %n" /etc/passwd
      register: SV_257907r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257907r991589_rule

    - name: 'SV-257907r991589_rule | Display check result'
      debug:
        var: SV_257907r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257907r991589_rule


    - name: 'SV-257908r991589_rule | RHEL 9 /etc/passwd- file must be owned by root.'
      shell:
        cmd: stat -c "%U %n" /etc/passwd-
      register: SV_257908r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257908r991589_rule

    - name: 'SV-257908r991589_rule | Display check result'
      debug:
        var: SV_257908r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257908r991589_rule


    - name: 'SV-257909r991589_rule | RHEL 9 /etc/passwd- file must be group-owned by root.'
      shell:
        cmd: stat -c "%G %n" /etc/passwd-
      register: SV_257909r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257909r991589_rule

    - name: 'SV-257909r991589_rule | Display check result'
      debug:
        var: SV_257909r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257909r991589_rule


    - name: 'SV-257910r991589_rule | RHEL 9 /etc/shadow file must be owned by root.'
      shell:
        cmd: stat -c "%U %n" /etc/shadow
      register: SV_257910r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257910r991589_rule

    - name: 'SV-257910r991589_rule | Display check result'
      debug:
        var: SV_257910r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257910r991589_rule


    - name: 'SV-257911r991589_rule | RHEL 9 /etc/shadow file must be group-owned by root.'
      shell:
        cmd: stat -c "%G %n" /etc/shadow
      register: SV_257911r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257911r991589_rule

    - name: 'SV-257911r991589_rule | Display check result'
      debug:
        var: SV_257911r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257911r991589_rule


    - name: 'SV-257912r991589_rule | RHEL 9 /etc/shadow- file must be owned by root.'
      shell:
        cmd: stat -c "%U %n" /etc/shadow-
      register: SV_257912r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257912r991589_rule

    - name: 'SV-257912r991589_rule | Display check result'
      debug:
        var: SV_257912r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257912r991589_rule


    - name: 'SV-257913r991589_rule | RHEL 9 /etc/shadow- file must be group-owned by root.'
      shell:
        cmd: stat -c "%G %n" /etc/shadow-
      register: SV_257913r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257913r991589_rule

    - name: 'SV-257913r991589_rule | Display check result'
      debug:
        var: SV_257913r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257913r991589_rule


    - name: 'SV-257914r1044969_rule | RHEL 9 /var/log directory must be owned by root.'
      shell:
        cmd: stat -c "%U %n" /var/log
      register: SV_257914r1044969_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257914r1044969_rule

    - name: 'SV-257914r1044969_rule | Display check result'
      debug:
        var: SV_257914r1044969_rule_check.stdout
      tags:
        - stig_check
        - SV-257914r1044969_rule


    - name: 'SV-257915r1044971_rule | RHEL 9 /var/log directory must be group-owned by root.'
      shell:
        cmd: stat -c "%G %n" /var/log
      register: SV_257915r1044971_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257915r1044971_rule

    - name: 'SV-257915r1044971_rule | Display check result'
      debug:
        var: SV_257915r1044971_rule_check.stdout
      tags:
        - stig_check
        - SV-257915r1044971_rule


    - name: 'SV-257916r1101916_rule | RHEL 9 /var/log/messages file must be owned by root.'
      shell:
        cmd: stat -c "%U %n" /var/log/messages
      register: SV_257916r1101916_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257916r1101916_rule

    - name: 'SV-257916r1101916_rule | Display check result'
      debug:
        var: SV_257916r1101916_rule_check.stdout
      tags:
        - stig_check
        - SV-257916r1101916_rule


    - name: 'SV-257917r1101914_rule | RHEL 9 /var/log/messages file must be group-owned by root.'
      shell:
        cmd: stat -c "%G %n" /var/log/messages
      register: SV_257917r1101914_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257917r1101914_rule

    - name: 'SV-257917r1101914_rule | Display check result'
      debug:
        var: SV_257917r1101914_rule_check.stdout
      tags:
        - stig_check
        - SV-257917r1101914_rule


    - name: 'SV-257918r1044977_rule | RHEL 9 system commands must be owned by root.'
      shell:
        cmd: find -L /bin /sbin /usr/bin /usr/sbin /usr/libexec /usr/local/bin /usr/local/sbin ! -user root -exec stat -L -c "%U %n" {} \
      register: SV_257918r1044977_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257918r1044977_rule

    - name: 'SV-257918r1044977_rule | Display check result'
      debug:
        var: SV_257918r1044977_rule_check.stdout
      tags:
        - stig_check
        - SV-257918r1044977_rule


    - name: 'SV-257919r1044979_rule | RHEL 9 system commands must be group-owned by root or a system account.'
      shell:
        cmd: find -L /bin /sbin /usr/bin /usr/sbin /usr/libexec /usr/local/bin /usr/local/sbin ! -group root -exec stat -L -c "%G %n" {} \
      register: SV_257919r1044979_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257919r1044979_rule

    - name: 'SV-257919r1044979_rule | Display check result'
      debug:
        var: SV_257919r1044979_rule_check.stdout
      tags:
        - stig_check
        - SV-257919r1044979_rule


    - name: 'SV-257920r1101926_rule | RHEL 9 library files must be owned by root.'
      shell:
        cmd: find /lib /lib64 /usr/lib /usr/lib64 -type f -name '*.so*' ! -user root -exec stat -c "%n %U" {} +
      register: SV_257920r1101926_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257920r1101926_rule

    - name: 'SV-257920r1101926_rule | Display check result'
      debug:
        var: SV_257920r1101926_rule_check.stdout
      tags:
        - stig_check
        - SV-257920r1101926_rule


    - name: 'SV-257921r1106308_rule | RHEL 9 library files must be group-owned by root or a system account.'
      shell:
        cmd: find /lib /lib64 /usr/lib /usr/lib64 -type f -name '*.so*' ! -group root -exec stat -c "%n %G" {} +
      register: SV_257921r1106308_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257921r1106308_rule

    - name: 'SV-257921r1106308_rule | Display check result'
      debug:
        var: SV_257921r1106308_rule_check.stdout
      tags:
        - stig_check
        - SV-257921r1106308_rule


    - name: 'SV-257922r1044988_rule | RHEL 9 library directories must be owned by root.'
      shell:
        cmd: find /lib /lib64 /usr/lib /usr/lib64 ! -user root -type d -exec stat -c "%U %n" {} \
      register: SV_257922r1044988_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257922r1044988_rule

    - name: 'SV-257922r1044988_rule | Display check result'
      debug:
        var: SV_257922r1044988_rule_check.stdout
      tags:
        - stig_check
        - SV-257922r1044988_rule


    - name: 'SV-257923r1044991_rule | RHEL 9 library directories must be group-owned by root or a system account.'
      shell:
        cmd: find /lib /lib64 /usr/lib /usr/lib64 ! -group root -type d -exec stat -c "%G %n" {} \
      register: SV_257923r1044991_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257923r1044991_rule

    - name: 'SV-257923r1044991_rule | Display check result'
      debug:
        var: SV_257923r1044991_rule_check.stdout
      tags:
        - stig_check
        - SV-257923r1044991_rule


    - name: 'SV-257924r991557_rule | RHEL 9 audit tools must be owned by root.'
      shell:
        cmd: stat -c "%U %n" /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/rsyslogd /sbin/augenrules
      register: SV_257924r991557_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257924r991557_rule

    - name: 'SV-257924r991557_rule | Display check result'
      debug:
        var: SV_257924r991557_rule_check.stdout
      tags:
        - stig_check
        - SV-257924r991557_rule


    - name: 'SV-257925r991557_rule | RHEL 9 audit tools must be group-owned by root.'
      shell:
        cmd: stat -c "%G %n" /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/rsyslogd /sbin/augenrules
      register: SV_257925r991557_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257925r991557_rule

    - name: 'SV-257925r991557_rule | Display check result'
      debug:
        var: SV_257925r991557_rule_check.stdout
      tags:
        - stig_check
        - SV-257925r991557_rule


    - name: 'SV-257926r991589_rule | RHEL 9 cron configuration files directory must be owned by root.'
      shell:
        cmd: stat -c "%U %n" /etc/cron*
      register: SV_257926r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257926r991589_rule

    - name: 'SV-257926r991589_rule | Display check result'
      debug:
        var: SV_257926r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257926r991589_rule


    - name: 'SV-257927r991589_rule | RHEL 9 cron configuration files directory must be group-owned by root.'
      shell:
        cmd: stat -c "%G %n" /etc/cron*
      register: SV_257927r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257927r991589_rule

    - name: 'SV-257927r991589_rule | Display check result'
      debug:
        var: SV_257927r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257927r991589_rule


    - name: 'SV-257928r1044992_rule | All RHEL 9 world-writable directories must be owned by root, sys, bin, or an app'
      shell:
        cmd: find PART -xdev -type d -perm -0002 -uid +0 -print
      register: SV_257928r1044992_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257928r1044992_rule

    - name: 'SV-257928r1044992_rule | Display check result'
      debug:
        var: SV_257928r1044992_rule_check.stdout
      tags:
        - stig_check
        - SV-257928r1044992_rule


    - name: 'SV-257929r1117267_rule | A sticky bit must be set on all RHEL 9 public directories.'
      shell:
        cmd: find / -type d \( -perm -0002 -a ! -perm -1000 \) -print 2>/dev/null
      register: SV_257929r1117267_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257929r1117267_rule

    - name: 'SV-257929r1117267_rule | Display check result'
      debug:
        var: SV_257929r1117267_rule_check.stdout
      tags:
        - stig_check
        - SV-257929r1117267_rule


    - name: 'SV-257930r991589_rule | All RHEL 9 local files and directories must have a valid group owner.'
      shell:
        cmd: df --local -P | awk {'if (NR!=1) print $6'} | sudo xargs -I '{}' find '{}' -xdev -nogroup
      register: SV_257930r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257930r991589_rule

    - name: 'SV-257930r991589_rule | Display check result'
      debug:
        var: SV_257930r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257930r991589_rule


    - name: 'SV-257931r991589_rule | All RHEL 9 local files and directories must have a valid owner.'
      shell:
        cmd: df --local -P | awk {'if (NR!=1) print $6'} | sudo xargs -I '{}' find '{}' -xdev -nouser
      register: SV_257931r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257931r991589_rule

    - name: 'SV-257931r991589_rule | Display check result'
      debug:
        var: SV_257931r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257931r991589_rule


    - name: 'SV-257932r1014838_rule | RHEL 9 must be configured so that all system device files are correctly labeled '
      shell:
        cmd: find /dev -context *:device_t:* \( -type c -o -type b \) -printf "%p %Z\n"
      register: SV_257932r1014838_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257932r1014838_rule

    - name: 'SV-257932r1014838_rule | Display check result'
      debug:
        var: SV_257932r1014838_rule_check.stdout
      tags:
        - stig_check
        - SV-257932r1014838_rule


    - name: 'SV-257934r991589_rule | RHEL 9 /etc/shadow file must have mode 0000 to prevent unauthorized access.'
      shell:
        cmd: stat -c "%a %n" /etc/shadow
      register: SV_257934r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257934r991589_rule

    - name: 'SV-257934r991589_rule | Display check result'
      debug:
        var: SV_257934r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257934r991589_rule


    - name: 'SV-257935r1044994_rule | RHEL 9 must have the firewalld package installed.'
      shell:
        cmd: dnf list --installed firewalld
      register: SV_257935r1044994_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257935r1044994_rule

    - name: 'SV-257935r1044994_rule | Display check result'
      debug:
        var: SV_257935r1044994_rule_check.stdout
      tags:
        - stig_check
        - SV-257935r1044994_rule


    - name: 'SV-257936r1044995_rule | The firewalld service on RHEL 9 must be active.'
      shell:
        cmd: systemctl is-active firewalld
      register: SV_257936r1044995_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257936r1044995_rule

    - name: 'SV-257936r1044995_rule | Display check result'
      debug:
        var: SV_257936r1044995_rule_check.stdout
      tags:
        - stig_check
        - SV-257936r1044995_rule


    - name: 'SV-257937r1106310_rule | The RHEL 9 firewall must employ a deny-all, allow-by-exception policy for allowi'
      shell:
        cmd: firewall-cmd --state
      register: SV_257937r1106310_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257937r1106310_rule

    - name: 'SV-257937r1106310_rule | Display check result'
      debug:
        var: SV_257937r1106310_rule_check.stdout
      tags:
        - stig_check
        - SV-257937r1106310_rule


    - name: 'SV-257939r1044997_rule | RHEL 9 must protect against or limit the effects of denial-of-service (DoS) atta'
      shell:
        cmd: grep -i firewallbackend /etc/firewalld/firewalld.conf
      register: SV_257939r1044997_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257939r1044997_rule

    - name: 'SV-257939r1044997_rule | Display check result'
      debug:
        var: SV_257939r1044997_rule_check.stdout
      tags:
        - stig_check
        - SV-257939r1044997_rule


    - name: 'SV-257940r1106312_rule | RHEL 9 must be configured to prohibit or restrict the use of functions, ports, p'
      shell:
        cmd: firewall-cmd --list-all-zones | grep -e "active" -e "services"
      register: SV_257940r1106312_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257940r1106312_rule

    - name: 'SV-257940r1106312_rule | Display check result'
      debug:
        var: SV_257940r1106312_rule_check.stdout
      tags:
        - stig_check
        - SV-257940r1106312_rule


    - name: 'SV-257941r991589_rule | RHEL 9 network interfaces must not be in promiscuous mode.'
      shell:
        cmd: ip link | grep -i promisc
      register: SV_257941r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257941r991589_rule

    - name: 'SV-257941r991589_rule | Display check result'
      debug:
        var: SV_257941r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257941r991589_rule


    - name: 'SV-257942r1106314_rule | RHEL 9 must enable hardening for the Berkeley Packet Filter just-in-time compile'
      shell:
        cmd: sysctl net.core.bpf_jit_harden
      register: SV_257942r1106314_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257942r1106314_rule

    - name: 'SV-257942r1106314_rule | Display check result'
      debug:
        var: SV_257942r1106314_rule_check.stdout
      tags:
        - stig_check
        - SV-257942r1106314_rule


    - name: 'SV-257943r1045001_rule | RHEL 9 must have the chrony package installed.'
      shell:
        cmd: dnf list --installed chrony
      register: SV_257943r1045001_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257943r1045001_rule

    - name: 'SV-257943r1045001_rule | Display check result'
      debug:
        var: SV_257943r1045001_rule_check.stdout
      tags:
        - stig_check
        - SV-257943r1045001_rule


    - name: 'SV-257944r1038944_rule | RHEL 9 chronyd service must be enabled.'
      shell:
        cmd: systemctl is-active chronyd
      register: SV_257944r1038944_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257944r1038944_rule

    - name: 'SV-257944r1038944_rule | Display check result'
      debug:
        var: SV_257944r1038944_rule_check.stdout
      tags:
        - stig_check
        - SV-257944r1038944_rule


    - name: 'SV-257945r1038944_rule | RHEL 9 must securely compare internal information system clocks at least every 2'
      shell:
        cmd: grep maxpoll /etc/chrony.conf
      register: SV_257945r1038944_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257945r1038944_rule

    - name: 'SV-257945r1038944_rule | Display check result'
      debug:
        var: SV_257945r1038944_rule_check.stdout
      tags:
        - stig_check
        - SV-257945r1038944_rule


    - name: 'SV-257946r958480_rule | RHEL 9 must disable the chrony daemon from acting as a server.'
      shell:
        cmd: grep -w port /etc/chrony.conf
      register: SV_257946r958480_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257946r958480_rule

    - name: 'SV-257946r958480_rule | Display check result'
      debug:
        var: SV_257946r958480_rule_check.stdout
      tags:
        - stig_check
        - SV-257946r958480_rule


    - name: 'SV-257947r958480_rule | RHEL 9 must disable network management of the chrony daemon.'
      shell:
        cmd: grep -w cmdport /etc/chrony.conf
      register: SV_257947r958480_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257947r958480_rule

    - name: 'SV-257947r958480_rule | Display check result'
      debug:
        var: SV_257947r958480_rule_check.stdout
      tags:
        - stig_check
        - SV-257947r958480_rule


    - name: 'SV-257948r1045004_rule | RHEL 9 systems using Domain Name Servers (DNS) resolution must have at least two'
      shell:
        cmd: grep nameserver /etc/resolv.conf
      register: SV_257948r1045004_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257948r1045004_rule

    - name: 'SV-257948r1045004_rule | Display check result'
      debug:
        var: SV_257948r1045004_rule_check.stdout
      tags:
        - stig_check
        - SV-257948r1045004_rule


    - name: 'SV-257949r1134947_rule | RHEL 9 must configure a DNS processing mode in Network Manager.'
      debug:
        msg: "SV-257949r1134947_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-257949r1134947_rule


    - name: 'SV-257950r1045006_rule | RHEL 9 must not have unauthorized IP tunnels configured.'
      shell:
        cmd: systemctl is-active ipsec
      register: SV_257950r1045006_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257950r1045006_rule

    - name: 'SV-257950r1045006_rule | Display check result'
      debug:
        var: SV_257950r1045006_rule_check.stdout
      tags:
        - stig_check
        - SV-257950r1045006_rule


    - name: 'SV-257951r1014843_rule | RHEL 9 must be configured to prevent unrestricted mail relaying.'
      debug:
        msg: "SV-257951r1014843_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-257951r1014843_rule


    - name: 'SV-257953r958424_rule | RHEL 9 must forward mail from postmaster to the root account using a postfix ali'
      shell:
        cmd: grep "postmaster:\s*root$" /etc/aliases
      register: SV_257953r958424_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257953r958424_rule

    - name: 'SV-257953r958424_rule | Display check result'
      debug:
        var: SV_257953r958424_rule_check.stdout
      tags:
        - stig_check
        - SV-257953r958424_rule


    - name: 'SV-257954r1106315_rule | RHEL 9 libreswan package must be installed.'
      shell:
        cmd: dnf list --installed libreswan
      register: SV_257954r1106315_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257954r1106315_rule

    - name: 'SV-257954r1106315_rule | Display check result'
      debug:
        var: SV_257954r1106315_rule_check.stdout
      tags:
        - stig_check
        - SV-257954r1106315_rule


    - name: 'SV-257955r991589_rule | There must be no shosts.equiv files on RHEL 9.'
      shell:
        cmd: find / -name shosts.equiv
      register: SV_257955r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257955r991589_rule

    - name: 'SV-257955r991589_rule | Display check result'
      debug:
        var: SV_257955r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257955r991589_rule


    - name: 'SV-257956r991589_rule | There must be no .shosts files on RHEL 9.'
      shell:
        cmd: find / -name .shosts
      register: SV_257956r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257956r991589_rule

    - name: 'SV-257956r991589_rule | Display check result'
      debug:
        var: SV_257956r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257956r991589_rule


    - name: 'SV-257957r1106317_rule | RHEL 9 must be configured to use TCP syncookies.'
      shell:
        cmd: sysctl net.ipv4.tcp_syncookies
      register: SV_257957r1106317_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257957r1106317_rule

    - name: 'SV-257957r1106317_rule | Display check result'
      debug:
        var: SV_257957r1106317_rule_check.stdout
      tags:
        - stig_check
        - SV-257957r1106317_rule


    - name: 'SV-257958r1106319_rule | RHEL 9 must ignore Internet Protocol version 4 (IPv4) Internet Control Message P'
      shell:
        cmd: sysctl net.ipv4.conf.all.accept_redirects
      register: SV_257958r1106319_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257958r1106319_rule

    - name: 'SV-257958r1106319_rule | Display check result'
      debug:
        var: SV_257958r1106319_rule_check.stdout
      tags:
        - stig_check
        - SV-257958r1106319_rule


    - name: 'SV-257959r1102024_rule | RHEL 9 must not forward Internet Protocol version 4 (IPv4) source-routed packets'
      shell:
        cmd: sysctl net.ipv4.conf.all.accept_source_route
      register: SV_257959r1102024_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257959r1102024_rule

    - name: 'SV-257959r1102024_rule | Display check result'
      debug:
        var: SV_257959r1102024_rule_check.stdout
      tags:
        - stig_check
        - SV-257959r1102024_rule


    - name: 'SV-257960r1106321_rule | RHEL 9 must log IPv4 packets with impossible addresses.'
      shell:
        cmd: sysctl net.ipv4.conf.all.log_martians
      register: SV_257960r1106321_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257960r1106321_rule

    - name: 'SV-257960r1106321_rule | Display check result'
      debug:
        var: SV_257960r1106321_rule_check.stdout
      tags:
        - stig_check
        - SV-257960r1106321_rule


    - name: 'SV-257961r1106323_rule | RHEL 9 must log IPv4 packets with impossible addresses by default.'
      shell:
        cmd: sysctl net.ipv4.conf.default.log_martians
      register: SV_257961r1106323_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257961r1106323_rule

    - name: 'SV-257961r1106323_rule | Display check result'
      debug:
        var: SV_257961r1106323_rule_check.stdout
      tags:
        - stig_check
        - SV-257961r1106323_rule


    - name: 'SV-257962r1106437_rule | RHEL 9 must use reverse path filtering on all IPv4 interfaces.'
      shell:
        cmd: sysctl net.ipv4.conf.all.rp_filter
      register: SV_257962r1106437_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257962r1106437_rule

    - name: 'SV-257962r1106437_rule | Display check result'
      debug:
        var: SV_257962r1106437_rule_check.stdout
      tags:
        - stig_check
        - SV-257962r1106437_rule


    - name: 'SV-257963r1106328_rule | RHEL 9 must prevent IPv4 Internet Control Message Protocol (ICMP) redirect messa'
      shell:
        cmd: sysctl net.ipv4.conf.default.accept_redirects
      register: SV_257963r1106328_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257963r1106328_rule

    - name: 'SV-257963r1106328_rule | Display check result'
      debug:
        var: SV_257963r1106328_rule_check.stdout
      tags:
        - stig_check
        - SV-257963r1106328_rule


    - name: 'SV-257964r1106438_rule | RHEL 9 must not forward IPv4 source-routed packets by default.'
      shell:
        cmd: sysctl net.ipv4.conf.default.accept_source_route
      register: SV_257964r1106438_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257964r1106438_rule

    - name: 'SV-257964r1106438_rule | Display check result'
      debug:
        var: SV_257964r1106438_rule_check.stdout
      tags:
        - stig_check
        - SV-257964r1106438_rule


    - name: 'SV-257965r1106333_rule | RHEL 9 must use a reverse-path filter for IPv4 network traffic when possible by '
      shell:
        cmd: sysctl net.ipv4.conf.default.rp_filter
      register: SV_257965r1106333_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257965r1106333_rule

    - name: 'SV-257965r1106333_rule | Display check result'
      debug:
        var: SV_257965r1106333_rule_check.stdout
      tags:
        - stig_check
        - SV-257965r1106333_rule


    - name: 'SV-257966r1106440_rule | RHEL 9 must not respond to Internet Control Message Protocol (ICMP) echoes sent '
      shell:
        cmd: sysctl net.ipv4.icmp_echo_ignore_broadcasts
      register: SV_257966r1106440_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257966r1106440_rule

    - name: 'SV-257966r1106440_rule | Display check result'
      debug:
        var: SV_257966r1106440_rule_check.stdout
      tags:
        - stig_check
        - SV-257966r1106440_rule


    - name: 'SV-257967r1106337_rule | RHEL 9 must limit the number of bogus Internet Control Message Protocol (ICMP) r'
      shell:
        cmd: sysctl net.ipv4.icmp_ignore_bogus_error_responses
      register: SV_257967r1106337_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257967r1106337_rule

    - name: 'SV-257967r1106337_rule | Display check result'
      debug:
        var: SV_257967r1106337_rule_check.stdout
      tags:
        - stig_check
        - SV-257967r1106337_rule


    - name: 'SV-257968r1106339_rule | RHEL 9 must not send Internet Control Message Protocol (ICMP) redirects.'
      shell:
        cmd: sysctl net.ipv4.conf.all.send_redirects
      register: SV_257968r1106339_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257968r1106339_rule

    - name: 'SV-257968r1106339_rule | Display check result'
      debug:
        var: SV_257968r1106339_rule_check.stdout
      tags:
        - stig_check
        - SV-257968r1106339_rule


    - name: 'SV-257969r991589_rule | RHEL 9 must not allow interfaces to perform Internet Control Message Protocol (I'
      shell:
        cmd: sysctl net.ipv4.conf.default.send_redirects
      register: SV_257969r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257969r991589_rule

    - name: 'SV-257969r991589_rule | Display check result'
      debug:
        var: SV_257969r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-257969r991589_rule


    - name: 'SV-257970r1106442_rule | RHEL 9 must not enable IPv4 packet forwarding unless the system is a router.'
      shell:
        cmd: sysctl net.ipv4.conf.all.forwarding
      register: SV_257970r1106442_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257970r1106442_rule

    - name: 'SV-257970r1106442_rule | Display check result'
      debug:
        var: SV_257970r1106442_rule_check.stdout
      tags:
        - stig_check
        - SV-257970r1106442_rule


    - name: 'SV-257971r1106444_rule | RHEL 9 must not accept router advertisements on all IPv6 interfaces.'
      shell:
        cmd: sysctl net.ipv6.conf.all.accept_ra
      register: SV_257971r1106444_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257971r1106444_rule

    - name: 'SV-257971r1106444_rule | Display check result'
      debug:
        var: SV_257971r1106444_rule_check.stdout
      tags:
        - stig_check
        - SV-257971r1106444_rule


    - name: 'SV-257972r1106446_rule | RHEL 9 must ignore IPv6 Internet Control Message Protocol (ICMP) redirect messag'
      shell:
        cmd: sysctl net.ipv6.conf.all.accept_redirects
      register: SV_257972r1106446_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257972r1106446_rule

    - name: 'SV-257972r1106446_rule | Display check result'
      debug:
        var: SV_257972r1106446_rule_check.stdout
      tags:
        - stig_check
        - SV-257972r1106446_rule


    - name: 'SV-257973r1106448_rule | RHEL 9 must not forward IPv6 source-routed packets.'
      shell:
        cmd: sysctl net.ipv6.conf.all.accept_source_route
      register: SV_257973r1106448_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257973r1106448_rule

    - name: 'SV-257973r1106448_rule | Display check result'
      debug:
        var: SV_257973r1106448_rule_check.stdout
      tags:
        - stig_check
        - SV-257973r1106448_rule


    - name: 'SV-257974r1106450_rule | RHEL 9 must not enable IPv6 packet forwarding unless the system is a router.'
      shell:
        cmd: sysctl net.ipv6.conf.all.forwarding
      register: SV_257974r1106450_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257974r1106450_rule

    - name: 'SV-257974r1106450_rule | Display check result'
      debug:
        var: SV_257974r1106450_rule_check.stdout
      tags:
        - stig_check
        - SV-257974r1106450_rule


    - name: 'SV-257975r1106452_rule | RHEL 9 must not accept router advertisements on all IPv6 interfaces by default.'
      shell:
        cmd: sysctl net.ipv6.conf.default.accept_ra
      register: SV_257975r1106452_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257975r1106452_rule

    - name: 'SV-257975r1106452_rule | Display check result'
      debug:
        var: SV_257975r1106452_rule_check.stdout
      tags:
        - stig_check
        - SV-257975r1106452_rule


    - name: 'SV-257976r1106454_rule | RHEL 9 must prevent IPv6 Internet Control Message Protocol (ICMP) redirect messa'
      shell:
        cmd: sysctl net.ipv6.conf.default.accept_redirects
      register: SV_257976r1106454_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257976r1106454_rule

    - name: 'SV-257976r1106454_rule | Display check result'
      debug:
        var: SV_257976r1106454_rule_check.stdout
      tags:
        - stig_check
        - SV-257976r1106454_rule


    - name: 'SV-257977r1106456_rule | RHEL 9 must not forward IPv6 source-routed packets by default.'
      shell:
        cmd: sysctl net.ipv6.conf.default.accept_source_route
      register: SV_257977r1106456_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257977r1106456_rule

    - name: 'SV-257977r1106456_rule | Display check result'
      debug:
        var: SV_257977r1106456_rule_check.stdout
      tags:
        - stig_check
        - SV-257977r1106456_rule


    - name: 'SV-257978r1045013_rule | All RHEL 9 networked systems must have SSH installed.'
      shell:
        cmd: dnf list --installed openssh-server
      register: SV_257978r1045013_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257978r1045013_rule

    - name: 'SV-257978r1045013_rule | Display check result'
      debug:
        var: SV_257978r1045013_rule_check.stdout
      tags:
        - stig_check
        - SV-257978r1045013_rule


    - name: 'SV-257979r958908_rule | All RHEL 9 networked systems must have and implement SSH to protect the confiden'
      shell:
        cmd: systemctl is-active sshd
      register: SV_257979r958908_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257979r958908_rule

    - name: 'SV-257979r958908_rule | Display check result'
      debug:
        var: SV_257979r958908_rule_check.stdout
      tags:
        - stig_check
        - SV-257979r958908_rule


    - name: 'SV-257980r1045016_rule | RHEL 9 must have the openssh-clients package installed.'
      shell:
        cmd: dnf list --installed openssh-clients
      register: SV_257980r1045016_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257980r1045016_rule

    - name: 'SV-257980r1045016_rule | Display check result'
      debug:
        var: SV_257980r1045016_rule_check.stdout
      tags:
        - stig_check
        - SV-257980r1045016_rule


    - name: 'SV-257981r1101970_rule | RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before '
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*banner'
      register: SV_257981r1101970_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257981r1101970_rule

    - name: 'SV-257981r1101970_rule | Display check result'
      debug:
        var: SV_257981r1101970_rule_check.stdout
      tags:
        - stig_check
        - SV-257981r1101970_rule


    - name: 'SV-257982r1045021_rule | RHEL 9 must log SSH connection attempts and failures to the server.'
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*loglevel'
      register: SV_257982r1045021_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257982r1045021_rule

    - name: 'SV-257982r1045021_rule | Display check result'
      debug:
        var: SV_257982r1045021_rule_check.stdout
      tags:
        - stig_check
        - SV-257982r1045021_rule


    - name: 'SV-257983r1045024_rule | RHEL 9 SSHD must accept public key authentication.'
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*pubkeyauthentication'
      register: SV_257983r1045024_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257983r1045024_rule

    - name: 'SV-257983r1045024_rule | Display check result'
      debug:
        var: SV_257983r1045024_rule_check.stdout
      tags:
        - stig_check
        - SV-257983r1045024_rule


    - name: 'SV-257984r1045026_rule | RHEL 9 SSHD must not allow blank passwords.'
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*permitemptypasswords'
      register: SV_257984r1045026_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257984r1045026_rule

    - name: 'SV-257984r1045026_rule | Display check result'
      debug:
        var: SV_257984r1045026_rule_check.stdout
      tags:
        - stig_check
        - SV-257984r1045026_rule


    - name: 'SV-257985r1069364_rule | RHEL 9 must not permit direct logons to the root account using remote access via'
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*permitrootlogin'
      register: SV_257985r1069364_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257985r1069364_rule

    - name: 'SV-257985r1069364_rule | Display check result'
      debug:
        var: SV_257985r1069364_rule_check.stdout
      tags:
        - stig_check
        - SV-257985r1069364_rule


    - name: 'SV-257986r1045030_rule | RHEL 9 must enable the Pluggable Authentication Module (PAM) interface for SSHD.'
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*usepam'
      register: SV_257986r1045030_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257986r1045030_rule

    - name: 'SV-257986r1045030_rule | Display check result'
      debug:
        var: SV_257986r1045030_rule_check.stdout
      tags:
        - stig_check
        - SV-257986r1045030_rule


    - name: 'SV-257989r1051240_rule | The RHEL 9 SSH server must be configured to use only DOD-approved encryption cip'
      shell:
        cmd: grep -i Ciphers /etc/crypto-policies/back-ends/opensshserver.config
      register: SV_257989r1051240_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257989r1051240_rule

    - name: 'SV-257989r1051240_rule | Display check result'
      debug:
        var: SV_257989r1051240_rule_check.stdout
      tags:
        - stig_check
        - SV-257989r1051240_rule


    - name: 'SV-257991r1051246_rule | The RHEL 9 SSH server must be configured to use only Message Authentication Code'
      shell:
        cmd: grep -i MACs /etc/crypto-policies/back-ends/opensshserver.config
      register: SV_257991r1051246_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257991r1051246_rule

    - name: 'SV-257991r1051246_rule | Display check result'
      debug:
        var: SV_257991r1051246_rule_check.stdout
      tags:
        - stig_check
        - SV-257991r1051246_rule


    - name: 'SV-257992r1045047_rule | RHEL 9 must not allow a noncertificate trusted host SSH logon to the system.'
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*hostbasedauthentication'
      register: SV_257992r1045047_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257992r1045047_rule

    - name: 'SV-257992r1045047_rule | Display check result'
      debug:
        var: SV_257992r1045047_rule_check.stdout
      tags:
        - stig_check
        - SV-257992r1045047_rule


    - name: 'SV-257993r1045049_rule | RHEL 9 must not allow users to override SSH environment variables.'
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*permituserenvironment'
      register: SV_257993r1045049_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257993r1045049_rule

    - name: 'SV-257993r1045049_rule | Display check result'
      debug:
        var: SV_257993r1045049_rule_check.stdout
      tags:
        - stig_check
        - SV-257993r1045049_rule


    - name: 'SV-257994r1045051_rule | RHEL 9 must force a frequent session key renegotiation for SSH connections to th'
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*rekeylimit'
      register: SV_257994r1045051_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257994r1045051_rule

    - name: 'SV-257994r1045051_rule | Display check result'
      debug:
        var: SV_257994r1045051_rule_check.stdout
      tags:
        - stig_check
        - SV-257994r1045051_rule


    - name: 'SV-257995r1045053_rule | RHEL 9 must be configured so that all network connections associated with SSH tr'
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*clientalivecountmax'
      register: SV_257995r1045053_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257995r1045053_rule

    - name: 'SV-257995r1045053_rule | Display check result'
      debug:
        var: SV_257995r1045053_rule_check.stdout
      tags:
        - stig_check
        - SV-257995r1045053_rule


    - name: 'SV-257996r1134915_rule | RHEL 9 must be configured so that all network connections associated with SSH tr'
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*clientaliveinterval'
      register: SV_257996r1134915_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257996r1134915_rule

    - name: 'SV-257996r1134915_rule | Display check result'
      debug:
        var: SV_257996r1134915_rule_check.stdout
      tags:
        - stig_check
        - SV-257996r1134915_rule


    - name: 'SV-257997r1069370_rule | RHEL 9 SSH server configuration file must be group-owned by root.'
      shell:
        cmd: find /etc/ssh/sshd_config /etc/ssh/sshd_config.d -exec stat -c "%G %n" {} \
      register: SV_257997r1069370_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257997r1069370_rule

    - name: 'SV-257997r1069370_rule | Display check result'
      debug:
        var: SV_257997r1069370_rule_check.stdout
      tags:
        - stig_check
        - SV-257997r1069370_rule


    - name: 'SV-257998r1082181_rule | The RHEL 9 SSH server configuration file must be owned by root.'
      shell:
        cmd: find /etc/ssh/sshd_config /etc/ssh/sshd_config.d -exec stat -c "%U %n" {} \
      register: SV_257998r1082181_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257998r1082181_rule

    - name: 'SV-257998r1082181_rule | Display check result'
      debug:
        var: SV_257998r1082181_rule_check.stdout
      tags:
        - stig_check
        - SV-257998r1082181_rule


    - name: 'SV-257999r1134918_rule | RHEL 9 SSH server configuration files' permissions must not be modified.'
      shell:
        cmd: rpm --verify openssh-server | awk '! ($2 == "c" && $1 ~ /^.\..\.\.\.\..\./) {print $0}'
      register: SV_257999r1134918_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-257999r1134918_rule

    - name: 'SV-257999r1134918_rule | Display check result'
      debug:
        var: SV_257999r1134918_rule_check.stdout
      tags:
        - stig_check
        - SV-257999r1134918_rule


    - name: 'SV-258000r1045063_rule | RHEL 9 SSH private host key files must have mode 0640 or less permissive.'
      shell:
        cmd: stat -c "%a %n" /etc/ssh/*_key
      register: SV_258000r1045063_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258000r1045063_rule

    - name: 'SV-258000r1045063_rule | Display check result'
      debug:
        var: SV_258000r1045063_rule_check.stdout
      tags:
        - stig_check
        - SV-258000r1045063_rule


    - name: 'SV-258001r991589_rule | RHEL 9 SSH public host key files must have mode 0644 or less permissive.'
      shell:
        cmd: stat -c "%a %n" /etc/ssh/*.pub
      register: SV_258001r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258001r991589_rule

    - name: 'SV-258001r991589_rule | Display check result'
      debug:
        var: SV_258001r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-258001r991589_rule


    - name: 'SV-258002r991589_rule | RHEL 9 SSH daemon must not allow compression or must only allow compression afte'
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*compression'
      register: SV_258002r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258002r991589_rule

    - name: 'SV-258002r991589_rule | Display check result'
      debug:
        var: SV_258002r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-258002r991589_rule


    - name: 'SV-258003r1045065_rule | RHEL 9 SSH daemon must not allow GSSAPI authentication.'
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*gssapiauthentication'
      register: SV_258003r1045065_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258003r1045065_rule

    - name: 'SV-258003r1045065_rule | Display check result'
      debug:
        var: SV_258003r1045065_rule_check.stdout
      tags:
        - stig_check
        - SV-258003r1045065_rule


    - name: 'SV-258004r1045067_rule | RHEL 9 SSH daemon must not allow Kerberos authentication.'
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*kerberosauthentication'
      register: SV_258004r1045067_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258004r1045067_rule

    - name: 'SV-258004r1045067_rule | Display check result'
      debug:
        var: SV_258004r1045067_rule_check.stdout
      tags:
        - stig_check
        - SV-258004r1045067_rule


    - name: 'SV-258005r1045069_rule | RHEL 9 SSH daemon must not allow rhosts authentication.'
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*ignorerhosts'
      register: SV_258005r1045069_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258005r1045069_rule

    - name: 'SV-258005r1045069_rule | Display check result'
      debug:
        var: SV_258005r1045069_rule_check.stdout
      tags:
        - stig_check
        - SV-258005r1045069_rule


    - name: 'SV-258006r1045071_rule | RHEL 9 SSH daemon must not allow known hosts authentication.'
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*ignoreuserknownhosts'
      register: SV_258006r1045071_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258006r1045071_rule

    - name: 'SV-258006r1045071_rule | Display check result'
      debug:
        var: SV_258006r1045071_rule_check.stdout
      tags:
        - stig_check
        - SV-258006r1045071_rule


    - name: 'SV-258007r1045073_rule | RHEL 9 SSH daemon must disable remote X connections for interactive users.'
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*x11forwarding'
      register: SV_258007r1045073_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258007r1045073_rule

    - name: 'SV-258007r1045073_rule | Display check result'
      debug:
        var: SV_258007r1045073_rule_check.stdout
      tags:
        - stig_check
        - SV-258007r1045073_rule


    - name: 'SV-258008r1045075_rule | RHEL 9 SSH daemon must perform strict mode checking of home directory configurat'
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*strictmodes'
      register: SV_258008r1045075_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258008r1045075_rule

    - name: 'SV-258008r1045075_rule | Display check result'
      debug:
        var: SV_258008r1045075_rule_check.stdout
      tags:
        - stig_check
        - SV-258008r1045075_rule


    - name: 'SV-258009r1045077_rule | RHEL 9 SSH daemon must display the date and time of the last successful account '
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*printlastlog'
      register: SV_258009r1045077_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258009r1045077_rule

    - name: 'SV-258009r1045077_rule | Display check result'
      debug:
        var: SV_258009r1045077_rule_check.stdout
      tags:
        - stig_check
        - SV-258009r1045077_rule


    - name: 'SV-258011r1045079_rule | RHEL 9 SSH daemon must prevent remote hosts from connecting to the proxy display'
      shell:
        cmd: /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*x11uselocalhost'
      register: SV_258011r1045079_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258011r1045079_rule

    - name: 'SV-258011r1045079_rule | Display check result'
      debug:
        var: SV_258011r1045079_rule_check.stdout
      tags:
        - stig_check
        - SV-258011r1045079_rule


    - name: 'SV-258012r1014855_rule | RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before '
      shell:
        cmd: gsettings get org.gnome.login-screen banner-message-enable
      register: SV_258012r1014855_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258012r1014855_rule

    - name: 'SV-258012r1014855_rule | Display check result'
      debug:
        var: SV_258012r1014855_rule_check.stdout
      tags:
        - stig_check
        - SV-258012r1014855_rule


    - name: 'SV-258013r1045082_rule | RHEL 9 must prevent a user from overriding the banner-message-enable setting for'
      shell:
        cmd: gsettings writable org.gnome.login-screen banner-message-enable
      register: SV_258013r1045082_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258013r1045082_rule

    - name: 'SV-258013r1045082_rule | Display check result'
      debug:
        var: SV_258013r1045082_rule_check.stdout
      tags:
        - stig_check
        - SV-258013r1045082_rule


    - name: 'SV-258014r1045084_rule | RHEL 9 must disable the graphical user interface automount function unless requi'
      debug:
        msg: "SV-258014r1045084_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-258014r1045084_rule


    - name: 'SV-258015r1045086_rule | RHEL 9 must prevent a user from overriding the disabling of the graphical user i'
      shell:
        cmd: grep system-db /etc/dconf/profile/user
      register: SV_258015r1045086_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258015r1045086_rule

    - name: 'SV-258015r1045086_rule | Display check result'
      debug:
        var: SV_258015r1045086_rule_check.stdout
      tags:
        - stig_check
        - SV-258015r1045086_rule


    - name: 'SV-258016r958804_rule | RHEL 9 must disable the graphical user interface autorun function unless require'
      debug:
        msg: "SV-258016r958804_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-258016r958804_rule


    - name: 'SV-258017r1045088_rule | RHEL 9 must prevent a user from overriding the disabling of the graphical user i'
      debug:
        msg: "SV-258017r1045088_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-258017r1045088_rule


    - name: 'SV-258018r1045090_rule | RHEL 9 must not allow unattended or automatic logon via the graphical user inter'
      shell:
        cmd: grep -i automaticlogin /etc/gdm/custom.conf
      register: SV_258018r1045090_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258018r1045090_rule

    - name: 'SV-258018r1045090_rule | Display check result'
      debug:
        var: SV_258018r1045090_rule_check.stdout
      tags:
        - stig_check
        - SV-258018r1045090_rule


    - name: 'SV-258019r1045092_rule | RHEL 9 must be able to initiate directly a session lock for all connection types'
      shell:
        cmd: gsettings get org.gnome.settings-daemon.peripherals.smartcard removal-action
      register: SV_258019r1045092_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258019r1045092_rule

    - name: 'SV-258019r1045092_rule | Display check result'
      debug:
        var: SV_258019r1045092_rule_check.stdout
      tags:
        - stig_check
        - SV-258019r1045092_rule


    - name: 'SV-258020r1045094_rule | RHEL 9 must prevent a user from overriding the disabling of the graphical user s'
      shell:
        cmd: gsettings writable org.gnome.settings-daemon.peripherals.smartcard removal-action
      register: SV_258020r1045094_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258020r1045094_rule

    - name: 'SV-258020r1045094_rule | Display check result'
      debug:
        var: SV_258020r1045094_rule_check.stdout
      tags:
        - stig_check
        - SV-258020r1045094_rule


    - name: 'SV-258021r1015088_rule | RHEL 9 must enable a user session lock until that user re-establishes access usi'
      shell:
        cmd: gsettings get org.gnome.desktop.screensaver lock-enabled
      register: SV_258021r1015088_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258021r1015088_rule

    - name: 'SV-258021r1015088_rule | Display check result'
      debug:
        var: SV_258021r1015088_rule_check.stdout
      tags:
        - stig_check
        - SV-258021r1015088_rule


    - name: 'SV-258022r1045097_rule | RHEL 9 must prevent a user from overriding the screensaver lock-enabled setting '
      shell:
        cmd: gsettings writable org.gnome.desktop.screensaver lock-enabled
      register: SV_258022r1045097_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258022r1045097_rule

    - name: 'SV-258022r1045097_rule | Display check result'
      debug:
        var: SV_258022r1045097_rule_check.stdout
      tags:
        - stig_check
        - SV-258022r1045097_rule


    - name: 'SV-258023r958402_rule | RHEL 9 must automatically lock graphical user sessions after 15 minutes of inact'
      shell:
        cmd: gsettings get org.gnome.desktop.session idle-delay
      register: SV_258023r958402_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258023r958402_rule

    - name: 'SV-258023r958402_rule | Display check result'
      debug:
        var: SV_258023r958402_rule_check.stdout
      tags:
        - stig_check
        - SV-258023r958402_rule


    - name: 'SV-258024r1045100_rule | RHEL 9 must prevent a user from overriding the session idle-delay setting for th'
      shell:
        cmd: gsettings writable org.gnome.desktop.session idle-delay
      register: SV_258024r1045100_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258024r1045100_rule

    - name: 'SV-258024r1045100_rule | Display check result'
      debug:
        var: SV_258024r1045100_rule_check.stdout
      tags:
        - stig_check
        - SV-258024r1045100_rule


    - name: 'SV-258025r958402_rule | RHEL 9 must initiate a session lock for graphical user interfaces when the scree'
      shell:
        cmd: gsettings get org.gnome.desktop.screensaver lock-delay
      register: SV_258025r958402_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258025r958402_rule

    - name: 'SV-258025r958402_rule | Display check result'
      debug:
        var: SV_258025r958402_rule_check.stdout
      tags:
        - stig_check
        - SV-258025r958402_rule


    - name: 'SV-258026r1045103_rule | RHEL 9 must prevent a user from overriding the session lock-delay setting for th'
      shell:
        cmd: gsettings writable org.gnome.desktop.screensaver lock-delay
      register: SV_258026r1045103_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258026r1045103_rule

    - name: 'SV-258026r1045103_rule | Display check result'
      debug:
        var: SV_258026r1045103_rule_check.stdout
      tags:
        - stig_check
        - SV-258026r1045103_rule


    - name: 'SV-258027r1045106_rule | RHEL 9 must conceal, via the session lock, information previously visible on the'
      shell:
        cmd: gsettings writable org.gnome.desktop.screensaver picture-uri
      register: SV_258027r1045106_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258027r1045106_rule

    - name: 'SV-258027r1045106_rule | Display check result'
      debug:
        var: SV_258027r1045106_rule_check.stdout
      tags:
        - stig_check
        - SV-258027r1045106_rule


    - name: 'SV-258028r991589_rule | RHEL 9 effective dconf policy must match the policy keyfiles.'
      debug:
        msg: "SV-258028r991589_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-258028r991589_rule


    - name: 'SV-258029r1045109_rule | RHEL 9 must disable the ability of a user to restart the system from the login s'
      shell:
        cmd: gsettings get org.gnome.login-screen disable-restart-buttons
      register: SV_258029r1045109_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258029r1045109_rule

    - name: 'SV-258029r1045109_rule | Display check result'
      debug:
        var: SV_258029r1045109_rule_check.stdout
      tags:
        - stig_check
        - SV-258029r1045109_rule


    - name: 'SV-258030r1045112_rule | RHEL 9 must prevent a user from overriding the disable-restart-buttons setting f'
      shell:
        cmd: gsettings writable org.gnome.login-screen disable-restart-buttons
      register: SV_258030r1045112_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258030r1045112_rule

    - name: 'SV-258030r1045112_rule | Display check result'
      debug:
        var: SV_258030r1045112_rule_check.stdout
      tags:
        - stig_check
        - SV-258030r1045112_rule


    - name: 'SV-258031r1134920_rule | RHEL 9 must disable the ability of a user to accidentally press Ctrl-Alt-Del and'
      debug:
        msg: "SV-258031r1134920_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-258031r1134920_rule


    - name: 'SV-258032r1045117_rule | RHEL 9 must prevent a user from overriding the Ctrl-Alt-Del sequence settings fo'
      debug:
        msg: "SV-258032r1045117_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-258032r1045117_rule


    - name: 'SV-258033r1045120_rule | RHEL 9 must disable the user list at logon for graphical user interfaces.'
      shell:
        cmd: gsettings get org.gnome.login-screen disable-user-list
      register: SV_258033r1045120_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258033r1045120_rule

    - name: 'SV-258033r1045120_rule | Display check result'
      debug:
        var: SV_258033r1045120_rule_check.stdout
      tags:
        - stig_check
        - SV-258033r1045120_rule


    - name: 'SV-258034r1051267_rule | RHEL 9 must be configured to disable USB mass storage.'
      shell:
        cmd: grep -r usb-storage /etc/modprobe.conf /etc/modprobe.d/*
      register: SV_258034r1051267_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258034r1051267_rule

    - name: 'SV-258034r1051267_rule | Display check result'
      debug:
        var: SV_258034r1051267_rule_check.stdout
      tags:
        - stig_check
        - SV-258034r1051267_rule


    - name: 'SV-258035r1045125_rule | RHEL 9 must have the USBGuard package installed.'
      shell:
        cmd: dnf list installed usbguard
      register: SV_258035r1045125_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258035r1045125_rule

    - name: 'SV-258035r1045125_rule | Display check result'
      debug:
        var: SV_258035r1045125_rule_check.stdout
      tags:
        - stig_check
        - SV-258035r1045125_rule


    - name: 'SV-258036r1014861_rule | RHEL 9 must have the USBGuard package enabled.'
      shell:
        cmd: systemctl is-active usbguard
      register: SV_258036r1014861_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258036r1014861_rule

    - name: 'SV-258036r1014861_rule | Display check result'
      debug:
        var: SV_258036r1014861_rule_check.stdout
      tags:
        - stig_check
        - SV-258036r1014861_rule


    - name: 'SV-258037r1014863_rule | RHEL 9 must enable Linux audit logging for the USBGuard daemon.'
      shell:
        cmd: grep AuditBackend /etc/usbguard/usbguard-daemon.conf
      register: SV_258037r1014863_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258037r1014863_rule

    - name: 'SV-258037r1014863_rule | Display check result'
      debug:
        var: SV_258037r1014863_rule_check.stdout
      tags:
        - stig_check
        - SV-258037r1014863_rule


    - name: 'SV-258038r1045128_rule | RHEL 9 must block unauthorized peripherals before establishing a connection.'
      debug:
        msg: "SV-258038r1045128_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-258038r1045128_rule


    - name: 'SV-258039r1045131_rule | RHEL 9 Bluetooth must be disabled.'
      shell:
        cmd: grep -r bluetooth /etc/modprobe.conf /etc/modprobe.d/*
      register: SV_258039r1045131_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258039r1045131_rule

    - name: 'SV-258039r1045131_rule | Display check result'
      debug:
        var: SV_258039r1045131_rule_check.stdout
      tags:
        - stig_check
        - SV-258039r1045131_rule


    - name: 'SV-258040r991568_rule | RHEL 9 wireless network adapters must be disabled.'
      shell:
        cmd: nmcli device status
      register: SV_258040r991568_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258040r991568_rule

    - name: 'SV-258040r991568_rule | Display check result'
      debug:
        var: SV_258040r991568_rule_check.stdout
      tags:
        - stig_check
        - SV-258040r991568_rule


    - name: 'SV-258041r1038967_rule | RHEL 9 user account passwords for new users or password changes must have a 60-d'
      shell:
        cmd: grep -i pass_max_days /etc/login.defs
      register: SV_258041r1038967_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258041r1038967_rule

    - name: 'SV-258041r1038967_rule | Display check result'
      debug:
        var: SV_258041r1038967_rule_check.stdout
      tags:
        - stig_check
        - SV-258041r1038967_rule


    - name: 'SV-258042r1045133_rule | RHEL 9 user account passwords must have a 60-day maximum password lifetime restr'
      shell:
        cmd: awk -F: '$5 > 60 {printf "%s %d\n", $1, $5}' /etc/shadow
      register: SV_258042r1045133_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258042r1045133_rule

    - name: 'SV-258042r1045133_rule | Display check result'
      debug:
        var: SV_258042r1045133_rule_check.stdout
      tags:
        - stig_check
        - SV-258042r1045133_rule


    - name: 'SV-258043r991589_rule | All RHEL 9 local interactive user accounts must be assigned a home directory upo'
      shell:
        cmd: grep -i create_home /etc/login.defs
      register: SV_258043r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258043r991589_rule

    - name: 'SV-258043r991589_rule | Display check result'
      debug:
        var: SV_258043r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-258043r991589_rule


    - name: 'SV-258044r1045135_rule | RHEL 9 must set the umask value to 077 for all local interactive user accounts.'
      shell:
        cmd: find /home -maxdepth 2 -type f -name ".[^.]*" -exec grep -iH -d skip --exclude=.bash_history umask {} \
      register: SV_258044r1045135_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258044r1045135_rule

    - name: 'SV-258044r1045135_rule | Display check result'
      debug:
        var: SV_258044r1045135_rule_check.stdout
      tags:
        - stig_check
        - SV-258044r1045135_rule


    - name: 'SV-258045r958482_rule | RHEL 9 duplicate User IDs (UIDs) must not exist for interactive users.'
      shell:
        cmd: awk -F ":" 'list[$3]++{print $1, $3}' /etc/passwd
      register: SV_258045r958482_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258045r958482_rule

    - name: 'SV-258045r958482_rule | Display check result'
      debug:
        var: SV_258045r958482_rule_check.stdout
      tags:
        - stig_check
        - SV-258045r958482_rule


    - name: 'SV-258046r991589_rule | RHEL 9 system accounts must not have an interactive login shell.'
      shell:
        cmd: awk -F: '($3<1000){print $1 ":" $3 ":" $7}' /etc/passwd
      register: SV_258046r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258046r991589_rule

    - name: 'SV-258046r991589_rule | Display check result'
      debug:
        var: SV_258046r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-258046r991589_rule


    - name: 'SV-258047r1101951_rule | RHEL 9 must automatically expire temporary accounts within 72 hours.'
      debug:
        msg: "SV-258047r1101951_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-258047r1101951_rule


    - name: 'SV-258048r1069380_rule | All RHEL 9 interactive users must have a primary group that exists.'
      debug:
        msg: "SV-258048r1069380_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-258048r1069380_rule


    - name: 'SV-258049r1015092_rule | RHEL 9 must disable account identifiers (individuals, groups, roles, and devices'
      shell:
        cmd: grep -i inactive /etc/default/useradd
      register: SV_258049r1015092_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258049r1015092_rule

    - name: 'SV-258049r1015092_rule | Display check result'
      debug:
        var: SV_258049r1015092_rule_check.stdout
      tags:
        - stig_check
        - SV-258049r1015092_rule


    - name: 'SV-258050r1045137_rule | Executable search paths within the initialization files of all local interactive'
      shell:
        cmd: find /home -maxdepth 2 -type f -name ".[^.]*" -exec grep -iH path= {} \
      register: SV_258050r1045137_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258050r1045137_rule

    - name: 'SV-258050r1045137_rule | Display check result'
      debug:
        var: SV_258050r1045137_rule_check.stdout
      tags:
        - stig_check
        - SV-258050r1045137_rule


    - name: 'SV-258051r991589_rule | All RHEL 9 local interactive users must have a home directory assigned in the /e'
      shell:
        cmd: awk -F: '($3>=1000)&&($7 !~ /nologin/){print $1, $3, $6}' /etc/passwd
      register: SV_258051r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258051r991589_rule

    - name: 'SV-258051r991589_rule | Display check result'
      debug:
        var: SV_258051r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-258051r991589_rule


    - name: 'SV-258052r991589_rule | All RHEL 9 local interactive user home directories defined in the /etc/passwd fi'
      debug:
        msg: "SV-258052r991589_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-258052r991589_rule


    - name: 'SV-258053r991589_rule | All RHEL 9 local interactive user home directories must be group-owned by the ho'
      shell:
        cmd: ls -ld $(awk -F: '($3>=1000)&&($7 !~ /nologin/){print $6}' /etc/passwd)
      register: SV_258053r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258053r991589_rule

    - name: 'SV-258053r991589_rule | Display check result'
      debug:
        var: SV_258053r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-258053r991589_rule


    - name: 'SV-258054r958736_rule | RHEL 9 must automatically lock an account when three unsuccessful logon attempts'
      shell:
        cmd: grep 'deny =' /etc/security/faillock.conf
      register: SV_258054r958736_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258054r958736_rule

    - name: 'SV-258054r958736_rule | Display check result'
      debug:
        var: SV_258054r958736_rule_check.stdout
      tags:
        - stig_check
        - SV-258054r958736_rule


    - name: 'SV-258055r1045140_rule | RHEL 9 must automatically lock the root account until the root account is releas'
      shell:
        cmd: grep even_deny_root /etc/security/faillock.conf
      register: SV_258055r1045140_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258055r1045140_rule

    - name: 'SV-258055r1045140_rule | Display check result'
      debug:
        var: SV_258055r1045140_rule_check.stdout
      tags:
        - stig_check
        - SV-258055r1045140_rule


    - name: 'SV-258056r1045143_rule | RHEL 9 must automatically lock an account when three unsuccessful logon attempts'
      shell:
        cmd: grep fail_interval /etc/security/faillock.conf
      register: SV_258056r1045143_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258056r1045143_rule

    - name: 'SV-258056r1045143_rule | Display check result'
      debug:
        var: SV_258056r1045143_rule_check.stdout
      tags:
        - stig_check
        - SV-258056r1045143_rule


    - name: 'SV-258057r1045146_rule | RHEL 9 must maintain an account lock until the locked account is released by an '
      shell:
        cmd: grep -w unlock_time /etc/security/faillock.conf
      register: SV_258057r1045146_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258057r1045146_rule

    - name: 'SV-258057r1045146_rule | Display check result'
      debug:
        var: SV_258057r1045146_rule_check.stdout
      tags:
        - stig_check
        - SV-258057r1045146_rule


    - name: 'SV-258058r1045148_rule | RHEL 9 must not have unauthorized accounts.'
      shell:
        cmd: less /etc/passwd
      register: SV_258058r1045148_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258058r1045148_rule

    - name: 'SV-258058r1045148_rule | Display check result'
      debug:
        var: SV_258058r1045148_rule_check.stdout
      tags:
        - stig_check
        - SV-258058r1045148_rule


    - name: 'SV-258059r991589_rule | The root account must be the only account having unrestricted access to RHEL 9 s'
      shell:
        cmd: awk -F: '$3 == 0 {print $1}' /etc/passwd
      register: SV_258059r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258059r991589_rule

    - name: 'SV-258059r991589_rule | Display check result'
      debug:
        var: SV_258059r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-258059r991589_rule


    - name: 'SV-258060r1045150_rule | RHEL 9 must ensure account lockouts persist.'
      shell:
        cmd: grep -w dir /etc/security/faillock.conf
      register: SV_258060r1045150_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258060r1045150_rule

    - name: 'SV-258060r1045150_rule | Display check result'
      debug:
        var: SV_258060r1045150_rule_check.stdout
      tags:
        - stig_check
        - SV-258060r1045150_rule


    - name: 'SV-258061r958482_rule | RHEL 9 groups must have unique Group ID (GID).'
      debug:
        msg: "SV-258061r958482_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-258061r958482_rule


    - name: 'SV-258062r991589_rule | Local RHEL 9 initialization files must not execute world-writable programs.'
      shell:
        cmd: find /home -perm -002 -type f -name ".[^.]*" -exec ls -ld {} \
      register: SV_258062r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258062r991589_rule

    - name: 'SV-258062r991589_rule | Display check result'
      debug:
        var: SV_258062r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-258062r991589_rule


    - name: 'SV-258068r1101950_rule | RHEL 9 must automatically exit interactive command shell user sessions after 10 '
      shell:
        cmd: grep -i tmout /etc/profile /etc/profile.d/*.sh
      register: SV_258068r1101950_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258068r1101950_rule

    - name: 'SV-258068r1101950_rule | Display check result'
      debug:
        var: SV_258068r1101950_rule_check.stdout
      tags:
        - stig_check
        - SV-258068r1101950_rule


    - name: 'SV-258069r958398_rule | RHEL 9 must limit the number of concurrent sessions to ten for all accounts and/'
      shell:
        cmd: grep -r -s maxlogins /etc/security/limits.conf /etc/security/limits.d/*.conf
      register: SV_258069r958398_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258069r958398_rule

    - name: 'SV-258069r958398_rule | Display check result'
      debug:
        var: SV_258069r958398_rule_check.stdout
      tags:
        - stig_check
        - SV-258069r958398_rule


    - name: 'SV-258070r1045153_rule | RHEL 9 must log username information when unsuccessful logon attempts occur.'
      shell:
        cmd: grep audit /etc/security/faillock.conf
      register: SV_258070r1045153_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258070r1045153_rule

    - name: 'SV-258070r1045153_rule | Display check result'
      debug:
        var: SV_258070r1045153_rule_check.stdout
      tags:
        - stig_check
        - SV-258070r1045153_rule


    - name: 'SV-258071r991588_rule | RHEL 9 must enforce a delay of at least four seconds between logon prompts follo'
      shell:
        cmd: grep -i fail_delay /etc/login.defs
      register: SV_258071r991588_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258071r991588_rule

    - name: 'SV-258071r991588_rule | Display check result'
      debug:
        var: SV_258071r991588_rule_check.stdout
      tags:
        - stig_check
        - SV-258071r991588_rule


    - name: 'SV-258072r1045155_rule | RHEL 9 must define default permissions for the bash shell.'
      shell:
        cmd: grep umask /etc/bashrc
      register: SV_258072r1045155_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258072r1045155_rule

    - name: 'SV-258072r1045155_rule | Display check result'
      debug:
        var: SV_258072r1045155_rule_check.stdout
      tags:
        - stig_check
        - SV-258072r1045155_rule


    - name: 'SV-258073r1045157_rule | RHEL 9 must define default permissions for the c shell.'
      shell:
        cmd: grep umask /etc/csh.cshrc
      register: SV_258073r1045157_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258073r1045157_rule

    - name: 'SV-258073r1045157_rule | Display check result'
      debug:
        var: SV_258073r1045157_rule_check.stdout
      tags:
        - stig_check
        - SV-258073r1045157_rule


    - name: 'SV-258074r991590_rule | RHEL 9 must define default permissions for all authenticated users in such a way'
      shell:
        cmd: grep -i umask /etc/login.defs
      register: SV_258074r991590_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258074r991590_rule

    - name: 'SV-258074r991590_rule | Display check result'
      debug:
        var: SV_258074r991590_rule_check.stdout
      tags:
        - stig_check
        - SV-258074r991590_rule


    - name: 'SV-258075r991590_rule | RHEL 9 must define default permissions for the system default profile.'
      shell:
        cmd: grep umask /etc/profile
      register: SV_258075r991590_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258075r991590_rule

    - name: 'SV-258075r991590_rule | Display check result'
      debug:
        var: SV_258075r991590_rule_check.stdout
      tags:
        - stig_check
        - SV-258075r991590_rule


    - name: 'SV-258076r991589_rule | RHEL 9 must display the date and time of the last successful account logon upon '
      shell:
        cmd: grep pam_lastlog /etc/pam.d/postlogin
      register: SV_258076r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258076r991589_rule

    - name: 'SV-258076r991589_rule | Display check result'
      debug:
        var: SV_258076r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-258076r991589_rule


    - name: 'SV-258077r1014874_rule | RHEL 9 must terminate idle user sessions.'
      shell:
        cmd: grep -i ^StopIdleSessionSec /etc/systemd/logind.conf
      register: SV_258077r1014874_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258077r1014874_rule

    - name: 'SV-258077r1014874_rule | Display check result'
      debug:
        var: SV_258077r1014874_rule_check.stdout
      tags:
        - stig_check
        - SV-258077r1014874_rule


    - name: 'SV-258078r958944_rule | RHEL 9 must use a Linux Security Module configured to enforce limits on system s'
      shell:
        cmd: getenforce
      register: SV_258078r958944_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258078r958944_rule

    - name: 'SV-258078r958944_rule | Display check result'
      debug:
        var: SV_258078r958944_rule_check.stdout
      tags:
        - stig_check
        - SV-258078r958944_rule


    - name: 'SV-258079r1045159_rule | RHEL 9 must enable the SELinux targeted policy.'
      shell:
        cmd: sestatus | grep "policy name"
      register: SV_258079r1045159_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258079r1045159_rule

    - name: 'SV-258079r1045159_rule | Display check result'
      debug:
        var: SV_258079r1045159_rule_check.stdout
      tags:
        - stig_check
        - SV-258079r1045159_rule


    - name: 'SV-258080r1045162_rule | RHEL 9 must configure SELinux context type to allow the use of a nondefault fail'
      shell:
        cmd: grep -w dir /etc/security/faillock.conf
      register: SV_258080r1045162_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258080r1045162_rule

    - name: 'SV-258080r1045162_rule | Display check result'
      debug:
        var: SV_258080r1045162_rule_check.stdout
      tags:
        - stig_check
        - SV-258080r1045162_rule


    - name: 'SV-258081r1045164_rule | RHEL 9 must have policycoreutils package installed.'
      shell:
        cmd: dnf list --installed policycoreutils
      register: SV_258081r1045164_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258081r1045164_rule

    - name: 'SV-258081r1045164_rule | Display check result'
      debug:
        var: SV_258081r1045164_rule_check.stdout
      tags:
        - stig_check
        - SV-258081r1045164_rule


    - name: 'SV-258082r1045166_rule | RHEL 9 policycoreutils-python-utils package must be installed.'
      shell:
        cmd: dnf list --installed policycoreutils-python-utils
      register: SV_258082r1045166_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258082r1045166_rule

    - name: 'SV-258082r1045166_rule | Display check result'
      debug:
        var: SV_258082r1045166_rule_check.stdout
      tags:
        - stig_check
        - SV-258082r1045166_rule


    - name: 'SV-258083r1045168_rule | RHEL 9 must have the sudo package installed.'
      shell:
        cmd: dnf list --installed sudo
      register: SV_258083r1045168_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258083r1045168_rule

    - name: 'SV-258083r1045168_rule | Display check result'
      debug:
        var: SV_258083r1045168_rule_check.stdout
      tags:
        - stig_check
        - SV-258083r1045168_rule


    - name: 'SV-258084r1050789_rule | RHEL 9 must require reauthentication when using the "sudo" command.'
      shell:
        cmd: grep -ir 'timestamp_timeout' /etc/sudoers /etc/sudoers.d/
      register: SV_258084r1050789_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258084r1050789_rule

    - name: 'SV-258084r1050789_rule | Display check result'
      debug:
        var: SV_258084r1050789_rule_check.stdout
      tags:
        - stig_check
        - SV-258084r1050789_rule


    - name: 'SV-258085r1045173_rule | RHEL 9 must use the invoking user's password for privilege escalation when using'
      shell:
        cmd: egrep -ir '(!rootpw|!targetpw|!runaspw)' /etc/sudoers /etc/sudoers.d/ | grep -v '#'
      register: SV_258085r1045173_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258085r1045173_rule

    - name: 'SV-258085r1045173_rule | Display check result'
      debug:
        var: SV_258085r1045173_rule_check.stdout
      tags:
        - stig_check
        - SV-258085r1045173_rule


    - name: 'SV-258086r1102063_rule | RHEL 9 must require users to reauthenticate for privilege escalation.'
      shell:
        cmd: egrep -iR '!authenticate' /etc/sudoers /etc/sudoers.d/
      register: SV_258086r1102063_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258086r1102063_rule

    - name: 'SV-258086r1102063_rule | Display check result'
      debug:
        var: SV_258086r1102063_rule_check.stdout
      tags:
        - stig_check
        - SV-258086r1102063_rule


    - name: 'SV-258087r1102071_rule | RHEL 9 must restrict privilege elevation to authorized personnel.'
      shell:
        cmd: grep -iwR 'ALL' /etc/sudoers /etc/sudoers.d/ | grep -v '#'
      register: SV_258087r1102071_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258087r1102071_rule

    - name: 'SV-258087r1102071_rule | Display check result'
      debug:
        var: SV_258087r1102071_rule_check.stdout
      tags:
        - stig_check
        - SV-258087r1102071_rule


    - name: 'SV-258088r1050789_rule | RHEL 9 must restrict the use of the "su" command.'
      shell:
        cmd: grep pam_wheel /etc/pam.d/su
      register: SV_258088r1050789_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258088r1050789_rule

    - name: 'SV-258088r1050789_rule | Display check result'
      debug:
        var: SV_258088r1050789_rule_check.stdout
      tags:
        - stig_check
        - SV-258088r1050789_rule


    - name: 'SV-258089r1045179_rule | RHEL 9 fapolicy module must be installed.'
      shell:
        cmd: dnf list --installed fapolicyd
      register: SV_258089r1045179_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258089r1045179_rule

    - name: 'SV-258089r1045179_rule | Display check result'
      debug:
        var: SV_258089r1045179_rule_check.stdout
      tags:
        - stig_check
        - SV-258089r1045179_rule


    - name: 'SV-258090r958808_rule | RHEL 9 fapolicy module must be enabled.'
      shell:
        cmd: systemctl is-active fapolicyd
      register: SV_258090r958808_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258090r958808_rule

    - name: 'SV-258090r958808_rule | Display check result'
      debug:
        var: SV_258090r958808_rule_check.stdout
      tags:
        - stig_check
        - SV-258090r958808_rule


    - name: 'SV-258091r1045185_rule | RHEL 9 must ensure the password complexity module in the system-auth file is con'
      shell:
        cmd: grep -w retry /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf
      register: SV_258091r1045185_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258091r1045185_rule

    - name: 'SV-258091r1045185_rule | Display check result'
      debug:
        var: SV_258091r1045185_rule_check.stdout
      tags:
        - stig_check
        - SV-258091r1045185_rule


    - name: 'SV-258094r1045187_rule | RHEL 9 must not allow blank or null passwords.'
      shell:
        cmd: grep -i nullok /etc/pam.d/system-auth /etc/pam.d/password-auth
      register: SV_258094r1045187_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258094r1045187_rule

    - name: 'SV-258094r1045187_rule | Display check result'
      debug:
        var: SV_258094r1045187_rule_check.stdout
      tags:
        - stig_check
        - SV-258094r1045187_rule


    - name: 'SV-258095r1045189_rule | RHEL 9 must configure the use of the pam_faillock.so module in the /etc/pam.d/sy'
      shell:
        cmd: grep pam_faillock.so /etc/pam.d/system-auth
      register: SV_258095r1045189_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258095r1045189_rule

    - name: 'SV-258095r1045189_rule | Display check result'
      debug:
        var: SV_258095r1045189_rule_check.stdout
      tags:
        - stig_check
        - SV-258095r1045189_rule


    - name: 'SV-258096r1045191_rule | RHEL 9 must configure the use of the pam_faillock.so module in the /etc/pam.d/pa'
      shell:
        cmd: grep pam_faillock.so /etc/pam.d/password-auth
      register: SV_258096r1045191_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258096r1045191_rule

    - name: 'SV-258096r1045191_rule | Display check result'
      debug:
        var: SV_258096r1045191_rule_check.stdout
      tags:
        - stig_check
        - SV-258096r1045191_rule


    - name: 'SV-258097r1045193_rule | RHEL 9 must ensure the password complexity module is enabled in the password-aut'
      shell:
        cmd: grep pam_pwquality /etc/pam.d/password-auth
      register: SV_258097r1045193_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258097r1045193_rule

    - name: 'SV-258097r1045193_rule | Display check result'
      debug:
        var: SV_258097r1045193_rule_check.stdout
      tags:
        - stig_check
        - SV-258097r1045193_rule


    - name: 'SV-258098r1045195_rule | RHEL 9 must ensure the password complexity module is enabled in the system-auth '
      shell:
        cmd: grep pam_pwquality /etc/pam.d/system-auth
      register: SV_258098r1045195_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258098r1045195_rule

    - name: 'SV-258098r1045195_rule | Display check result'
      debug:
        var: SV_258098r1045195_rule_check.stdout
      tags:
        - stig_check
        - SV-258098r1045195_rule


    - name: 'SV-258099r1045198_rule | RHEL 9 password-auth must be configured to use a sufficient number of hashing ro'
      shell:
        cmd: grep rounds /etc/pam.d/password-auth
      register: SV_258099r1045198_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258099r1045198_rule

    - name: 'SV-258099r1045198_rule | Display check result'
      debug:
        var: SV_258099r1045198_rule_check.stdout
      tags:
        - stig_check
        - SV-258099r1045198_rule


    - name: 'SV-258100r1045201_rule | RHEL 9 system-auth must be configured to use a sufficient number of hashing roun'
      shell:
        cmd: grep rounds /etc/pam.d/system-auth
      register: SV_258100r1045201_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258100r1045201_rule

    - name: 'SV-258100r1045201_rule | Display check result'
      debug:
        var: SV_258100r1045201_rule_check.stdout
      tags:
        - stig_check
        - SV-258100r1045201_rule


    - name: 'SV-258101r1045204_rule | RHEL 9 must enforce password complexity rules for the root account.'
      shell:
        cmd: grep enforce_for_root /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf
      register: SV_258101r1045204_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258101r1045204_rule

    - name: 'SV-258101r1045204_rule | Display check result'
      debug:
        var: SV_258101r1045204_rule_check.stdout
      tags:
        - stig_check
        - SV-258101r1045204_rule


    - name: 'SV-258102r1045207_rule | RHEL 9 must enforce password complexity by requiring that at least one lowercase'
      shell:
        cmd: grep lcredit /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf
      register: SV_258102r1045207_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258102r1045207_rule

    - name: 'SV-258102r1045207_rule | Display check result'
      debug:
        var: SV_258102r1045207_rule_check.stdout
      tags:
        - stig_check
        - SV-258102r1045207_rule


    - name: 'SV-258103r1045210_rule | RHEL 9 must enforce password complexity by requiring that at least one numeric c'
      shell:
        cmd: grep dcredit /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf
      register: SV_258103r1045210_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258103r1045210_rule

    - name: 'SV-258103r1045210_rule | Display check result'
      debug:
        var: SV_258103r1045210_rule_check.stdout
      tags:
        - stig_check
        - SV-258103r1045210_rule


    - name: 'SV-258104r1015104_rule | RHEL 9 passwords for new users or password changes must have a 24 hours minimum '
      shell:
        cmd: grep -i pass_min_days /etc/login.defs
      register: SV_258104r1015104_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258104r1015104_rule

    - name: 'SV-258104r1015104_rule | Display check result'
      debug:
        var: SV_258104r1015104_rule_check.stdout
      tags:
        - stig_check
        - SV-258104r1015104_rule


    - name: 'SV-258105r1045212_rule | RHEL 9 passwords must have a 24 hours minimum password lifetime restriction in /'
      shell:
        cmd: awk -F: '$4 < 1 {printf "%s %d\n", $1, $4}' /etc/shadow
      register: SV_258105r1045212_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258105r1045212_rule

    - name: 'SV-258105r1045212_rule | Display check result'
      debug:
        var: SV_258105r1045212_rule_check.stdout
      tags:
        - stig_check
        - SV-258105r1045212_rule


    - name: 'SV-258106r1102061_rule | RHEL 9 must require users to provide a password for privilege escalation.'
      shell:
        cmd: grep -iR 'NOPASSWD' /etc/sudoers /etc/sudoers.d/
      register: SV_258106r1102061_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258106r1102061_rule

    - name: 'SV-258106r1102061_rule | Display check result'
      debug:
        var: SV_258106r1102061_rule_check.stdout
      tags:
        - stig_check
        - SV-258106r1102061_rule


    - name: 'SV-258107r1045218_rule | RHEL 9 passwords must be created with a minimum of 15 characters.'
      shell:
        cmd: grep minlen /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf
      register: SV_258107r1045218_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258107r1045218_rule

    - name: 'SV-258107r1045218_rule | Display check result'
      debug:
        var: SV_258107r1045218_rule_check.stdout
      tags:
        - stig_check
        - SV-258107r1045218_rule


    - name: 'SV-258109r1045220_rule | RHEL 9 must enforce password complexity by requiring that at least one special c'
      shell:
        cmd: grep ocredit /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf
      register: SV_258109r1045220_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258109r1045220_rule

    - name: 'SV-258109r1045220_rule | Display check result'
      debug:
        var: SV_258109r1045220_rule_check.stdout
      tags:
        - stig_check
        - SV-258109r1045220_rule


    - name: 'SV-258110r1045223_rule | RHEL 9 must prevent the use of dictionary words for passwords.'
      shell:
        cmd: grep dictcheck /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf
      register: SV_258110r1045223_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258110r1045223_rule

    - name: 'SV-258110r1045223_rule | Display check result'
      debug:
        var: SV_258110r1045223_rule_check.stdout
      tags:
        - stig_check
        - SV-258110r1045223_rule


    - name: 'SV-258111r1045226_rule | RHEL 9 must enforce password complexity by requiring that at least one uppercase'
      shell:
        cmd: grep ucredit /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf
      register: SV_258111r1045226_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258111r1045226_rule

    - name: 'SV-258111r1045226_rule | Display check result'
      debug:
        var: SV_258111r1045226_rule_check.stdout
      tags:
        - stig_check
        - SV-258111r1045226_rule


    - name: 'SV-258112r1045229_rule | RHEL 9 must require the change of at least eight characters when passwords are c'
      shell:
        cmd: grep difok /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf
      register: SV_258112r1045229_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258112r1045229_rule

    - name: 'SV-258112r1045229_rule | Display check result'
      debug:
        var: SV_258112r1045229_rule_check.stdout
      tags:
        - stig_check
        - SV-258112r1045229_rule


    - name: 'SV-258113r1045232_rule | RHEL 9 must require the maximum number of repeating characters of the same chara'
      shell:
        cmd: grep maxclassrepeat /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf
      register: SV_258113r1045232_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258113r1045232_rule

    - name: 'SV-258113r1045232_rule | Display check result'
      debug:
        var: SV_258113r1045232_rule_check.stdout
      tags:
        - stig_check
        - SV-258113r1045232_rule


    - name: 'SV-258114r1045235_rule | RHEL 9 must require the maximum number of repeating characters be limited to thr'
      shell:
        cmd: grep maxrepeat /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf
      register: SV_258114r1045235_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258114r1045235_rule

    - name: 'SV-258114r1045235_rule | Display check result'
      debug:
        var: SV_258114r1045235_rule_check.stdout
      tags:
        - stig_check
        - SV-258114r1045235_rule


    - name: 'SV-258115r1045238_rule | RHEL 9 must require the change of at least four character classes when passwords'
      shell:
        cmd: grep minclass /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf
      register: SV_258115r1045238_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258115r1045238_rule

    - name: 'SV-258115r1045238_rule | Display check result'
      debug:
        var: SV_258115r1045238_rule_check.stdout
      tags:
        - stig_check
        - SV-258115r1045238_rule


    - name: 'SV-258116r1045240_rule | RHEL 9 must be configured so that user and group account administration utilitie'
      shell:
        cmd: grep crypt_style /etc/libuser.conf
      register: SV_258116r1045240_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258116r1045240_rule

    - name: 'SV-258116r1045240_rule | Display check result'
      debug:
        var: SV_258116r1045240_rule_check.stdout
      tags:
        - stig_check
        - SV-258116r1045240_rule


    - name: 'SV-258117r1015116_rule | RHEL 9 must be configured to use the shadow file to store only encrypted represe'
      shell:
        cmd: grep -i encrypt_method /etc/login.defs
      register: SV_258117r1015116_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258117r1015116_rule

    - name: 'SV-258117r1015116_rule | Display check result'
      debug:
        var: SV_258117r1015116_rule_check.stdout
      tags:
        - stig_check
        - SV-258117r1015116_rule


    - name: 'SV-258118r1050789_rule | RHEL 9 must not be configured to bypass password requirements for privilege esca'
      shell:
        cmd: grep pam_succeed_if /etc/pam.d/sudo
      register: SV_258118r1050789_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258118r1050789_rule

    - name: 'SV-258118r1050789_rule | Display check result'
      debug:
        var: SV_258118r1050789_rule_check.stdout
      tags:
        - stig_check
        - SV-258118r1050789_rule


    - name: 'SV-258120r991589_rule | RHEL 9 must not have accounts configured with blank or null passwords.'
      shell:
        cmd: awk -F: '!$2 {print $1}' /etc/shadow
      register: SV_258120r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258120r991589_rule

    - name: 'SV-258120r991589_rule | Display check result'
      debug:
        var: SV_258120r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-258120r991589_rule


    - name: 'SV-258121r1102086_rule | RHEL 9 must use the common access card (CAC) smart card driver.'
      debug:
        msg: "SV-258121r1102086_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-258121r1102086_rule


    - name: 'SV-258122r1045246_rule | RHEL 9 must enable certificate based smart card authentication.'
      shell:
        cmd: grep -ir pam_cert_auth /etc/sssd/sssd.conf /etc/sssd/conf.d/
      register: SV_258122r1045246_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258122r1045246_rule

    - name: 'SV-258122r1045246_rule | Display check result'
      debug:
        var: SV_258122r1045246_rule_check.stdout
      tags:
        - stig_check
        - SV-258122r1045246_rule


    - name: 'SV-258123r1134923_rule | RHEL 9 must implement certificate status checking for multifactor authentication'
      shell:
        cmd: grep -sir certificate_verification /etc/sssd/sssd.conf /etc/sssd/conf.d/ | grep -v "^#"
      register: SV_258123r1134923_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258123r1134923_rule

    - name: 'SV-258123r1134923_rule | Display check result'
      debug:
        var: SV_258123r1134923_rule_check.stdout
      tags:
        - stig_check
        - SV-258123r1134923_rule


    - name: 'SV-258124r1045250_rule | RHEL 9 must have the pcsc-lite package installed.'
      shell:
        cmd: dnf list --installed pcsc-lite
      register: SV_258124r1045250_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258124r1045250_rule

    - name: 'SV-258124r1045250_rule | Display check result'
      debug:
        var: SV_258124r1045250_rule_check.stdout
      tags:
        - stig_check
        - SV-258124r1045250_rule


    - name: 'SV-258125r1045253_rule | The pcscd service on RHEL 9 must be active.'
      shell:
        cmd: systemctl is-active pcscd.socket
      register: SV_258125r1045253_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258125r1045253_rule

    - name: 'SV-258125r1045253_rule | Display check result'
      debug:
        var: SV_258125r1045253_rule_check.stdout
      tags:
        - stig_check
        - SV-258125r1045253_rule


    - name: 'SV-258126r1045255_rule | RHEL 9 must have the opensc package installed.'
      shell:
        cmd: dnf list --installed opensc
      register: SV_258126r1045255_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258126r1045255_rule

    - name: 'SV-258126r1045255_rule | Display check result'
      debug:
        var: SV_258126r1045255_rule_check.stdout
      tags:
        - stig_check
        - SV-258126r1045255_rule


    - name: 'SV-258127r1134925_rule | RHEL 9, for PKI-based authentication, must enforce authorized access to the corr'
      shell:
        cmd: ssh-keygen -y -f /path/to/file
      register: SV_258127r1134925_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258127r1134925_rule

    - name: 'SV-258127r1134925_rule | Display check result'
      debug:
        var: SV_258127r1134925_rule_check.stdout
      tags:
        - stig_check
        - SV-258127r1134925_rule


    - name: 'SV-258128r1117265_rule | RHEL 9 must require authentication to access emergency mode.'
      shell:
        cmd: grep sulogin /usr/lib/systemd/system/emergency.service
      register: SV_258128r1117265_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258128r1117265_rule

    - name: 'SV-258128r1117265_rule | Display check result'
      debug:
        var: SV_258128r1117265_rule_check.stdout
      tags:
        - stig_check
        - SV-258128r1117265_rule


    - name: 'SV-258129r1117265_rule | RHEL 9 must require authentication to access single-user mode.'
      shell:
        cmd: grep sulogin /usr/lib/systemd/system/rescue.service
      register: SV_258129r1117265_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258129r1117265_rule

    - name: 'SV-258129r1117265_rule | Display check result'
      debug:
        var: SV_258129r1117265_rule_check.stdout
      tags:
        - stig_check
        - SV-258129r1117265_rule


    - name: 'SV-258131r1134927_rule | RHEL 9, for PKI-based authentication, must validate certificates by constructing'
      shell:
        cmd: openssl x509 -text -in /etc/sssd/pki/sssd_auth_ca_db.pem
      register: SV_258131r1134927_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258131r1134927_rule

    - name: 'SV-258131r1134927_rule | Display check result'
      debug:
        var: SV_258131r1134927_rule_check.stdout
      tags:
        - stig_check
        - SV-258131r1134927_rule


    - name: 'SV-258132r1134929_rule | RHEL 9 must map the authenticated identity to the user or group account for PKI-'
      shell:
        cmd: find /etc/sssd/sssd.conf /etc/sssd/conf.d/ -type f -exec cat {} \
      register: SV_258132r1134929_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258132r1134929_rule

    - name: 'SV-258132r1134929_rule | Display check result'
      debug:
        var: SV_258132r1134929_rule_check.stdout
      tags:
        - stig_check
        - SV-258132r1134929_rule


    - name: 'SV-258133r1045263_rule | RHEL 9 must prohibit the use of cached authenticators after one day.'
      shell:
        cmd: grep -ir cache_credentials /etc/sssd/sssd.conf /etc/sssd/conf.d/
      register: SV_258133r1045263_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258133r1045263_rule

    - name: 'SV-258133r1045263_rule | Display check result'
      debug:
        var: SV_258133r1045263_rule_check.stdout
      tags:
        - stig_check
        - SV-258133r1045263_rule


    - name: 'SV-258134r1101983_rule | RHEL 9 must have the AIDE package installed.'
      shell:
        cmd: find / -name aide.conf
      register: SV_258134r1101983_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258134r1101983_rule

    - name: 'SV-258134r1101983_rule | Display check result'
      debug:
        var: SV_258134r1101983_rule_check.stdout
      tags:
        - stig_check
        - SV-258134r1101983_rule


    - name: 'SV-258135r1045267_rule | RHEL 9 must routinely check the baseline configuration for unauthorized changes '
      shell:
        cmd: ls -al /etc/cron.* | grep aide
      register: SV_258135r1045267_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258135r1045267_rule

    - name: 'SV-258135r1045267_rule | Display check result'
      debug:
        var: SV_258135r1045267_rule_check.stdout
      tags:
        - stig_check
        - SV-258135r1045267_rule


    - name: 'SV-258136r1045270_rule | RHEL 9 must use a file integrity tool that is configured to use FIPS 140-3-appro'
      shell:
        cmd: grep sha512 /etc/aide.conf
      register: SV_258136r1045270_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258136r1045270_rule

    - name: 'SV-258136r1045270_rule | Display check result'
      debug:
        var: SV_258136r1045270_rule_check.stdout
      tags:
        - stig_check
        - SV-258136r1045270_rule


    - name: 'SV-258137r1102081_rule | RHEL 9 must use cryptographic mechanisms to protect the integrity of audit tools'
      shell:
        cmd: grep /usr/sbin/au /etc/aide.conf
      register: SV_258137r1102081_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258137r1102081_rule

    - name: 'SV-258137r1102081_rule | Display check result'
      debug:
        var: SV_258137r1102081_rule_check.stdout
      tags:
        - stig_check
        - SV-258137r1102081_rule


    - name: 'SV-258138r1045274_rule | RHEL 9 must be configured so that the file integrity tool verifies Access Contro'
      shell:
        cmd: grep acl /etc/aide.conf
      register: SV_258138r1045274_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258138r1045274_rule

    - name: 'SV-258138r1045274_rule | Display check result'
      debug:
        var: SV_258138r1045274_rule_check.stdout
      tags:
        - stig_check
        - SV-258138r1045274_rule


    - name: 'SV-258139r1045276_rule | RHEL 9 must be configured so that the file integrity tool verifies extended attr'
      shell:
        cmd: grep xattrs /etc/aide.conf
      register: SV_258139r1045276_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258139r1045276_rule

    - name: 'SV-258139r1045276_rule | Display check result'
      debug:
        var: SV_258139r1045276_rule_check.stdout
      tags:
        - stig_check
        - SV-258139r1045276_rule


    - name: 'SV-258140r1106460_rule | RHEL 9 must have the rsyslog package installed.'
      shell:
        cmd: dnf list --installed rsyslog
      register: SV_258140r1106460_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258140r1106460_rule

    - name: 'SV-258140r1106460_rule | Display check result'
      debug:
        var: SV_258140r1106460_rule_check.stdout
      tags:
        - stig_check
        - SV-258140r1106460_rule


    - name: 'SV-258141r1045280_rule | RHEL 9 must have the packages required for encrypting offloaded audit logs insta'
      shell:
        cmd: dnf list --installed rsyslog-gnutls
      register: SV_258141r1045280_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258141r1045280_rule

    - name: 'SV-258141r1045280_rule | Display check result'
      debug:
        var: SV_258141r1045280_rule_check.stdout
      tags:
        - stig_check
        - SV-258141r1045280_rule


    - name: 'SV-258142r991589_rule | The rsyslog service on RHEL 9 must be active.'
      shell:
        cmd: systemctl is-active rsyslog
      register: SV_258142r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258142r991589_rule

    - name: 'SV-258142r991589_rule | Display check result'
      debug:
        var: SV_258142r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-258142r991589_rule


    - name: 'SV-258143r1134931_rule | RHEL 9 must be configured so that the rsyslog daemon does not accept log message'
      shell:
        cmd: ss -tulnp | grep rsyslog
      register: SV_258143r1134931_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258143r1134931_rule

    - name: 'SV-258143r1134931_rule | Display check result'
      debug:
        var: SV_258143r1134931_rule_check.stdout
      tags:
        - stig_check
        - SV-258143r1134931_rule


    - name: 'SV-258144r1045286_rule | All RHEL 9 remote access methods must be monitored.'
      shell:
        cmd: grep -rE '(auth.\*|authpriv.\*|daemon.\*)' /etc/rsyslog.conf /etc/rsyslog.d/
      register: SV_258144r1045286_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258144r1045286_rule

    - name: 'SV-258144r1045286_rule | Display check result'
      debug:
        var: SV_258144r1045286_rule_check.stdout
      tags:
        - stig_check
        - SV-258144r1045286_rule


    - name: 'SV-258146r1045288_rule | RHEL 9 must authenticate the remote logging server for offloading audit logs via'
      shell:
        cmd: grep -i 'StreamDriver[\.]*AuthMode' /etc/rsyslog.conf /etc/rsyslog.d/*.conf
      register: SV_258146r1045288_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258146r1045288_rule

    - name: 'SV-258146r1045288_rule | Display check result'
      debug:
        var: SV_258146r1045288_rule_check.stdout
      tags:
        - stig_check
        - SV-258146r1045288_rule


    - name: 'SV-258147r1045290_rule | RHEL 9 must encrypt the transfer of audit records offloaded onto a different sys'
      shell:
        cmd: grep -i 'StreamDriver[\.]*Mode' /etc/rsyslog.conf /etc/rsyslog.d/*.conf
      register: SV_258147r1045290_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258147r1045290_rule

    - name: 'SV-258147r1045290_rule | Display check result'
      debug:
        var: SV_258147r1045290_rule_check.stdout
      tags:
        - stig_check
        - SV-258147r1045290_rule


    - name: 'SV-258148r1045292_rule | RHEL 9 must encrypt via the gtls driver the transfer of audit records offloaded '
      shell:
        cmd: grep -Ei 'DefaultNetStreamDriver\b|StreamDriver.Name' /etc/rsyslog.conf /etc/rsyslog.d/*.conf
      register: SV_258148r1045292_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258148r1045292_rule

    - name: 'SV-258148r1045292_rule | Display check result'
      debug:
        var: SV_258148r1045292_rule_check.stdout
      tags:
        - stig_check
        - SV-258148r1045292_rule


    - name: 'SV-258149r1106462_rule | RHEL 9 must be configured to forward audit records via TCP to a different system'
      shell:
        cmd: grep -iR '@@' /etc/rsyslog.conf /etc/rsyslog.d/
      register: SV_258149r1106462_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258149r1106462_rule

    - name: 'SV-258149r1106462_rule | Display check result'
      debug:
        var: SV_258149r1106462_rule_check.stdout
      tags:
        - stig_check
        - SV-258149r1106462_rule


    - name: 'SV-258150r1045296_rule | RHEL 9 must use cron logging.'
      shell:
        cmd: grep -s cron /etc/rsyslog.conf /etc/rsyslog.d/*.conf
      register: SV_258150r1045296_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258150r1045296_rule

    - name: 'SV-258150r1045296_rule | Display check result'
      debug:
        var: SV_258150r1045296_rule_check.stdout
      tags:
        - stig_check
        - SV-258150r1045296_rule


    - name: 'SV-258151r1045298_rule | RHEL 9 audit package must be installed.'
      shell:
        cmd: dnf list --installed audit
      register: SV_258151r1045298_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258151r1045298_rule

    - name: 'SV-258151r1045298_rule | Display check result'
      debug:
        var: SV_258151r1045298_rule_check.stdout
      tags:
        - stig_check
        - SV-258151r1045298_rule


    - name: 'SV-258152r1015127_rule | RHEL 9 audit service must be enabled.'
      shell:
        cmd: systemctl status auditd.service
      register: SV_258152r1015127_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258152r1015127_rule

    - name: 'SV-258152r1015127_rule | Display check result'
      debug:
        var: SV_258152r1015127_rule_check.stdout
      tags:
        - stig_check
        - SV-258152r1015127_rule


    - name: 'SV-258153r1038966_rule | RHEL 9 audit system must take appropriate action when an error writing to the au'
      shell:
        cmd: grep disk_error_action /etc/audit/auditd.conf
      register: SV_258153r1038966_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258153r1038966_rule

    - name: 'SV-258153r1038966_rule | Display check result'
      debug:
        var: SV_258153r1038966_rule_check.stdout
      tags:
        - stig_check
        - SV-258153r1038966_rule


    - name: 'SV-258154r1038966_rule | RHEL 9 audit system must take appropriate action when the audit storage volume i'
      shell:
        cmd: grep disk_full_action /etc/audit/auditd.conf
      register: SV_258154r1038966_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258154r1038966_rule

    - name: 'SV-258154r1038966_rule | Display check result'
      debug:
        var: SV_258154r1038966_rule_check.stdout
      tags:
        - stig_check
        - SV-258154r1038966_rule


    - name: 'SV-258155r1045300_rule | RHEL 9 must allocate audit record storage capacity to store at least one week's '
      shell:
        cmd: grep -w log_file /etc/audit/auditd.conf
      register: SV_258155r1045300_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258155r1045300_rule

    - name: 'SV-258155r1045300_rule | Display check result'
      debug:
        var: SV_258155r1045300_rule_check.stdout
      tags:
        - stig_check
        - SV-258155r1045300_rule


    - name: 'SV-258156r1106364_rule | RHEL 9 must take action when allocated audit record storage volume reaches 75 pe'
      shell:
        cmd: grep -w space_left /etc/audit/auditd.conf
      register: SV_258156r1106364_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258156r1106364_rule

    - name: 'SV-258156r1106364_rule | Display check result'
      debug:
        var: SV_258156r1106364_rule_check.stdout
      tags:
        - stig_check
        - SV-258156r1106364_rule


    - name: 'SV-258157r1134932_rule | RHEL 9 must notify the system administrator (SA) and information system security'
      shell:
        cmd: grep -w space_left_action /etc/audit/auditd.conf
      register: SV_258157r1134932_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258157r1134932_rule

    - name: 'SV-258157r1134932_rule | Display check result'
      debug:
        var: SV_258157r1134932_rule_check.stdout
      tags:
        - stig_check
        - SV-258157r1134932_rule


    - name: 'SV-258158r971542_rule | RHEL 9 must take action when allocated audit record storage volume reaches 95 pe'
      shell:
        cmd: grep -w admin_space_left /etc/audit/auditd.conf
      register: SV_258158r971542_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258158r971542_rule

    - name: 'SV-258158r971542_rule | Display check result'
      debug:
        var: SV_258158r971542_rule_check.stdout
      tags:
        - stig_check
        - SV-258158r971542_rule


    - name: 'SV-258159r971542_rule | RHEL 9 must take action when allocated audit record storage volume reaches 95 pe'
      shell:
        cmd: grep admin_space_left_action /etc/audit/auditd.conf
      register: SV_258159r971542_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258159r971542_rule

    - name: 'SV-258159r971542_rule | Display check result'
      debug:
        var: SV_258159r971542_rule_check.stdout
      tags:
        - stig_check
        - SV-258159r971542_rule


    - name: 'SV-258160r1038966_rule | RHEL 9 audit system must take appropriate action when the audit files have reach'
      shell:
        cmd: grep max_log_file_action /etc/audit/auditd.conf
      register: SV_258160r1038966_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258160r1038966_rule

    - name: 'SV-258160r1038966_rule | Display check result'
      debug:
        var: SV_258160r1038966_rule_check.stdout
      tags:
        - stig_check
        - SV-258160r1038966_rule


    - name: 'SV-258161r958416_rule | RHEL 9 must label all offloaded audit logs before sending them to the central lo'
      shell:
        cmd: grep name_format /etc/audit/auditd.conf
      register: SV_258161r958416_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258161r958416_rule

    - name: 'SV-258161r958416_rule | Display check result'
      debug:
        var: SV_258161r958416_rule_check.stdout
      tags:
        - stig_check
        - SV-258161r958416_rule


    - name: 'SV-258162r958754_rule | RHEL 9 must take appropriate action when the internal event queue is full.'
      shell:
        cmd: grep -i overflow_action /etc/audit/auditd.conf
      register: SV_258162r958754_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258162r958754_rule

    - name: 'SV-258162r958754_rule | Display check result'
      debug:
        var: SV_258162r958754_rule_check.stdout
      tags:
        - stig_check
        - SV-258162r958754_rule


    - name: 'SV-258163r958424_rule | RHEL 9 System Administrator (SA) and/or information system security officer (ISS'
      shell:
        cmd: grep action_mail_acct /etc/audit/auditd.conf
      register: SV_258163r958424_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258163r958424_rule

    - name: 'SV-258163r958424_rule | Display check result'
      debug:
        var: SV_258163r958424_rule_check.stdout
      tags:
        - stig_check
        - SV-258163r958424_rule


    - name: 'SV-258164r1045301_rule | RHEL 9 audit system must audit local events.'
      shell:
        cmd: grep local_events /etc/audit/auditd.conf
      register: SV_258164r1045301_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258164r1045301_rule

    - name: 'SV-258164r1045301_rule | Display check result'
      debug:
        var: SV_258164r1045301_rule_check.stdout
      tags:
        - stig_check
        - SV-258164r1045301_rule


    - name: 'SV-258165r958434_rule | RHEL 9 audit logs must be group-owned by root or by a restricted logging group t'
      shell:
        cmd: grep log_group /etc/audit/auditd.conf
      register: SV_258165r958434_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258165r958434_rule

    - name: 'SV-258165r958434_rule | Display check result'
      debug:
        var: SV_258165r958434_rule_check.stdout
      tags:
        - stig_check
        - SV-258165r958434_rule


    - name: 'SV-258166r1045303_rule | RHEL 9 audit log directory must be owned by root to prevent unauthorized read ac'
      shell:
        cmd: grep -iw log_file /etc/audit/auditd.conf
      register: SV_258166r1045303_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258166r1045303_rule

    - name: 'SV-258166r1045303_rule | Display check result'
      debug:
        var: SV_258166r1045303_rule_check.stdout
      tags:
        - stig_check
        - SV-258166r1045303_rule


    - name: 'SV-258167r1101918_rule | RHEL 9 audit logs file must have mode 0600 or less permissive to prevent unautho'
      shell:
        cmd: find /var/log/audit/ -type f -exec stat -c '%a %n' {} \
      register: SV_258167r1101918_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258167r1101918_rule

    - name: 'SV-258167r1101918_rule | Display check result'
      debug:
        var: SV_258167r1101918_rule_check.stdout
      tags:
        - stig_check
        - SV-258167r1101918_rule


    - name: 'SV-258168r958428_rule | RHEL 9 must periodically flush audit records to disk to prevent the loss of audi'
      shell:
        cmd: grep freq /etc/audit/auditd.conf
      register: SV_258168r958428_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258168r958428_rule

    - name: 'SV-258168r958428_rule | Display check result'
      debug:
        var: SV_258168r958428_rule_check.stdout
      tags:
        - stig_check
        - SV-258168r958428_rule


    - name: 'SV-258169r991556_rule | RHEL 9 must produce audit records containing information to establish the identi'
      shell:
        cmd: grep log_format /etc/audit/auditd.conf
      register: SV_258169r991556_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258169r991556_rule

    - name: 'SV-258169r991556_rule | Display check result'
      debug:
        var: SV_258169r991556_rule_check.stdout
      tags:
        - stig_check
        - SV-258169r991556_rule


    - name: 'SV-258170r991589_rule | RHEL 9 must write audit records to disk.'
      shell:
        cmd: grep write_logs /etc/audit/auditd.conf
      register: SV_258170r991589_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258170r991589_rule

    - name: 'SV-258170r991589_rule | Display check result'
      debug:
        var: SV_258170r991589_rule_check.stdout
      tags:
        - stig_check
        - SV-258170r991589_rule


    - name: 'SV-258171r1134934_rule | RHEL 9 must allow only the information system security manager (ISSM) (or indivi'
      shell:
        cmd: find /etc/audit/rules.d/ /etc/audit/audit.rules /etc/audit/auditd.conf -type f -exec stat -c "%a %n" {} \
      register: SV_258171r1134934_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258171r1134934_rule

    - name: 'SV-258171r1134934_rule | Display check result'
      debug:
        var: SV_258171r1134934_rule_check.stdout
      tags:
        - stig_check
        - SV-258171r1134934_rule


    - name: 'SV-258173r1101933_rule | RHEL 9 must allocate an audit_backlog_limit of sufficient size to capture proces'
      shell:
        cmd: grubby --info=ALL | grep args | grep 'audit_backlog_limit'
      register: SV_258173r1101933_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258173r1101933_rule

    - name: 'SV-258173r1101933_rule | Display check result'
      debug:
        var: SV_258173r1101933_rule_check.stdout
      tags:
        - stig_check
        - SV-258173r1101933_rule


    - name: 'SV-258174r958424_rule | RHEL 9 must have mail aliases to notify the information system security officer '
      shell:
        cmd: Find the alias maps that are being used with the following command
      register: SV_258174r958424_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258174r958424_rule

    - name: 'SV-258174r958424_rule | Display check result'
      debug:
        var: SV_258174r958424_rule_check.stdout
      tags:
        - stig_check
        - SV-258174r958424_rule


    - name: 'SV-258175r1045310_rule | RHEL 9 audispd-plugins package must be installed.'
      shell:
        cmd: dnf list --installed audispd-plugins
      register: SV_258175r1045310_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258175r1045310_rule

    - name: 'SV-258175r1045310_rule | Display check result'
      debug:
        var: SV_258175r1045310_rule_check.stdout
      tags:
        - stig_check
        - SV-258175r1045310_rule


    - name: 'SV-258176r1106366_rule | RHEL 9 must audit uses of the "execve" system call.'
      shell:
        cmd: auditctl -l | grep execve
      register: SV_258176r1106366_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258176r1106366_rule

    - name: 'SV-258176r1106366_rule | Display check result'
      debug:
        var: SV_258176r1106366_rule_check.stdout
      tags:
        - stig_check
        - SV-258176r1106366_rule


    - name: 'SV-258177r1106368_rule | RHEL 9 must audit all uses of the chmod, fchmod, and fchmodat system calls.'
      shell:
        cmd: auditctl -l | grep chmod
      register: SV_258177r1106368_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258177r1106368_rule

    - name: 'SV-258177r1106368_rule | Display check result'
      debug:
        var: SV_258177r1106368_rule_check.stdout
      tags:
        - stig_check
        - SV-258177r1106368_rule


    - name: 'SV-258178r1106370_rule | RHEL 9 must audit all uses of the chown, fchown, fchownat, and lchown system cal'
      shell:
        cmd: auditctl -l | grep chown
      register: SV_258178r1106370_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258178r1106370_rule

    - name: 'SV-258178r1106370_rule | Display check result'
      debug:
        var: SV_258178r1106370_rule_check.stdout
      tags:
        - stig_check
        - SV-258178r1106370_rule


    - name: 'SV-258179r1106371_rule | RHEL 9 must audit all uses of the setxattr, fsetxattr, lsetxattr, removexattr, f'
      shell:
        cmd: auditctl -l | grep xattr
      register: SV_258179r1106371_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258179r1106371_rule

    - name: 'SV-258179r1106371_rule | Display check result'
      debug:
        var: SV_258179r1106371_rule_check.stdout
      tags:
        - stig_check
        - SV-258179r1106371_rule


    - name: 'SV-258180r1045325_rule | RHEL 9 must audit all uses of umount system calls.'
      shell:
        cmd: auditctl -l | grep /usr/bin/umount
      register: SV_258180r1045325_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258180r1045325_rule

    - name: 'SV-258180r1045325_rule | Display check result'
      debug:
        var: SV_258180r1045325_rule_check.stdout
      tags:
        - stig_check
        - SV-258180r1045325_rule


    - name: 'SV-258181r1045328_rule | RHEL 9 must audit all uses of the chacl command.'
      shell:
        cmd: auditctl -l | grep chacl
      register: SV_258181r1045328_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258181r1045328_rule

    - name: 'SV-258181r1045328_rule | Display check result'
      debug:
        var: SV_258181r1045328_rule_check.stdout
      tags:
        - stig_check
        - SV-258181r1045328_rule


    - name: 'SV-258182r1045331_rule | RHEL 9 must audit all uses of the setfacl command.'
      shell:
        cmd: auditctl -l | grep setfacl
      register: SV_258182r1045331_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258182r1045331_rule

    - name: 'SV-258182r1045331_rule | Display check result'
      debug:
        var: SV_258182r1045331_rule_check.stdout
      tags:
        - stig_check
        - SV-258182r1045331_rule


    - name: 'SV-258183r1045334_rule | RHEL 9 must audit all uses of the chcon command.'
      shell:
        cmd: auditctl -l | grep chcon
      register: SV_258183r1045334_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258183r1045334_rule

    - name: 'SV-258183r1045334_rule | Display check result'
      debug:
        var: SV_258183r1045334_rule_check.stdout
      tags:
        - stig_check
        - SV-258183r1045334_rule


    - name: 'SV-258184r1045337_rule | RHEL 9 must audit all uses of the semanage command.'
      shell:
        cmd: auditctl -l | grep semanage
      register: SV_258184r1045337_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258184r1045337_rule

    - name: 'SV-258184r1045337_rule | Display check result'
      debug:
        var: SV_258184r1045337_rule_check.stdout
      tags:
        - stig_check
        - SV-258184r1045337_rule


    - name: 'SV-258185r1045340_rule | RHEL 9 must audit all uses of the setfiles command.'
      shell:
        cmd: auditctl -l | grep setfiles
      register: SV_258185r1045340_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258185r1045340_rule

    - name: 'SV-258185r1045340_rule | Display check result'
      debug:
        var: SV_258185r1045340_rule_check.stdout
      tags:
        - stig_check
        - SV-258185r1045340_rule


    - name: 'SV-258186r1045343_rule | RHEL 9 must audit all uses of the setsebool command.'
      shell:
        cmd: auditctl -l | grep setsebool
      register: SV_258186r1045343_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258186r1045343_rule

    - name: 'SV-258186r1045343_rule | Display check result'
      debug:
        var: SV_258186r1045343_rule_check.stdout
      tags:
        - stig_check
        - SV-258186r1045343_rule


    - name: 'SV-258187r1106373_rule | RHEL 9 must audit all uses of the rename, unlink, rmdir, renameat, and unlinkat '
      shell:
        cmd: auditctl -l | grep 'rename\|unlink\|rmdir'
      register: SV_258187r1106373_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258187r1106373_rule

    - name: 'SV-258187r1106373_rule | Display check result'
      debug:
        var: SV_258187r1106373_rule_check.stdout
      tags:
        - stig_check
        - SV-258187r1106373_rule


    - name: 'SV-258188r1106375_rule | RHEL 9 must audit all uses of the truncate, ftruncate, creat, open, openat, and '
      shell:
        cmd: auditctl -l | grep 'open\b\|openat\|open_by_handle_at\|truncate\|creat'
      register: SV_258188r1106375_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258188r1106375_rule

    - name: 'SV-258188r1106375_rule | Display check result'
      debug:
        var: SV_258188r1106375_rule_check.stdout
      tags:
        - stig_check
        - SV-258188r1106375_rule


    - name: 'SV-258189r1106377_rule | RHEL 9 must audit all uses of the delete_module system call.'
      shell:
        cmd: auditctl -l | grep delete_module
      register: SV_258189r1106377_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258189r1106377_rule

    - name: 'SV-258189r1106377_rule | Display check result'
      debug:
        var: SV_258189r1106377_rule_check.stdout
      tags:
        - stig_check
        - SV-258189r1106377_rule


    - name: 'SV-258190r1106379_rule | RHEL 9 must audit all uses of the init_module and finit_module system calls.'
      shell:
        cmd: auditctl -l | grep init_module
      register: SV_258190r1106379_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258190r1106379_rule

    - name: 'SV-258190r1106379_rule | Display check result'
      debug:
        var: SV_258190r1106379_rule_check.stdout
      tags:
        - stig_check
        - SV-258190r1106379_rule


    - name: 'SV-258191r1045358_rule | RHEL 9 must audit all uses of the chage command.'
      shell:
        cmd: auditctl -l | grep chage
      register: SV_258191r1045358_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258191r1045358_rule

    - name: 'SV-258191r1045358_rule | Display check result'
      debug:
        var: SV_258191r1045358_rule_check.stdout
      tags:
        - stig_check
        - SV-258191r1045358_rule


    - name: 'SV-258192r1045361_rule | RHEL 9 must audit all uses of the chsh command.'
      shell:
        cmd: auditctl -l | grep chsh
      register: SV_258192r1045361_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258192r1045361_rule

    - name: 'SV-258192r1045361_rule | Display check result'
      debug:
        var: SV_258192r1045361_rule_check.stdout
      tags:
        - stig_check
        - SV-258192r1045361_rule


    - name: 'SV-258193r1045364_rule | RHEL 9 must audit all uses of the crontab command.'
      shell:
        cmd: auditctl -l | grep crontab
      register: SV_258193r1045364_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258193r1045364_rule

    - name: 'SV-258193r1045364_rule | Display check result'
      debug:
        var: SV_258193r1045364_rule_check.stdout
      tags:
        - stig_check
        - SV-258193r1045364_rule


    - name: 'SV-258194r1045367_rule | RHEL 9 must audit all uses of the gpasswd command.'
      shell:
        cmd: auditctl -l | grep gpasswd
      register: SV_258194r1045367_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258194r1045367_rule

    - name: 'SV-258194r1045367_rule | Display check result'
      debug:
        var: SV_258194r1045367_rule_check.stdout
      tags:
        - stig_check
        - SV-258194r1045367_rule


    - name: 'SV-258195r1045370_rule | RHEL 9 must audit all uses of the kmod command.'
      shell:
        cmd: auditctl -l | grep kmod
      register: SV_258195r1045370_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258195r1045370_rule

    - name: 'SV-258195r1045370_rule | Display check result'
      debug:
        var: SV_258195r1045370_rule_check.stdout
      tags:
        - stig_check
        - SV-258195r1045370_rule


    - name: 'SV-258196r1045373_rule | RHEL 9 must audit all uses of the newgrp command.'
      shell:
        cmd: auditctl -l | grep newgrp
      register: SV_258196r1045373_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258196r1045373_rule

    - name: 'SV-258196r1045373_rule | Display check result'
      debug:
        var: SV_258196r1045373_rule_check.stdout
      tags:
        - stig_check
        - SV-258196r1045373_rule


    - name: 'SV-258197r1045376_rule | RHEL 9 must audit all uses of the pam_timestamp_check command.'
      shell:
        cmd: auditctl -l | grep timestamp
      register: SV_258197r1045376_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258197r1045376_rule

    - name: 'SV-258197r1045376_rule | Display check result'
      debug:
        var: SV_258197r1045376_rule_check.stdout
      tags:
        - stig_check
        - SV-258197r1045376_rule


    - name: 'SV-258198r1045379_rule | RHEL 9 must audit all uses of the passwd command.'
      shell:
        cmd: auditctl -l | egrep '(/usr/bin/passwd)'
      register: SV_258198r1045379_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258198r1045379_rule

    - name: 'SV-258198r1045379_rule | Display check result'
      debug:
        var: SV_258198r1045379_rule_check.stdout
      tags:
        - stig_check
        - SV-258198r1045379_rule


    - name: 'SV-258199r1045382_rule | RHEL 9 must audit all uses of the postdrop command.'
      shell:
        cmd: auditctl -l | grep postdrop
      register: SV_258199r1045382_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258199r1045382_rule

    - name: 'SV-258199r1045382_rule | Display check result'
      debug:
        var: SV_258199r1045382_rule_check.stdout
      tags:
        - stig_check
        - SV-258199r1045382_rule


    - name: 'SV-258200r1045385_rule | RHEL 9 must audit all uses of the postqueue command.'
      shell:
        cmd: auditctl -l | grep postqueue
      register: SV_258200r1045385_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258200r1045385_rule

    - name: 'SV-258200r1045385_rule | Display check result'
      debug:
        var: SV_258200r1045385_rule_check.stdout
      tags:
        - stig_check
        - SV-258200r1045385_rule


    - name: 'SV-258201r1045388_rule | RHEL 9 must audit all uses of the ssh-agent command.'
      shell:
        cmd: auditctl -l | grep ssh-agent
      register: SV_258201r1045388_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258201r1045388_rule

    - name: 'SV-258201r1045388_rule | Display check result'
      debug:
        var: SV_258201r1045388_rule_check.stdout
      tags:
        - stig_check
        - SV-258201r1045388_rule


    - name: 'SV-258202r1045391_rule | RHEL 9 must audit all uses of the ssh-keysign command.'
      shell:
        cmd: auditctl -l | grep ssh-keysign
      register: SV_258202r1045391_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258202r1045391_rule

    - name: 'SV-258202r1045391_rule | Display check result'
      debug:
        var: SV_258202r1045391_rule_check.stdout
      tags:
        - stig_check
        - SV-258202r1045391_rule


    - name: 'SV-258203r1045394_rule | RHEL 9 must audit all uses of the su command.'
      shell:
        cmd: auditctl -l | grep '/usr/bin/su\b'
      register: SV_258203r1045394_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258203r1045394_rule

    - name: 'SV-258203r1045394_rule | Display check result'
      debug:
        var: SV_258203r1045394_rule_check.stdout
      tags:
        - stig_check
        - SV-258203r1045394_rule


    - name: 'SV-258204r1045397_rule | RHEL 9 must audit all uses of the sudo command.'
      shell:
        cmd: auditctl -l | grep '/usr/bin/sudo\b'
      register: SV_258204r1045397_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258204r1045397_rule

    - name: 'SV-258204r1045397_rule | Display check result'
      debug:
        var: SV_258204r1045397_rule_check.stdout
      tags:
        - stig_check
        - SV-258204r1045397_rule


    - name: 'SV-258205r1045400_rule | RHEL 9 must audit all uses of the sudoedit command.'
      shell:
        cmd: auditctl -l | grep /usr/bin/sudoedit
      register: SV_258205r1045400_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258205r1045400_rule

    - name: 'SV-258205r1045400_rule | Display check result'
      debug:
        var: SV_258205r1045400_rule_check.stdout
      tags:
        - stig_check
        - SV-258205r1045400_rule


    - name: 'SV-258206r1045403_rule | RHEL 9 must audit all uses of the unix_chkpwd command.'
      shell:
        cmd: auditctl -l | grep unix_chkpwd
      register: SV_258206r1045403_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258206r1045403_rule

    - name: 'SV-258206r1045403_rule | Display check result'
      debug:
        var: SV_258206r1045403_rule_check.stdout
      tags:
        - stig_check
        - SV-258206r1045403_rule


    - name: 'SV-258207r1045406_rule | RHEL 9 must audit all uses of the unix_update command.'
      shell:
        cmd: auditctl -l | grep unix_update
      register: SV_258207r1045406_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258207r1045406_rule

    - name: 'SV-258207r1045406_rule | Display check result'
      debug:
        var: SV_258207r1045406_rule_check.stdout
      tags:
        - stig_check
        - SV-258207r1045406_rule


    - name: 'SV-258208r1045409_rule | RHEL 9 must audit all uses of the userhelper command.'
      shell:
        cmd: auditctl -l | grep userhelper
      register: SV_258208r1045409_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258208r1045409_rule

    - name: 'SV-258208r1045409_rule | Display check result'
      debug:
        var: SV_258208r1045409_rule_check.stdout
      tags:
        - stig_check
        - SV-258208r1045409_rule


    - name: 'SV-258209r1045412_rule | RHEL 9 must audit all uses of the usermod command.'
      shell:
        cmd: auditctl -l | grep usermod
      register: SV_258209r1045412_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258209r1045412_rule

    - name: 'SV-258209r1045412_rule | Display check result'
      debug:
        var: SV_258209r1045412_rule_check.stdout
      tags:
        - stig_check
        - SV-258209r1045412_rule


    - name: 'SV-258210r1045415_rule | RHEL 9 must audit all uses of the mount command.'
      shell:
        cmd: auditctl -l | grep /usr/bin/mount
      register: SV_258210r1045415_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258210r1045415_rule

    - name: 'SV-258210r1045415_rule | Display check result'
      debug:
        var: SV_258210r1045415_rule_check.stdout
      tags:
        - stig_check
        - SV-258210r1045415_rule


    - name: 'SV-258211r1045418_rule | Successful/unsuccessful uses of the init command in RHEL 9 must generate an audi'
      shell:
        cmd: auditctl -l | grep /usr/sbin/init
      register: SV_258211r1045418_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258211r1045418_rule

    - name: 'SV-258211r1045418_rule | Display check result'
      debug:
        var: SV_258211r1045418_rule_check.stdout
      tags:
        - stig_check
        - SV-258211r1045418_rule


    - name: 'SV-258212r1045421_rule | Successful/unsuccessful uses of the poweroff command in RHEL 9 must generate an '
      shell:
        cmd: auditctl -l | grep poweroff
      register: SV_258212r1045421_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258212r1045421_rule

    - name: 'SV-258212r1045421_rule | Display check result'
      debug:
        var: SV_258212r1045421_rule_check.stdout
      tags:
        - stig_check
        - SV-258212r1045421_rule


    - name: 'SV-258213r1045424_rule | Successful/unsuccessful uses of the reboot command in RHEL 9 must generate an au'
      shell:
        cmd: auditctl -l | grep reboot
      register: SV_258213r1045424_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258213r1045424_rule

    - name: 'SV-258213r1045424_rule | Display check result'
      debug:
        var: SV_258213r1045424_rule_check.stdout
      tags:
        - stig_check
        - SV-258213r1045424_rule


    - name: 'SV-258214r1045427_rule | Successful/unsuccessful uses of the shutdown command in RHEL 9 must generate an '
      shell:
        cmd: cat /etc/audit/rules.d/* | grep shutdown
      register: SV_258214r1045427_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258214r1045427_rule

    - name: 'SV-258214r1045427_rule | Display check result'
      debug:
        var: SV_258214r1045427_rule_check.stdout
      tags:
        - stig_check
        - SV-258214r1045427_rule


    - name: 'SV-258215r1106381_rule | Successful/unsuccessful uses of the umount system call in RHEL 9 must generate a'
      shell:
        cmd: auditctl -l | grep b32 | grep 'umount\b'
      register: SV_258215r1106381_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258215r1106381_rule

    - name: 'SV-258215r1106381_rule | Display check result'
      debug:
        var: SV_258215r1106381_rule_check.stdout
      tags:
        - stig_check
        - SV-258215r1106381_rule


    - name: 'SV-258216r1102090_rule | Successful/unsuccessful uses of the umount2 system call in RHEL 9 must generate '
      shell:
        cmd: auditctl -l | grep umount2
      register: SV_258216r1102090_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258216r1102090_rule

    - name: 'SV-258216r1102090_rule | Display check result'
      debug:
        var: SV_258216r1102090_rule_check.stdout
      tags:
        - stig_check
        - SV-258216r1102090_rule


    - name: 'SV-258217r1045436_rule | RHEL 9 must generate audit records for all account creations, modifications, dis'
      shell:
        cmd: auditctl -l | grep '/etc/sudoers[^.]'
      register: SV_258217r1045436_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258217r1045436_rule

    - name: 'SV-258217r1045436_rule | Display check result'
      debug:
        var: SV_258217r1045436_rule_check.stdout
      tags:
        - stig_check
        - SV-258217r1045436_rule


    - name: 'SV-258218r1101981_rule | RHEL 9 must generate audit records for all account creations, modifications, dis'
      shell:
        cmd: auditctl -l | grep /etc/sudoers.d
      register: SV_258218r1101981_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258218r1101981_rule

    - name: 'SV-258218r1101981_rule | Display check result'
      debug:
        var: SV_258218r1101981_rule_check.stdout
      tags:
        - stig_check
        - SV-258218r1101981_rule


    - name: 'SV-258219r1015130_rule | RHEL 9 must generate audit records for all account creations, modifications, dis'
      shell:
        cmd: auditctl -l | egrep '(/etc/group)'
      register: SV_258219r1015130_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258219r1015130_rule

    - name: 'SV-258219r1015130_rule | Display check result'
      debug:
        var: SV_258219r1015130_rule_check.stdout
      tags:
        - stig_check
        - SV-258219r1015130_rule


    - name: 'SV-258220r1015131_rule | RHEL 9 must generate audit records for all account creations, modifications, dis'
      shell:
        cmd: auditctl -l | egrep '(/etc/gshadow)'
      register: SV_258220r1015131_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258220r1015131_rule

    - name: 'SV-258220r1015131_rule | Display check result'
      debug:
        var: SV_258220r1015131_rule_check.stdout
      tags:
        - stig_check
        - SV-258220r1015131_rule


    - name: 'SV-258221r1015132_rule | RHEL 9 must generate audit records for all account creations, modifications, dis'
      shell:
        cmd: auditctl -l | egrep '(/etc/security/opasswd)'
      register: SV_258221r1015132_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258221r1015132_rule

    - name: 'SV-258221r1015132_rule | Display check result'
      debug:
        var: SV_258221r1015132_rule_check.stdout
      tags:
        - stig_check
        - SV-258221r1015132_rule


    - name: 'SV-258222r1015133_rule | RHEL 9 must generate audit records for all account creations, modifications, dis'
      shell:
        cmd: auditctl -l | egrep '(/etc/passwd)'
      register: SV_258222r1015133_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258222r1015133_rule

    - name: 'SV-258222r1015133_rule | Display check result'
      debug:
        var: SV_258222r1015133_rule_check.stdout
      tags:
        - stig_check
        - SV-258222r1015133_rule


    - name: 'SV-258223r1015134_rule | RHEL 9 must generate audit records for all account creations, modifications, dis'
      shell:
        cmd: auditctl -l | egrep '(/etc/shadow)'
      register: SV_258223r1015134_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258223r1015134_rule

    - name: 'SV-258223r1015134_rule | Display check result'
      debug:
        var: SV_258223r1015134_rule_check.stdout
      tags:
        - stig_check
        - SV-258223r1015134_rule


    - name: 'SV-258224r1014988_rule | RHEL 9 must generate audit records for all account creations, modifications, dis'
      shell:
        cmd: auditctl -l | grep /var/log/faillock
      register: SV_258224r1014988_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258224r1014988_rule

    - name: 'SV-258224r1014988_rule | Display check result'
      debug:
        var: SV_258224r1014988_rule_check.stdout
      tags:
        - stig_check
        - SV-258224r1014988_rule


    - name: 'SV-258225r1014990_rule | RHEL 9 must generate audit records for all account creations, modifications, dis'
      shell:
        cmd: auditctl -l | grep /var/log/lastlog
      register: SV_258225r1014990_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258225r1014990_rule

    - name: 'SV-258225r1014990_rule | Display check result'
      debug:
        var: SV_258225r1014990_rule_check.stdout
      tags:
        - stig_check
        - SV-258225r1014990_rule


    - name: 'SV-258227r1014992_rule | RHEL 9 must take appropriate action when a critical audit processing failure occ'
      shell:
        cmd: grep "\-f" /etc/audit/audit.rules
      register: SV_258227r1014992_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258227r1014992_rule

    - name: 'SV-258227r1014992_rule | Display check result'
      debug:
        var: SV_258227r1014992_rule_check.stdout
      tags:
        - stig_check
        - SV-258227r1014992_rule


    - name: 'SV-258228r991572_rule | RHEL 9 audit system must protect logon UIDs from unauthorized change.'
      shell:
        cmd: grep -i immutable /etc/audit/audit.rules
      register: SV_258228r991572_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258228r991572_rule

    - name: 'SV-258228r991572_rule | Display check result'
      debug:
        var: SV_258228r991572_rule_check.stdout
      tags:
        - stig_check
        - SV-258228r991572_rule


    - name: 'SV-258229r958434_rule | RHEL 9 audit system must protect auditing rules from unauthorized change.'
      shell:
        cmd: grep "^\s*[^#]" /etc/audit/audit.rules | tail -1
      register: SV_258229r958434_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258229r958434_rule

    - name: 'SV-258229r958434_rule | Display check result'
      debug:
        var: SV_258229r958434_rule_check.stdout
      tags:
        - stig_check
        - SV-258229r958434_rule


    - name: 'SV-258230r1134936_rule | RHEL 9 must enable FIPS mode.'
      debug:
        msg: "SV-258230r1134936_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-258230r1134936_rule


    - name: 'SV-258231r1069375_rule | RHEL 9 must employ FIPS 140-3 approved cryptographic hashing algorithms for all '
      debug:
        msg: "SV-258231r1069375_rule requires manual verification. See CTP document for procedure."
      tags:
        - stig_check
        - SV-258231r1069375_rule


    - name: 'SV-258232r1045440_rule | RHEL 9 IP tunnels must use FIPS 140-3 approved cryptographic algorithms.'
      shell:
        cmd: grep include /etc/ipsec.conf /etc/ipsec.d/*.conf
      register: SV_258232r1045440_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258232r1045440_rule

    - name: 'SV-258232r1045440_rule | Display check result'
      debug:
        var: SV_258232r1045440_rule_check.stdout
      tags:
        - stig_check
        - SV-258232r1045440_rule


    - name: 'SV-258233r1015136_rule | RHEL 9 pam_unix.so module must be configured in the password-auth file to use a '
      shell:
        cmd: grep "^password.*pam_unix.so.*sha512" /etc/pam.d/password-auth
      register: SV_258233r1015136_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258233r1015136_rule

    - name: 'SV-258233r1015136_rule | Display check result'
      debug:
        var: SV_258233r1015136_rule_check.stdout
      tags:
        - stig_check
        - SV-258233r1015136_rule


    - name: 'SV-258234r1051250_rule | RHEL 9 must have the crypto-policies package installed.'
      shell:
        cmd: dnf list --installed crypto-policies
      register: SV_258234r1051250_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258234r1051250_rule

    - name: 'SV-258234r1051250_rule | Display check result'
      debug:
        var: SV_258234r1051250_rule_check.stdout
      tags:
        - stig_check
        - SV-258234r1051250_rule


    - name: 'SV-258236r1101920_rule | RHEL 9 cryptographic policy must not be overridden.'
      shell:
        cmd: ls -l /etc/crypto-policies/back-ends/
      register: SV_258236r1101920_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258236r1101920_rule

    - name: 'SV-258236r1101920_rule | Display check result'
      debug:
        var: SV_258236r1101920_rule_check.stdout
      tags:
        - stig_check
        - SV-258236r1101920_rule


    - name: 'SV-258241r1106302_rule | RHEL 9 must implement a FIPS 140-3-compliant systemwide cryptographic policy.'
      shell:
        cmd: grep -E 'rsa_size|hash' /etc/crypto-policies/state/CURRENT.pol
      register: SV_258241r1106302_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258241r1106302_rule

    - name: 'SV-258241r1106302_rule | Display check result'
      debug:
        var: SV_258241r1106302_rule_check.stdout
      tags:
        - stig_check
        - SV-258241r1106302_rule


    - name: 'SV-258242r958908_rule | RHEL 9 must implement DOD-approved encryption in the bind package.'
      shell:
        cmd: grep include /etc/named.conf
      register: SV_258242r958908_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-258242r958908_rule

    - name: 'SV-258242r958908_rule | Display check result'
      debug:
        var: SV_258242r958908_rule_check.stdout
      tags:
        - stig_check
        - SV-258242r958908_rule


    - name: 'SV-270174r1044831_rule | RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before '
      shell:
        cmd: gsettings get org.gnome.login-screen banner-message-text
      register: SV_270174r1044831_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-270174r1044831_rule

    - name: 'SV-270174r1044831_rule | Display check result'
      debug:
        var: SV_270174r1044831_rule_check.stdout
      tags:
        - stig_check
        - SV-270174r1044831_rule


    - name: 'SV-270175r1117265_rule | RHEL 9 "/etc/audit/" must be owned by root.'
      shell:
        cmd: stat -c "%U %n" /etc/audit/
      register: SV_270175r1117265_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-270175r1117265_rule

    - name: 'SV-270175r1117265_rule | Display check result'
      debug:
        var: SV_270175r1117265_rule_check.stdout
      tags:
        - stig_check
        - SV-270175r1117265_rule


    - name: 'SV-270176r1117265_rule | RHEL 9 "/etc/audit/" must be group-owned by root.'
      shell:
        cmd: stat -c "%G %n" /etc/audit/
      register: SV_270176r1117265_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-270176r1117265_rule

    - name: 'SV-270176r1117265_rule | Display check result'
      debug:
        var: SV_270176r1117265_rule_check.stdout
      tags:
        - stig_check
        - SV-270176r1117265_rule


    - name: 'SV-270177r1051237_rule | The RHEL 9 SSH client must be configured to use only DOD-approved encryption cip'
      shell:
        cmd: grep -i Ciphers /etc/crypto-policies/back-ends/openssh.config
      register: SV_270177r1051237_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-270177r1051237_rule

    - name: 'SV-270177r1051237_rule | Display check result'
      debug:
        var: SV_270177r1051237_rule_check.stdout
      tags:
        - stig_check
        - SV-270177r1051237_rule


    - name: 'SV-270178r1051243_rule | The RHEL 9 SSH client must be configured to use only DOD-approved Message Authen'
      shell:
        cmd: grep -i MACs /etc/crypto-policies/back-ends/openssh.config
      register: SV_270178r1051243_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-270178r1051243_rule

    - name: 'SV-270178r1051243_rule | Display check result'
      debug:
        var: SV_270178r1051243_rule_check.stdout
      tags:
        - stig_check
        - SV-270178r1051243_rule


    - name: 'SV-270180r1045182_rule | The RHEL 9 fapolicy module must be configured to employ a deny-all, permit-by-ex'
      shell:
        cmd: grep permissive /etc/fapolicyd/fapolicyd.conf
      register: SV_270180r1045182_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-270180r1045182_rule

    - name: 'SV-270180r1045182_rule | Display check result'
      debug:
        var: SV_270180r1045182_rule_check.stdout
      tags:
        - stig_check
        - SV-270180r1045182_rule


    - name: 'SV-272488r1082178_rule | RHEL 9 must have the Postfix package installed.'
      shell:
        cmd: dnf list --installed postfix
      register: SV_272488r1082178_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-272488r1082178_rule

    - name: 'SV-272488r1082178_rule | Display check result'
      debug:
        var: SV_272488r1082178_rule_check.stdout
      tags:
        - stig_check
        - SV-272488r1082178_rule


    - name: 'SV-272496r1134956_rule | RHEL 9 must elevate the SELinux context when an administrator calls the sudo com'
      shell:
        cmd: grep -r sysadm_r /etc/sudoers /etc/sudoers.d
      register: SV_272496r1134956_rule_check
      changed_when: false
      failed_when: false
      tags:
        - validate_semi_automatable
        - stig_check
        - SV-272496r1134956_rule

    - name: 'SV-272496r1134956_rule | Display check result'
      debug:
        var: SV_272496r1134956_rule_check.stdout
      tags:
        - stig_check
        - SV-272496r1134956_rule

