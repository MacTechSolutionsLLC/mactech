# Generated hardening playbook for rhel9
# Total Controls: 447

- name: Apply RHEL9 STIG hardening
  hosts: all
  become: yes
  vars:
    # Place any tunable defaults here if needed later
  tasks:

    - name: 'SV-257777r991589_rule | RHEL 9 must be a vendor-supported release.'
      debug:
        msg: "Manual hardening required for SV-257777r991589_rule: RHEL 9 must be a vendor-supported release. - Upgrade to a supported version of RHEL 9. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257777r991589_rule
        - package_present
        - severity_high
        - semi_automatable


    - name: 'SV-257778r1134892_rule | RHEL 9 vendor packaged system security patches and updates must be installed and'
      debug:
        msg: "Manual hardening required for SV-257778r1134892_rule: RHEL 9 vendor packaged system security patches and updates must be installed and - Install RHEL 9 security patches and updates at the organizationally defined frequency. If system upd Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257778r1134892_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-257779r958390_rule | RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before '
      debug:
        msg: "Manual hardening required for SV-257779r958390_rule: RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before  - Configure RHEL 9 to display the Standard Mandatory DOD Notice and Consent Banner before granting acc Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257779r958390_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257781r991589_rule | The graphical display manager must not be the default target on RHEL 9 unless ap'
      debug:
        msg: "Manual hardening required for SV-257781r991589_rule: The graphical display manager must not be the default target on RHEL 9 unless ap - Document the requirement for a graphical user interface with the ISSO or set the default target to m Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257781r991589_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257782r991589_rule | RHEL 9 must enable the hardware random number generator entropy gatherer service'
      debug:
        msg: "Manual hardening required for SV-257782r991589_rule: RHEL 9 must enable the hardware random number generator entropy gatherer service - Install the rng-tools package with the following command:  $ sudo dnf install rng-tools  Then enable Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257782r991589_rule
        - file_permissions
        - severity_low
        - semi_automatable


    - name: 'SV-257783r991562_rule | RHEL 9 systemd-journald service must be enabled.'
      systemd:
        name: is
        enabled: yes
        state: started
      tags:
        - stig
        - SV-257783r991562_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257784r1044832_rule | The systemd Ctrl-Alt-Delete burst key sequence in RHEL 9 must be disabled.'
      debug:
        msg: "Manual hardening required for SV-257784r1044832_rule: The systemd Ctrl-Alt-Delete burst key sequence in RHEL 9 must be disabled. - Configure the system to disable the CtrlAltDelBurstAction by added or modifying the following line i Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257784r1044832_rule
        - service_disabled
        - severity_high
        - semi_automatable


    - name: 'SV-257785r1044833_rule | The x86 Ctrl-Alt-Delete key sequence must be disabled on RHEL 9.'
      debug:
        msg: "Manual hardening required for SV-257785r1044833_rule: The x86 Ctrl-Alt-Delete key sequence must be disabled on RHEL 9. - Configure RHEL 9 to disable the ctrl-alt-del.target with the following command:  $ sudo systemctl di Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257785r1044833_rule
        - service_disabled
        - severity_high
        - semi_automatable


    - name: 'SV-257786r1044834_rule | RHEL 9 debug-shell systemd service must be disabled.'
      systemd:
        name: with
        masked: yes
        state: stopped
      tags:
        - stig
        - SV-257786r1044834_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257787r1117265_rule | RHEL 9 must require a boot loader superuser password.'
      debug:
        msg: "Manual hardening required for SV-257787r1117265_rule: RHEL 9 must require a boot loader superuser password. - Configure RHEL 9 to require a grub bootloader password for the grub superuser account.  Generate an  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257787r1117265_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-257788r1044838_rule | RHEL 9 must disable the ability of systemd to spawn an interactive boot process.'
      debug:
        msg: "Manual hardening required for SV-257788r1044838_rule: RHEL 9 must disable the ability of systemd to spawn an interactive boot process. - Configure the current GRUB 2 configuration to disable the ability of systemd to spawn an interactive Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257788r1044838_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257789r1134895_rule | RHEL 9 must require a unique superusers name upon booting into single-user and m'
      file:
        path: /etc/grub.d/01_users
        state: file
      tags:
        - stig
        - SV-257789r1134895_rule
        - file_permissions
        - severity_high
        - semi_automatable


    - name: 'SV-257790r991589_rule | RHEL 9 /boot/grub2/grub.cfg file must be group-owned by root.'
      debug:
        msg: "Manual hardening required for SV-257790r991589_rule: RHEL 9 /boot/grub2/grub.cfg file must be group-owned by root. - Change the group of the file /boot/grub2/grub.cfg to root by running the following command:  $ sudo  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257790r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257791r991589_rule | RHEL 9 /boot/grub2/grub.cfg file must be owned by root.'
      debug:
        msg: "Manual hardening required for SV-257791r991589_rule: RHEL 9 /boot/grub2/grub.cfg file must be owned by root. - Change the owner of the file /boot/grub2/grub.cfg to root by running the following command:  $ sudo  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257791r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257792r1044842_rule | RHEL 9 must disable virtual system calls.'
      debug:
        msg: "Manual hardening required for SV-257792r1044842_rule: RHEL 9 must disable virtual system calls. - Document the use of virtual system calls with the ISSO as an operational requirement or disable them Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257792r1044842_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257793r1044843_rule | RHEL 9 must clear the page allocator to prevent use-after-free attacks.'
      debug:
        msg: "Manual hardening required for SV-257793r1044843_rule: RHEL 9 must clear the page allocator to prevent use-after-free attacks. - Configure RHEL 9 to enable page poisoning with the following commands:  $ sudo grubby --update-kerne Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257793r1044843_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257794r1069362_rule | RHEL 9 must clear memory when it is freed to prevent use-after-free attacks.'
      debug:
        msg: "Manual hardening required for SV-257794r1069362_rule: RHEL 9 must clear memory when it is freed to prevent use-after-free attacks. - Configure RHEL 9 to enable init_on_free with the following command: $ sudo grubby --update-kernel=AL Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257794r1069362_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257795r1044845_rule | RHEL 9 must enable mitigations against processor-based vulnerabilities.'
      debug:
        msg: "Manual hardening required for SV-257795r1044845_rule: RHEL 9 must enable mitigations against processor-based vulnerabilities. - Configure RHEL 9 to enable kernel page-table isolation with the following command:  $ sudo grubby -- Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257795r1044845_rule
        - service_enabled
        - severity_low
        - semi_automatable


    - name: 'SV-257796r1044847_rule | RHEL 9 must enable auditing of processes that start prior to the audit daemon.'
      debug:
        msg: "Manual hardening required for SV-257796r1044847_rule: RHEL 9 must enable auditing of processes that start prior to the audit daemon. - Enable auditing of processes that start prior to the audit daemon with the following command:  $ sud Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257796r1044847_rule
        - service_enabled
        - severity_low
        - semi_automatable


    - name: 'SV-257797r1117266_rule | RHEL 9 must restrict access to the kernel message buffer.'
      debug:
        msg: "Manual hardening required for SV-257797r1117266_rule: RHEL 9 must restrict access to the kernel message buffer. - Configure RHEL 9 to restrict access to the kernel message buffer.  Add or edit the following line in Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257797r1117266_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257798r1117266_rule | RHEL 9 must prevent kernel profiling by nonprivileged users.'
      debug:
        msg: "Manual hardening required for SV-257798r1117266_rule: RHEL 9 must prevent kernel profiling by nonprivileged users. - Configure RHEL 9 to prevent kernel profiling by nonprivileged users.  Add or edit the following line Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257798r1117266_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257799r1106273_rule | RHEL 9 must prevent the loading of a new kernel for later execution.'
      debug:
        msg: "Manual hardening required for SV-257799r1106273_rule: RHEL 9 must prevent the loading of a new kernel for later execution. - Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:  ke Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257799r1106273_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257800r1117266_rule | RHEL 9 must restrict exposed kernel pointer addresses access.'
      debug:
        msg: "Manual hardening required for SV-257800r1117266_rule: RHEL 9 must restrict exposed kernel pointer addresses access. - Configure RHEL 9 to restrict exposed kernel pointer addresses access by adding the following line to Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257800r1117266_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257801r1106279_rule | RHEL 9 must enable kernel parameters to enforce discretionary access control on '
      debug:
        msg: "Manual hardening required for SV-257801r1106279_rule: RHEL 9 must enable kernel parameters to enforce discretionary access control on  - Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:  fs Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257801r1106279_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257802r1106282_rule | RHEL 9 must enable kernel parameters to enforce discretionary access control on '
      debug:
        msg: "Manual hardening required for SV-257802r1106282_rule: RHEL 9 must enable kernel parameters to enforce discretionary access control on  - Configure RHEL 9 to enable DAC on symlinks.  Add or edit the following line in a system configuratio Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257802r1106282_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257803r1106429_rule | RHEL 9 must disable the kernel.core_pattern.'
      debug:
        msg: "Manual hardening required for SV-257803r1106429_rule: RHEL 9 must disable the kernel.core_pattern. - Configure RHEL 9 to disable storing core dumps.  Add or edit the following line in a system configur Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257803r1106429_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257804r1044853_rule | RHEL 9 must be configured to disable the Asynchronous Transfer Mode kernel modul'
      file:
        path: /etc/modprobe.d/atm.conf
        state: file
      tags:
        - stig
        - SV-257804r1044853_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257805r1044856_rule | RHEL 9 must be configured to disable the Controller Area Network kernel module.'
      debug:
        msg: "Manual hardening required for SV-257805r1044856_rule: RHEL 9 must be configured to disable the Controller Area Network kernel module. - To configure the system to prevent the can kernel module from being loaded, add the following lines  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257805r1044856_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257806r1044859_rule | RHEL 9 must be configured to disable the FireWire kernel module.'
      debug:
        msg: "Manual hardening required for SV-257806r1044859_rule: RHEL 9 must be configured to disable the FireWire kernel module. - To configure the system to prevent the firewire-core kernel module from being loaded, add the follow Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257806r1044859_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257807r1044862_rule | RHEL 9 must disable the Stream Control Transmission Protocol (SCTP) kernel modul'
      debug:
        msg: "Manual hardening required for SV-257807r1044862_rule: RHEL 9 must disable the Stream Control Transmission Protocol (SCTP) kernel modul - To configure the system to prevent the sctp kernel module from being loaded, add the following lines Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257807r1044862_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257808r1044865_rule | RHEL 9 must disable the Transparent Inter Process Communication (TIPC) kernel mo'
      debug:
        msg: "Manual hardening required for SV-257808r1044865_rule: RHEL 9 must disable the Transparent Inter Process Communication (TIPC) kernel mo - To configure the system to prevent the tipc kernel module from being loaded, add the following lines Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257808r1044865_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257809r1106288_rule | RHEL 9 must implement address space layout randomization (ASLR) to protect its m'
      debug:
        msg: "Manual hardening required for SV-257809r1106288_rule: RHEL 9 must implement address space layout randomization (ASLR) to protect its m - Configure RHEL 9 to implement virtual address space randomization.  Add or edit the following line i Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257809r1106288_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257810r1117266_rule | RHEL 9 must disable access to network bpf system call from nonprivileged process'
      debug:
        msg: "Manual hardening required for SV-257810r1117266_rule: RHEL 9 must disable access to network bpf system call from nonprivileged process - Configure RHEL 9 to prevent privilege escalation through the kernel by disabling access to the bpf s Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257810r1117266_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257811r1117266_rule | RHEL 9 must restrict usage of ptrace to descendant processes.'
      debug:
        msg: "Manual hardening required for SV-257811r1117266_rule: RHEL 9 must restrict usage of ptrace to descendant processes. - Configure RHEL 9 to restrict usage of ptrace to descendant processes by adding the following line to Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257811r1117266_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257812r1134897_rule | RHEL 9 must disable core dump backtraces.'
      debug:
        msg: "Manual hardening required for SV-257812r1134897_rule: RHEL 9 must disable core dump backtraces. - Configure the operating system to disable core dump backtraces.  Add or modify the following line in Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257812r1134897_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257813r1134899_rule | RHEL 9 must disable storing core dumps.'
      debug:
        msg: "Manual hardening required for SV-257813r1134899_rule: RHEL 9 must disable storing core dumps. - Configure the operating system to disable storing core dumps for all users.  Add or modify the follo Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257813r1134899_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257814r1134901_rule | RHEL 9 must disable core dumps for all users.'
      debug:
        msg: "Manual hardening required for SV-257814r1134901_rule: RHEL 9 must disable core dumps for all users. - Configure the operating system to disable core dumps for all users.  Add the following line to the t Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257814r1134901_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257815r1134903_rule | RHEL 9 must disable acquiring, saving, and processing core dumps.'
      debug:
        msg: "Manual hardening required for SV-257815r1134903_rule: RHEL 9 must disable acquiring, saving, and processing core dumps. - Configure the system to disable the systemd-coredump.socket with the following command:  $ sudo syst Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257815r1134903_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257816r1106435_rule | RHEL 9 must disable the use of user namespaces.'
      debug:
        msg: "Manual hardening required for SV-257816r1106435_rule: RHEL 9 must disable the use of user namespaces. - Configure RHEL 9 to disable the use of user namespaces by adding the following line to a file in the Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257816r1106435_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257817r1069383_rule | RHEL 9 must implement nonexecutable data to protect its memory from unauthorized'
      debug:
        msg: "Manual hardening required for SV-257817r1069383_rule: RHEL 9 must implement nonexecutable data to protect its memory from unauthorized - If /proc/cpuinfo shows that one or more processors do not enable ExecShield (lack the "nx" feature f Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257817r1069383_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257818r1044876_rule | The kdump service on RHEL 9 must be disabled.'
      systemd:
        name: on
        masked: yes
        state: stopped
      tags:
        - stig
        - SV-257818r1044876_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257819r1015075_rule | RHEL 9 must ensure cryptographic verification of vendor software packages.'
      debug:
        msg: "Manual hardening required for SV-257819r1015075_rule: RHEL 9 must ensure cryptographic verification of vendor software packages. - Install Red Hat package-signing keys on the system and verify their fingerprints match vendor values Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257819r1015075_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-257820r1044878_rule | RHEL 9 must check the GPG signature of software packages originating from extern'
      debug:
        msg: "Manual hardening required for SV-257820r1044878_rule: RHEL 9 must check the GPG signature of software packages originating from extern - Configure dnf to always check the GPG signature of software packages originating from external softw Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257820r1044878_rule
        - package_present
        - severity_high
        - semi_automatable


    - name: 'SV-257821r1015077_rule | RHEL 9 must check the GPG signature of locally installed software packages befor'
      debug:
        msg: "Manual hardening required for SV-257821r1015077_rule: RHEL 9 must check the GPG signature of locally installed software packages befor - Configure dnf to always check the GPG signature of local software packages before installation.  Add Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257821r1015077_rule
        - package_present
        - severity_high
        - semi_automatable


    - name: 'SV-257822r1044880_rule | RHEL 9 must have GPG signature verification enabled for all software repositorie'
      debug:
        msg: "Manual hardening required for SV-257822r1044880_rule: RHEL 9 must have GPG signature verification enabled for all software repositorie - Configure all software repositories defined in "/etc/yum.repos.d/" to have "gpgcheck" enabled:  $ su Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257822r1044880_rule
        - service_enabled
        - severity_high
        - semi_automatable


    - name: 'SV-257823r1051231_rule | RHEL 9 must be configured so that the cryptographic hashes of system files match'
      debug:
        msg: "Manual hardening required for SV-257823r1051231_rule: RHEL 9 must be configured so that the cryptographic hashes of system files match - Configure RHEL 9 so that the cryptographic hashes of system files match vendor values.  Given output Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257823r1051231_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-257824r1044886_rule | RHEL 9 must remove all software components after updated versions have been inst'
      debug:
        msg: "Manual hardening required for SV-257824r1044886_rule: RHEL 9 must remove all software components after updated versions have been inst - Configure RHEL 9 to remove all software components after updated versions have been installed.  Edit Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257824r1044886_rule
        - package_absent
        - severity_low
        - semi_automatable


    - name: 'SV-257825r1044888_rule | RHEL 9 subscription-manager package must be installed.'
      package:
        name: subscription-manager
        state: present
      tags:
        - stig
        - SV-257825r1044888_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-257826r1106299_rule | RHEL 9 must not have a File Transfer Protocol (FTP) server package installed.'
      package:
        name: vsftpd
        state: absent
      tags:
        - stig
        - SV-257826r1106299_rule
        - package_absent
        - severity_high
        - semi_automatable


    - name: 'SV-257827r1044892_rule | RHEL 9 must not have the sendmail package installed.'
      package:
        name: sendmail
        state: absent
      tags:
        - stig
        - SV-257827r1044892_rule
        - package_absent
        - severity_medium
        - semi_automatable


    - name: 'SV-257828r1044894_rule | RHEL 9 must not have the nfs-utils package installed.'
      package:
        name: nfs-utils
        state: absent
      tags:
        - stig
        - SV-257828r1044894_rule
        - package_absent
        - severity_medium
        - semi_automatable


    - name: 'SV-257829r1044896_rule | RHEL 9 must not have the ypserv package installed.'
      package:
        name: ypserv
        state: absent
      tags:
        - stig
        - SV-257829r1044896_rule
        - package_absent
        - severity_medium
        - semi_automatable


    - name: 'SV-257830r1134906_rule | RHEL 9 must not install packages from the Extra Packages for Enterprise Linux (E'
      debug:
        msg: "Manual hardening required for SV-257830r1134906_rule: RHEL 9 must not install packages from the Extra Packages for Enterprise Linux (E - The repo package can be manually removed with the following command:  $ sudo dnf remove epel-release Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257830r1134906_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257831r1044898_rule | RHEL 9 must not have the telnet-server package installed.'
      package:
        name: telnet-server
        state: absent
      tags:
        - stig
        - SV-257831r1044898_rule
        - package_absent
        - severity_medium
        - semi_automatable


    - name: 'SV-257832r1044900_rule | RHEL 9 must not have the gssproxy package installed.'
      package:
        name: gssproxy
        state: absent
      tags:
        - stig
        - SV-257832r1044900_rule
        - package_absent
        - severity_medium
        - semi_automatable


    - name: 'SV-257833r1044902_rule | RHEL 9 must not have the iprutils package installed.'
      package:
        name: iprutils
        state: absent
      tags:
        - stig
        - SV-257833r1044902_rule
        - package_absent
        - severity_medium
        - semi_automatable


    - name: 'SV-257834r1044904_rule | RHEL 9 must not have the tuned package installed.'
      package:
        name: tuned
        state: absent
      tags:
        - stig
        - SV-257834r1044904_rule
        - package_absent
        - severity_medium
        - semi_automatable


    - name: 'SV-257835r1102037_rule | RHEL 9 must not have a Trivial File Transfer Protocol (TFTP) server package inst'
      package:
        name: tftp-server
        state: absent
      tags:
        - stig
        - SV-257835r1102037_rule
        - package_absent
        - severity_high
        - semi_automatable


    - name: 'SV-257836r1044908_rule | RHEL 9 must not have the quagga package installed.'
      package:
        name: quagga
        state: absent
      tags:
        - stig
        - SV-257836r1044908_rule
        - package_absent
        - severity_medium
        - semi_automatable


    - name: 'SV-257837r1044910_rule | A graphical display manager must not be installed on RHEL 9 unless approved.'
      debug:
        msg: "Manual hardening required for SV-257837r1044910_rule: A graphical display manager must not be installed on RHEL 9 unless approved. - Document the requirement for a graphical user interface with the ISSO or remove all xorg packages wi Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257837r1044910_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257838r1044912_rule | RHEL 9 must have the openssl-pkcs11 package installed.'
      package:
        name: openssl-pkcs11
        state: present
      tags:
        - stig
        - SV-257838r1044912_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-257839r991589_rule | RHEL 9 must have the gnutls-utils package installed.'
      package:
        name: gnutls-utils
        state: present
      tags:
        - stig
        - SV-257839r991589_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-257840r991589_rule | RHEL 9 must have the nss-tools package installed.'
      package:
        name: nss-tools
        state: present
      tags:
        - stig
        - SV-257840r991589_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-257841r1044914_rule | RHEL 9 must have the rng-tools package installed.'
      package:
        name: rng-tools
        state: present
      tags:
        - stig
        - SV-257841r1044914_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-257842r1044916_rule | RHEL 9 must have the s-nail package installed.'
      package:
        name: s-nail
        state: present
      tags:
        - stig
        - SV-257842r1044916_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-257843r991589_rule | A separate RHEL 9 file system must be used for user home directories (such as /h'
      debug:
        msg: "Manual hardening required for SV-257843r991589_rule: A separate RHEL 9 file system must be used for user home directories (such as /h - Migrate the "/home" directory onto a separate file system/partition. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257843r991589_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257844r1044918_rule | RHEL 9 must use a separate file system for /tmp.'
      debug:
        msg: "Manual hardening required for SV-257844r1044918_rule: RHEL 9 must use a separate file system for /tmp. - Migrate the "/tmp" path onto a separate file system. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257844r1044918_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257845r1044920_rule | RHEL 9 must use a separate file system for /var.'
      debug:
        msg: "Manual hardening required for SV-257845r1044920_rule: RHEL 9 must use a separate file system for /var. - Migrate the "/var" path onto a separate file system. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257845r1044920_rule
        - mount_option
        - severity_low
        - semi_automatable


    - name: 'SV-257846r1044922_rule | RHEL 9 must use a separate file system for /var/log.'
      debug:
        msg: "Manual hardening required for SV-257846r1044922_rule: RHEL 9 must use a separate file system for /var/log. - Migrate the "/var/log" path onto a separate file system. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257846r1044922_rule
        - mount_option
        - severity_low
        - semi_automatable


    - name: 'SV-257847r1044924_rule | RHEL 9 must use a separate file system for the system audit data path.'
      debug:
        msg: "Manual hardening required for SV-257847r1044924_rule: RHEL 9 must use a separate file system for the system audit data path. - Migrate the system audit data path onto a separate file system. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257847r1044924_rule
        - mount_option
        - severity_low
        - semi_automatable


    - name: 'SV-257848r1044926_rule | RHEL 9 must use a separate file system for /var/tmp.'
      debug:
        msg: "Manual hardening required for SV-257848r1044926_rule: RHEL 9 must use a separate file system for /var/tmp. - Migrate the "/var/tmp" path onto a separate file system. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257848r1044926_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257849r1044928_rule | RHEL 9 file system automount function must be disabled unless required.'
      systemd:
        name: can
        masked: yes
        state: stopped
      tags:
        - stig
        - SV-257849r1044928_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257850r1044930_rule | RHEL 9 must prevent device files from being interpreted on file systems that con'
      debug:
        msg: "Manual hardening required for SV-257850r1044930_rule: RHEL 9 must prevent device files from being interpreted on file systems that con - Modify "/etc/fstab" to use the "nodev" option on the "/home" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257850r1044930_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257851r1044932_rule | RHEL 9 must prevent files with the setuid and setgid bit set from being executed'
      debug:
        msg: "Manual hardening required for SV-257851r1044932_rule: RHEL 9 must prevent files with the setuid and setgid bit set from being executed - Modify "/etc/fstab" to use the "nosuid" option on the "/home" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257851r1044932_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257852r991589_rule | RHEL 9 must prevent code from being executed on file systems that contain user h'
      debug:
        msg: "Manual hardening required for SV-257852r991589_rule: RHEL 9 must prevent code from being executed on file systems that contain user h - Modify "/etc/fstab" to use the "noexec" option on the "/home" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257852r991589_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257854r1044934_rule | RHEL 9 must prevent special devices on file systems that are imported via Networ'
      debug:
        msg: "Manual hardening required for SV-257854r1044934_rule: RHEL 9 must prevent special devices on file systems that are imported via Networ - Update each NFS mounted file system to use the "nodev" option on file systems that are being importe Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257854r1044934_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257855r1044936_rule | RHEL 9  must prevent code from being executed on file systems that are imported '
      debug:
        msg: "Manual hardening required for SV-257855r1044936_rule: RHEL 9  must prevent code from being executed on file systems that are imported  - Update each NFS mounted file system to use the "noexec" option on file systems that are being import Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257855r1044936_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257856r1044938_rule | RHEL 9 must prevent files with the setuid and setgid bit set from being executed'
      debug:
        msg: "Manual hardening required for SV-257856r1044938_rule: RHEL 9 must prevent files with the setuid and setgid bit set from being executed - Update each NFS mounted file system to use the "nosuid" option on file systems that are being import Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257856r1044938_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257857r991589_rule | RHEL 9 must prevent code from being executed on file systems that are used with '
      file:
        path: /etc/fstab
        state: file
      tags:
        - stig
        - SV-257857r991589_rule
        - file_owner
        - severity_medium
        - manual


    - name: 'SV-257858r991589_rule | RHEL 9 must prevent special devices on file systems that are used with removable'
      file:
        path: /etc/fstab
        state: file
      tags:
        - stig
        - SV-257858r991589_rule
        - file_owner
        - severity_medium
        - manual


    - name: 'SV-257859r991589_rule | RHEL 9 must prevent files with the setuid and setgid bit set from being executed'
      file:
        path: /etc/fstab
        state: file
      tags:
        - stig
        - SV-257859r991589_rule
        - file_owner
        - severity_medium
        - manual


    - name: 'SV-257860r1044940_rule | RHEL 9 must mount /boot with the nodev option.'
      debug:
        msg: "Manual hardening required for SV-257860r1044940_rule: RHEL 9 must mount /boot with the nodev option. - Modify "/etc/fstab" to use the "nodev" option on the "/boot" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257860r1044940_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257861r1044941_rule | RHEL 9 must prevent files with the setuid and setgid bit set from being executed'
      debug:
        msg: "Manual hardening required for SV-257861r1044941_rule: RHEL 9 must prevent files with the setuid and setgid bit set from being executed - Modify "/etc/fstab" to use the "nosuid" option on the "/boot" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257861r1044941_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257862r1134908_rule | RHEL 9 must prevent files with the setuid and setgid bit set from being executed'
      debug:
        msg: "Manual hardening required for SV-257862r1134908_rule: RHEL 9 must prevent files with the setuid and setgid bit set from being executed - Modify "/etc/fstab" to use the "nosuid" option on the "/boot/efi" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257862r1134908_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257863r958804_rule | RHEL 9 must mount /dev/shm with the nodev option.'
      debug:
        msg: "Manual hardening required for SV-257863r958804_rule: RHEL 9 must mount /dev/shm with the nodev option. - Modify "/etc/fstab" to use the "nodev" option on the "/dev/shm" file system. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257863r958804_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257864r1106304_rule | RHEL 9 must mount /dev/shm with the noexec option.'
      systemd:
        name: tmp.mount
        masked: yes
        state: stopped
      tags:
        - stig
        - SV-257864r1106304_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257865r1044946_rule | RHEL 9 must mount /dev/shm with the nosuid option.'
      debug:
        msg: "Manual hardening required for SV-257865r1044946_rule: RHEL 9 must mount /dev/shm with the nosuid option. - Modify "/etc/fstab" to use the "nosuid" option on the "/dev/shm" file system. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257865r1044946_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257866r958804_rule | RHEL 9 must mount /tmp with the nodev option.'
      debug:
        msg: "Manual hardening required for SV-257866r958804_rule: RHEL 9 must mount /tmp with the nodev option. - Modify "/etc/fstab" to use the "nodev" option on the "/tmp" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257866r958804_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257867r958804_rule | RHEL 9 must mount /tmp with the noexec option.'
      debug:
        msg: "Manual hardening required for SV-257867r958804_rule: RHEL 9 must mount /tmp with the noexec option. - Modify "/etc/fstab" to use the "noexec" option on the "/tmp" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257867r958804_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257868r958804_rule | RHEL 9 must mount /tmp with the nosuid option.'
      debug:
        msg: "Manual hardening required for SV-257868r958804_rule: RHEL 9 must mount /tmp with the nosuid option. - Modify "/etc/fstab" to use the "nosuid" option on the "/tmp" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257868r958804_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257869r1102009_rule | RHEL 9 must mount /var with the nodev option.'
      debug:
        msg: "Manual hardening required for SV-257869r1102009_rule: RHEL 9 must mount /var with the nodev option. - Modify "/etc/fstab" to use the "nodev" option on the "/var" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257869r1102009_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257870r958804_rule | RHEL 9 must mount /var/log with the nodev option.'
      debug:
        msg: "Manual hardening required for SV-257870r958804_rule: RHEL 9 must mount /var/log with the nodev option. - Modify "/etc/fstab" to use the "nodev" option on the "/var/log" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257870r958804_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257871r958804_rule | RHEL 9 must mount /var/log with the noexec option.'
      debug:
        msg: "Manual hardening required for SV-257871r958804_rule: RHEL 9 must mount /var/log with the noexec option. - Modify "/etc/fstab" to use the "noexec" option on the "/var/log" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257871r958804_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257872r958804_rule | RHEL 9 must mount /var/log with the nosuid option.'
      debug:
        msg: "Manual hardening required for SV-257872r958804_rule: RHEL 9 must mount /var/log with the nosuid option. - Modify "/etc/fstab" to use the "nosuid" option on the "/var/log" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257872r958804_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257873r958804_rule | RHEL 9 must mount /var/log/audit with the nodev option.'
      debug:
        msg: "Manual hardening required for SV-257873r958804_rule: RHEL 9 must mount /var/log/audit with the nodev option. - Modify "/etc/fstab" to use the "nodev" option on the "/var/log/audit" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257873r958804_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257874r958804_rule | RHEL 9 must mount /var/log/audit with the noexec option.'
      debug:
        msg: "Manual hardening required for SV-257874r958804_rule: RHEL 9 must mount /var/log/audit with the noexec option. - Modify "/etc/fstab" to use the "noexec" option on the "/var/log/audit" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257874r958804_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257875r958804_rule | RHEL 9 must mount /var/log/audit with the nosuid option.'
      debug:
        msg: "Manual hardening required for SV-257875r958804_rule: RHEL 9 must mount /var/log/audit with the nosuid option. - Modify "/etc/fstab" to use the "nosuid" option on the "/var/log/audit" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257875r958804_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257876r958804_rule | RHEL 9 must mount /var/tmp with the nodev option.'
      debug:
        msg: "Manual hardening required for SV-257876r958804_rule: RHEL 9 must mount /var/tmp with the nodev option. - Modify "/etc/fstab" to use the "nodev" option on the "/var/tmp" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257876r958804_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257877r958804_rule | RHEL 9 must mount /var/tmp with the noexec option.'
      debug:
        msg: "Manual hardening required for SV-257877r958804_rule: RHEL 9 must mount /var/tmp with the noexec option. - Modify "/etc/fstab" to use the "noexec" option on the "/var/tmp" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257877r958804_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257878r958804_rule | RHEL 9 must mount /var/tmp with the nosuid option.'
      debug:
        msg: "Manual hardening required for SV-257878r958804_rule: RHEL 9 must mount /var/tmp with the nosuid option. - Modify "/etc/fstab" to use the "nosuid" option on the "/var/tmp" directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257878r958804_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257879r1045454_rule | RHEL 9 local disk partitions must implement cryptographic mechanisms to prevent '
      debug:
        msg: "Manual hardening required for SV-257879r1045454_rule: RHEL 9 local disk partitions must implement cryptographic mechanisms to prevent  - Configure RHEL 9 to prevent unauthorized modification of all information at rest by using disk encry Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257879r1045454_rule
        - file_permissions
        - severity_high
        - semi_automatable


    - name: 'SV-257880r1044951_rule | RHEL 9 must disable mounting of cramfs.'
      debug:
        msg: "Manual hardening required for SV-257880r1044951_rule: RHEL 9 must disable mounting of cramfs. - To configure the system to prevent the cramfs kernel module from being loaded, add the following lin Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257880r1044951_rule
        - service_disabled
        - severity_low
        - semi_automatable


    - name: 'SV-257881r991589_rule | RHEL 9 must prevent special devices on non-root local partitions.'
      debug:
        msg: "Manual hardening required for SV-257881r991589_rule: RHEL 9 must prevent special devices on non-root local partitions. - Configure the "/etc/fstab" to use the "nodev" option on all non-root local partitions. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257881r991589_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-257882r991560_rule | RHEL 9 system commands must have mode 755 or less permissive.'
      debug:
        msg: "Manual hardening required for SV-257882r991560_rule: RHEL 9 system commands must have mode 755 or less permissive. - Configure the system commands to be protected from unauthorized access.  Run the following command,  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257882r991560_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257883r991560_rule | RHEL 9 library directories must have mode 755 or less permissive.'
      file:
        path: /usr/lib
        mode: '755'
        state: file
      tags:
        - stig
        - SV-257883r991560_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257884r1106306_rule | RHEL 9 library files must have mode 755 or less permissive.'
      file:
        path: /usr/lib
        mode: '0755'
        state: file
      tags:
        - stig
        - SV-257884r1106306_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257885r1044953_rule | RHEL 9 /var/log directory must have mode 0755 or less permissive.'
      file:
        path: /var/log
        mode: '0755'
        state: file
      tags:
        - stig
        - SV-257885r1044953_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257886r1044955_rule | RHEL 9 /var/log/messages file must have mode 0640 or less permissive.'
      file:
        path: /var/log/messages
        mode: '0640'
        state: file
      tags:
        - stig
        - SV-257886r1044955_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257887r991557_rule | RHEL 9 audit tools must have a mode of 0755 or less permissive.'
      debug:
        msg: "Manual hardening required for SV-257887r991557_rule: RHEL 9 audit tools must have a mode of 0755 or less permissive. - Configure the audit tools to have a mode of "0755" by running the following command:  $ sudo chmod 0 Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257887r991557_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257888r1134910_rule | RHEL 9 permissions of cron configuration files and directories must not be modif'
      debug:
        msg: "Manual hardening required for SV-257888r1134910_rule: RHEL 9 permissions of cron configuration files and directories must not be modif - Run the following commands to restore the permissions of cron configuration files and directories to Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257888r1134910_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257889r1044959_rule | All RHEL 9 local initialization files must have mode 0740 or less permissive.'
      file:
        path: /home/wadea
        mode: '0740'
        state: file
      tags:
        - stig
        - SV-257889r1044959_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257890r1044961_rule | All RHEL 9 local interactive user home directories must have mode 0750 or less p'
      file:
        path: /home/wadea
        mode: '0750'
        state: file
      tags:
        - stig
        - SV-257890r1044961_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257891r991589_rule | RHEL 9 /etc/group file must have mode 0644 or less permissive to prevent unautho'
      file:
        path: /etc/group
        mode: '0644'
        state: file
      tags:
        - stig
        - SV-257891r991589_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257892r991589_rule | RHEL 9 /etc/group- file must have mode 0644 or less permissive to prevent unauth'
      file:
        path: /etc/group-
        mode: '0644'
        state: file
      tags:
        - stig
        - SV-257892r991589_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257893r991589_rule | RHEL 9 /etc/gshadow file must have mode 0000 or less permissive to prevent unaut'
      file:
        path: /etc/gshadow
        mode: '0000'
        state: file
      tags:
        - stig
        - SV-257893r991589_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257894r991589_rule | RHEL 9 /etc/gshadow- file must have mode 0000 or less permissive to prevent unau'
      file:
        path: /etc/gshadow-
        mode: '0000'
        state: file
      tags:
        - stig
        - SV-257894r991589_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257895r991589_rule | RHEL 9 /etc/passwd file must have mode 0644 or less permissive to prevent unauth'
      file:
        path: /etc/passwd
        mode: '0644'
        state: file
      tags:
        - stig
        - SV-257895r991589_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257896r991589_rule | RHEL 9 /etc/passwd- file must have mode 0644 or less permissive to prevent unaut'
      file:
        path: /etc/passwd-
        mode: '0644'
        state: file
      tags:
        - stig
        - SV-257896r991589_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257897r991589_rule | RHEL 9 /etc/shadow- file must have mode 0000 or less permissive to prevent unaut'
      file:
        path: /etc/shadow-
        mode: '0000'
        state: file
      tags:
        - stig
        - SV-257897r991589_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257898r991589_rule | RHEL 9 /etc/group file must be owned by root.'
      file:
        path: /etc/group
        owner: root
        group: to
        state: file
      tags:
        - stig
        - SV-257898r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257899r991589_rule | RHEL 9 /etc/group file must be group-owned by root.'
      file:
        path: /etc/group
        group: of
        state: file
      tags:
        - stig
        - SV-257899r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257900r991589_rule | RHEL 9 /etc/group- file must be owned by root.'
      file:
        path: /etc/group-
        owner: root
        state: file
      tags:
        - stig
        - SV-257900r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257901r991589_rule | RHEL 9 /etc/group- file must be group-owned by root.'
      file:
        path: /etc/group-
        group: of
        state: file
      tags:
        - stig
        - SV-257901r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257902r991589_rule | RHEL 9 /etc/gshadow file must be owned by root.'
      file:
        path: /etc/gshadow
        owner: root
        state: file
      tags:
        - stig
        - SV-257902r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257903r991589_rule | RHEL 9 /etc/gshadow file must be group-owned by root.'
      file:
        path: /etc/gshadow
        group: of
        state: file
      tags:
        - stig
        - SV-257903r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257904r991589_rule | RHEL 9 /etc/gshadow- file must be owned by root.'
      file:
        path: /etc/gshadow-
        owner: root
        state: file
      tags:
        - stig
        - SV-257904r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257905r991589_rule | RHEL 9 /etc/gshadow- file must be group-owned by root.'
      file:
        path: /etc/gshadow-
        group: of
        state: file
      tags:
        - stig
        - SV-257905r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257906r991589_rule | RHEL 9 /etc/passwd file must be owned by root.'
      file:
        path: /etc/passwd
        owner: root
        state: file
      tags:
        - stig
        - SV-257906r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257907r991589_rule | RHEL 9 /etc/passwd file must be group-owned by root.'
      file:
        path: /etc/passwd
        group: of
        state: file
      tags:
        - stig
        - SV-257907r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257908r991589_rule | RHEL 9 /etc/passwd- file must be owned by root.'
      file:
        path: /etc/passwd-
        owner: root
        state: file
      tags:
        - stig
        - SV-257908r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257909r991589_rule | RHEL 9 /etc/passwd- file must be group-owned by root.'
      file:
        path: /etc/passwd-
        group: of
        state: file
      tags:
        - stig
        - SV-257909r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257910r991589_rule | RHEL 9 /etc/shadow file must be owned by root.'
      file:
        path: /etc/shadow
        owner: root
        state: file
      tags:
        - stig
        - SV-257910r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257911r991589_rule | RHEL 9 /etc/shadow file must be group-owned by root.'
      file:
        path: /etc/shadow
        group: of
        state: file
      tags:
        - stig
        - SV-257911r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257912r991589_rule | RHEL 9 /etc/shadow- file must be owned by root.'
      file:
        path: /etc/shadow-
        owner: root
        state: file
      tags:
        - stig
        - SV-257912r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257913r991589_rule | RHEL 9 /etc/shadow- file must be group-owned by root.'
      file:
        path: /etc/shadow-
        group: of
        state: file
      tags:
        - stig
        - SV-257913r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257914r1044969_rule | RHEL 9 /var/log directory must be owned by root.'
      file:
        path: /var/log
        owner: root
        state: file
      tags:
        - stig
        - SV-257914r1044969_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257915r1044971_rule | RHEL 9 /var/log directory must be group-owned by root.'
      file:
        path: /var/log
        owner: of
        group: owner
        state: file
      tags:
        - stig
        - SV-257915r1044971_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257916r1101916_rule | RHEL 9 /var/log/messages file must be owned by root.'
      file:
        path: /var/log/messages
        owner: root
        state: file
      tags:
        - stig
        - SV-257916r1101916_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257917r1101914_rule | RHEL 9 /var/log/messages file must be group-owned by root.'
      file:
        path: /var/log/messages
        owner: of
        group: owner
        state: file
      tags:
        - stig
        - SV-257917r1101914_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257918r1044977_rule | RHEL 9 system commands must be owned by root.'
      debug:
        msg: "Manual hardening required for SV-257918r1044977_rule: RHEL 9 system commands must be owned by root. - Configure the system commands to be protected from unauthorized access.  Run the following command,  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257918r1044977_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257919r1044979_rule | RHEL 9 system commands must be group-owned by root or a system account.'
      debug:
        msg: "Manual hardening required for SV-257919r1044979_rule: RHEL 9 system commands must be group-owned by root or a system account. - Configure the system commands to be protected from unauthorized access.  Run the following command,  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257919r1044979_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257920r1101926_rule | RHEL 9 library files must be owned by root.'
      file:
        path: /usr/lib
        owner: root
        state: file
      tags:
        - stig
        - SV-257920r1101926_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257921r1106308_rule | RHEL 9 library files must be group-owned by root or a system account.'
      file:
        path: /usr/lib
        group: owned
        state: file
      tags:
        - stig
        - SV-257921r1106308_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257922r1044988_rule | RHEL 9 library directories must be owned by root.'
      file:
        path: /usr/lib
        owner: root
        state: file
      tags:
        - stig
        - SV-257922r1044988_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257923r1044991_rule | RHEL 9 library directories must be group-owned by root or a system account.'
      file:
        path: /usr/lib
        state: file
      tags:
        - stig
        - SV-257923r1044991_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257924r991557_rule | RHEL 9 audit tools must be owned by root.'
      debug:
        msg: "Manual hardening required for SV-257924r991557_rule: RHEL 9 audit tools must be owned by root. - Configure the audit tools to be owned by "root" by running the following command:  $ sudo chown root Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257924r991557_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257925r991557_rule | RHEL 9 audit tools must be group-owned by root.'
      debug:
        msg: "Manual hardening required for SV-257925r991557_rule: RHEL 9 audit tools must be group-owned by root. - Configure the audit tools to be group-owned by "root" by running the following command:  $ sudo chgr Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257925r991557_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257926r991589_rule | RHEL 9 cron configuration files directory must be owned by root.'
      debug:
        msg: "Manual hardening required for SV-257926r991589_rule: RHEL 9 cron configuration files directory must be owned by root. - Configure any cron configuration not owned by root with the following command:  $ sudo chown root [c Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257926r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257927r991589_rule | RHEL 9 cron configuration files directory must be group-owned by root.'
      debug:
        msg: "Manual hardening required for SV-257927r991589_rule: RHEL 9 cron configuration files directory must be group-owned by root. - Configure any cron configuration not group-owned by root with the following command:  $ sudo chgrp r Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257927r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257928r1044992_rule | All RHEL 9 world-writable directories must be owned by root, sys, bin, or an app'
      debug:
        msg: "Manual hardening required for SV-257928r1044992_rule: All RHEL 9 world-writable directories must be owned by root, sys, bin, or an app - Configure all public directories to be owned by root or a system account to prevent unauthorized and Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257928r1044992_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257929r1117267_rule | A sticky bit must be set on all RHEL 9 public directories.'
      debug:
        msg: "Manual hardening required for SV-257929r1117267_rule: A sticky bit must be set on all RHEL 9 public directories. - Configure all world-writable directories to have the sticky bit set to prevent unauthorized and unin Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257929r1117267_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257930r991589_rule | All RHEL 9 local files and directories must have a valid group owner.'
      debug:
        msg: "Manual hardening required for SV-257930r991589_rule: All RHEL 9 local files and directories must have a valid group owner. - Either remove all files and directories from RHEL 9 that do not have a valid group, or assign a vali Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257930r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257931r991589_rule | All RHEL 9 local files and directories must have a valid owner.'
      debug:
        msg: "Manual hardening required for SV-257931r991589_rule: All RHEL 9 local files and directories must have a valid owner. - Either remove all files and directories from the system that do not have a valid user, or assign a v Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257931r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257932r1014838_rule | RHEL 9 must be configured so that all system device files are correctly labeled '
      debug:
        msg: "Manual hardening required for SV-257932r1014838_rule: RHEL 9 must be configured so that all system device files are correctly labeled  - Restore the SELinux policy for the affected device file from the system policy database using the fo Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257932r1014838_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-257934r991589_rule | RHEL 9 /etc/shadow file must have mode 0000 to prevent unauthorized access.'
      file:
        path: /etc/shadow
        mode: '0000'
        state: file
      tags:
        - stig
        - SV-257934r991589_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257935r1044994_rule | RHEL 9 must have the firewalld package installed.'
      package:
        name: firewalld
        state: present
      tags:
        - stig
        - SV-257935r1044994_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-257936r1044995_rule | The firewalld service on RHEL 9 must be active.'
      systemd:
        name: run
        enabled: yes
        state: started
      tags:
        - stig
        - SV-257936r1044995_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257937r1106310_rule | The RHEL 9 firewall must employ a deny-all, allow-by-exception policy for allowi'
      debug:
        msg: "Manual hardening required for SV-257937r1106310_rule: The RHEL 9 firewall must employ a deny-all, allow-by-exception policy for allowi - Configure the "firewalld" daemon to employ a deny-all, allow-by-exception policy with the following  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257937r1106310_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257939r1044997_rule | RHEL 9 must protect against or limit the effects of denial-of-service (DoS) atta'
      debug:
        msg: "Manual hardening required for SV-257939r1044997_rule: RHEL 9 must protect against or limit the effects of denial-of-service (DoS) atta - Configure "nftables" to be the default "firewallbackend" for "firewalld" by adding or editing the fo Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257939r1044997_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257940r1106312_rule | RHEL 9 must be configured to prohibit or restrict the use of functions, ports, p'
      systemd:
        name: Assessment
        enabled: yes
        state: started
      tags:
        - stig
        - SV-257940r1106312_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257941r991589_rule | RHEL 9 network interfaces must not be in promiscuous mode.'
      debug:
        msg: "Manual hardening required for SV-257941r991589_rule: RHEL 9 network interfaces must not be in promiscuous mode. - Configure network interfaces to turn off promiscuous mode unless approved by the ISSO and documented Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257941r991589_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257942r1106314_rule | RHEL 9 must enable hardening for the Berkeley Packet Filter just-in-time compile'
      debug:
        msg: "Manual hardening required for SV-257942r1106314_rule: RHEL 9 must enable hardening for the Berkeley Packet Filter just-in-time compile - Configure RHEL 9 to enable hardening for the BPF JIT compiler by adding the following line to a file Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257942r1106314_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257943r1045001_rule | RHEL 9 must have the chrony package installed.'
      package:
        name: chrony
        state: present
      tags:
        - stig
        - SV-257943r1045001_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-257944r1038944_rule | RHEL 9 chronyd service must be enabled.'
      systemd:
        name: run
        enabled: yes
        state: started
      tags:
        - stig
        - SV-257944r1038944_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257945r1038944_rule | RHEL 9 must securely compare internal information system clocks at least every 2'
      debug:
        msg: "Manual hardening required for SV-257945r1038944_rule: RHEL 9 must securely compare internal information system clocks at least every 2 - Configure RHEL 9 to securely compare internal information system clocks at least every 24 hours with Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257945r1038944_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-257946r958480_rule | RHEL 9 must disable the chrony daemon from acting as a server.'
      debug:
        msg: "Manual hardening required for SV-257946r958480_rule: RHEL 9 must disable the chrony daemon from acting as a server. - Configure RHEL 9 to disable the chrony daemon from acting as a server by adding/modifying the follow Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257946r958480_rule
        - service_disabled
        - severity_low
        - semi_automatable


    - name: 'SV-257947r958480_rule | RHEL 9 must disable network management of the chrony daemon.'
      debug:
        msg: "Manual hardening required for SV-257947r958480_rule: RHEL 9 must disable network management of the chrony daemon. - Configure RHEL 9 to disable network management of the chrony daemon by adding/modifying the followin Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257947r958480_rule
        - service_disabled
        - severity_low
        - semi_automatable


    - name: 'SV-257948r1045004_rule | RHEL 9 systems using Domain Name Servers (DNS) resolution must have at least two'
      file:
        path: /etc/resolv.conf
        state: file
      tags:
        - stig
        - SV-257948r1045004_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257949r1134947_rule | RHEL 9 must configure a DNS processing mode in Network Manager.'
      file:
        path: /etc/NetworkManager/NetworkManager.conf
        state: file
      tags:
        - stig
        - SV-257949r1134947_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-257950r1045006_rule | RHEL 9 must not have unauthorized IP tunnels configured.'
      systemd:
        name: is
        enabled: yes
        state: started
      tags:
        - stig
        - SV-257950r1045006_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257951r1014843_rule | RHEL 9 must be configured to prevent unrestricted mail relaying.'
      debug:
        msg: "Manual hardening required for SV-257951r1014843_rule: RHEL 9 must be configured to prevent unrestricted mail relaying. - Modify the postfix configuration file to restrict client connections to the local network with the f Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257951r1014843_rule
        - package_present
        - severity_medium
        - manual


    - name: 'SV-257953r958424_rule | RHEL 9 must forward mail from postmaster to the root account using a postfix ali'
      debug:
        msg: "Manual hardening required for SV-257953r958424_rule: RHEL 9 must forward mail from postmaster to the root account using a postfix ali - Configure a valid email address as an alias for the root account.  Append the following line to "/et Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257953r958424_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-257954r1106315_rule | RHEL 9 libreswan package must be installed.'
      systemd:
        name: package
        enabled: yes
        state: started
      tags:
        - stig
        - SV-257954r1106315_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257955r991589_rule | There must be no shosts.equiv files on RHEL 9.'
      debug:
        msg: "Manual hardening required for SV-257955r991589_rule: There must be no shosts.equiv files on RHEL 9. - Remove any found "shosts.equiv" files from the system.  $ sudo rm /[path]/[to]/[file]/shosts.equiv Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257955r991589_rule
        - package_absent
        - severity_high
        - semi_automatable


    - name: 'SV-257956r991589_rule | There must be no .shosts files on RHEL 9.'
      debug:
        msg: "Manual hardening required for SV-257956r991589_rule: There must be no .shosts files on RHEL 9. - Remove any found ".shosts" files from the system.  $ sudo rm /[path]/[to]/[file]/.shosts Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257956r991589_rule
        - package_absent
        - severity_high
        - semi_automatable


    - name: 'SV-257957r1106317_rule | RHEL 9 must be configured to use TCP syncookies.'
      debug:
        msg: "Manual hardening required for SV-257957r1106317_rule: RHEL 9 must be configured to use TCP syncookies. - Configure RHEL 9 to use TCP syncookies.  Add or edit the following line in a system configuration fi Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257957r1106317_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257958r1106319_rule | RHEL 9 must ignore Internet Protocol version 4 (IPv4) Internet Control Message P'
      debug:
        msg: "Manual hardening required for SV-257958r1106319_rule: RHEL 9 must ignore Internet Protocol version 4 (IPv4) Internet Control Message P - Configure RHEL 9 to ignore IPv4 ICMP redirect messages.  Add or edit the following line in a system  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257958r1106319_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257959r1102024_rule | RHEL 9 must not forward Internet Protocol version 4 (IPv4) source-routed packets'
      debug:
        msg: "Manual hardening required for SV-257959r1102024_rule: RHEL 9 must not forward Internet Protocol version 4 (IPv4) source-routed packets - Configure RHEL 9 to not forward IPv4 source-routed packets.  Add or edit the following line in a sys Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257959r1102024_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257960r1106321_rule | RHEL 9 must log IPv4 packets with impossible addresses.'
      debug:
        msg: "Manual hardening required for SV-257960r1106321_rule: RHEL 9 must log IPv4 packets with impossible addresses. - Configure RHEL 9 to log martian packets on IPv4 interfaces.  Add or edit the following line in a sin Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257960r1106321_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257961r1106323_rule | RHEL 9 must log IPv4 packets with impossible addresses by default.'
      debug:
        msg: "Manual hardening required for SV-257961r1106323_rule: RHEL 9 must log IPv4 packets with impossible addresses by default. - Configure RHEL 9 to log martian packets on IPv4 interfaces by default.  Add or edit the following li Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257961r1106323_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257962r1106437_rule | RHEL 9 must use reverse path filtering on all IPv4 interfaces.'
      debug:
        msg: "Manual hardening required for SV-257962r1106437_rule: RHEL 9 must use reverse path filtering on all IPv4 interfaces. - Configure RHEL 9 to use reverse path filtering on all IPv4 interfaces by adding the following line t Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257962r1106437_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257963r1106328_rule | RHEL 9 must prevent IPv4 Internet Control Message Protocol (ICMP) redirect messa'
      debug:
        msg: "Manual hardening required for SV-257963r1106328_rule: RHEL 9 must prevent IPv4 Internet Control Message Protocol (ICMP) redirect messa - Configure RHEL 9 to prevent IPv4 ICMP redirect messages from being accepted.  Add or edit the follow Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257963r1106328_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257964r1106438_rule | RHEL 9 must not forward IPv4 source-routed packets by default.'
      debug:
        msg: "Manual hardening required for SV-257964r1106438_rule: RHEL 9 must not forward IPv4 source-routed packets by default. - Configure RHEL 9 to not forward IPv4 source-routed packets by default.  Add or edit the following li Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257964r1106438_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257965r1106333_rule | RHEL 9 must use a reverse-path filter for IPv4 network traffic when possible by '
      debug:
        msg: "Manual hardening required for SV-257965r1106333_rule: RHEL 9 must use a reverse-path filter for IPv4 network traffic when possible by  - Configure RHEL 9 to use reverse path filtering on IPv4 interfaces by default.  Add or edit the follo Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257965r1106333_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257966r1106440_rule | RHEL 9 must not respond to Internet Control Message Protocol (ICMP) echoes sent '
      debug:
        msg: "Manual hardening required for SV-257966r1106440_rule: RHEL 9 must not respond to Internet Control Message Protocol (ICMP) echoes sent  - Configure RHEL 9 to not respond to IPv4 ICMP echoes sent to a broadcast address.  Add or edit the fo Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257966r1106440_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257967r1106337_rule | RHEL 9 must limit the number of bogus Internet Control Message Protocol (ICMP) r'
      debug:
        msg: "Manual hardening required for SV-257967r1106337_rule: RHEL 9 must limit the number of bogus Internet Control Message Protocol (ICMP) r - Configure RHEL 9 to not log bogus ICMP errors:   Add or edit the following line in a single system c Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257967r1106337_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257968r1106339_rule | RHEL 9 must not send Internet Control Message Protocol (ICMP) redirects.'
      debug:
        msg: "Manual hardening required for SV-257968r1106339_rule: RHEL 9 must not send Internet Control Message Protocol (ICMP) redirects. - Configure RHEL 9 to not allow interfaces to perform IPv4 ICMP redirects.  Add or edit the following  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257968r1106339_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257969r991589_rule | RHEL 9 must not allow interfaces to perform Internet Control Message Protocol (I'
      debug:
        msg: "Manual hardening required for SV-257969r991589_rule: RHEL 9 must not allow interfaces to perform Internet Control Message Protocol (I - Configure RHEL 9 to not allow interfaces to perform Internet Protocol version 4 (IPv4) ICMP redirect Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257969r991589_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257970r1106442_rule | RHEL 9 must not enable IPv4 packet forwarding unless the system is a router.'
      debug:
        msg: "Manual hardening required for SV-257970r1106442_rule: RHEL 9 must not enable IPv4 packet forwarding unless the system is a router. - Configure RHEL 9 to not allow IPv4 packet forwarding, unless the system is a router.  Add or edit th Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257970r1106442_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257971r1106444_rule | RHEL 9 must not accept router advertisements on all IPv6 interfaces.'
      debug:
        msg: "Manual hardening required for SV-257971r1106444_rule: RHEL 9 must not accept router advertisements on all IPv6 interfaces. - Configure RHEL 9 to not accept router advertisements on all IPv6 interfaces unless the system is a r Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257971r1106444_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257972r1106446_rule | RHEL 9 must ignore IPv6 Internet Control Message Protocol (ICMP) redirect messag'
      debug:
        msg: "Manual hardening required for SV-257972r1106446_rule: RHEL 9 must ignore IPv6 Internet Control Message Protocol (ICMP) redirect messag - Configure RHEL 9 to ignore IPv6 ICMP redirect messages.  Add or edit the following line in a system  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257972r1106446_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257973r1106448_rule | RHEL 9 must not forward IPv6 source-routed packets.'
      debug:
        msg: "Manual hardening required for SV-257973r1106448_rule: RHEL 9 must not forward IPv6 source-routed packets. - Configure RHEL 9 to not forward IPv6 source-routed packets.  Add or edit the following line in a sys Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257973r1106448_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257974r1106450_rule | RHEL 9 must not enable IPv6 packet forwarding unless the system is a router.'
      debug:
        msg: "Manual hardening required for SV-257974r1106450_rule: RHEL 9 must not enable IPv6 packet forwarding unless the system is a router. - Configure RHEL 9 to not allow IPv6 packet forwarding, unless the system is a router.  Add or edit th Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257974r1106450_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257975r1106452_rule | RHEL 9 must not accept router advertisements on all IPv6 interfaces by default.'
      debug:
        msg: "Manual hardening required for SV-257975r1106452_rule: RHEL 9 must not accept router advertisements on all IPv6 interfaces by default. - Configure RHEL 9 to not accept router advertisements on all IPv6 interfaces by default unless the sy Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257975r1106452_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257976r1106454_rule | RHEL 9 must prevent IPv6 Internet Control Message Protocol (ICMP) redirect messa'
      debug:
        msg: "Manual hardening required for SV-257976r1106454_rule: RHEL 9 must prevent IPv6 Internet Control Message Protocol (ICMP) redirect messa - Configure RHEL 9 to prevent IPv6 ICMP redirect messages from being accepted.  Add or edit the follow Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257976r1106454_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257977r1106456_rule | RHEL 9 must not forward IPv6 source-routed packets by default.'
      debug:
        msg: "Manual hardening required for SV-257977r1106456_rule: RHEL 9 must not forward IPv6 source-routed packets by default. - Configure RHEL 9 to not forward IPv6 source-routed packets by default.  Add or edit the following li Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257977r1106456_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257978r1045013_rule | All RHEL 9 networked systems must have SSH installed.'
      package:
        name: openssh-server
        state: present
      tags:
        - stig
        - SV-257978r1045013_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-257979r958908_rule | All RHEL 9 networked systems must have and implement SSH to protect the confiden'
      systemd:
        name: run
        enabled: yes
        state: started
      tags:
        - stig
        - SV-257979r958908_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257980r1045016_rule | RHEL 9 must have the openssh-clients package installed.'
      package:
        name: openssh-clients
        state: present
      tags:
        - stig
        - SV-257980r1045016_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-257981r1101970_rule | RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before '
      debug:
        msg: "Manual hardening required for SV-257981r1101970_rule: RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before  - Configure RHEL 9 to display the Standard Mandatory DOD Notice and Consent Banner before granting acc Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257981r1101970_rule
        - ssh_config
        - severity_medium
        - semi_automatable


    - name: 'SV-257982r1045021_rule | RHEL 9 must log SSH connection attempts and failures to the server.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257982r1045021_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257983r1045024_rule | RHEL 9 SSHD must accept public key authentication.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257983r1045024_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257984r1045026_rule | RHEL 9 SSHD must not allow blank passwords.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257984r1045026_rule
        - service_enabled
        - severity_high
        - semi_automatable


    - name: 'SV-257985r1069364_rule | RHEL 9 must not permit direct logons to the root account using remote access via'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257985r1069364_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257986r1045030_rule | RHEL 9 must enable the Pluggable Authentication Module (PAM) interface for SSHD.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257986r1045030_rule
        - service_enabled
        - severity_high
        - semi_automatable


    - name: 'SV-257989r1051240_rule | The RHEL 9 SSH server must be configured to use only DOD-approved encryption cip'
      debug:
        msg: "Manual hardening required for SV-257989r1051240_rule: The RHEL 9 SSH server must be configured to use only DOD-approved encryption cip - Configure the RHEL 9 SSH server to use only ciphers employing FIPS 140-3 approved algorithms.  Reins Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257989r1051240_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-257991r1051246_rule | The RHEL 9 SSH server must be configured to use only Message Authentication Code'
      debug:
        msg: "Manual hardening required for SV-257991r1051246_rule: The RHEL 9 SSH server must be configured to use only Message Authentication Code - Configure the RHEL 9 SSH server to use only MACs employing FIPS 140-3 approved algorithms.  Reinstal Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257991r1051246_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-257992r1045047_rule | RHEL 9 must not allow a noncertificate trusted host SSH logon to the system.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257992r1045047_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257993r1045049_rule | RHEL 9 must not allow users to override SSH environment variables.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257993r1045049_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257994r1045051_rule | RHEL 9 must force a frequent session key renegotiation for SSH connections to th'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257994r1045051_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257995r1045053_rule | RHEL 9 must be configured so that all network connections associated with SSH tr'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257995r1045053_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257996r1134915_rule | RHEL 9 must be configured so that all network connections associated with SSH tr'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257996r1134915_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-257997r1069370_rule | RHEL 9 SSH server configuration file must be group-owned by root.'
      file:
        path: /etc/ssh/sshd_config
        state: file
      tags:
        - stig
        - SV-257997r1069370_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257998r1082181_rule | The RHEL 9 SSH server configuration file must be owned by root.'
      file:
        path: /etc/ssh/sshd_config
        state: file
      tags:
        - stig
        - SV-257998r1082181_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-257999r1134918_rule | RHEL 9 SSH server configuration files' permissions must not be modified.'
      debug:
        msg: "Manual hardening required for SV-257999r1134918_rule: RHEL 9 SSH server configuration files' permissions must not be modified. - Run the following commands to restore the correct permissions of OpenSSH server configuration files: Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257999r1134918_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258000r1045063_rule | RHEL 9 SSH private host key files must have mode 0640 or less permissive.'
      file:
        path: /etc/ssh
        mode: '0640'
        state: file
      tags:
        - stig
        - SV-258000r1045063_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258001r991589_rule | RHEL 9 SSH public host key files must have mode 0644 or less permissive.'
      file:
        path: /etc/ssh
        mode: '0644'
        state: file
      tags:
        - stig
        - SV-258001r991589_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258002r991589_rule | RHEL 9 SSH daemon must not allow compression or must only allow compression afte'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-258002r991589_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258003r1045065_rule | RHEL 9 SSH daemon must not allow GSSAPI authentication.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-258003r1045065_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258004r1045067_rule | RHEL 9 SSH daemon must not allow Kerberos authentication.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-258004r1045067_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258005r1045069_rule | RHEL 9 SSH daemon must not allow rhosts authentication.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-258005r1045069_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258006r1045071_rule | RHEL 9 SSH daemon must not allow known hosts authentication.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-258006r1045071_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258007r1045073_rule | RHEL 9 SSH daemon must disable remote X connections for interactive users.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-258007r1045073_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258008r1045075_rule | RHEL 9 SSH daemon must perform strict mode checking of home directory configurat'
      file:
        path: /etc/ssh/sshd_config
        state: file
      tags:
        - stig
        - SV-258008r1045075_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258009r1045077_rule | RHEL 9 SSH daemon must display the date and time of the last successful account '
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-258009r1045077_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258011r1045079_rule | RHEL 9 SSH daemon must prevent remote hosts from connecting to the proxy display'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-258011r1045079_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258012r1014855_rule | RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before '
      debug:
        msg: "Manual hardening required for SV-258012r1014855_rule: RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before  - Configure RHEL 9 to display the Standard Mandatory DOD Notice and Consent Banner before granting acc Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258012r1014855_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258013r1045082_rule | RHEL 9 must prevent a user from overriding the banner-message-enable setting for'
      debug:
        msg: "Manual hardening required for SV-258013r1045082_rule: RHEL 9 must prevent a user from overriding the banner-message-enable setting for - Configure RHEL 9 to prevent a user from overriding the banner setting for graphical user interfaces. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258013r1045082_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258014r1045084_rule | RHEL 9 must disable the graphical user interface automount function unless requi'
      debug:
        msg: "Manual hardening required for SV-258014r1045084_rule: RHEL 9 must disable the graphical user interface automount function unless requi - Configure the GNOME desktop to disable automated mounting of removable media.  The dconf settings ca Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258014r1045084_rule
        - service_disabled
        - severity_medium
        - manual


    - name: 'SV-258015r1045086_rule | RHEL 9 must prevent a user from overriding the disabling of the graphical user i'
      debug:
        msg: "Manual hardening required for SV-258015r1045086_rule: RHEL 9 must prevent a user from overriding the disabling of the graphical user i - Configure the GNOME desktop to not allow a user to change the setting that disables automated mounti Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258015r1045086_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258016r958804_rule | RHEL 9 must disable the graphical user interface autorun function unless require'
      debug:
        msg: "Manual hardening required for SV-258016r958804_rule: RHEL 9 must disable the graphical user interface autorun function unless require - Configure the GNOME desktop to disable the autorun function on removable media.  The dconf settings  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258016r958804_rule
        - service_disabled
        - severity_medium
        - manual


    - name: 'SV-258017r1045088_rule | RHEL 9 must prevent a user from overriding the disabling of the graphical user i'
      debug:
        msg: "Manual hardening required for SV-258017r1045088_rule: RHEL 9 must prevent a user from overriding the disabling of the graphical user i - Configure the GNOME desktop to not allow a user to change the setting that disables autorun on remov Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258017r1045088_rule
        - service_disabled
        - severity_medium
        - manual


    - name: 'SV-258018r1045090_rule | RHEL 9 must not allow unattended or automatic logon via the graphical user inter'
      debug:
        msg: "Manual hardening required for SV-258018r1045090_rule: RHEL 9 must not allow unattended or automatic logon via the graphical user inter - Configure the GNOME desktop display manager to disable automatic login.  Set AutomaticLoginEnable to Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258018r1045090_rule
        - service_disabled
        - severity_high
        - semi_automatable


    - name: 'SV-258019r1045092_rule | RHEL 9 must be able to initiate directly a session lock for all connection types'
      debug:
        msg: "Manual hardening required for SV-258019r1045092_rule: RHEL 9 must be able to initiate directly a session lock for all connection types - Configure RHEL 9 to enable a user's session lock until that user re-establishes access using establi Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258019r1045092_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258020r1045094_rule | RHEL 9 must prevent a user from overriding the disabling of the graphical user s'
      debug:
        msg: "Manual hardening required for SV-258020r1045094_rule: RHEL 9 must prevent a user from overriding the disabling of the graphical user s - Add the following line to "/etc/dconf/db/local.d/locks/00-security-settings-lock" to prevent user ov Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258020r1045094_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258021r1015088_rule | RHEL 9 must enable a user session lock until that user re-establishes access usi'
      debug:
        msg: "Manual hardening required for SV-258021r1015088_rule: RHEL 9 must enable a user session lock until that user re-establishes access usi - Configure RHEL 9 to enable a user's session lock until that user re-establishes access using establi Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258021r1015088_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258022r1045097_rule | RHEL 9 must prevent a user from overriding the screensaver lock-enabled setting '
      debug:
        msg: "Manual hardening required for SV-258022r1045097_rule: RHEL 9 must prevent a user from overriding the screensaver lock-enabled setting  - Configure RHEL 9 to prevent a user from overriding settings for graphical user interfaces.  Create a Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258022r1045097_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258023r958402_rule | RHEL 9 must automatically lock graphical user sessions after 15 minutes of inact'
      debug:
        msg: "Manual hardening required for SV-258023r958402_rule: RHEL 9 must automatically lock graphical user sessions after 15 minutes of inact - Configure RHEL 9 to initiate a screensaver after a 15-minute period of inactivity for graphical user Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258023r958402_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258024r1045100_rule | RHEL 9 must prevent a user from overriding the session idle-delay setting for th'
      debug:
        msg: "Manual hardening required for SV-258024r1045100_rule: RHEL 9 must prevent a user from overriding the session idle-delay setting for th - Configure RHEL 9 to prevent a user from overriding settings for graphical user interfaces.  Create a Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258024r1045100_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258025r958402_rule | RHEL 9 must initiate a session lock for graphical user interfaces when the scree'
      debug:
        msg: "Manual hardening required for SV-258025r958402_rule: RHEL 9 must initiate a session lock for graphical user interfaces when the scree - Configure RHEL 9 to initiate a session lock for graphical user interfaces when a screensaver is acti Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258025r958402_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258026r1045103_rule | RHEL 9 must prevent a user from overriding the session lock-delay setting for th'
      debug:
        msg: "Manual hardening required for SV-258026r1045103_rule: RHEL 9 must prevent a user from overriding the session lock-delay setting for th - Configure RHEL 9 to prevent a user from overriding settings for graphical user interfaces.  Create a Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258026r1045103_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258027r1045106_rule | RHEL 9 must conceal, via the session lock, information previously visible on the'
      debug:
        msg: "Manual hardening required for SV-258027r1045106_rule: RHEL 9 must conceal, via the session lock, information previously visible on the - Configure RHEL 9 to prevent a user from overriding the picture-uri setting for graphical user interf Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258027r1045106_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258028r991589_rule | RHEL 9 effective dconf policy must match the policy keyfiles.'
      debug:
        msg: "Manual hardening required for SV-258028r991589_rule: RHEL 9 effective dconf policy must match the policy keyfiles. - Update the dconf databases by running the following command:  $ sudo dconf update Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258028r991589_rule
        - package_present
        - severity_medium
        - manual


    - name: 'SV-258029r1045109_rule | RHEL 9 must disable the ability of a user to restart the system from the login s'
      debug:
        msg: "Manual hardening required for SV-258029r1045109_rule: RHEL 9 must disable the ability of a user to restart the system from the login s - Configure RHEL 9 to disable a user's ability to restart the system.  $ gsettings set org.gnome.login Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258029r1045109_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258030r1045112_rule | RHEL 9 must prevent a user from overriding the disable-restart-buttons setting f'
      debug:
        msg: "Manual hardening required for SV-258030r1045112_rule: RHEL 9 must prevent a user from overriding the disable-restart-buttons setting f - Configure RHEL 9 to prevent a user from overriding the disable-restart-buttons setting for graphical Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258030r1045112_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258031r1134920_rule | RHEL 9 must disable the ability of a user to accidentally press Ctrl-Alt-Del and'
      debug:
        msg: "Manual hardening required for SV-258031r1134920_rule: RHEL 9 must disable the ability of a user to accidentally press Ctrl-Alt-Del and - Configure RHEL 9 to ignore the Ctrl-Alt-Del sequence in the GNOME desktop.  Run the following comman Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258031r1134920_rule
        - service_disabled
        - severity_medium
        - manual


    - name: 'SV-258032r1045117_rule | RHEL 9 must prevent a user from overriding the Ctrl-Alt-Del sequence settings fo'
      debug:
        msg: "Manual hardening required for SV-258032r1045117_rule: RHEL 9 must prevent a user from overriding the Ctrl-Alt-Del sequence settings fo - Configure RHEL 9 to disallow the user changing the Ctrl-Alt-Del sequence in the GNOME desktop.  Crea Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258032r1045117_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258033r1045120_rule | RHEL 9 must disable the user list at logon for graphical user interfaces.'
      debug:
        msg: "Manual hardening required for SV-258033r1045120_rule: RHEL 9 must disable the user list at logon for graphical user interfaces. - Configure RHEL 9 to disable the user list at logon for graphical user interfaces.  Create a database Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258033r1045120_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258034r1051267_rule | RHEL 9 must be configured to disable USB mass storage.'
      debug:
        msg: "Manual hardening required for SV-258034r1051267_rule: RHEL 9 must be configured to disable USB mass storage. - To configure the system to prevent the usb-storage kernel module from being loaded, add the followin Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258034r1051267_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258035r1045125_rule | RHEL 9 must have the USBGuard package installed.'
      systemd:
        name: usbguard.service
        enabled: yes
      tags:
        - stig
        - SV-258035r1045125_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258036r1014861_rule | RHEL 9 must have the USBGuard package enabled.'
      systemd:
        name: run
        enabled: yes
        state: started
      tags:
        - stig
        - SV-258036r1014861_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258037r1014863_rule | RHEL 9 must enable Linux audit logging for the USBGuard daemon.'
      debug:
        msg: "Manual hardening required for SV-258037r1014863_rule: RHEL 9 must enable Linux audit logging for the USBGuard daemon. - Configure RHEL 9 USBGuard AuditBackend to use the audit system.  Add or edit the following line in / Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258037r1014863_rule
        - service_enabled
        - severity_low
        - semi_automatable


    - name: 'SV-258038r1045128_rule | RHEL 9 must block unauthorized peripherals before establishing a connection.'
      debug:
        msg: "Manual hardening required for SV-258038r1045128_rule: RHEL 9 must block unauthorized peripherals before establishing a connection. - Configure the operating system to enable the blocking of unauthorized peripherals with the following Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258038r1045128_rule
        - service_enabled
        - severity_medium
        - manual


    - name: 'SV-258039r1045131_rule | RHEL 9 Bluetooth must be disabled.'
      debug:
        msg: "Manual hardening required for SV-258039r1045131_rule: RHEL 9 Bluetooth must be disabled. - Configure RHEL 9 to disable the Bluetooth adapter when not in use.  Create or modify the "/etc/modpr Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258039r1045131_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258040r991568_rule | RHEL 9 wireless network adapters must be disabled.'
      debug:
        msg: "Manual hardening required for SV-258040r991568_rule: RHEL 9 wireless network adapters must be disabled. - Configure the system to disable all wireless network interfaces with the following command:  $ nmcli Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258040r991568_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258041r1038967_rule | RHEL 9 user account passwords for new users or password changes must have a 60-d'
      lineinfile:
        path: /etc/login.defs
        line: 'PASS_MAX_DAYS 60'
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258041r1038967_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258042r1045133_rule | RHEL 9 user account passwords must have a 60-day maximum password lifetime restr'
      debug:
        msg: "Manual hardening required for SV-258042r1045133_rule: RHEL 9 user account passwords must have a 60-day maximum password lifetime restr - Configure noncompliant accounts to enforce a 60-day maximum password lifetime restriction.  passwd - Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258042r1045133_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258043r991589_rule | All RHEL 9 local interactive user accounts must be assigned a home directory upo'
      lineinfile:
        path: /etc/login.defs
        line: 'CREATE_HOME yes'
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258043r991589_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258044r1045135_rule | RHEL 9 must set the umask value to 077 for all local interactive user accounts.'
      debug:
        msg: "Manual hardening required for SV-258044r1045135_rule: RHEL 9 must set the umask value to 077 for all local interactive user accounts. - Remove the umask statement from all local interactive user's initialization files.   If the account  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258044r1045135_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258045r958482_rule | RHEL 9 duplicate User IDs (UIDs) must not exist for interactive users.'
      debug:
        msg: "Manual hardening required for SV-258045r958482_rule: RHEL 9 duplicate User IDs (UIDs) must not exist for interactive users. - Edit the file "/etc/passwd" and provide each interactive user account that has a duplicate UID with  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258045r958482_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258046r991589_rule | RHEL 9 system accounts must not have an interactive login shell.'
      debug:
        msg: "Manual hardening required for SV-258046r991589_rule: RHEL 9 system accounts must not have an interactive login shell. - Configure RHEL 9 so that all noninteractive accounts on the system do not have an interactive shell  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258046r991589_rule
        - service_disabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258047r1101951_rule | RHEL 9 must automatically expire temporary accounts within 72 hours.'
      debug:
        msg: "Manual hardening required for SV-258047r1101951_rule: RHEL 9 must automatically expire temporary accounts within 72 hours. - Configure the operating system to expire temporary accounts after 72 hours with the following comman Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258047r1101951_rule
        - other
        - severity_medium
        - manual


    - name: 'SV-258048r1069380_rule | All RHEL 9 interactive users must have a primary group that exists.'
      file:
        path: /etc/passwd
        state: file
      tags:
        - stig
        - SV-258048r1069380_rule
        - file_owner
        - severity_medium
        - manual


    - name: 'SV-258049r1015092_rule | RHEL 9 must disable account identifiers (individuals, groups, roles, and devices'
      debug:
        msg: "Manual hardening required for SV-258049r1015092_rule: RHEL 9 must disable account identifiers (individuals, groups, roles, and devices - Configure RHEL 9 to disable account identifiers after 35 days of inactivity after the password expir Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258049r1015092_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-258050r1045137_rule | Executable search paths within the initialization files of all local interactive'
      debug:
        msg: "Manual hardening required for SV-258050r1045137_rule: Executable search paths within the initialization files of all local interactive - Edit the local interactive user initialization files to change any PATH variable statements that ref Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258050r1045137_rule
        - other
        - severity_medium
        - semi_automatable


    - name: 'SV-258051r991589_rule | All RHEL 9 local interactive users must have a home directory assigned in the /e'
      debug:
        msg: "Manual hardening required for SV-258051r991589_rule: All RHEL 9 local interactive users must have a home directory assigned in the /e - Create and assign home directories to all local interactive users on RHEL 9 that currently do not ha Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258051r991589_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258052r991589_rule | All RHEL 9 local interactive user home directories defined in the /etc/passwd fi'
      file:
        path: /etc/passwd
        mode: '0750'
        owner: wadea
        group: Identifier
        state: file
      tags:
        - stig
        - SV-258052r991589_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258053r991589_rule | All RHEL 9 local interactive user home directories must be group-owned by the ho'
      file:
        path: /etc/passwd
        owner: of
        group: owner
        state: file
      tags:
        - stig
        - SV-258053r991589_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-258054r958736_rule | RHEL 9 must automatically lock an account when three unsuccessful logon attempts'
      lineinfile:
        path: /etc/security/faillock.conf
        line: 'deny = 3'
        regexp: '^#?\s*deny\s*='
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258054r958736_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258055r1045140_rule | RHEL 9 must automatically lock the root account until the root account is releas'
      debug:
        msg: "Manual hardening required for SV-258055r1045140_rule: RHEL 9 must automatically lock the root account until the root account is releas - To configure RHEL 9 to lock out the "root" account after a number of incorrect logon attempts using  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258055r1045140_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258056r1045143_rule | RHEL 9 must automatically lock an account when three unsuccessful logon attempts'
      debug:
        msg: "Manual hardening required for SV-258056r1045143_rule: RHEL 9 must automatically lock an account when three unsuccessful logon attempts - To configure RHEL 9 to lock out the "root" account after a number of incorrect logon attempts within Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258056r1045143_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258057r1045146_rule | RHEL 9 must maintain an account lock until the locked account is released by an '
      debug:
        msg: "Manual hardening required for SV-258057r1045146_rule: RHEL 9 must maintain an account lock until the locked account is released by an  - Configure RHEL 9 to lock an account until released by an administrator after three unsuccessful logo Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258057r1045146_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258058r1045148_rule | RHEL 9 must not have unauthorized accounts.'
      debug:
        msg: "Manual hardening required for SV-258058r1045148_rule: RHEL 9 must not have unauthorized accounts. - Remove unauthorized local interactive user accounts with the following command where <unauthorized_u Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258058r1045148_rule
        - package_absent
        - severity_medium
        - semi_automatable


    - name: 'SV-258059r991589_rule | The root account must be the only account having unrestricted access to RHEL 9 s'
      debug:
        msg: "Manual hardening required for SV-258059r991589_rule: The root account must be the only account having unrestricted access to RHEL 9 s - Change the UID of any account on the system, other than root, that has a UID of "0".   If the accoun Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258059r991589_rule
        - config
        - severity_high
        - semi_automatable


    - name: 'SV-258060r1045150_rule | RHEL 9 must ensure account lockouts persist.'
      lineinfile:
        path: /etc/security/faillock.conf
        line: 'dir = /var/log/faillock'
        regexp: '^#?\s*dir\s*='
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258060r1045150_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258061r958482_rule | RHEL 9 groups must have unique Group ID (GID).'
      file:
        path: /etc/group
        group: that
        state: file
      tags:
        - stig
        - SV-258061r958482_rule
        - file_owner
        - severity_medium
        - manual


    - name: 'SV-258062r991589_rule | Local RHEL 9 initialization files must not execute world-writable programs.'
      debug:
        msg: "Manual hardening required for SV-258062r991589_rule: Local RHEL 9 initialization files must not execute world-writable programs. - Set the mode on files being executed by the local initialization files with the following command:   Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258062r991589_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258068r1101950_rule | RHEL 9 must automatically exit interactive command shell user sessions after 10 '
      debug:
        msg: "Manual hardening required for SV-258068r1101950_rule: RHEL 9 must automatically exit interactive command shell user sessions after 10  - Configure RHEL 9 to exit interactive command shell user sessions after 10 minutes of inactivity.  Ad Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258068r1101950_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258069r958398_rule | RHEL 9 must limit the number of concurrent sessions to ten for all accounts and/'
      debug:
        msg: "Manual hardening required for SV-258069r958398_rule: RHEL 9 must limit the number of concurrent sessions to ten for all accounts and/ - Configure RHEL 9 to limit the number of concurrent sessions to "10" for all accounts and/or account  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258069r958398_rule
        - config
        - severity_low
        - semi_automatable


    - name: 'SV-258070r1045153_rule | RHEL 9 must log username information when unsuccessful logon attempts occur.'
      debug:
        msg: "Manual hardening required for SV-258070r1045153_rule: RHEL 9 must log username information when unsuccessful logon attempts occur. - Configure RHEL 9 to log username information when unsuccessful logon attempts occur.  Enable the fea Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258070r1045153_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258071r991588_rule | RHEL 9 must enforce a delay of at least four seconds between logon prompts follo'
      lineinfile:
        path: /etc/login.defs
        line: 'FAIL_DELAY 4'
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258071r991588_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258072r1045155_rule | RHEL 9 must define default permissions for the bash shell.'
      file:
        path: /etc/bashrc
        state: file
      tags:
        - stig
        - SV-258072r1045155_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258073r1045157_rule | RHEL 9 must define default permissions for the c shell.'
      file:
        path: /etc/csh.cshrc
        state: file
      tags:
        - stig
        - SV-258073r1045157_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258074r991590_rule | RHEL 9 must define default permissions for all authenticated users in such a way'
      file:
        path: /etc/login.defs
        state: file
      tags:
        - stig
        - SV-258074r991590_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258075r991590_rule | RHEL 9 must define default permissions for the system default profile.'
      file:
        path: /etc/profile
        state: file
      tags:
        - stig
        - SV-258075r991590_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258076r991589_rule | RHEL 9 must display the date and time of the last successful account logon upon '
      debug:
        msg: "Manual hardening required for SV-258076r991589_rule: RHEL 9 must display the date and time of the last successful account logon upon  - Configure RHEL 9 to provide users with feedback on when account accesses last occurred by setting th Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258076r991589_rule
        - config
        - severity_low
        - semi_automatable


    - name: 'SV-258077r1014874_rule | RHEL 9 must terminate idle user sessions.'
      systemd:
        name: systemd-logind.service
        state: restarted
      tags:
        - stig
        - SV-258077r1014874_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258078r958944_rule | RHEL 9 must use a Linux Security Module configured to enforce limits on system s'
      debug:
        msg: "Manual hardening required for SV-258078r958944_rule: RHEL 9 must use a Linux Security Module configured to enforce limits on system s - Configure RHEL 9 to verify correct operation of security functions.  Edit the file "/etc/selinux/con Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258078r958944_rule
        - service_disabled
        - severity_high
        - semi_automatable


    - name: 'SV-258079r1045159_rule | RHEL 9 must enable the SELinux targeted policy.'
      debug:
        msg: "Manual hardening required for SV-258079r1045159_rule: RHEL 9 must enable the SELinux targeted policy. - Configure RHEL 9 to use the targetd SELINUX policy.  Edit the file "/etc/selinux/config" and add or  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258079r1045159_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258080r1045162_rule | RHEL 9 must configure SELinux context type to allow the use of a nondefault fail'
      debug:
        msg: "Manual hardening required for SV-258080r1045162_rule: RHEL 9 must configure SELinux context type to allow the use of a nondefault fail - Configure RHEL 9 to allow the use of a nondefault faillock tally directory while SELinux enforces a  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258080r1045162_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258081r1045164_rule | RHEL 9 must have policycoreutils package installed.'
      package:
        name: policycoreutils
        state: present
      tags:
        - stig
        - SV-258081r1045164_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258082r1045166_rule | RHEL 9 policycoreutils-python-utils package must be installed.'
      systemd:
        name: package
        enabled: yes
        state: started
      tags:
        - stig
        - SV-258082r1045166_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258083r1045168_rule | RHEL 9 must have the sudo package installed.'
      package:
        name: sudo
        state: present
      tags:
        - stig
        - SV-258083r1045168_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258084r1050789_rule | RHEL 9 must require reauthentication when using the "sudo" command.'
      debug:
        msg: "Manual hardening required for SV-258084r1050789_rule: RHEL 9 must require reauthentication when using the "sudo" command. - Configure RHEL 9 to reauthenticate "sudo" commands after the specified timeout:  Add the following l Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258084r1050789_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258085r1045173_rule | RHEL 9 must use the invoking user's password for privilege escalation when using'
      debug:
        msg: "Manual hardening required for SV-258085r1045173_rule: RHEL 9 must use the invoking user's password for privilege escalation when using - Define the following in the Defaults section of the /etc/sudoers file or a single configuration file Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258085r1045173_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258086r1102063_rule | RHEL 9 must require users to reauthenticate for privilege escalation.'
      debug:
        msg: "Manual hardening required for SV-258086r1102063_rule: RHEL 9 must require users to reauthenticate for privilege escalation. - Configure RHEL 9 to not allow users to execute privileged actions without authenticating.  Remove an Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258086r1102063_rule
        - package_absent
        - severity_medium
        - semi_automatable


    - name: 'SV-258087r1102071_rule | RHEL 9 must restrict privilege elevation to authorized personnel.'
      debug:
        msg: "Manual hardening required for SV-258087r1102071_rule: RHEL 9 must restrict privilege elevation to authorized personnel. - Remove the following entries from the /etc/sudoers file or configuration file under /etc/sudoers.d/: Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258087r1102071_rule
        - package_absent
        - severity_medium
        - semi_automatable


    - name: 'SV-258088r1050789_rule | RHEL 9 must restrict the use of the "su" command.'
      file:
        path: /etc/pam.d/su
        group: to
        state: file
      tags:
        - stig
        - SV-258088r1050789_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-258089r1045179_rule | RHEL 9 fapolicy module must be installed.'
      package:
        name: fapolicyd
        state: present
      tags:
        - stig
        - SV-258089r1045179_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258090r958808_rule | RHEL 9 fapolicy module must be enabled.'
      debug:
        msg: "Manual hardening required for SV-258090r958808_rule: RHEL 9 fapolicy module must be enabled. - Enable the fapolicyd with the following command:  $ systemctl enable --now fapolicyd Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258090r958808_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258091r1045185_rule | RHEL 9 must ensure the password complexity module in the system-auth file is con'
      lineinfile:
        path: /etc/security/pwquality.conf
        line: 'retry = 3'
        regexp: '^#?\s*retry\s*='
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258091r1045185_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258094r1045187_rule | RHEL 9 must not allow blank or null passwords.'
      debug:
        msg: "Manual hardening required for SV-258094r1045187_rule: RHEL 9 must not allow blank or null passwords. - If PAM is managed with authselect, use the following command to remove instances of "nullok":   $ su Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258094r1045187_rule
        - service_enabled
        - severity_high
        - semi_automatable


    - name: 'SV-258095r1045189_rule | RHEL 9 must configure the use of the pam_faillock.so module in the /etc/pam.d/sy'
      debug:
        msg: "Manual hardening required for SV-258095r1045189_rule: RHEL 9 must configure the use of the pam_faillock.so module in the /etc/pam.d/sy - Configure RHEL 9 to include the use of the pam_faillock.so module in the /etc/pam.d/system-auth file Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258095r1045189_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258096r1045191_rule | RHEL 9 must configure the use of the pam_faillock.so module in the /etc/pam.d/pa'
      debug:
        msg: "Manual hardening required for SV-258096r1045191_rule: RHEL 9 must configure the use of the pam_faillock.so module in the /etc/pam.d/pa - Configure RHEL 9 to include the use of the pam_faillock.so module in the /etc/pam.d/password-auth fi Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258096r1045191_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258097r1045193_rule | RHEL 9 must ensure the password complexity module is enabled in the password-aut'
      debug:
        msg: "Manual hardening required for SV-258097r1045193_rule: RHEL 9 must ensure the password complexity module is enabled in the password-aut - Configure RHEL 9 to use "pwquality" to enforce password complexity rules.  Add the following line to Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258097r1045193_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258098r1045195_rule | RHEL 9 must ensure the password complexity module is enabled in the system-auth '
      debug:
        msg: "Manual hardening required for SV-258098r1045195_rule: RHEL 9 must ensure the password complexity module is enabled in the system-auth  - Configure RHEL 9 to use "pwquality" to enforce password complexity rules.  Add the following line to Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258098r1045195_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258099r1045198_rule | RHEL 9 password-auth must be configured to use a sufficient number of hashing ro'
      debug:
        msg: "Manual hardening required for SV-258099r1045198_rule: RHEL 9 password-auth must be configured to use a sufficient number of hashing ro - Configure RHEL 9 to use 100000 hashing rounds for hashing passwords.  Add or modify the following li Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258099r1045198_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258100r1045201_rule | RHEL 9 system-auth must be configured to use a sufficient number of hashing roun'
      debug:
        msg: "Manual hardening required for SV-258100r1045201_rule: RHEL 9 system-auth must be configured to use a sufficient number of hashing roun - Configure RHEL 9 to use 100000 hashing rounds for hashing passwords.  Add or modify the following li Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258100r1045201_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258101r1045204_rule | RHEL 9 must enforce password complexity rules for the root account.'
      debug:
        msg: "Manual hardening required for SV-258101r1045204_rule: RHEL 9 must enforce password complexity rules for the root account. - Configure RHEL 9 to enforce password complexity on the root account.  Add or update the following li Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258101r1045204_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258102r1045207_rule | RHEL 9 must enforce password complexity by requiring that at least one lowercase'
      lineinfile:
        path: /etc/security/pwquality.conf
        line: 'lcredit = -1'
        regexp: '^#?\s*lcredit\s*='
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258102r1045207_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258103r1045210_rule | RHEL 9 must enforce password complexity by requiring that at least one numeric c'
      lineinfile:
        path: /etc/security/pwquality.conf
        line: 'dcredit = -1'
        regexp: '^#?\s*dcredit\s*='
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258103r1045210_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258104r1015104_rule | RHEL 9 passwords for new users or password changes must have a 24 hours minimum '
      lineinfile:
        path: /etc/login.defs
        line: 'PASS_MIN_DAYS 1'
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258104r1015104_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258105r1045212_rule | RHEL 9 passwords must have a 24 hours minimum password lifetime restriction in /'
      debug:
        msg: "Manual hardening required for SV-258105r1045212_rule: RHEL 9 passwords must have a 24 hours minimum password lifetime restriction in / - Configure noncompliant accounts to enforce a 24 hour minimum password lifetime:  $ sudo passwd -n 1  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258105r1045212_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258106r1102061_rule | RHEL 9 must require users to provide a password for privilege escalation.'
      file:
        path: /etc/sudoers
        state: file
      tags:
        - stig
        - SV-258106r1102061_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-258107r1045218_rule | RHEL 9 passwords must be created with a minimum of 15 characters.'
      lineinfile:
        path: /etc/security/pwquality.conf
        line: 'minlen = 15'
        regexp: '^#?\s*minlen\s*='
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258107r1045218_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258109r1045220_rule | RHEL 9 must enforce password complexity by requiring that at least one special c'
      lineinfile:
        path: /etc/security/pwquality.conf
        line: 'ocredit = -1'
        regexp: '^#?\s*ocredit\s*='
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258109r1045220_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258110r1045223_rule | RHEL 9 must prevent the use of dictionary words for passwords.'
      lineinfile:
        path: /etc/security/pwquality.conf
        line: 'dictcheck=1'
        regexp: '^#?\s*dictcheck\s*='
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258110r1045223_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258111r1045226_rule | RHEL 9 must enforce password complexity by requiring that at least one uppercase'
      lineinfile:
        path: /etc/security/pwquality.conf
        line: 'ucredit = -1'
        regexp: '^#?\s*ucredit\s*='
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258111r1045226_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258112r1045229_rule | RHEL 9 must require the change of at least eight characters when passwords are c'
      lineinfile:
        path: /etc/security/pwquality.conf
        line: 'difok = 8'
        regexp: '^#?\s*difok\s*='
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258112r1045229_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258113r1045232_rule | RHEL 9 must require the maximum number of repeating characters of the same chara'
      lineinfile:
        path: /etc/security/pwquality.conf
        line: 'maxclassrepeat = 4'
        regexp: '^#?\s*maxclassrepeat\s*='
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258113r1045232_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258114r1045235_rule | RHEL 9 must require the maximum number of repeating characters be limited to thr'
      lineinfile:
        path: /etc/security/pwquality.conf
        line: 'maxrepeat = 3'
        regexp: '^#?\s*maxrepeat\s*='
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258114r1045235_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258115r1045238_rule | RHEL 9 must require the change of at least four character classes when passwords'
      lineinfile:
        path: /etc/security/pwquality.conf
        line: 'minclass = 4'
        regexp: '^#?\s*minclass\s*='
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258115r1045238_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258116r1045240_rule | RHEL 9 must be configured so that user and group account administration utilitie'
      file:
        path: /etc/libuser.conf
        state: file
      tags:
        - stig
        - SV-258116r1045240_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-258117r1015116_rule | RHEL 9 must be configured to use the shadow file to store only encrypted represe'
      lineinfile:
        path: /etc/login.defs
        line: 'ENCRYPT_METHOD SHA512'
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258117r1015116_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258118r1050789_rule | RHEL 9 must not be configured to bypass password requirements for privilege esca'
      debug:
        msg: "Manual hardening required for SV-258118r1050789_rule: RHEL 9 must not be configured to bypass password requirements for privilege esca - Configure the operating system to require users to supply a password for privilege escalation.  Remo Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258118r1050789_rule
        - package_absent
        - severity_medium
        - semi_automatable


    - name: 'SV-258120r991589_rule | RHEL 9 must not have accounts configured with blank or null passwords.'
      debug:
        msg: "Manual hardening required for SV-258120r991589_rule: RHEL 9 must not have accounts configured with blank or null passwords. - Configure all accounts on RHEL 9 to have a password or lock the account with the following commands: Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258120r991589_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258121r1102086_rule | RHEL 9 must use the common access card (CAC) smart card driver.'
      systemd:
        name: pcscd.service
        state: restarted
      tags:
        - stig
        - SV-258121r1102086_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258122r1045246_rule | RHEL 9 must enable certificate based smart card authentication.'
      debug:
        msg: "Manual hardening required for SV-258122r1045246_rule: RHEL 9 must enable certificate based smart card authentication. - Edit the file "/etc/sssd/sssd.conf" or a configuration file in "/etc/sssd/conf.d" and add or edit th Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258122r1045246_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258123r1134923_rule | RHEL 9 must implement certificate status checking for multifactor authentication'
      file:
        path: /etc/sssd/conf.d/certificate_verification.conf
        mode: '600'
        owner: root
        group: root
        state: file
      tags:
        - stig
        - SV-258123r1134923_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258124r1045250_rule | RHEL 9 must have the pcsc-lite package installed.'
      package:
        name: pcsc-lite
        state: present
      tags:
        - stig
        - SV-258124r1045250_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258125r1045253_rule | The pcscd service on RHEL 9 must be active.'
      debug:
        msg: "Manual hardening required for SV-258125r1045253_rule: The pcscd service on RHEL 9 must be active. - To enable the pcscd socket, run the following command:  $ sudo systemctl enable --now pcscd.socket Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258125r1045253_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258126r1045255_rule | RHEL 9 must have the opensc package installed.'
      package:
        name: opensc
        state: present
      tags:
        - stig
        - SV-258126r1045255_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258127r1134925_rule | RHEL 9, for PKI-based authentication, must enforce authorized access to the corr'
      debug:
        msg: "Manual hardening required for SV-258127r1134925_rule: RHEL 9, for PKI-based authentication, must enforce authorized access to the corr - Create a new private and public key pair that utilizes a passcode with the following command:  $ sud Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258127r1134925_rule
        - other
        - severity_medium
        - semi_automatable


    - name: 'SV-258128r1117265_rule | RHEL 9 must require authentication to access emergency mode.'
      file:
        path: /usr/lib/systemd/system/emergency.service
        state: file
      tags:
        - stig
        - SV-258128r1117265_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258129r1117265_rule | RHEL 9 must require authentication to access single-user mode.'
      file:
        path: /etc/systemd/system/rescue.service.d/
        state: file
      tags:
        - stig
        - SV-258129r1117265_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258131r1134927_rule | RHEL 9, for PKI-based authentication, must validate certificates by constructing'
      debug:
        msg: "Manual hardening required for SV-258131r1134927_rule: RHEL 9, for PKI-based authentication, must validate certificates by constructing - Configure RHEL 9, for PKI-based authentication, to validate certificates by constructing a certifica Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258131r1134927_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258132r1134929_rule | RHEL 9 must map the authenticated identity to the user or group account for PKI-'
      file:
        path: /etc/sssd/sssd.conf
        group: account
        state: file
      tags:
        - stig
        - SV-258132r1134929_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-258133r1045263_rule | RHEL 9 must prohibit the use of cached authenticators after one day.'
      debug:
        msg: "Manual hardening required for SV-258133r1045263_rule: RHEL 9 must prohibit the use of cached authenticators after one day. - Configure the SSSD to prohibit the use of cached authentications after one day.  Edit the file "/etc Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258133r1045263_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258134r1101983_rule | RHEL 9 must have the AIDE package installed.'
      file:
        path: /usr/sbin/aide
        mode: '0600'
        state: file
      tags:
        - stig
        - SV-258134r1101983_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258135r1045267_rule | RHEL 9 must routinely check the baseline configuration for unauthorized changes '
      debug:
        msg: "Manual hardening required for SV-258135r1045267_rule: RHEL 9 must routinely check the baseline configuration for unauthorized changes  - Configure the file integrity tool to run automatically on the system at least weekly and to notify d Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258135r1045267_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258136r1045270_rule | RHEL 9 must use a file integrity tool that is configured to use FIPS 140-3-appro'
      debug:
        msg: "Manual hardening required for SV-258136r1045270_rule: RHEL 9 must use a file integrity tool that is configured to use FIPS 140-3-appro - Configure the file integrity tool to use FIPS 140-3 cryptographic hashes for validating file and dir Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258136r1045270_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258137r1102081_rule | RHEL 9 must use cryptographic mechanisms to protect the integrity of audit tools'
      debug:
        msg: "Manual hardening required for SV-258137r1102081_rule: RHEL 9 must use cryptographic mechanisms to protect the integrity of audit tools - Add or update the following lines to "/etc/aide.conf", to protect the integrity of the audit tools.  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258137r1102081_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258138r1045274_rule | RHEL 9 must be configured so that the file integrity tool verifies Access Contro'
      debug:
        msg: "Manual hardening required for SV-258138r1045274_rule: RHEL 9 must be configured so that the file integrity tool verifies Access Contro - Configure the file integrity tool to check file and directory ACLs.   If AIDE is installed, ensure t Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258138r1045274_rule
        - package_present
        - severity_low
        - semi_automatable


    - name: 'SV-258139r1045276_rule | RHEL 9 must be configured so that the file integrity tool verifies extended attr'
      debug:
        msg: "Manual hardening required for SV-258139r1045276_rule: RHEL 9 must be configured so that the file integrity tool verifies extended attr - Configure the file integrity tool to check file and directory extended attributes.   If AIDE is inst Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258139r1045276_rule
        - package_present
        - severity_low
        - semi_automatable


    - name: 'SV-258140r1106460_rule | RHEL 9 must have the rsyslog package installed.'
      package:
        name: rsyslog
        state: present
      tags:
        - stig
        - SV-258140r1106460_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258141r1045280_rule | RHEL 9 must have the packages required for encrypting offloaded audit logs insta'
      package:
        name: rsyslog-gnutls
        state: present
      tags:
        - stig
        - SV-258141r1045280_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258142r991589_rule | The rsyslog service on RHEL 9 must be active.'
      systemd:
        name: is
        enabled: yes
        state: started
      tags:
        - stig
        - SV-258142r991589_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258143r1134931_rule | RHEL 9 must be configured so that the rsyslog daemon does not accept log message'
      systemd:
        name: rsyslog.service
        state: restarted
      tags:
        - stig
        - SV-258143r1134931_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258144r1045286_rule | All RHEL 9 remote access methods must be monitored.'
      systemd:
        name: rsyslog.service
        state: restarted
      tags:
        - stig
        - SV-258144r1045286_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258146r1045288_rule | RHEL 9 must authenticate the remote logging server for offloading audit logs via'
      file:
        path: /etc/rsyslog.conf
        state: file
      tags:
        - stig
        - SV-258146r1045288_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258147r1045290_rule | RHEL 9 must encrypt the transfer of audit records offloaded onto a different sys'
      file:
        path: /etc/rsyslog.conf
        state: file
      tags:
        - stig
        - SV-258147r1045290_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258148r1045292_rule | RHEL 9 must encrypt via the gtls driver the transfer of audit records offloaded '
      debug:
        msg: "Manual hardening required for SV-258148r1045292_rule: RHEL 9 must encrypt via the gtls driver the transfer of audit records offloaded  - Configure RHEL 9 to use the gtls driver to encrypt offloaded audit records by setting the following  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258148r1045292_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258149r1106462_rule | RHEL 9 must be configured to forward audit records via TCP to a different system'
      debug:
        msg: "Manual hardening required for SV-258149r1106462_rule: RHEL 9 must be configured to forward audit records via TCP to a different system - Configure RHEL 9 to off-load audit records onto a different system or media from the system being au Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258149r1106462_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258150r1045296_rule | RHEL 9 must use cron logging.'
      systemd:
        name: rsyslog.service
        state: restarted
      tags:
        - stig
        - SV-258150r1045296_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258151r1045298_rule | RHEL 9 audit package must be installed.'
      systemd:
        name: package
        enabled: yes
        state: started
      tags:
        - stig
        - SV-258151r1045298_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258152r1015127_rule | RHEL 9 audit service must be enabled.'
      systemd:
        name: run
        enabled: yes
        state: started
      tags:
        - stig
        - SV-258152r1015127_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258153r1038966_rule | RHEL 9 audit system must take appropriate action when an error writing to the au'
      debug:
        msg: "Manual hardening required for SV-258153r1038966_rule: RHEL 9 audit system must take appropriate action when an error writing to the au - Configure RHEL 9 to shut down by default upon audit failure (unless availability is an overriding co Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258153r1038966_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258154r1038966_rule | RHEL 9 audit system must take appropriate action when the audit storage volume i'
      debug:
        msg: "Manual hardening required for SV-258154r1038966_rule: RHEL 9 audit system must take appropriate action when the audit storage volume i - Configure RHEL 9 to shut down by default upon audit failure (unless availability is an overriding co Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258154r1038966_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258155r1045300_rule | RHEL 9 must allocate audit record storage capacity to store at least one week's '
      debug:
        msg: "Manual hardening required for SV-258155r1045300_rule: RHEL 9 must allocate audit record storage capacity to store at least one week's  - Allocate enough storage capacity for at least one week of audit records when audit records are not i Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258155r1045300_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258156r1106364_rule | RHEL 9 must take action when allocated audit record storage volume reaches 75 pe'
      debug:
        msg: "Manual hardening required for SV-258156r1106364_rule: RHEL 9 must take action when allocated audit record storage volume reaches 75 pe - Configure RHEL 9 to initiate an action to notify the SA and ISSO (at a minimum) when allocated audit Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258156r1106364_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258157r1134932_rule | RHEL 9 must notify the system administrator (SA) and information system security'
      debug:
        msg: "Manual hardening required for SV-258157r1134932_rule: RHEL 9 must notify the system administrator (SA) and information system security - Configure RHEL 9 to initiate an action to notify the SA and ISSO (at a minimum) when allocated audit Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258157r1134932_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258158r971542_rule | RHEL 9 must take action when allocated audit record storage volume reaches 95 pe'
      debug:
        msg: "Manual hardening required for SV-258158r971542_rule: RHEL 9 must take action when allocated audit record storage volume reaches 95 pe - Configure RHEL 9 to initiate an action when allocated audit record storage volume reaches 95 percent Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258158r971542_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258159r971542_rule | RHEL 9 must take action when allocated audit record storage volume reaches 95 pe'
      file:
        path: /etc/audit/auditd.conf
        state: file
      tags:
        - stig
        - SV-258159r971542_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258160r1038966_rule | RHEL 9 audit system must take appropriate action when the audit files have reach'
      debug:
        msg: "Manual hardening required for SV-258160r1038966_rule: RHEL 9 audit system must take appropriate action when the audit files have reach - Configure RHEL 9 to rotate the audit log when it reaches maximum size.  Add or update the following  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258160r1038966_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258161r958416_rule | RHEL 9 must label all offloaded audit logs before sending them to the central lo'
      debug:
        msg: "Manual hardening required for SV-258161r958416_rule: RHEL 9 must label all offloaded audit logs before sending them to the central lo - Edit the /etc/audit/auditd.conf file and add or update the "name_format" option:  name_format = host Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258161r958416_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258162r958754_rule | RHEL 9 must take appropriate action when the internal event queue is full.'
      debug:
        msg: "Manual hardening required for SV-258162r958754_rule: RHEL 9 must take appropriate action when the internal event queue is full. - Edit the /etc/audit/auditd.conf file and add or update the "overflow_action" option:  overflow_actio Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258162r958754_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258163r958424_rule | RHEL 9 System Administrator (SA) and/or information system security officer (ISS'
      systemd:
        name: to
        enabled: yes
        state: started
      tags:
        - stig
        - SV-258163r958424_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258164r1045301_rule | RHEL 9 audit system must audit local events.'
      debug:
        msg: "Manual hardening required for SV-258164r1045301_rule: RHEL 9 audit system must audit local events. - Configure RHEL 9 to generate audit records for local events by adding or updating the following line Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258164r1045301_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258165r958434_rule | RHEL 9 audit logs must be group-owned by root or by a restricted logging group t'
      file:
        path: /etc/audit/auditd.conf
        group: of
        state: file
      tags:
        - stig
        - SV-258165r958434_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-258166r1045303_rule | RHEL 9 audit log directory must be owned by root to prevent unauthorized read ac'
      file:
        path: /var/log/audit
        owner: root
        state: file
      tags:
        - stig
        - SV-258166r1045303_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-258167r1101918_rule | RHEL 9 audit logs file must have mode 0600 or less permissive to prevent unautho'
      file:
        path: /etc/audit/auditd.conf
        mode: '0600'
        group: that
        state: file
      tags:
        - stig
        - SV-258167r1101918_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258168r958428_rule | RHEL 9 must periodically flush audit records to disk to prevent the loss of audi'
      debug:
        msg: "Manual hardening required for SV-258168r958428_rule: RHEL 9 must periodically flush audit records to disk to prevent the loss of audi - Configure RHEL 9 to flush audit to disk by adding or updating the following rule in "/etc/audit/audi Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258168r958428_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258169r991556_rule | RHEL 9 must produce audit records containing information to establish the identi'
      debug:
        msg: "Manual hardening required for SV-258169r991556_rule: RHEL 9 must produce audit records containing information to establish the identi - Edit the /etc/audit/auditd.conf file and add or update the "log_format" option:  log_format = ENRICH Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258169r991556_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258170r991589_rule | RHEL 9 must write audit records to disk.'
      debug:
        msg: "Manual hardening required for SV-258170r991589_rule: RHEL 9 must write audit records to disk. - Configure the audit system to write log files to the disk.  Edit the /etc/audit/auditd.conf file and Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258170r991589_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258171r1134934_rule | RHEL 9 must allow only the information system security manager (ISSM) (or indivi'
      file:
        path: /etc/audit/rules.d/
        mode: '0640'
        state: file
      tags:
        - stig
        - SV-258171r1134934_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258173r1101933_rule | RHEL 9 must allocate an audit_backlog_limit of sufficient size to capture proces'
      debug:
        msg: "Manual hardening required for SV-258173r1101933_rule: RHEL 9 must allocate an audit_backlog_limit of sufficient size to capture proces - Configure RHEL 9 to allocate sufficient audit_backlog_limit to capture processes that start prior to Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258173r1101933_rule
        - package_present
        - severity_low
        - semi_automatable


    - name: 'SV-258174r958424_rule | RHEL 9 must have mail aliases to notify the information system security officer '
      debug:
        msg: "Manual hardening required for SV-258174r958424_rule: RHEL 9 must have mail aliases to notify the information system security officer  - Edit the aliases map file (by default /etc/aliases) used by Postfix and configure a root alias (usin Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258174r958424_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258175r1045310_rule | RHEL 9 audispd-plugins package must be installed.'
      package:
        name: audispd-plugins
        state: present
      tags:
        - stig
        - SV-258175r1045310_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258176r1106366_rule | RHEL 9 must audit uses of the "execve" system call.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k execpriv'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258176r1106366_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258177r1106368_rule | RHEL 9 must audit all uses of the chmod, fchmod, and fchmodat system calls.'
      file:
        path: /etc/audit/rules.d/audit.rules
        state: file
      tags:
        - stig
        - SV-258177r1106368_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-258178r1106370_rule | RHEL 9 must audit all uses of the chown, fchown, fchownat, and lchown system cal'
      file:
        path: /etc/audit/rules.d/audit.rules
        state: file
      tags:
        - stig
        - SV-258178r1106370_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-258179r1106371_rule | RHEL 9 must audit all uses of the setxattr, fsetxattr, lsetxattr, removexattr, f'
      debug:
        msg: "Manual hardening required for SV-258179r1106371_rule: RHEL 9 must audit all uses of the setxattr, fsetxattr, lsetxattr, removexattr, f - Configure RHEL 9 to audit the execution of the "setxattr", "fsetxattr", "lsetxattr", "removexattr",  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258179r1106371_rule
        - package_absent
        - severity_medium
        - semi_automatable


    - name: 'SV-258180r1045325_rule | RHEL 9 must audit all uses of umount system calls.'
      debug:
        msg: "Manual hardening required for SV-258180r1045325_rule: RHEL 9 must audit all uses of umount system calls. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the "umount" Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258180r1045325_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-258181r1045328_rule | RHEL 9 must audit all uses of the chacl command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/chacl -F perm=x -F auid>=1000 -F auid!=unset -k perm_mod'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258181r1045328_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258182r1045331_rule | RHEL 9 must audit all uses of the setfacl command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/setfacl -F perm=x -F auid>=1000 -F auid!=unset -k perm_mod'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258182r1045331_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258183r1045334_rule | RHEL 9 must audit all uses of the chcon command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=unset -k perm_mod'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258183r1045334_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258184r1045337_rule | RHEL 9 must audit all uses of the semanage command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/semanage -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258184r1045337_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258185r1045340_rule | RHEL 9 must audit all uses of the setfiles command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/setfiles -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258185r1045340_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258186r1045343_rule | RHEL 9 must audit all uses of the setsebool command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/setsebool -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258186r1045343_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258187r1106373_rule | RHEL 9 must audit all uses of the rename, unlink, rmdir, renameat, and unlinkat '
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S rename,unlink,rmdir,renameat,unlinkat -F auid>=1000 -F auid!=unset -k delete'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258187r1106373_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258188r1106375_rule | RHEL 9 must audit all uses of the truncate, ftruncate, creat, open, openat, and '
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S truncate,ftruncate,creat,open,openat,open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -k perm_access'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258188r1106375_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258189r1106377_rule | RHEL 9 must audit all uses of the delete_module system call.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S delete_module -F auid>=1000 -F auid!=unset -k module_chng'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258189r1106377_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258190r1106379_rule | RHEL 9 must audit all uses of the init_module and finit_module system calls.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S init_module,finit_module -F auid>=1000 -F auid!=unset -k module_chng'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258190r1106379_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258191r1045358_rule | RHEL 9 must audit all uses of the chage command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=unset -k privileged-chage'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258191r1045358_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258192r1045361_rule | RHEL 9 must audit all uses of the chsh command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258192r1045361_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258193r1045364_rule | RHEL 9 must audit all uses of the crontab command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/crontab -F perm=x -F auid>=1000 -F auid!=unset -k privileged-crontab'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258193r1045364_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258194r1045367_rule | RHEL 9 must audit all uses of the gpasswd command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=unset -k privileged-gpasswd'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258194r1045367_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258195r1045370_rule | RHEL 9 must audit all uses of the kmod command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/kmod -F perm=x -F auid>=1000 -F auid!=unset -k modules'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258195r1045370_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258196r1045373_rule | RHEL 9 must audit all uses of the newgrp command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258196r1045373_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258197r1045376_rule | RHEL 9 must audit all uses of the pam_timestamp_check command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/pam_timestamp_check -F perm=x -F auid>=1000 -F auid!=unset -k privileged-pam_timestamp_check'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258197r1045376_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258198r1045379_rule | RHEL 9 must audit all uses of the passwd command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/passwd -F perm=x -F auid>=1000 -F auid!=unset -k privileged-passwd'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258198r1045379_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258199r1045382_rule | RHEL 9 must audit all uses of the postdrop command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/postdrop -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258199r1045382_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258200r1045385_rule | RHEL 9 must audit all uses of the postqueue command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/postqueue -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258200r1045385_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258201r1045388_rule | RHEL 9 must audit all uses of the ssh-agent command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/ssh-agent -F perm=x -F auid>=1000 -F auid!=unset -k privileged-ssh'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258201r1045388_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258202r1045391_rule | RHEL 9 must audit all uses of the ssh-keysign command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/libexec/openssh/ssh-keysign -F perm=x -F auid>=1000 -F auid!=unset -k privileged-ssh'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258202r1045391_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258203r1045394_rule | RHEL 9 must audit all uses of the su command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=unset -k privileged-priv_change'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258203r1045394_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258204r1045397_rule | RHEL 9 must audit all uses of the sudo command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258204r1045397_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258205r1045400_rule | RHEL 9 must audit all uses of the sudoedit command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/sudoedit -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258205r1045400_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258206r1045403_rule | RHEL 9 must audit all uses of the unix_chkpwd command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258206r1045403_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258207r1045406_rule | RHEL 9 must audit all uses of the unix_update command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/unix_update -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258207r1045406_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258208r1045409_rule | RHEL 9 must audit all uses of the userhelper command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258208r1045409_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258209r1045412_rule | RHEL 9 must audit all uses of the usermod command.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/usermod -F perm=x -F auid>=1000 -F auid!=unset -k privileged-usermod'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258209r1045412_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258210r1045415_rule | RHEL 9 must audit all uses of the mount command.'
      debug:
        msg: "Manual hardening required for SV-258210r1045415_rule: RHEL 9 must audit all uses of the mount command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the "mount"  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258210r1045415_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-258211r1045418_rule | Successful/unsuccessful uses of the init command in RHEL 9 must generate an audi'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/init -F perm=x -F auid>=1000 -F auid!=unset -k privileged-init'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258211r1045418_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258212r1045421_rule | Successful/unsuccessful uses of the poweroff command in RHEL 9 must generate an '
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/poweroff -F perm=x -F auid>=1000 -F auid!=unset -k privileged-poweroff'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258212r1045421_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258213r1045424_rule | Successful/unsuccessful uses of the reboot command in RHEL 9 must generate an au'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/reboot -F perm=x -F auid>=1000 -F auid!=unset -k privileged-reboot'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258213r1045424_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258214r1045427_rule | Successful/unsuccessful uses of the shutdown command in RHEL 9 must generate an '
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/shutdown -F perm=x -F auid>=1000 -F auid!=unset -k privileged-shutdown'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258214r1045427_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258215r1106381_rule | Successful/unsuccessful uses of the umount system call in RHEL 9 must generate a'
      debug:
        msg: "Manual hardening required for SV-258215r1106381_rule: Successful/unsuccessful uses of the umount system call in RHEL 9 must generate a - Configure the audit system to generate an audit event for any successful/unsuccessful use of the "um Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258215r1106381_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-258216r1102090_rule | Successful/unsuccessful uses of the umount2 system call in RHEL 9 must generate '
      debug:
        msg: "Manual hardening required for SV-258216r1102090_rule: Successful/unsuccessful uses of the umount2 system call in RHEL 9 must generate  - Configure the audit system to generate an audit event for any successful/unsuccessful use of the "um Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258216r1102090_rule
        - mount_option
        - severity_medium
        - semi_automatable


    - name: 'SV-258217r1045436_rule | RHEL 9 must generate audit records for all account creations, modifications, dis'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/sudoers -p wa -k identity'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258217r1045436_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258218r1101981_rule | RHEL 9 must generate audit records for all account creations, modifications, dis'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/sudoers.d/ -p wa -k identity'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258218r1101981_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258219r1015130_rule | RHEL 9 must generate audit records for all account creations, modifications, dis'
      file:
        path: /etc/group
        state: file
      tags:
        - stig
        - SV-258219r1015130_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-258220r1015131_rule | RHEL 9 must generate audit records for all account creations, modifications, dis'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/gshadow -p wa -k identity'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258220r1015131_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258221r1015132_rule | RHEL 9 must generate audit records for all account creations, modifications, dis'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/security/opasswd -p wa -k identity'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258221r1015132_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258222r1015133_rule | RHEL 9 must generate audit records for all account creations, modifications, dis'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/passwd -p wa -k identity'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258222r1015133_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258223r1015134_rule | RHEL 9 must generate audit records for all account creations, modifications, dis'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/shadow -p wa -k identity'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258223r1015134_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258224r1014988_rule | RHEL 9 must generate audit records for all account creations, modifications, dis'
      systemd:
        name: auditd
        enabled: yes
        state: started
      tags:
        - stig
        - SV-258224r1014988_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258225r1014990_rule | RHEL 9 must generate audit records for all account creations, modifications, dis'
      systemd:
        name: auditd
        enabled: yes
        state: started
      tags:
        - stig
        - SV-258225r1014990_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258227r1014992_rule | RHEL 9 must take appropriate action when a critical audit processing failure occ'
      systemd:
        name: is
        enabled: yes
        state: started
      tags:
        - stig
        - SV-258227r1014992_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258228r991572_rule | RHEL 9 audit system must protect logon UIDs from unauthorized change.'
      debug:
        msg: "Manual hardening required for SV-258228r991572_rule: RHEL 9 audit system must protect logon UIDs from unauthorized change. - Configure RHEL 9 auditing to prevent modification of login UIDs once they are set by adding the foll Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258228r991572_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258229r958434_rule | RHEL 9 audit system must protect auditing rules from unauthorized change.'
      debug:
        msg: "Manual hardening required for SV-258229r958434_rule: RHEL 9 audit system must protect auditing rules from unauthorized change. - Configure the audit system to set the audit rules to be immutable by adding the following line to en Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258229r958434_rule
        - audit
        - severity_medium
        - semi_automatable


    - name: 'SV-258230r1134936_rule | RHEL 9 must enable FIPS mode.'
      debug:
        msg: "Manual hardening required for SV-258230r1134936_rule: RHEL 9 must enable FIPS mode. - Configure the operating system to implement FIPS mode with the following command  $ sudo fips-mode-s Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258230r1134936_rule
        - file_permissions
        - severity_high
        - manual


    - name: 'SV-258231r1069375_rule | RHEL 9 must employ FIPS 140-3 approved cryptographic hashing algorithms for all '
      debug:
        msg: "Manual hardening required for SV-258231r1069375_rule: RHEL 9 must employ FIPS 140-3 approved cryptographic hashing algorithms for all  - Lock all interactive user accounts not using SHA-512 hashing until the passwords can be regenerated  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258231r1069375_rule
        - config
        - severity_medium
        - manual


    - name: 'SV-258232r1045440_rule | RHEL 9 IP tunnels must use FIPS 140-3 approved cryptographic algorithms.'
      systemd:
        name: uses
        enabled: yes
        state: started
      tags:
        - stig
        - SV-258232r1045440_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258233r1015136_rule | RHEL 9 pam_unix.so module must be configured in the password-auth file to use a '
      debug:
        msg: "Manual hardening required for SV-258233r1015136_rule: RHEL 9 pam_unix.so module must be configured in the password-auth file to use a  - Configure RHEL 9 to use a FIPS 140-3 approved cryptographic hashing algorithm for system authenticat Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258233r1015136_rule
        - config
        - severity_medium
        - semi_automatable


    - name: 'SV-258234r1051250_rule | RHEL 9 must have the crypto-policies package installed.'
      debug:
        msg: "Manual hardening required for SV-258234r1051250_rule: RHEL 9 must have the crypto-policies package installed. - Install the crypto-policies package (if the package is not already installed) with the following com Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258234r1051250_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-258236r1101920_rule | RHEL 9 cryptographic policy must not be overridden.'
      debug:
        msg: "Manual hardening required for SV-258236r1101920_rule: RHEL 9 cryptographic policy must not be overridden. - Configure RHEL 9 to correctly implement the systemwide cryptographic policies by reinstalling the cr Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258236r1101920_rule
        - package_present
        - severity_high
        - semi_automatable


    - name: 'SV-258241r1106302_rule | RHEL 9 must implement a FIPS 140-3-compliant systemwide cryptographic policy.'
      debug:
        msg: "Manual hardening required for SV-258241r1106302_rule: RHEL 9 must implement a FIPS 140-3-compliant systemwide cryptographic policy. - Configure RHEL 9 to use a FIPS 140-3-compliant systemwide cryptographic policy.  Create a subpolicy  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258241r1106302_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-258242r958908_rule | RHEL 9 must implement DOD-approved encryption in the bind package.'
      debug:
        msg: "Manual hardening required for SV-258242r958908_rule: RHEL 9 must implement DOD-approved encryption in the bind package. - Configure BIND to use the system crypto policy.  Add the following line to the "options" section in  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258242r958908_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-270174r1044831_rule | RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before '
      debug:
        msg: "Manual hardening required for SV-270174r1044831_rule: RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before  - Configure the operating system to display the Standard Mandatory DOD Notice and Consent Banner befor Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-270174r1044831_rule
        - service_enabled
        - severity_medium
        - semi_automatable


    - name: 'SV-270175r1117265_rule | RHEL 9 "/etc/audit/" must be owned by root.'
      file:
        path: /etc/audit/
        owner: root
        state: file
      tags:
        - stig
        - SV-270175r1117265_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-270176r1117265_rule | RHEL 9 "/etc/audit/" must be group-owned by root.'
      file:
        path: /etc/audit/
        group: of
        state: file
      tags:
        - stig
        - SV-270176r1117265_rule
        - file_owner
        - severity_medium
        - semi_automatable


    - name: 'SV-270177r1051237_rule | The RHEL 9 SSH client must be configured to use only DOD-approved encryption cip'
      debug:
        msg: "Manual hardening required for SV-270177r1051237_rule: The RHEL 9 SSH client must be configured to use only DOD-approved encryption cip - Configure the SSH client to use only ciphers employing FIPS 140-3 approved algorithms.  Reinstall cr Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-270177r1051237_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-270178r1051243_rule | The RHEL 9 SSH client must be configured to use only DOD-approved Message Authen'
      debug:
        msg: "Manual hardening required for SV-270178r1051243_rule: The RHEL 9 SSH client must be configured to use only DOD-approved Message Authen - Configure the SSH client to use only MACs employing FIPS 140-3 approved algorithms.  Reinstall crypt Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-270178r1051243_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-270180r1045182_rule | The RHEL 9 fapolicy module must be configured to employ a deny-all, permit-by-ex'
      file:
        path: /etc/fapolicyd/fapolicyd.conf
        state: file
      tags:
        - stig
        - SV-270180r1045182_rule
        - file_permissions
        - severity_medium
        - semi_automatable


    - name: 'SV-272488r1082178_rule | RHEL 9 must have the Postfix package installed.'
      package:
        name: postfix
        state: present
      tags:
        - stig
        - SV-272488r1082178_rule
        - package_present
        - severity_medium
        - semi_automatable


    - name: 'SV-272496r1134956_rule | RHEL 9 must elevate the SELinux context when an administrator calls the sudo com'
      file:
        path: /etc/sudoers.d
        group: to
        state: file
      tags:
        - stig
        - SV-272496r1134956_rule
        - file_owner
        - severity_medium
        - semi_automatable

