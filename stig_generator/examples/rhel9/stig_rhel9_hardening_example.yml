# Generated from: U_RHEL_9_STIG_V2R6_Manual-xccdf
# STIG Release: Unknown
# Source File: U_RHEL_9_STIG_V2R6_Manual-xccdf.xml
# Generated On: 2025-12-05T00:50:39.293345
# Total Controls: 447
#   - Automatable: 91
#   - Manual (with commands): 356

- name: Apply RHEL 9 STIG hardening
  hosts: all
  become: yes
  vars:
    # Place any tunable defaults here if needed later
  tasks:

    # Category: other
    # STIG Severity: high
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>An operating system release is considered "supported" if th...
    # Fix Text: Upgrade to a supported version of RHEL 9.
    - name: 'SV-257777r991589_rule | RHEL 9 must be a vendor-supported release.'
      debug:
        msg: "Manual hardening required for SV-257777r991589_rule: RHEL 9 must be a vendor-supported release. - Upgrade to a supported version of RHEL 9. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257777r991589_rule
        - other
        - severity_high
        - manual

    # Category: package
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Installing software updates is a fundamental mitigation aga...
    # Fix Text: Install RHEL 9 security patches and updates at the organizationally defined...
    - name: 'SV-257778r1134892_rule | RHEL 9 vendor packaged system security patches and updates must be installed and up to date.'
      debug:
        msg: "Manual hardening required for SV-257778r1134892_rule: RHEL 9 vendor packaged system security patches and updates must be installed and up to date. - Install RHEL 9 security patches and updates at the organizationally defined frequency. If system upd Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257778r1134892_rule
        - package
        - severity_medium
        - automatable

    # Category: service
    # STIG Severity: medium
    # NIST: AC.08.1(ii)
    # Description: <VulnDiscussion>Display of a standardized and approved use notification bef...
    # Fix Text: Configure RHEL 9 to display the Standard Mandatory DOD Notice and Consent B...
    - name: 'SV-257779r958390_rule | RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before granting local or remote access to the system via a command line user logon.'
      debug:
        msg: "Manual hardening required for SV-257779r958390_rule: RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before granting local or re - Configure RHEL 9 to display the Standard Mandatory DOD Notice and Consent Banner before granting acc Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257779r958390_rule
        - service
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Unnecessary service packages must not be installed to decre...
    # Fix Text: Document the requirement for a graphical user interface with the ISSO or se...
    - name: 'SV-257781r991589_rule | The graphical display manager must not be the default target on RHEL 9 unless approved.'
      debug:
        msg: "Manual hardening required for SV-257781r991589_rule: The graphical display manager must not be the default target on RHEL 9 unless approved. - Document the requirement for a graphical user interface with the ISSO or set the default target to m Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257781r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: low
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The most important characteristic of a random number genera...
    # Fix Text: Install the rng-tools package with the following command - $ sudo dnf insta...
    - name: 'SV-257782r991589_rule | RHEL 9 must enable the hardware random number generator entropy gatherer service.'
      debug:
        msg: "Manual hardening required for SV-257782r991589_rule: RHEL 9 must enable the hardware random number generator entropy gatherer service. - Install the rng-tools package with the following command:  $ sudo dnf install rng-tools  Then enable Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257782r991589_rule
        - other
        - severity_low
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SC.24.1(v)
    # Description: <VulnDiscussion>In the event of a system failure, RHEL 9 must preserve any ...
    # Fix Text: To enable the systemd-journald service, run the following command - $ sudo ...
    - name: 'SV-257783r991562_rule | RHEL 9 systemd-journald service must be enabled.'
      debug:
        msg: "Manual hardening required for SV-257783r991562_rule: RHEL 9 systemd-journald service must be enabled. - To enable the systemd-journald service, run the following command:  $ sudo systemctl enable --now sy Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257783r991562_rule
        - other
        - severity_medium
        - manual

    # Category: service
    # STIG Severity: high
    # NIST: AC.06(10)
    # Description: <VulnDiscussion>A locally logged-on user who presses Ctrl-Alt-Delete when a...
    # Fix Text: Configure the system to disable the CtrlAltDelBurstAction by added or modif...
    - name: 'SV-257784r1044832_rule | The systemd Ctrl-Alt-Delete burst key sequence in RHEL 9 must be disabled.'
      debug:
        msg: "Manual hardening required for SV-257784r1044832_rule: The systemd Ctrl-Alt-Delete burst key sequence in RHEL 9 must be disabled. - Configure the system to disable the CtrlAltDelBurstAction by added or modifying the following line i Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257784r1044832_rule
        - service
        - severity_high
        - automatable

    # Category: service
    # STIG Severity: high
    # NIST: AC.06(10)
    # Description: <VulnDiscussion>A locally logged-on user who presses Ctrl-Alt-Delete when a...
    # Fix Text: Configure RHEL 9 to disable the ctrl-alt-del.target with the following comm...
    - name: 'SV-257785r1044833_rule | The x86 Ctrl-Alt-Delete key sequence must be disabled on RHEL 9.'
      debug:
        msg: "Manual hardening required for SV-257785r1044833_rule: The x86 Ctrl-Alt-Delete key sequence must be disabled on RHEL 9. - Configure RHEL 9 to disable the ctrl-alt-del.target with the following command:  $ sudo systemctl di Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257785r1044833_rule
        - service
        - severity_high
        - automatable

    # Category: service
    # STIG Severity: medium
    # NIST: AC.06(10)
    # Description: <VulnDiscussion>The debug-shell requires no authentication and provides roo...
    # Fix Text: Configure RHEL 9 to mask the debug-shell systemd service with the following...
    - name: 'SV-257786r1044834_rule | RHEL 9 debug-shell systemd service must be disabled.'
      debug:
        msg: "Manual hardening required for SV-257786r1044834_rule: RHEL 9 debug-shell systemd service must be disabled. - Configure RHEL 9 to mask the debug-shell systemd service with the following command:  $ sudo systemc Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257786r1044834_rule
        - service
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: AC.03.1
    # Description: <VulnDiscussion>To mitigate the risk of unauthorized access to sensitive in...
    # Fix Text: Configure RHEL 9 to require a grub bootloader password for the grub superus...
    - name: 'SV-257787r1117265_rule | RHEL 9 must require a boot loader superuser password.'
      shell: |
        grub2-setpassword
      tags:
        - stig
        - SV-257787r1117265_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Using interactive or recovery boot, the console user could ...
    # Fix Text: Configure the current GRUB 2 configuration to disable the ability of system...
    - name: 'SV-257788r1044838_rule | RHEL 9 must disable the ability of systemd to spawn an interactive boot process.'
      shell: |
        grubby --update-kernel=ALL --remove-args="systemd.confirm_spawn"
      tags:
        - stig
        - SV-257788r1044838_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: high
    # NIST: AC.03.1
    # Description: <VulnDiscussion>Having a nondefault grub superuser username makes password-...
    # Fix Text: Configure RHEL 9 to have a unique username for the grub superuser account. ...
    - name: 'SV-257789r1134895_rule | RHEL 9 must require a unique superusers name upon booting into single-user and maintenance modes.'
      shell: |
        grub2-mkconfig -o /boot/grub2/grub.cfg --update-bls-cmdline
      tags:
        - stig
        - SV-257789r1134895_rule
        - other
        - severity_high
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "root" group is a highly privileged group. Furthermore,...
    # Fix Text: Change the group of the file /boot/grub2/grub.cfg to root by running the fo...
    - name: 'SV-257790r991589_rule | RHEL 9 /boot/grub2/grub.cfg file must be group-owned by root.'
      debug:
        msg: "Manual hardening required for SV-257790r991589_rule: RHEL 9 /boot/grub2/grub.cfg file must be group-owned by root. - Change the group of the file /boot/grub2/grub.cfg to root by running the following command:  $ sudo  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257790r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The " /boot/grub2/grub.cfg" file stores sensitive system co...
    # Fix Text: Change the owner of the file /boot/grub2/grub.cfg to root by running the fo...
    - name: 'SV-257791r991589_rule | RHEL 9 /boot/grub2/grub.cfg file must be owned by root.'
      shell: |
        chown root /boot/grub2/grub.cfg
      tags:
        - stig
        - SV-257791r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SC.03.1(ii)
    # Description: <VulnDiscussion>System calls are special routines in the Linux kernel, whic...
    # Fix Text: Document the use of virtual system calls with the ISSO as an operational re...
    - name: 'SV-257792r1044842_rule | RHEL 9 must disable virtual system calls.'
      shell: |
        grubby --update-kernel=ALL --args="vsyscall=none"
      tags:
        - stig
        - SV-257792r1044842_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SC.03.1(ii)
    # Description: <VulnDiscussion>Poisoning writes an arbitrary value to freed pages, so any ...
    # Fix Text: Configure RHEL 9 to enable page poisoning with the following commands - $ s...
    - name: 'SV-257793r1044843_rule | RHEL 9 must clear the page allocator to prevent use-after-free attacks.'
      shell: |
        grubby --update-kernel=ALL --args="page_poison=1"
      tags:
        - stig
        - SV-257793r1044843_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SC.03.1(ii)
    # Description: <VulnDiscussion>Some adversaries launch attacks with the intent of executin...
    # Fix Text: Configure RHEL 9 to enable init_on_free with the following command - $ sudo...
    - name: 'SV-257794r1069362_rule | RHEL 9 must clear memory when it is freed to prevent use-after-free attacks.'
      shell: |
        grubby --update-kernel=ALL --args="init_on_free=1"
      tags:
        - stig
        - SV-257794r1069362_rule
        - other
        - severity_medium
        - manual

    # Category: service
    # STIG Severity: low
    # NIST: CM.07.1(ii)
    # Description: <VulnDiscussion>Kernel page-table isolation is a kernel feature that mitiga...
    # Fix Text: Configure RHEL 9 to enable kernel page-table isolation with the following c...
    - name: 'SV-257795r1044845_rule | RHEL 9 must enable mitigations against processor-based vulnerabilities.'
      debug:
        msg: "Manual hardening required for SV-257795r1044845_rule: RHEL 9 must enable mitigations against processor-based vulnerabilities. - Configure RHEL 9 to enable kernel page-table isolation with the following command:  $ sudo grubby -- Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257795r1044845_rule
        - service
        - severity_low
        - automatable

    # Category: other
    # STIG Severity: low
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without the capability to generate audit records, it would ...
    # Fix Text: Enable auditing of processes that start prior to the audit daemon with the ...
    - name: 'SV-257796r1044847_rule | RHEL 9 must enable auditing of processes that start prior to the audit daemon.'
      shell: |
        grubby --update-kernel=ALL --args="audit=1"
      tags:
        - stig
        - SV-257796r1044847_rule
        - other
        - severity_low
        - manual

    # Category: sysctl
    # STIG Severity: medium
    # NIST: SC.02.1
    # Description: <VulnDiscussion>Preventing unauthorized information transfers mitigates the...
    # Fix Text: Configure RHEL 9 to restrict access to the kernel message buffer. Add or ed...
    - name: 'SV-257797r1117266_rule | RHEL 9 must restrict access to the kernel message buffer.'
      sysctl:
        name: kernel.dmesg_restrict
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257797r1117266_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: SC.02.1
    # Description: <VulnDiscussion>Preventing unauthorized information transfers mitigates the...
    # Fix Text: Configure RHEL 9 to prevent kernel profiling by nonprivileged users. Add or...
    - name: 'SV-257798r1117266_rule | RHEL 9 must prevent kernel profiling by nonprivileged users.'
      sysctl:
        name: kernel.perf_event_paranoid
        value: '2'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257798r1117266_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: service
    # STIG Severity: medium
    # NIST: CM.05(3)
    # Description: <VulnDiscussion>Changes to any software components can have significant eff...
    # Fix Text: Add or edit the following line in a system configuration file in the "/etc/...
    - name: 'SV-257799r1106273_rule | RHEL 9 must prevent the loading of a new kernel for later execution.'
      debug:
        msg: "Manual hardening required for SV-257799r1106273_rule: RHEL 9 must prevent the loading of a new kernel for later execution. - Add or edit the following line in a system configuration file in the '/etc/sysctl.d/' directory:  ke Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257799r1106273_rule
        - service
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: SC.02.1
    # Description: <VulnDiscussion>It is detrimental for operating systems to provide, or inst...
    # Fix Text: Configure RHEL 9 to restrict exposed kernel pointer addresses access by add...
    - name: 'SV-257800r1117266_rule | RHEL 9 must restrict exposed kernel pointer addresses access.'
      sysctl:
        name: kernel.kptr_restrict
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257800r1117266_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: AC.03(4)
    # Description: <VulnDiscussion>Discretionary Access Control (DAC) is based on the notion t...
    # Fix Text: Add or edit the following line in a system configuration file in the "/etc/...
    - name: 'SV-257801r1106279_rule | RHEL 9 must enable kernel parameters to enforce discretionary access control on hardlinks.'
      sysctl:
        name: fs.protected_hardlinks
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257801r1106279_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: AC.03(4)
    # Description: <VulnDiscussion>Discretionary Access Control (DAC) is based on the notion t...
    # Fix Text: Configure RHEL 9 to enable DAC on symlinks. Add or edit the following line ...
    - name: 'SV-257802r1106282_rule | RHEL 9 must enable kernel parameters to enforce discretionary access control on symlinks.'
      sysctl:
        name: fs.protected_symlinks
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257802r1106282_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>It is detrimental for operating systems to provide, or inst...
    # Fix Text: Configure RHEL 9 to disable storing core dumps. Add or edit the following l...
    - name: 'SV-257803r1106429_rule | RHEL 9 must disable the kernel.core_pattern.'
      debug:
        msg: "Manual hardening required for SV-257803r1106429_rule: RHEL 9 must disable the kernel.core_pattern. - Configure RHEL 9 to disable storing core dumps.  Add or edit the following line in a system configur Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257803r1106429_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07.1(ii)
    # Description: <VulnDiscussion>Disabling Asynchronous Transfer Mode (ATM) protects the sys...
    # Fix Text: To configure the system to prevent the atm kernel module from being loaded,...
    - name: 'SV-257804r1044853_rule | RHEL 9 must be configured to disable the Asynchronous Transfer Mode kernel module.'
      debug:
        msg: "Manual hardening required for SV-257804r1044853_rule: RHEL 9 must be configured to disable the Asynchronous Transfer Mode kernel module. - To configure the system to prevent the atm kernel module from being loaded, add the following line t Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257804r1044853_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07.1(ii)
    # Description: <VulnDiscussion>Disabling Controller Area Network (CAN) protects the system...
    # Fix Text: To configure the system to prevent the can kernel module from being loaded,...
    - name: 'SV-257805r1044856_rule | RHEL 9 must be configured to disable the Controller Area Network kernel module.'
      debug:
        msg: "Manual hardening required for SV-257805r1044856_rule: RHEL 9 must be configured to disable the Controller Area Network kernel module. - To configure the system to prevent the can kernel module from being loaded, add the following lines  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257805r1044856_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07.1(ii)
    # Description: <VulnDiscussion>Disabling firewire protects the system against exploitation...
    # Fix Text: To configure the system to prevent the firewire-core kernel module from bei...
    - name: 'SV-257806r1044859_rule | RHEL 9 must be configured to disable the FireWire kernel module.'
      debug:
        msg: "Manual hardening required for SV-257806r1044859_rule: RHEL 9 must be configured to disable the FireWire kernel module. - To configure the system to prevent the firewire-core kernel module from being loaded, add the follow Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257806r1044859_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07.1(ii)
    # Description: <VulnDiscussion>It is detrimental for operating systems to provide, or inst...
    # Fix Text: To configure the system to prevent the sctp kernel module from being loaded...
    - name: 'SV-257807r1044862_rule | RHEL 9 must disable the Stream Control Transmission Protocol (SCTP) kernel module.'
      debug:
        msg: "Manual hardening required for SV-257807r1044862_rule: RHEL 9 must disable the Stream Control Transmission Protocol (SCTP) kernel module. - To configure the system to prevent the sctp kernel module from being loaded, add the following lines Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257807r1044862_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07.1(ii)
    # Description: <VulnDiscussion>It is detrimental for operating systems to provide, or inst...
    # Fix Text: To configure the system to prevent the tipc kernel module from being loaded...
    - name: 'SV-257808r1044865_rule | RHEL 9 must disable the Transparent Inter Process Communication (TIPC) kernel module.'
      debug:
        msg: "Manual hardening required for SV-257808r1044865_rule: RHEL 9 must disable the Transparent Inter Process Communication (TIPC) kernel module. - To configure the system to prevent the tipc kernel module from being loaded, add the following lines Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257808r1044865_rule
        - other
        - severity_medium
        - manual

    # Category: sysctl
    # STIG Severity: medium
    # NIST: SI.16
    # Description: <VulnDiscussion>Some adversaries launch attacks with the intent of executin...
    # Fix Text: Configure RHEL 9 to implement virtual address space randomization. Add or e...
    - name: 'SV-257809r1106288_rule | RHEL 9 must implement address space layout randomization (ASLR) to protect its memory from unauthorized code execution.'
      sysctl:
        name: kernel.randomize_va_space
        value: '2'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257809r1106288_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: service
    # STIG Severity: medium
    # NIST: SC.02.1
    # Description: <VulnDiscussion>It is detrimental for operating systems to provide, or inst...
    # Fix Text: Configure RHEL 9 to prevent privilege escalation through the kernel by disa...
    - name: 'SV-257810r1117266_rule | RHEL 9 must disable access to network bpf system call from nonprivileged processes.'
      debug:
        msg: "Manual hardening required for SV-257810r1117266_rule: RHEL 9 must disable access to network bpf system call from nonprivileged processes. - Configure RHEL 9 to prevent privilege escalation through the kernel by disabling access to the bpf s Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257810r1117266_rule
        - service
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: SC.02.1
    # Description: <VulnDiscussion>It is detrimental for operating systems to provide, or inst...
    # Fix Text: Configure RHEL 9 to restrict usage of ptrace to descendant processes by add...
    - name: 'SV-257811r1117266_rule | RHEL 9 must restrict usage of ptrace to descendant processes.'
      sysctl:
        name: kernel.yama.ptrace_scope
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257811r1117266_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: service
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>A core dump includes a memory image taken at the time the o...
    # Fix Text: Configure the operating system to disable core dump backtraces. Add or modi...
    - name: 'SV-257812r1134897_rule | RHEL 9 must disable core dump backtraces.'
      debug:
        msg: "Manual hardening required for SV-257812r1134897_rule: RHEL 9 must disable core dump backtraces. - Configure the operating system to disable core dump backtraces.  Add or modify the following line in Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257812r1134897_rule
        - service
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>A core dump includes a memory image taken at the time the o...
    # Fix Text: Configure the operating system to disable storing core dumps for all users....
    - name: 'SV-257813r1134899_rule | RHEL 9 must disable storing core dumps.'
      debug:
        msg: "Manual hardening required for SV-257813r1134899_rule: RHEL 9 must disable storing core dumps. - Configure the operating system to disable storing core dumps for all users.  Add or modify the follo Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257813r1134899_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>A core dump includes a memory image taken at the time the o...
    # Fix Text: Configure the operating system to disable core dumps for all users. Add the...
    - name: 'SV-257814r1134901_rule | RHEL 9 must disable core dumps for all users.'
      debug:
        msg: "Manual hardening required for SV-257814r1134901_rule: RHEL 9 must disable core dumps for all users. - Configure the operating system to disable core dumps for all users.  Add the following line to the t Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257814r1134901_rule
        - other
        - severity_medium
        - manual

    # Category: service
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>A core dump includes a memory image taken at the time the o...
    # Fix Text: Configure the system to disable the systemd-coredump.socket with the follow...
    - name: 'SV-257815r1134903_rule | RHEL 9 must disable acquiring, saving, and processing core dumps.'
      debug:
        msg: "Manual hardening required for SV-257815r1134903_rule: RHEL 9 must disable acquiring, saving, and processing core dumps. - Configure the system to disable the systemd-coredump.socket with the following command:  $ sudo syst Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257815r1134903_rule
        - service
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>It is detrimental for operating systems to provide, or inst...
    # Fix Text: Configure RHEL 9 to disable the use of user namespaces by adding the follow...
    - name: 'SV-257816r1106435_rule | RHEL 9 must disable the use of user namespaces.'
      sysctl:
        name: user.max_user_namespaces
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257816r1106435_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: SI.16
    # Description: <VulnDiscussion>ExecShield uses the segmentation feature on all x86 systems...
    # Fix Text: If /proc/cpuinfo shows that one or more processors do not enable ExecShield...
    - name: 'SV-257817r1069383_rule | RHEL 9 must implement nonexecutable data to protect its memory from unauthorized code execution.'
      shell: |
        grubby --update-kernel=ALL --remove-args=noexec
      tags:
        - stig
        - SV-257817r1069383_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Kernel core dumps may contain the full contents of system m...
    # Fix Text: Disable and mask the kdump service on RHEL 9. To disable the kdump service ...
    - name: 'SV-257818r1044876_rule | The kdump service on RHEL 9 must be disabled.'
      debug:
        msg: "Manual hardening required for SV-257818r1044876_rule: The kdump service on RHEL 9 must be disabled. - Disable and mask the kdump service on RHEL 9.  To disable the kdump service run the following comman Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257818r1044876_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.05(3)
    # Description: <VulnDiscussion>Cryptographic verification of vendor software packages ensu...
    # Fix Text: Install Red Hat package-signing keys on the system and verify their fingerp...
    - name: 'SV-257819r1015075_rule | RHEL 9 must ensure cryptographic verification of vendor software packages.'
      debug:
        msg: "Manual hardening required for SV-257819r1015075_rule: RHEL 9 must ensure cryptographic verification of vendor software packages. - Install Red Hat package-signing keys on the system and verify their fingerprints match vendor values Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257819r1015075_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: high
    # NIST: CM.05(3)
    # Description: <VulnDiscussion>Changes to any software components can have significant eff...
    # Fix Text: Configure dnf to always check the GPG signature of software packages origin...
    - name: 'SV-257820r1044878_rule | RHEL 9 must check the GPG signature of software packages originating from external software repositories before installation.'
      debug:
        msg: "Manual hardening required for SV-257820r1044878_rule: RHEL 9 must check the GPG signature of software packages originating from external software reposito - Configure dnf to always check the GPG signature of software packages originating from external softw Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257820r1044878_rule
        - other
        - severity_high
        - manual

    # Category: other
    # STIG Severity: high
    # NIST: CM.05(3)
    # Description: <VulnDiscussion>Changes to any software components can have significant eff...
    # Fix Text: Configure dnf to always check the GPG signature of local software packages ...
    - name: 'SV-257821r1015077_rule | RHEL 9 must check the GPG signature of locally installed software packages before installation.'
      debug:
        msg: "Manual hardening required for SV-257821r1015077_rule: RHEL 9 must check the GPG signature of locally installed software packages before installation. - Configure dnf to always check the GPG signature of local software packages before installation.  Add Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257821r1015077_rule
        - other
        - severity_high
        - manual

    # Category: other
    # STIG Severity: high
    # NIST: CM.05(3)
    # Description: <VulnDiscussion>Changes to any software components can have significant eff...
    # Fix Text: Configure all software repositories defined in "/etc/yum.repos.d/" to have ...
    - name: 'SV-257822r1044880_rule | RHEL 9 must have GPG signature verification enabled for all software repositories.'
      debug:
        msg: "Manual hardening required for SV-257822r1044880_rule: RHEL 9 must have GPG signature verification enabled for all software repositories. - Configure all software repositories defined in '/etc/yum.repos.d/' to have 'gpgcheck' enabled:  $ su Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257822r1044880_rule
        - other
        - severity_high
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The hashes of important files such as system executables sh...
    # Fix Text: Configure RHEL 9 so that the cryptographic hashes of system files match ven...
    - name: 'SV-257823r1051231_rule | RHEL 9 must be configured so that the cryptographic hashes of system files match vendor values.'
      debug:
        msg: "Manual hardening required for SV-257823r1051231_rule: RHEL 9 must be configured so that the cryptographic hashes of system files match vendor values. - Configure RHEL 9 so that the cryptographic hashes of system files match vendor values.  Given output Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257823r1051231_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: low
    # NIST: SI.02(6)
    # Description: <VulnDiscussion>Previous versions of software components that are not remov...
    # Fix Text: Configure RHEL 9 to remove all software components after updated versions h...
    - name: 'SV-257824r1044886_rule | RHEL 9 must remove all software components after updated versions have been installed.'
      debug:
        msg: "Manual hardening required for SV-257824r1044886_rule: RHEL 9 must remove all software components after updated versions have been installed. - Configure RHEL 9 to remove all software components after updated versions have been installed.  Edit Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257824r1044886_rule
        - other
        - severity_low
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.05(3)
    # Description: <VulnDiscussion>The Red Hat Subscription Manager application manages softwa...
    # Fix Text: The subscription-manager package can be installed with the following comman...
    - name: 'SV-257825r1044888_rule | RHEL 9 subscription-manager package must be installed.'
      package:
        name: subscription-manager
        state: present
      tags:
        - stig
        - SV-257825r1044888_rule
        - other
        - severity_medium
        - manual

    # Category: package
    # STIG Severity: high
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>The FTP service provides an unencrypted remote access that ...
    # Fix Text: The ftp package can be removed with the following command (using vsftpd as ...
    - name: 'SV-257826r1106299_rule | RHEL 9 must not have a File Transfer Protocol (FTP) server package installed.'
      package:
        name: vsftpd
        state: absent
      tags:
        - stig
        - SV-257826r1106299_rule
        - package
        - severity_high
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07.1(ii)
    # Description: <VulnDiscussion>The sendmail software was not developed with security in mi...
    # Fix Text: Remove the sendmail package with the following command - $ sudo dnf remove ...
    - name: 'SV-257827r1044892_rule | RHEL 9 must not have the sendmail package installed.'
      package:
        name: sendmail
        state: absent
      tags:
        - stig
        - SV-257827r1044892_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07.1(ii)
    # Description: <VulnDiscussion>"nfs-utils" provides a daemon for the kernel NFS server and...
    # Fix Text: Remove the nfs-utils package with the following command - $ sudo dnf remove...
    - name: 'SV-257828r1044894_rule | RHEL 9 must not have the nfs-utils package installed.'
      package:
        name: nfs-utils
        state: absent
      tags:
        - stig
        - SV-257828r1044894_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07.1(ii)
    # Description: <VulnDiscussion>The NIS service provides an unencrypted authentication serv...
    # Fix Text: Remove the ypserv package with the following command - $ sudo dnf remove yp...
    - name: 'SV-257829r1044896_rule | RHEL 9 must not have the ypserv package installed.'
      package:
        name: ypserv
        state: absent
      tags:
        - stig
        - SV-257829r1044896_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07.1(ii)
    # Description: <VulnDiscussion>The EPEL is a repository of high-quality open-source packag...
    # Fix Text: The repo package can be manually removed with the following command - $ sud...
    - name: 'SV-257830r1134906_rule | RHEL 9 must not install packages from the Extra Packages for Enterprise Linux (EPEL) repository.'
      package:
        name: epel-release
        state: absent
      tags:
        - stig
        - SV-257830r1134906_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07.1(ii)
    # Description: <VulnDiscussion>It is detrimental for operating systems to provide, or inst...
    # Fix Text: Remove the telnet-server package with the following command - $ sudo dnf re...
    - name: 'SV-257831r1044898_rule | RHEL 9 must not have the telnet-server package installed.'
      package:
        name: telnet-server
        state: absent
      tags:
        - stig
        - SV-257831r1044898_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07.1(ii)
    # Description: <VulnDiscussion>It is detrimental for operating systems to provide, or inst...
    # Fix Text: Remove the gssproxy package with the following command - $ sudo dnf remove ...
    - name: 'SV-257832r1044900_rule | RHEL 9 must not have the gssproxy package installed.'
      package:
        name: gssproxy
        state: absent
      tags:
        - stig
        - SV-257832r1044900_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07.1(ii)
    # Description: <VulnDiscussion>It is detrimental for operating systems to provide, or inst...
    # Fix Text: Remove the iprutils package with the following command - $ sudo dnf remove ...
    - name: 'SV-257833r1044902_rule | RHEL 9 must not have the iprutils package installed.'
      package:
        name: iprutils
        state: absent
      tags:
        - stig
        - SV-257833r1044902_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07.1(ii)
    # Description: <VulnDiscussion>It is detrimental for operating systems to provide, or inst...
    # Fix Text: Remove the tuned package with the following command - $ sudo dnf remove tun...
    - name: 'SV-257834r1044904_rule | RHEL 9 must not have the tuned package installed.'
      package:
        name: tuned
        state: absent
      tags:
        - stig
        - SV-257834r1044904_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: high
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Removing the "tftp-server" package decreases the risk of th...
    # Fix Text: The "tftp-server" package can be removed with the following command - $ sud...
    - name: 'SV-257835r1102037_rule | RHEL 9 must not have a Trivial File Transfer Protocol (TFTP) server package installed.'
      package:
        name: tftp-server
        state: absent
      tags:
        - stig
        - SV-257835r1102037_rule
        - other
        - severity_high
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Quagga is a network routing software suite providing implem...
    # Fix Text: Remove the quagga package with the following command - $ sudo dnf remove qu...
    - name: 'SV-257836r1044908_rule | RHEL 9 must not have the quagga package installed.'
      package:
        name: quagga
        state: absent
      tags:
        - stig
        - SV-257836r1044908_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Unnecessary service packages must not be installed to decre...
    # Fix Text: Document the requirement for a graphical user interface with the ISSO or re...
    - name: 'SV-257837r1044910_rule | A graphical display manager must not be installed on RHEL 9 unless approved.'
      debug:
        msg: "Manual hardening required for SV-257837r1044910_rule: A graphical display manager must not be installed on RHEL 9 unless approved. - Document the requirement for a graphical user interface with the ISSO or remove all xorg packages wi Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257837r1044910_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.02.1(1)
    # Description: <VulnDiscussion>Without the use of multifactor authentication, the ease of ...
    # Fix Text: The openssl-pkcs11 package can be installed with the following command - $ ...
    - name: 'SV-257838r1044912_rule | RHEL 9 must have the openssl-pkcs11 package installed.'
      package:
        name: openssl-pkcs11
        state: present
      tags:
        - stig
        - SV-257838r1044912_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>GnuTLS is a secure communications library implementing the ...
    # Fix Text: The gnutls-utils package can be installed with the following command - $ su...
    - name: 'SV-257839r991589_rule | RHEL 9 must have the gnutls-utils package installed.'
      package:
        name: gnutls-utils
        state: present
      tags:
        - stig
        - SV-257839r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Network Security Services (NSS) is a set of libraries desig...
    # Fix Text: The nss-tools package can be installed with the following command - $ sudo ...
    - name: 'SV-257840r991589_rule | RHEL 9 must have the nss-tools package installed.'
      package:
        name: nss-tools
        state: present
      tags:
        - stig
        - SV-257840r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>"rng-tools" provides hardware random number generator tools...
    # Fix Text: The rng-tools package can be installed with the following command - $ sudo ...
    - name: 'SV-257841r1044914_rule | RHEL 9 must have the rng-tools package installed.'
      package:
        name: rng-tools
        state: present
      tags:
        - stig
        - SV-257841r1044914_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.03(5)
    # Description: <VulnDiscussion>The "s-nail" package provides the mail command required to ...
    # Fix Text: The s-nail package can be installed with the following command - $ sudo dnf...
    - name: 'SV-257842r1044916_rule | RHEL 9 must have the s-nail package installed.'
      package:
        name: s-nail
        state: present
      tags:
        - stig
        - SV-257842r1044916_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Ensuring that "/home" is mounted on its own partition enabl...
    # Fix Text: Migrate the "/home" directory onto a separate file system/partition.
    - name: 'SV-257843r991589_rule | A separate RHEL 9 file system must be used for user home directories (such as /home or an equivalent).'
      debug:
        msg: "Manual hardening required for SV-257843r991589_rule: A separate RHEL 9 file system must be used for user home directories (such as /home or an equivalent - Migrate the '/home' directory onto a separate file system/partition. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257843r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/tmp" partition is used as temporary storage by many p...
    # Fix Text: Migrate the "/tmp" path onto a separate file system.
    - name: 'SV-257844r1044918_rule | RHEL 9 must use a separate file system for /tmp.'
      debug:
        msg: "Manual hardening required for SV-257844r1044918_rule: RHEL 9 must use a separate file system for /tmp. - Migrate the '/tmp' path onto a separate file system. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257844r1044918_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: low
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Ensuring that "/var" is mounted on its own partition enable...
    # Fix Text: Migrate the "/var" path onto a separate file system.
    - name: 'SV-257845r1044920_rule | RHEL 9 must use a separate file system for /var.'
      debug:
        msg: "Manual hardening required for SV-257845r1044920_rule: RHEL 9 must use a separate file system for /var. - Migrate the '/var' path onto a separate file system. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257845r1044920_rule
        - other
        - severity_low
        - manual

    # Category: other
    # STIG Severity: low
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Placing "/var/log" in its own partition enables better sepa...
    # Fix Text: Migrate the "/var/log" path onto a separate file system.
    - name: 'SV-257846r1044922_rule | RHEL 9 must use a separate file system for /var/log.'
      debug:
        msg: "Manual hardening required for SV-257846r1044922_rule: RHEL 9 must use a separate file system for /var/log. - Migrate the '/var/log' path onto a separate file system. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257846r1044922_rule
        - other
        - severity_low
        - manual

    # Category: other
    # STIG Severity: low
    # NIST: AU.04
    # Description: <VulnDiscussion>Placing "/var/log/audit" in its own partition enables bette...
    # Fix Text: Migrate the system audit data path onto a separate file system.
    - name: 'SV-257847r1044924_rule | RHEL 9 must use a separate file system for the system audit data path.'
      debug:
        msg: "Manual hardening required for SV-257847r1044924_rule: RHEL 9 must use a separate file system for the system audit data path. - Migrate the system audit data path onto a separate file system. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257847r1044924_rule
        - other
        - severity_low
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/var/tmp" partition is used as temporary storage by ma...
    # Fix Text: Migrate the "/var/tmp" path onto a separate file system.
    - name: 'SV-257848r1044926_rule | RHEL 9 must use a separate file system for /var/tmp.'
      debug:
        msg: "Manual hardening required for SV-257848r1044926_rule: RHEL 9 must use a separate file system for /var/tmp. - Migrate the '/var/tmp' path onto a separate file system. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257848r1044926_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.03.1(ii)
    # Description: <VulnDiscussion>An authentication process resists replay attacks if it is i...
    # Fix Text: Configure RHEL 9 to disable the ability to automount devices. The autofs se...
    - name: 'SV-257849r1044928_rule | RHEL 9 file system automount function must be disabled unless required.'
      systemd:
        name: can
        masked: yes
        state: stopped
      tags:
        - stig
        - SV-257849r1044928_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "nodev" mount option causes the system to not interpret...
    # Fix Text: Modify "/etc/fstab" to use the "nodev" option on the "/home" directory.
    - name: 'SV-257850r1044930_rule | RHEL 9 must prevent device files from being interpreted on file systems that contain user home directories.'
      debug:
        msg: "Manual hardening required for SV-257850r1044930_rule: RHEL 9 must prevent device files from being interpreted on file systems that contain user home direc - Modify '/etc/fstab' to use the 'nodev' option on the '/home' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257850r1044930_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "nosuid" mount option causes the system to not execute ...
    # Fix Text: Modify "/etc/fstab" to use the "nosuid" option on the "/home" directory.
    - name: 'SV-257851r1044932_rule | RHEL 9 must prevent files with the setuid and setgid bit set from being executed on file systems that contain user home directories.'
      debug:
        msg: "Manual hardening required for SV-257851r1044932_rule: RHEL 9 must prevent files with the setuid and setgid bit set from being executed on file systems tha - Modify '/etc/fstab' to use the 'nosuid' option on the '/home' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257851r1044932_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "noexec" mount option causes the system to not execute ...
    # Fix Text: Modify "/etc/fstab" to use the "noexec" option on the "/home" directory.
    - name: 'SV-257852r991589_rule | RHEL 9 must prevent code from being executed on file systems that contain user home directories.'
      debug:
        msg: "Manual hardening required for SV-257852r991589_rule: RHEL 9 must prevent code from being executed on file systems that contain user home directories. - Modify '/etc/fstab' to use the 'noexec' option on the '/home' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257852r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "nodev" mount option causes the system to not interpret...
    # Fix Text: Update each NFS mounted file system to use the "nodev" option on file syste...
    - name: 'SV-257854r1044934_rule | RHEL 9 must prevent special devices on file systems that are imported via Network File System (NFS).'
      debug:
        msg: "Manual hardening required for SV-257854r1044934_rule: RHEL 9 must prevent special devices on file systems that are imported via Network File System (NFS). - Update each NFS mounted file system to use the 'nodev' option on file systems that are being importe Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257854r1044934_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "noexec" mount option causes the system not to execute ...
    # Fix Text: Update each NFS mounted file system to use the "noexec" option on file syst...
    - name: 'SV-257855r1044936_rule | RHEL 9  must prevent code from being executed on file systems that are imported via Network File System (NFS).'
      debug:
        msg: "Manual hardening required for SV-257855r1044936_rule: RHEL 9  must prevent code from being executed on file systems that are imported via Network File Sys - Update each NFS mounted file system to use the 'noexec' option on file systems that are being import Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257855r1044936_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "nosuid" mount option causes the system not to execute ...
    # Fix Text: Update each NFS mounted file system to use the "nosuid" option on file syst...
    - name: 'SV-257856r1044938_rule | RHEL 9 must prevent files with the setuid and setgid bit set from being executed on file systems that are imported via Network File System (NFS).'
      debug:
        msg: "Manual hardening required for SV-257856r1044938_rule: RHEL 9 must prevent files with the setuid and setgid bit set from being executed on file systems tha - Update each NFS mounted file system to use the 'nosuid' option on file systems that are being import Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257856r1044938_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "noexec" mount option causes the system not to execute ...
    # Fix Text: Configure the "/etc/fstab" to use the "noexec" option on file systems that ...
    - name: 'SV-257857r991589_rule | RHEL 9 must prevent code from being executed on file systems that are used with removable media.'
      debug:
        msg: "Manual hardening required for SV-257857r991589_rule: RHEL 9 must prevent code from being executed on file systems that are used with removable media. - Configure the '/etc/fstab' to use the 'noexec' option on file systems that are associated with remov Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257857r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "nodev" mount option causes the system not to interpret...
    # Fix Text: Configure the "/etc/fstab" to use the "nodev" option on file systems that a...
    - name: 'SV-257858r991589_rule | RHEL 9 must prevent special devices on file systems that are used with removable media.'
      debug:
        msg: "Manual hardening required for SV-257858r991589_rule: RHEL 9 must prevent special devices on file systems that are used with removable media. - Configure the '/etc/fstab' to use the 'nodev' option on file systems that are associated with remova Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257858r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "nosuid" mount option causes the system not to execute ...
    # Fix Text: Configure the "/etc/fstab" to use the "nosuid" option on file systems that ...
    - name: 'SV-257859r991589_rule | RHEL 9 must prevent files with the setuid and setgid bit set from being executed on file systems that are used with removable media.'
      debug:
        msg: "Manual hardening required for SV-257859r991589_rule: RHEL 9 must prevent files with the setuid and setgid bit set from being executed on file systems tha - Configure the '/etc/fstab' to use the 'nosuid' option on file systems that are associated with remov Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257859r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The only legitimate location for device files is the "/dev"...
    # Fix Text: Modify "/etc/fstab" to use the "nodev" option on the "/boot" directory.
    - name: 'SV-257860r1044940_rule | RHEL 9 must mount /boot with the nodev option.'
      debug:
        msg: "Manual hardening required for SV-257860r1044940_rule: RHEL 9 must mount /boot with the nodev option. - Modify '/etc/fstab' to use the 'nodev' option on the '/boot' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257860r1044940_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "nosuid" mount option causes the system not to execute ...
    # Fix Text: Modify "/etc/fstab" to use the "nosuid" option on the "/boot" directory.
    - name: 'SV-257861r1044941_rule | RHEL 9 must prevent files with the setuid and setgid bit set from being executed on the /boot directory.'
      debug:
        msg: "Manual hardening required for SV-257861r1044941_rule: RHEL 9 must prevent files with the setuid and setgid bit set from being executed on the /boot direct - Modify '/etc/fstab' to use the 'nosuid' option on the '/boot' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257861r1044941_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "nosuid" mount option causes the system not to execute ...
    # Fix Text: Modify "/etc/fstab" to use the "nosuid" option on the "/boot/efi" directory...
    - name: 'SV-257862r1134908_rule | RHEL 9 must prevent files with the setuid and setgid bit set from being executed on the /boot/efi directory.'
      debug:
        msg: "Manual hardening required for SV-257862r1134908_rule: RHEL 9 must prevent files with the setuid and setgid bit set from being executed on the /boot/efi di - Modify '/etc/fstab' to use the 'nosuid' option on the '/boot/efi' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257862r1134908_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "nodev" mount option causes the system to not interpret...
    # Fix Text: Modify "/etc/fstab" to use the "nodev" option on the "/dev/shm" file system...
    - name: 'SV-257863r958804_rule | RHEL 9 must mount /dev/shm with the nodev option.'
      debug:
        msg: "Manual hardening required for SV-257863r958804_rule: RHEL 9 must mount /dev/shm with the nodev option. - Modify '/etc/fstab' to use the 'nodev' option on the '/dev/shm' file system. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257863r958804_rule
        - other
        - severity_medium
        - manual

    # Category: service
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "noexec" mount option causes the system to not execute ...
    # Fix Text: Configure "/dev/shm" to mount with the "noexec" option. Determine how /dev/...
    - name: 'SV-257864r1106304_rule | RHEL 9 must mount /dev/shm with the noexec option.'
      systemd:
        name: tmp.mount
        masked: yes
        state: stopped
      tags:
        - stig
        - SV-257864r1106304_rule
        - service
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "nosuid" mount option causes the system to not execute ...
    # Fix Text: Modify "/etc/fstab" to use the "nosuid" option on the "/dev/shm" file syste...
    - name: 'SV-257865r1044946_rule | RHEL 9 must mount /dev/shm with the nosuid option.'
      debug:
        msg: "Manual hardening required for SV-257865r1044946_rule: RHEL 9 must mount /dev/shm with the nosuid option. - Modify '/etc/fstab' to use the 'nosuid' option on the '/dev/shm' file system. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257865r1044946_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "nodev" mount option causes the system to not interpret...
    # Fix Text: Modify "/etc/fstab" to use the "nodev" option on the "/tmp" directory.
    - name: 'SV-257866r958804_rule | RHEL 9 must mount /tmp with the nodev option.'
      debug:
        msg: "Manual hardening required for SV-257866r958804_rule: RHEL 9 must mount /tmp with the nodev option. - Modify '/etc/fstab' to use the 'nodev' option on the '/tmp' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257866r958804_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "noexec" mount option causes the system to not execute ...
    # Fix Text: Modify "/etc/fstab" to use the "noexec" option on the "/tmp" directory.
    - name: 'SV-257867r958804_rule | RHEL 9 must mount /tmp with the noexec option.'
      debug:
        msg: "Manual hardening required for SV-257867r958804_rule: RHEL 9 must mount /tmp with the noexec option. - Modify '/etc/fstab' to use the 'noexec' option on the '/tmp' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257867r958804_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "nosuid" mount option causes the system to not execute ...
    # Fix Text: Modify "/etc/fstab" to use the "nosuid" option on the "/tmp" directory.
    - name: 'SV-257868r958804_rule | RHEL 9 must mount /tmp with the nosuid option.'
      debug:
        msg: "Manual hardening required for SV-257868r958804_rule: RHEL 9 must mount /tmp with the nosuid option. - Modify '/etc/fstab' to use the 'nosuid' option on the '/tmp' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257868r958804_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "nodev" mount option causes the system to not interpret...
    # Fix Text: Modify "/etc/fstab" to use the "nodev" option on the "/var" directory.
    - name: 'SV-257869r1102009_rule | RHEL 9 must mount /var with the nodev option.'
      debug:
        msg: "Manual hardening required for SV-257869r1102009_rule: RHEL 9 must mount /var with the nodev option. - Modify '/etc/fstab' to use the 'nodev' option on the '/var' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257869r1102009_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "nodev" mount option causes the system to not interpret...
    # Fix Text: Modify "/etc/fstab" to use the "nodev" option on the "/var/log" directory.
    - name: 'SV-257870r958804_rule | RHEL 9 must mount /var/log with the nodev option.'
      debug:
        msg: "Manual hardening required for SV-257870r958804_rule: RHEL 9 must mount /var/log with the nodev option. - Modify '/etc/fstab' to use the 'nodev' option on the '/var/log' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257870r958804_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "noexec" mount option causes the system to not execute ...
    # Fix Text: Modify "/etc/fstab" to use the "noexec" option on the "/var/log" directory.
    - name: 'SV-257871r958804_rule | RHEL 9 must mount /var/log with the noexec option.'
      debug:
        msg: "Manual hardening required for SV-257871r958804_rule: RHEL 9 must mount /var/log with the noexec option. - Modify '/etc/fstab' to use the 'noexec' option on the '/var/log' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257871r958804_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "nosuid" mount option causes the system to not execute ...
    # Fix Text: Modify "/etc/fstab" to use the "nosuid" option on the "/var/log" directory.
    - name: 'SV-257872r958804_rule | RHEL 9 must mount /var/log with the nosuid option.'
      debug:
        msg: "Manual hardening required for SV-257872r958804_rule: RHEL 9 must mount /var/log with the nosuid option. - Modify '/etc/fstab' to use the 'nosuid' option on the '/var/log' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257872r958804_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "nodev" mount option causes the system to not interpret...
    # Fix Text: Modify "/etc/fstab" to use the "nodev" option on the "/var/log/audit" direc...
    - name: 'SV-257873r958804_rule | RHEL 9 must mount /var/log/audit with the nodev option.'
      debug:
        msg: "Manual hardening required for SV-257873r958804_rule: RHEL 9 must mount /var/log/audit with the nodev option. - Modify '/etc/fstab' to use the 'nodev' option on the '/var/log/audit' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257873r958804_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "noexec" mount option causes the system to not execute ...
    # Fix Text: Modify "/etc/fstab" to use the "noexec" option on the "/var/log/audit" dire...
    - name: 'SV-257874r958804_rule | RHEL 9 must mount /var/log/audit with the noexec option.'
      debug:
        msg: "Manual hardening required for SV-257874r958804_rule: RHEL 9 must mount /var/log/audit with the noexec option. - Modify '/etc/fstab' to use the 'noexec' option on the '/var/log/audit' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257874r958804_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "nosuid" mount option causes the system to not execute ...
    # Fix Text: Modify "/etc/fstab" to use the "nosuid" option on the "/var/log/audit" dire...
    - name: 'SV-257875r958804_rule | RHEL 9 must mount /var/log/audit with the nosuid option.'
      debug:
        msg: "Manual hardening required for SV-257875r958804_rule: RHEL 9 must mount /var/log/audit with the nosuid option. - Modify '/etc/fstab' to use the 'nosuid' option on the '/var/log/audit' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257875r958804_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "nodev" mount option causes the system to not interpret...
    # Fix Text: Modify "/etc/fstab" to use the "nodev" option on the "/var/tmp" directory.
    - name: 'SV-257876r958804_rule | RHEL 9 must mount /var/tmp with the nodev option.'
      debug:
        msg: "Manual hardening required for SV-257876r958804_rule: RHEL 9 must mount /var/tmp with the nodev option. - Modify '/etc/fstab' to use the 'nodev' option on the '/var/tmp' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257876r958804_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "noexec" mount option causes the system to not execute ...
    # Fix Text: Modify "/etc/fstab" to use the "noexec" option on the "/var/tmp" directory.
    - name: 'SV-257877r958804_rule | RHEL 9 must mount /var/tmp with the noexec option.'
      debug:
        msg: "Manual hardening required for SV-257877r958804_rule: RHEL 9 must mount /var/tmp with the noexec option. - Modify '/etc/fstab' to use the 'noexec' option on the '/var/tmp' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257877r958804_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The "nosuid" mount option causes the system to not execute ...
    # Fix Text: Modify "/etc/fstab" to use the "nosuid" option on the "/var/tmp" directory.
    - name: 'SV-257878r958804_rule | RHEL 9 must mount /var/tmp with the nosuid option.'
      debug:
        msg: "Manual hardening required for SV-257878r958804_rule: RHEL 9 must mount /var/tmp with the nosuid option. - Modify '/etc/fstab' to use the 'nosuid' option on the '/var/tmp' directory. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257878r958804_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: high
    # NIST: SC.28.1
    # Description: <VulnDiscussion>RHEL 9 systems handling data requiring "data at rest" prote...
    # Fix Text: Configure RHEL 9 to prevent unauthorized modification of all information at...
    - name: 'SV-257879r1045454_rule | RHEL 9 local disk partitions must implement cryptographic mechanisms to prevent unauthorized disclosure or modification of all information that requires at rest protection.'
      debug:
        msg: "Manual hardening required for SV-257879r1045454_rule: RHEL 9 local disk partitions must implement cryptographic mechanisms to prevent unauthorized disclos - Configure RHEL 9 to prevent unauthorized modification of all information at rest by using disk encry Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257879r1045454_rule
        - other
        - severity_high
        - manual

    # Category: other
    # STIG Severity: low
    # NIST: CM.07.1(ii)
    # Description: <VulnDiscussion>It is detrimental for operating systems to provide, or inst...
    # Fix Text: To configure the system to prevent the cramfs kernel module from being load...
    - name: 'SV-257880r1044951_rule | RHEL 9 must disable mounting of cramfs.'
      debug:
        msg: "Manual hardening required for SV-257880r1044951_rule: RHEL 9 must disable mounting of cramfs. - To configure the system to prevent the cramfs kernel module from being loaded, add the following lin Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257880r1044951_rule
        - other
        - severity_low
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "nodev" mount option causes the system to not interpret...
    # Fix Text: Configure the "/etc/fstab" to use the "nodev" option on all non-root local ...
    - name: 'SV-257881r991589_rule | RHEL 9 must prevent special devices on non-root local partitions.'
      debug:
        msg: "Manual hardening required for SV-257881r991589_rule: RHEL 9 must prevent special devices on non-root local partitions. - Configure the '/etc/fstab' to use the 'nodev' option on all non-root local partitions. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257881r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.05.1(6)
    # Description: <VulnDiscussion>If RHEL 9 allowed any user to make changes to software libr...
    # Fix Text: Configure the system commands to be protected from unauthorized access. Run...
    - name: 'SV-257882r991560_rule | RHEL 9 system commands must have mode 755 or less permissive.'
      debug:
        msg: "Manual hardening required for SV-257882r991560_rule: RHEL 9 system commands must have mode 755 or less permissive. - Configure the system commands to be protected from unauthorized access.  Run the following command,  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257882r991560_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.05.1(6)
    # Description: <VulnDiscussion>If RHEL 9 allowed any user to make changes to software libr...
    # Fix Text: Configure the system-wide shared library directories (/lib, /lib64, /usr/li...
    - name: 'SV-257883r991560_rule | RHEL 9 library directories must have mode 755 or less permissive.'
      file:
        path: /usr/lib
        mode: '755'
        state: file
      tags:
        - stig
        - SV-257883r991560_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.05.1(6)
    # Description: <VulnDiscussion>If RHEL 9 allowed any user to make changes to software libr...
    # Fix Text: Configure the systemwide shared library files contained in the directories ...
    - name: 'SV-257884r1106306_rule | RHEL 9 library files must have mode 755 or less permissive.'
      file:
        path: /usr/lib
        mode: '0755'
        state: file
      tags:
        - stig
        - SV-257884r1106306_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SI.11.1(iv)
    # Description: <VulnDiscussion>Only authorized personnel should be aware of errors and the...
    # Fix Text: Configure the "/var/log" directory to a mode of "0755" by running the follo...
    - name: 'SV-257885r1044953_rule | RHEL 9 /var/log directory must have mode 0755 or less permissive.'
      file:
        path: /var/log
        mode: '0755'
        state: file
      tags:
        - stig
        - SV-257885r1044953_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SI.11.1(iv)
    # Description: <VulnDiscussion>Only authorized personnel should be aware of errors and the...
    # Fix Text: Configure the "/var/log/messages" file to have a mode of "0640" by running ...
    - name: 'SV-257886r1044955_rule | RHEL 9 /var/log/messages file must have mode 0640 or less permissive.'
      file:
        path: /var/log/messages
        mode: '0640'
        state: file
      tags:
        - stig
        - SV-257886r1044955_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.09.1
    # Description: <VulnDiscussion>Protecting audit information also includes identifying and ...
    # Fix Text: Configure the audit tools to have a mode of "0755" by running the following...
    - name: 'SV-257887r991557_rule | RHEL 9 audit tools must have a mode of 0755 or less permissive.'
      shell: |
        chmod 0755 [audit_tool]
      tags:
        - stig
        - SV-257887r991557_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>If the permissions of cron configuration files or directori...
    # Fix Text: Run the following commands to restore the permissions of cron configuration...
    - name: 'SV-257888r1134910_rule | RHEL 9 permissions of cron configuration files and directories must not be modified from the operating system defaults.'
      debug:
        msg: "Manual hardening required for SV-257888r1134910_rule: RHEL 9 permissions of cron configuration files and directories must not be modified from the operati - Run the following commands to restore the permissions of cron configuration files and directories to Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257888r1134910_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Local initialization files are used to configure the user's...
    # Fix Text: Set the mode of the local initialization files to "0740" with the following...
    - name: 'SV-257889r1044959_rule | All RHEL 9 local initialization files must have mode 0740 or less permissive.'
      file:
        path: /home/wadea
        mode: '0740'
        state: file
      tags:
        - stig
        - SV-257889r1044959_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Excessive permissions on local interactive user home direct...
    # Fix Text: Change the mode of interactive user's home directories to "0750". To change...
    - name: 'SV-257890r1044961_rule | All RHEL 9 local interactive user home directories must have mode 0750 or less permissive.'
      file:
        path: /home/wadea
        mode: '0750'
        state: file
      tags:
        - stig
        - SV-257890r1044961_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/group" file contains information regarding groups...
    # Fix Text: Change the mode of the file "/etc/group" to "0644" by running the following...
    - name: 'SV-257891r991589_rule | RHEL 9 /etc/group file must have mode 0644 or less permissive to prevent unauthorized access.'
      file:
        path: /etc/group
        mode: '0644'
        state: file
      tags:
        - stig
        - SV-257891r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/group-" file is a backup file of "/etc/group", an...
    # Fix Text: Change the mode of the file "/etc/group-" to "0644" by running the followin...
    - name: 'SV-257892r991589_rule | RHEL 9 /etc/group- file must have mode 0644 or less permissive to prevent unauthorized access.'
      file:
        path: /etc/group-
        mode: '0644'
        state: file
      tags:
        - stig
        - SV-257892r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/gshadow" file contains group password hashes. Pro...
    # Fix Text: Change the mode of the file "/etc/gshadow" to "0000" by running the followi...
    - name: 'SV-257893r991589_rule | RHEL 9 /etc/gshadow file must have mode 0000 or less permissive to prevent unauthorized access.'
      file:
        path: /etc/gshadow
        mode: '0000'
        state: file
      tags:
        - stig
        - SV-257893r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/gshadow-" file is a backup of "/etc/gshadow", and...
    # Fix Text: Change the mode of the file "/etc/gshadow-" to "0000" by running the follow...
    - name: 'SV-257894r991589_rule | RHEL 9 /etc/gshadow- file must have mode 0000 or less permissive to prevent unauthorized access.'
      file:
        path: /etc/gshadow-
        mode: '0000'
        state: file
      tags:
        - stig
        - SV-257894r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>If the "/etc/passwd" file is writable by a group-owner or t...
    # Fix Text: Change the mode of the file "/etc/passwd" to "0644" by running the followin...
    - name: 'SV-257895r991589_rule | RHEL 9 /etc/passwd file must have mode 0644 or less permissive to prevent unauthorized access.'
      file:
        path: /etc/passwd
        mode: '0644'
        state: file
      tags:
        - stig
        - SV-257895r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/passwd-" file is a backup file of "/etc/passwd", ...
    # Fix Text: Change the mode of the file "/etc/passwd-" to "0644" by running the followi...
    - name: 'SV-257896r991589_rule | RHEL 9 /etc/passwd- file must have mode 0644 or less permissive to prevent unauthorized access.'
      file:
        path: /etc/passwd-
        mode: '0644'
        state: file
      tags:
        - stig
        - SV-257896r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/shadow-" file is a backup file of "/etc/shadow", ...
    # Fix Text: Change the mode of the file "/etc/shadow-" to "0000" by running the followi...
    - name: 'SV-257897r991589_rule | RHEL 9 /etc/shadow- file must have mode 0000 or less permissive to prevent unauthorized access.'
      file:
        path: /etc/shadow-
        mode: '0000'
        state: file
      tags:
        - stig
        - SV-257897r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/group" file contains information regarding groups...
    # Fix Text: Change the owner of the file /etc/group to root by running the following co...
    - name: 'SV-257898r991589_rule | RHEL 9 /etc/group file must be owned by root.'
      shell: |
        chown root /etc/group
      tags:
        - stig
        - SV-257898r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/group" file contains information regarding groups...
    # Fix Text: Change the group of the file /etc/group to root by running the following co...
    - name: 'SV-257899r991589_rule | RHEL 9 /etc/group file must be group-owned by root.'
      debug:
        msg: "Manual hardening required for SV-257899r991589_rule: RHEL 9 /etc/group file must be group-owned by root. - Change the group of the file /etc/group to root by running the following command:  $ sudo chgrp root Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257899r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/group-" file is a backup file of "/etc/group", an...
    # Fix Text: Change the owner of the file /etc/group- to root by running the following c...
    - name: 'SV-257900r991589_rule | RHEL 9 /etc/group- file must be owned by root.'
      shell: |
        chown root /etc/group-
      tags:
        - stig
        - SV-257900r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/group-" file is a backup file of "/etc/group", an...
    # Fix Text: Change the group of the file /etc/group- to root by running the following c...
    - name: 'SV-257901r991589_rule | RHEL 9 /etc/group- file must be group-owned by root.'
      debug:
        msg: "Manual hardening required for SV-257901r991589_rule: RHEL 9 /etc/group- file must be group-owned by root. - Change the group of the file /etc/group- to root by running the following command:  $ sudo chgrp roo Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257901r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/gshadow" file contains group password hashes. Pro...
    # Fix Text: Change the owner of the file /etc/gshadow to root by running the following ...
    - name: 'SV-257902r991589_rule | RHEL 9 /etc/gshadow file must be owned by root.'
      shell: |
        chown root /etc/gshadow
      tags:
        - stig
        - SV-257902r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/gshadow" file contains group password hashes. Pro...
    # Fix Text: Change the group of the file /etc/gshadow to root by running the following ...
    - name: 'SV-257903r991589_rule | RHEL 9 /etc/gshadow file must be group-owned by root.'
      debug:
        msg: "Manual hardening required for SV-257903r991589_rule: RHEL 9 /etc/gshadow file must be group-owned by root. - Change the group of the file /etc/gshadow to root by running the following command:  $ sudo chgrp ro Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257903r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/gshadow-" file is a backup of "/etc/gshadow", and...
    # Fix Text: Change the owner of the file /etc/gshadow- to root by running the following...
    - name: 'SV-257904r991589_rule | RHEL 9 /etc/gshadow- file must be owned by root.'
      shell: |
        chown root /etc/gshadow-
      tags:
        - stig
        - SV-257904r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/gshadow-" file is a backup of "/etc/gshadow", and...
    # Fix Text: Change the group of the file /etc/gshadow- to root by running the following...
    - name: 'SV-257905r991589_rule | RHEL 9 /etc/gshadow- file must be group-owned by root.'
      debug:
        msg: "Manual hardening required for SV-257905r991589_rule: RHEL 9 /etc/gshadow- file must be group-owned by root. - Change the group of the file /etc/gshadow- to root by running the following command:  $ sudo chgrp r Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257905r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/passwd" file contains information about the users...
    # Fix Text: Change the owner of the file /etc/passwd to root by running the following c...
    - name: 'SV-257906r991589_rule | RHEL 9 /etc/passwd file must be owned by root.'
      shell: |
        chown root /etc/passwd
      tags:
        - stig
        - SV-257906r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/passwd" file contains information about the users...
    # Fix Text: Change the group of the file /etc/passwd to root by running the following c...
    - name: 'SV-257907r991589_rule | RHEL 9 /etc/passwd file must be group-owned by root.'
      shell: |
        chgrp root /etc/passwd
      tags:
        - stig
        - SV-257907r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/passwd-" file is a backup file of "/etc/passwd", ...
    # Fix Text: Change the owner of the file /etc/passwd- to root by running the following ...
    - name: 'SV-257908r991589_rule | RHEL 9 /etc/passwd- file must be owned by root.'
      shell: |
        chown root /etc/passwd-
      tags:
        - stig
        - SV-257908r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/passwd-" file is a backup file of "/etc/passwd", ...
    # Fix Text: Change the group of the file /etc/passwd- to root by running the following ...
    - name: 'SV-257909r991589_rule | RHEL 9 /etc/passwd- file must be group-owned by root.'
      shell: |
        chgrp root /etc/passwd-
      tags:
        - stig
        - SV-257909r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/shadow" file contains the list of local system ac...
    # Fix Text: Change the owner of the file /etc/shadow to root by running the following c...
    - name: 'SV-257910r991589_rule | RHEL 9 /etc/shadow file must be owned by root.'
      shell: |
        chown root /etc/shadow
      tags:
        - stig
        - SV-257910r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/shadow" file stores password hashes. Protection o...
    # Fix Text: Change the group of the file /etc/shadow to root by running the following c...
    - name: 'SV-257911r991589_rule | RHEL 9 /etc/shadow file must be group-owned by root.'
      debug:
        msg: "Manual hardening required for SV-257911r991589_rule: RHEL 9 /etc/shadow file must be group-owned by root. - Change the group of the file /etc/shadow to root by running the following command:  $ sudo chgrp roo Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257911r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/shadow-" file is a backup file of "/etc/shadow", ...
    # Fix Text: Change the owner of the file /etc/shadow- to root by running the following ...
    - name: 'SV-257912r991589_rule | RHEL 9 /etc/shadow- file must be owned by root.'
      shell: |
        chown root /etc/shadow-
      tags:
        - stig
        - SV-257912r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/shadow-" file is a backup file of "/etc/shadow", ...
    # Fix Text: Change the group of the file /etc/shadow- to root by running the following ...
    - name: 'SV-257913r991589_rule | RHEL 9 /etc/shadow- file must be group-owned by root.'
      debug:
        msg: "Manual hardening required for SV-257913r991589_rule: RHEL 9 /etc/shadow- file must be group-owned by root. - Change the group of the file /etc/shadow- to root by running the following command:  $ sudo chgrp ro Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257913r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SI.11.1(iv)
    # Description: <VulnDiscussion>Only authorized personnel should be aware of errors and the...
    # Fix Text: Configure the owner of the directory "/var/log" to "root" by running the fo...
    - name: 'SV-257914r1044969_rule | RHEL 9 /var/log directory must be owned by root.'
      shell: |
        chown root /var/log
      tags:
        - stig
        - SV-257914r1044969_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SI.11.1(iv)
    # Description: <VulnDiscussion>Only authorized personnel should be aware of errors and the...
    # Fix Text: Configure the group owner of the directory "/var/log" to "root" by running ...
    - name: 'SV-257915r1044971_rule | RHEL 9 /var/log directory must be group-owned by root.'
      debug:
        msg: "Manual hardening required for SV-257915r1044971_rule: RHEL 9 /var/log directory must be group-owned by root. - Configure the group owner of the directory '/var/log' to 'root' by running the following command:  $ Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257915r1044971_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SI.11.1(iv)
    # Description: <VulnDiscussion>Only authorized personnel should be aware of errors and the...
    # Fix Text: Change the owner of the "/var/log/messages" file to "root" by running the f...
    - name: 'SV-257916r1101916_rule | RHEL 9 /var/log/messages file must be owned by root.'
      shell: |
        chown root /var/log/messages
      tags:
        - stig
        - SV-257916r1101916_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SI.11.1(iv)
    # Description: <VulnDiscussion>Only authorized personnel should be aware of errors and the...
    # Fix Text: Change the group owner of the "/var/log/messages" file to "root" by running...
    - name: 'SV-257917r1101914_rule | RHEL 9 /var/log/messages file must be group-owned by root.'
      shell: |
        chgrp root /var/log/messages
      tags:
        - stig
        - SV-257917r1101914_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.05.1(6)
    # Description: <VulnDiscussion>If RHEL 9 allowed any user to make changes to software libr...
    # Fix Text: Configure the system commands to be protected from unauthorized access. Run...
    - name: 'SV-257918r1044977_rule | RHEL 9 system commands must be owned by root.'
      debug:
        msg: "Manual hardening required for SV-257918r1044977_rule: RHEL 9 system commands must be owned by root. - Configure the system commands to be protected from unauthorized access.  Run the following command,  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257918r1044977_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.05.1(6)
    # Description: <VulnDiscussion>If RHEL 9 allowed any user to make changes to software libr...
    # Fix Text: Configure the system commands to be protected from unauthorized access. Run...
    - name: 'SV-257919r1044979_rule | RHEL 9 system commands must be group-owned by root or a system account.'
      debug:
        msg: "Manual hardening required for SV-257919r1044979_rule: RHEL 9 system commands must be group-owned by root or a system account. - Configure the system commands to be protected from unauthorized access.  Run the following command,  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257919r1044979_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.05.1(6)
    # Description: <VulnDiscussion>If RHEL 9 allowed any user to make changes to software libr...
    # Fix Text: Configure the systemwide shared library files contained in the directories ...
    - name: 'SV-257920r1101926_rule | RHEL 9 library files must be owned by root.'
      shell: |
        find /lib /lib64 /usr/lib /usr/lib64 -type f -name '*.so*' ! -user root -exec chown root {} +
      tags:
        - stig
        - SV-257920r1101926_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.05.1(6)
    # Description: <VulnDiscussion>If RHEL 9 allowed any user to make changes to software libr...
    # Fix Text: Configure the systemwide shared library files contained in the directories ...
    - name: 'SV-257921r1106308_rule | RHEL 9 library files must be group-owned by root or a system account.'
      shell: |
        find /lib /lib64 /usr/lib /usr/lib64 -type f -name '*.so*' ! -group root -exec chown :root {} +
      tags:
        - stig
        - SV-257921r1106308_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.05.1(6)
    # Description: <VulnDiscussion>If RHEL 9 allowed any user to make changes to software libr...
    # Fix Text: Configure the systemwide shared library directories within (/lib, /lib64, /...
    - name: 'SV-257922r1044988_rule | RHEL 9 library directories must be owned by root.'
      debug:
        msg: "Manual hardening required for SV-257922r1044988_rule: RHEL 9 library directories must be owned by root. - Configure the systemwide shared library directories within (/lib, /lib64, /usr/lib and /usr/lib64) t Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257922r1044988_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.05.1(6)
    # Description: <VulnDiscussion>If RHEL 9 allowed any user to make changes to software libr...
    # Fix Text: Configure the systemwide shared library directories (/lib, /lib64, /usr/lib...
    - name: 'SV-257923r1044991_rule | RHEL 9 library directories must be group-owned by root or a system account.'
      debug:
        msg: "Manual hardening required for SV-257923r1044991_rule: RHEL 9 library directories must be group-owned by root or a system account. - Configure the systemwide shared library directories (/lib, /lib64, /usr/lib and /usr/lib64) to be pr Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257923r1044991_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.09.1
    # Description: <VulnDiscussion>Protecting audit information also includes identifying and ...
    # Fix Text: Configure the audit tools to be owned by "root" by running the following co...
    - name: 'SV-257924r991557_rule | RHEL 9 audit tools must be owned by root.'
      shell: |
        chown root [audit_tool]
      tags:
        - stig
        - SV-257924r991557_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.09.1
    # Description: <VulnDiscussion>Protecting audit information also includes identifying and ...
    # Fix Text: Configure the audit tools to be group-owned by "root" by running the follow...
    - name: 'SV-257925r991557_rule | RHEL 9 audit tools must be group-owned by root.'
      debug:
        msg: "Manual hardening required for SV-257925r991557_rule: RHEL 9 audit tools must be group-owned by root. - Configure the audit tools to be group-owned by 'root' by running the following command:  $ sudo chgr Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257925r991557_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Service configuration files enable or disable features of t...
    # Fix Text: Configure any cron configuration not owned by root with the following comma...
    - name: 'SV-257926r991589_rule | RHEL 9 cron configuration files directory must be owned by root.'
      debug:
        msg: "Manual hardening required for SV-257926r991589_rule: RHEL 9 cron configuration files directory must be owned by root. - Configure any cron configuration not owned by root with the following command:  $ sudo chown root [c Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257926r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Service configuration files enable or disable features of t...
    # Fix Text: Configure any cron configuration not group-owned by root with the following...
    - name: 'SV-257927r991589_rule | RHEL 9 cron configuration files directory must be group-owned by root.'
      debug:
        msg: "Manual hardening required for SV-257927r991589_rule: RHEL 9 cron configuration files directory must be group-owned by root. - Configure any cron configuration not group-owned by root with the following command:  $ sudo chgrp r Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257927r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SC.04.1
    # Description: <VulnDiscussion>If a world-writable directory is not owned by root, sys, bi...
    # Fix Text: Configure all public directories to be owned by root or a system account to...
    - name: 'SV-257928r1044992_rule | All RHEL 9 world-writable directories must be owned by root, sys, bin, or an application user.'
      debug:
        msg: "Manual hardening required for SV-257928r1044992_rule: All RHEL 9 world-writable directories must be owned by root, sys, bin, or an application user. - Configure all public directories to be owned by root or a system account to prevent unauthorized and Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257928r1044992_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SC.04.1
    # Description: <VulnDiscussion>Preventing unauthorized information transfers mitigates the...
    # Fix Text: Configure all world-writable directories to have the sticky bit set to prev...
    - name: 'SV-257929r1117267_rule | A sticky bit must be set on all RHEL 9 public directories.'
      shell: |
        chmod a+t [World-Writable Directory]
      tags:
        - stig
        - SV-257929r1117267_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Files without a valid group owner may be unintentionally in...
    # Fix Text: Either remove all files and directories from RHEL 9 that do not have a vali...
    - name: 'SV-257930r991589_rule | All RHEL 9 local files and directories must have a valid group owner.'
      debug:
        msg: "Manual hardening required for SV-257930r991589_rule: All RHEL 9 local files and directories must have a valid group owner. - Either remove all files and directories from RHEL 9 that do not have a valid group, or assign a vali Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257930r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Unowned files and directories may be unintentionally inheri...
    # Fix Text: Either remove all files and directories from the system that do not have a ...
    - name: 'SV-257931r991589_rule | All RHEL 9 local files and directories must have a valid owner.'
      debug:
        msg: "Manual hardening required for SV-257931r991589_rule: All RHEL 9 local files and directories must have a valid owner. - Either remove all files and directories from the system that do not have a valid user, or assign a v Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257931r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>If an unauthorized or modified device is allowed to exist o...
    # Fix Text: Restore the SELinux policy for the affected device file from the system pol...
    - name: 'SV-257932r1014838_rule | RHEL 9 must be configured so that all system device files are correctly labeled to prevent unauthorized modification.'
      debug:
        msg: "Manual hardening required for SV-257932r1014838_rule: RHEL 9 must be configured so that all system device files are correctly labeled to prevent unauthori - Restore the SELinux policy for the affected device file from the system policy database using the fo Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257932r1014838_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "/etc/shadow" file contains the list of local system ac...
    # Fix Text: Change the mode of the file "/etc/shadow" to "0000" by running the followin...
    - name: 'SV-257934r991589_rule | RHEL 9 /etc/shadow file must have mode 0000 to prevent unauthorized access.'
      file:
        path: /etc/shadow
        mode: '0000'
        state: file
      tags:
        - stig
        - SV-257934r991589_rule
        - other
        - severity_medium
        - manual

    # Category: package
    # STIG Severity: medium
    # NIST: CM.07.1(iii)
    # Description: <VulnDiscussion>"Firewalld" provides an easy and effective way to block/lim...
    # Fix Text: To install the "firewalld" package run the following command - $ sudo dnf i...
    - name: 'SV-257935r1044994_rule | RHEL 9 must have the firewalld package installed.'
      package:
        name: firewalld
        state: present
      tags:
        - stig
        - SV-257935r1044994_rule
        - package
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07.1(iii)
    # Description: <VulnDiscussion>"Firewalld" provides an easy and effective way to block/lim...
    # Fix Text: To enable the firewalld service run the following command - $ sudo systemct...
    - name: 'SV-257936r1044995_rule | The firewalld service on RHEL 9 must be active.'
      debug:
        msg: "Manual hardening required for SV-257936r1044995_rule: The firewalld service on RHEL 9 must be active. - To enable the firewalld service run the following command:  $ sudo systemctl enable --now firewalld Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257936r1044995_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Failure to restrict network connectivity only to authorized...
    # Fix Text: Configure the "firewalld" daemon to employ a deny-all, allow-by-exception p...
    - name: 'SV-257937r1106310_rule | The RHEL 9 firewall must employ a deny-all, allow-by-exception policy for allowing connections to other systems.'
      shell: |
        firewall-cmd --reload
        firewall-cmd --set-default-zone=drop
        firewall-cmd --permanent --zone=drop --change-interface=ens192
      tags:
        - stig
        - SV-257937r1106310_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SC.05
    # Description: <VulnDiscussion>DoS is a condition when a resource is not available for leg...
    # Fix Text: Configure "nftables" to be the default "firewallbackend" for "firewalld" by...
    - name: 'SV-257939r1044997_rule | RHEL 9 must protect against or limit the effects of denial-of-service (DoS) attacks by ensuring rate-limiting measures on impacted network interfaces are implemented.'
      debug:
        msg: "Manual hardening required for SV-257939r1044997_rule: RHEL 9 must protect against or limit the effects of denial-of-service (DoS) attacks by ensuring rate - Configure 'nftables' to be the default 'firewallbackend' for 'firewalld' by adding or editing the fo Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257939r1044997_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07.1(iii)
    # Description: <VulnDiscussion>To prevent unauthorized connection of devices, unauthorized...
    # Fix Text: Update the host's firewall settings and/or running services to comply with ...
    - name: 'SV-257940r1106312_rule | RHEL 9 must be configured to prohibit or restrict the use of functions, ports, protocols, and/or services, as defined in the Ports, Protocols, and Services Management (PPSM) Category Assignments List (CAL) and vulnerability assessments.'
      shell: |
        firewall-cmd --reload
      tags:
        - stig
        - SV-257940r1106312_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Network interfaces in promiscuous mode allow for the captur...
    # Fix Text: Configure network interfaces to turn off promiscuous mode unless approved b...
    - name: 'SV-257941r991589_rule | RHEL 9 network interfaces must not be in promiscuous mode.'
      debug:
        msg: "Manual hardening required for SV-257941r991589_rule: RHEL 9 network interfaces must not be in promiscuous mode. - Configure network interfaces to turn off promiscuous mode unless approved by the ISSO and documented Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257941r991589_rule
        - other
        - severity_medium
        - manual

    # Category: sysctl
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>It is detrimental for operating systems to provide, or inst...
    # Fix Text: Configure RHEL 9 to enable hardening for the BPF JIT compiler by adding the...
    - name: 'SV-257942r1106314_rule | RHEL 9 must enable hardening for the Berkeley Packet Filter just-in-time compiler.'
      sysctl:
        name: net.core.bpf_jit_harden
        value: '2'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257942r1106314_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: AU.08(1)(a)
    # Description: <VulnDiscussion>Inaccurate time stamps make it more difficult to correlate ...
    # Fix Text: The chrony package can be installed with the following command - $ sudo dnf...
    - name: 'SV-257943r1045001_rule | RHEL 9 must have the chrony package installed.'
      package:
        name: chrony
        state: present
      tags:
        - stig
        - SV-257943r1045001_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.08(1)(a)
    # Description: <VulnDiscussion>Inaccurate time stamps make it more difficult to correlate ...
    # Fix Text: To enable the chronyd service run the following command - $ sudo systemctl ...
    - name: 'SV-257944r1038944_rule | RHEL 9 chronyd service must be enabled.'
      debug:
        msg: "Manual hardening required for SV-257944r1038944_rule: RHEL 9 chronyd service must be enabled. - To enable the chronyd service run the following command:  $ sudo systemctl enable --now chronyd Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257944r1038944_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.08.b
    # Description: <VulnDiscussion>Inaccurate time stamps make it more difficult to correlate ...
    # Fix Text: Configure RHEL 9 to securely compare internal information system clocks at ...
    - name: 'SV-257945r1038944_rule | RHEL 9 must securely compare internal information system clocks at least every 24 hours.'
      debug:
        msg: "Manual hardening required for SV-257945r1038944_rule: RHEL 9 must securely compare internal information system clocks at least every 24 hours. - Configure RHEL 9 to securely compare internal information system clocks at least every 24 hours with Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257945r1038944_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: low
    # NIST: CM.07.1(ii)
    # Description: <VulnDiscussion>Minimizing the exposure of the server functionality of the ...
    # Fix Text: Configure RHEL 9 to disable the chrony daemon from acting as a server by ad...
    - name: 'SV-257946r958480_rule | RHEL 9 must disable the chrony daemon from acting as a server.'
      debug:
        msg: "Manual hardening required for SV-257946r958480_rule: RHEL 9 must disable the chrony daemon from acting as a server. - Configure RHEL 9 to disable the chrony daemon from acting as a server by adding/modifying the follow Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257946r958480_rule
        - other
        - severity_low
        - manual

    # Category: other
    # STIG Severity: low
    # NIST: CM.07.1(ii)
    # Description: <VulnDiscussion>Not exposing the management interface of the chrony daemon ...
    # Fix Text: Configure RHEL 9 to disable network management of the chrony daemon by addi...
    - name: 'SV-257947r958480_rule | RHEL 9 must disable network management of the chrony daemon.'
      debug:
        msg: "Manual hardening required for SV-257947r958480_rule: RHEL 9 must disable network management of the chrony daemon. - Configure RHEL 9 to disable network management of the chrony daemon by adding/modifying the followin Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257947r958480_rule
        - other
        - severity_low
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>To provide availability for name resolution services, multi...
    # Fix Text: Configure the operating system to use two or more name servers for DNS reso...
    - name: 'SV-257948r1045004_rule | RHEL 9 systems using Domain Name Servers (DNS) resolution must have at least two name servers configured.'
      debug:
        msg: "Manual hardening required for SV-257948r1045004_rule: RHEL 9 systems using Domain Name Servers (DNS) resolution must have at least two name servers config - Configure the operating system to use two or more name servers for DNS resolution based on the DNS m Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257948r1045004_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>To ensure that DNS resolver settings are respected, a DNS m...
    # Fix Text: Configure NetworkManager in RHEL 9 to use a DNS mode. In "/etc/NetworkManag...
    - name: 'SV-257949r1134947_rule | RHEL 9 must configure a DNS processing mode in Network Manager.'
      debug:
        msg: "Manual hardening required for SV-257949r1134947_rule: RHEL 9 must configure a DNS processing mode in Network Manager. - Configure NetworkManager in RHEL 9 to use a DNS mode.  In '/etc/NetworkManager/NetworkManager.conf', Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257949r1134947_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>IP tunneling mechanisms can be used to bypass network filte...
    # Fix Text: Remove all unapproved tunnels from the system, or document them with the IS...
    - name: 'SV-257950r1045006_rule | RHEL 9 must not have unauthorized IP tunnels configured.'
      debug:
        msg: "Manual hardening required for SV-257950r1045006_rule: RHEL 9 must not have unauthorized IP tunnels configured. - Remove all unapproved tunnels from the system, or document them with the ISSO. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257950r1045006_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>If unrestricted mail relaying is permitted, unauthorized se...
    # Fix Text: Modify the postfix configuration file to restrict client connections to the...
    - name: 'SV-257951r1014843_rule | RHEL 9 must be configured to prevent unrestricted mail relaying.'
      debug:
        msg: "Manual hardening required for SV-257951r1014843_rule: RHEL 9 must be configured to prevent unrestricted mail relaying. - Modify the postfix configuration file to restrict client connections to the local network with the f Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257951r1014843_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.05.1(ii)
    # Description: <VulnDiscussion>It is critical for the appropriate personnel to be aware if...
    # Fix Text: Configure a valid email address as an alias for the root account. Append th...
    - name: 'SV-257953r958424_rule | RHEL 9 must forward mail from postmaster to the root account using a postfix alias.'
      debug:
        msg: "Manual hardening required for SV-257953r958424_rule: RHEL 9 must forward mail from postmaster to the root account using a postfix alias. - Configure a valid email address as an alias for the root account.  Append the following line to '/et Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257953r958424_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.07.1
    # Description: <VulnDiscussion>Providing the ability for remote users or systems to initia...
    # Fix Text: Install the libreswan service (if it is not already installed) with the fol...
    - name: 'SV-257954r1106315_rule | RHEL 9 libreswan package must be installed.'
      package:
        name: libreswan
        state: present
      tags:
        - stig
        - SV-257954r1106315_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: high
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The shosts.equiv files are used to configure host-based aut...
    # Fix Text: Remove any found "shosts.equiv" files from the system. $ sudo rm /[path]/[t...
    - name: 'SV-257955r991589_rule | There must be no shosts.equiv files on RHEL 9.'
      debug:
        msg: "Manual hardening required for SV-257955r991589_rule: There must be no shosts.equiv files on RHEL 9. - Remove any found 'shosts.equiv' files from the system.  $ sudo rm /[path]/[to]/[file]/shosts.equiv Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257955r991589_rule
        - other
        - severity_high
        - manual

    # Category: other
    # STIG Severity: high
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The .shosts files are used to configure host-based authenti...
    # Fix Text: Remove any found ".shosts" files from the system. $ sudo rm /[path]/[to]/[f...
    - name: 'SV-257956r991589_rule | There must be no .shosts files on RHEL 9.'
      debug:
        msg: "Manual hardening required for SV-257956r991589_rule: There must be no .shosts files on RHEL 9. - Remove any found '.shosts' files from the system.  $ sudo rm /[path]/[to]/[file]/.shosts Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257956r991589_rule
        - other
        - severity_high
        - manual

    # Category: sysctl
    # STIG Severity: medium
    # NIST: SC.05.1(2)
    # Description: <VulnDiscussion>Preventing unauthorized information transfers mitigates the...
    # Fix Text: Configure RHEL 9 to use TCP syncookies. Add or edit the following line in a...
    - name: 'SV-257957r1106317_rule | RHEL 9 must be configured to use TCP syncookies.'
      sysctl:
        name: net.ipv4.tcp_syncookies
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257957r1106317_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>ICMP redirect messages are used by routers to inform hosts ...
    # Fix Text: Configure RHEL 9 to ignore IPv4 ICMP redirect messages. Add or edit the fol...
    - name: 'SV-257958r1106319_rule | RHEL 9 must ignore Internet Protocol version 4 (IPv4) Internet Control Message Protocol (ICMP) redirect messages.'
      sysctl:
        name: net.ipv4.conf.all.accept_redirects
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257958r1106319_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Source-routed packets allow the source of the packet to sug...
    # Fix Text: Configure RHEL 9 to not forward IPv4 source-routed packets. Add or edit the...
    - name: 'SV-257959r1102024_rule | RHEL 9 must not forward Internet Protocol version 4 (IPv4) source-routed packets.'
      sysctl:
        name: net.ipv4.conf.all.accept_source_route
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257959r1102024_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The presence of "martian" packets (which have impossible ad...
    # Fix Text: Configure RHEL 9 to log martian packets on IPv4 interfaces. Add or edit the...
    - name: 'SV-257960r1106321_rule | RHEL 9 must log IPv4 packets with impossible addresses.'
      sysctl:
        name: net.ipv4.conf.all.log_martians
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257960r1106321_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The presence of "martian" packets (which have impossible ad...
    # Fix Text: Configure RHEL 9 to log martian packets on IPv4 interfaces by default. Add ...
    - name: 'SV-257961r1106323_rule | RHEL 9 must log IPv4 packets with impossible addresses by default.'
      sysctl:
        name: net.ipv4.conf.default.log_martians
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257961r1106323_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Enabling reverse path filtering drops packets with source a...
    # Fix Text: Configure RHEL 9 to use reverse path filtering on all IPv4 interfaces by ad...
    - name: 'SV-257962r1106437_rule | RHEL 9 must use reverse path filtering on all IPv4 interfaces.'
      sysctl:
        name: net.ipv4.conf.all.rp_filter
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257962r1106437_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>ICMP redirect messages are used by routers to inform hosts ...
    # Fix Text: Configure RHEL 9 to prevent IPv4 ICMP redirect messages from being accepted...
    - name: 'SV-257963r1106328_rule | RHEL 9 must prevent IPv4 Internet Control Message Protocol (ICMP) redirect messages from being accepted.'
      sysctl:
        name: net.ipv4.conf.default.accept_redirects
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257963r1106328_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Source-routed packets allow the source of the packet to sug...
    # Fix Text: Configure RHEL 9 to not forward IPv4 source-routed packets by default. Add ...
    - name: 'SV-257964r1106438_rule | RHEL 9 must not forward IPv4 source-routed packets by default.'
      sysctl:
        name: net.ipv4.conf.default.accept_source_route
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257964r1106438_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Enabling reverse path filtering drops packets with source a...
    # Fix Text: Configure RHEL 9 to use reverse path filtering on IPv4 interfaces by defaul...
    - name: 'SV-257965r1106333_rule | RHEL 9 must use a reverse-path filter for IPv4 network traffic when possible by default.'
      sysctl:
        name: net.ipv4.conf.default.rp_filter
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257965r1106333_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Responding to broadcast (ICMP) echoes facilitates network m...
    # Fix Text: Configure RHEL 9 to not respond to IPv4 ICMP echoes sent to a broadcast add...
    - name: 'SV-257966r1106440_rule | RHEL 9 must not respond to Internet Control Message Protocol (ICMP) echoes sent to a broadcast address.'
      sysctl:
        name: net.ipv4.icmp_echo_ignore_broadcasts
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257966r1106440_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Some routers will send responses to broadcast frames that v...
    # Fix Text: Configure RHEL 9 to not log bogus ICMP errors - Add or edit the following l...
    - name: 'SV-257967r1106337_rule | RHEL 9 must limit the number of bogus Internet Control Message Protocol (ICMP) response errors logs.'
      sysctl:
        name: net.ipv4.icmp_ignore_bogus_error_responses
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257967r1106337_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>ICMP redirect messages are used by routers to inform hosts ...
    # Fix Text: Configure RHEL 9 to not allow interfaces to perform IPv4 ICMP redirects. Ad...
    - name: 'SV-257968r1106339_rule | RHEL 9 must not send Internet Control Message Protocol (ICMP) redirects.'
      sysctl:
        name: net.ipv4.conf.all.send_redirects
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257968r1106339_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: sysctl
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>ICMP redirect messages are used by routers to inform hosts ...
    # Fix Text: Configure RHEL 9 to not allow interfaces to perform Internet Protocol versi...
    - name: 'SV-257969r991589_rule | RHEL 9 must not allow interfaces to perform Internet Control Message Protocol (ICMP) redirects by default.'
      sysctl:
        name: net.ipv4.conf.default.send_redirects
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      tags:
        - stig
        - SV-257969r991589_rule
        - sysctl
        - severity_medium
        - automatable

    # Category: service
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Routing protocol daemons are typically used on routers to e...
    # Fix Text: Configure RHEL 9 to not allow IPv4 packet forwarding, unless the system is ...
    - name: 'SV-257970r1106442_rule | RHEL 9 must not enable IPv4 packet forwarding unless the system is a router.'
      debug:
        msg: "Manual hardening required for SV-257970r1106442_rule: RHEL 9 must not enable IPv4 packet forwarding unless the system is a router. - Configure RHEL 9 to not allow IPv4 packet forwarding, unless the system is a router.  Add or edit th Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257970r1106442_rule
        - service
        - severity_medium
        - automatable

    # Category: service
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Routing protocol daemons are typically used on routers to e...
    # Fix Text: Configure RHEL 9 to not accept router advertisements on all IPv6 interfaces...
    - name: 'SV-257971r1106444_rule | RHEL 9 must not accept router advertisements on all IPv6 interfaces.'
      debug:
        msg: "Manual hardening required for SV-257971r1106444_rule: RHEL 9 must not accept router advertisements on all IPv6 interfaces. - Configure RHEL 9 to not accept router advertisements on all IPv6 interfaces unless the system is a r Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257971r1106444_rule
        - service
        - severity_medium
        - automatable

    # Category: service
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>ICMP redirect messages are used by routers to inform hosts ...
    # Fix Text: Configure RHEL 9 to ignore IPv6 ICMP redirect messages. Add or edit the fol...
    - name: 'SV-257972r1106446_rule | RHEL 9 must ignore IPv6 Internet Control Message Protocol (ICMP) redirect messages.'
      debug:
        msg: "Manual hardening required for SV-257972r1106446_rule: RHEL 9 must ignore IPv6 Internet Control Message Protocol (ICMP) redirect messages. - Configure RHEL 9 to ignore IPv6 ICMP redirect messages.  Add or edit the following line in a system  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257972r1106446_rule
        - service
        - severity_medium
        - automatable

    # Category: service
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Source-routed packets allow the source of the packet to sug...
    # Fix Text: Configure RHEL 9 to not forward IPv6 source-routed packets. Add or edit the...
    - name: 'SV-257973r1106448_rule | RHEL 9 must not forward IPv6 source-routed packets.'
      debug:
        msg: "Manual hardening required for SV-257973r1106448_rule: RHEL 9 must not forward IPv6 source-routed packets. - Configure RHEL 9 to not forward IPv6 source-routed packets.  Add or edit the following line in a sys Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257973r1106448_rule
        - service
        - severity_medium
        - automatable

    # Category: service
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Routing protocol daemons are typically used on routers to e...
    # Fix Text: Configure RHEL 9 to not allow IPv6 packet forwarding, unless the system is ...
    - name: 'SV-257974r1106450_rule | RHEL 9 must not enable IPv6 packet forwarding unless the system is a router.'
      debug:
        msg: "Manual hardening required for SV-257974r1106450_rule: RHEL 9 must not enable IPv6 packet forwarding unless the system is a router. - Configure RHEL 9 to not allow IPv6 packet forwarding, unless the system is a router.  Add or edit th Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257974r1106450_rule
        - service
        - severity_medium
        - automatable

    # Category: service
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Routing protocol daemons are typically used on routers to e...
    # Fix Text: Configure RHEL 9 to not accept router advertisements on all IPv6 interfaces...
    - name: 'SV-257975r1106452_rule | RHEL 9 must not accept router advertisements on all IPv6 interfaces by default.'
      debug:
        msg: "Manual hardening required for SV-257975r1106452_rule: RHEL 9 must not accept router advertisements on all IPv6 interfaces by default. - Configure RHEL 9 to not accept router advertisements on all IPv6 interfaces by default unless the sy Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257975r1106452_rule
        - service
        - severity_medium
        - automatable

    # Category: service
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>ICMP redirect messages are used by routers to inform hosts ...
    # Fix Text: Configure RHEL 9 to prevent IPv6 ICMP redirect messages from being accepted...
    - name: 'SV-257976r1106454_rule | RHEL 9 must prevent IPv6 Internet Control Message Protocol (ICMP) redirect messages from being accepted.'
      debug:
        msg: "Manual hardening required for SV-257976r1106454_rule: RHEL 9 must prevent IPv6 Internet Control Message Protocol (ICMP) redirect messages from being accep - Configure RHEL 9 to prevent IPv6 ICMP redirect messages from being accepted.  Add or edit the follow Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257976r1106454_rule
        - service
        - severity_medium
        - automatable

    # Category: service
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Source-routed packets allow the source of the packet to sug...
    # Fix Text: Configure RHEL 9 to not forward IPv6 source-routed packets by default. Add ...
    - name: 'SV-257977r1106456_rule | RHEL 9 must not forward IPv6 source-routed packets by default.'
      debug:
        msg: "Manual hardening required for SV-257977r1106456_rule: RHEL 9 must not forward IPv6 source-routed packets by default. - Configure RHEL 9 to not forward IPv6 source-routed packets by default.  Add or edit the following li Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257977r1106456_rule
        - service
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: SC.08
    # Description: <VulnDiscussion>Without protection of the transmitted information, confiden...
    # Fix Text: The openssh-server package can be installed with the following command - $ ...
    - name: 'SV-257978r1045013_rule | All RHEL 9 networked systems must have SSH installed.'
      package:
        name: openssh-server
        state: present
      tags:
        - stig
        - SV-257978r1045013_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SC.08
    # Description: <VulnDiscussion>Without protection of the transmitted information, confiden...
    # Fix Text: To enable the sshd service run the following command - $ systemctl enable -...
    - name: 'SV-257979r958908_rule | All RHEL 9 networked systems must have and implement SSH to protect the confidentiality and integrity of transmitted and received information, as well as information during preparation for transmission.'
      debug:
        msg: "Manual hardening required for SV-257979r958908_rule: All RHEL 9 networked systems must have and implement SSH to protect the confidentiality and integrit - To enable the sshd service run the following command:  $ systemctl enable --now sshd Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257979r958908_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>This package includes utilities to make encrypted connectio...
    # Fix Text: The openssh-clients package can be installed with the following command - $...
    - name: 'SV-257980r1045016_rule | RHEL 9 must have the openssh-clients package installed.'
      package:
        name: openssh-clients
        state: present
      tags:
        - stig
        - SV-257980r1045016_rule
        - other
        - severity_medium
        - manual

    # Category: config
    # STIG Severity: medium
    # NIST: AC.08.1(ii)
    # Description: <VulnDiscussion>The warning message reinforces policy awareness during the ...
    # Fix Text: Configure RHEL 9 to display the Standard Mandatory DOD Notice and Consent B...
    - name: 'SV-257981r1101970_rule | RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before granting local or remote access to the system via a SSH logon.'
      lineinfile:
        path: /etc/ssh/sshd_config.d
        line: 'Configure RHEL'
        regexp: '^#?\s*Configure\s+'
        create: yes
        backup: yes
      tags:
        - stig
        - SV-257981r1101970_rule
        - config
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: AC.17.1(1)
    # Description: <VulnDiscussion>SSH provides several logging levels with varying amounts of...
    # Fix Text: Configure RHEL 9 to log connection attempts add or modify the following lin...
    - name: 'SV-257982r1045021_rule | RHEL 9 must log SSH connection attempts and failures to the server.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257982r1045021_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.02.1(1)
    # Description: <VulnDiscussion>Without the use of multifactor authentication, the ease of ...
    # Fix Text: To configure the system, add or modify the following line in "/etc/ssh/sshd...
    - name: 'SV-257983r1045024_rule | RHEL 9 SSHD must accept public key authentication.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257983r1045024_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: high
    # NIST: IA.02.1(2)
    # Description: <VulnDiscussion>If an account has an empty password, anyone could log on an...
    # Fix Text: To configure the system to prevent SSH users from logging on with blank pas...
    - name: 'SV-257984r1045026_rule | RHEL 9 SSHD must not allow blank passwords.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257984r1045026_rule
        - other
        - severity_high
        - manual

    # Category: service
    # STIG Severity: medium
    # NIST: IA.02.2(5)(ii)
    # Description: <VulnDiscussion>Even though the communications channel may be encrypted, an...
    # Fix Text: To configure the system to prevent SSH users from logging on directly as ro...
    - name: 'SV-257985r1069364_rule | RHEL 9 must not permit direct logons to the root account using remote access via SSH.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257985r1069364_rule
        - service
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: high
    # NIST: MA.04.1(iv)
    # Description: <VulnDiscussion>When UsePAM is set to "yes", PAM runs through account and s...
    # Fix Text: Configure the RHEL 9 SSHD to use the UsePAM interface by adding or modifyin...
    - name: 'SV-257986r1045030_rule | RHEL 9 must enable the Pluggable Authentication Module (PAM) interface for SSHD.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257986r1045030_rule
        - other
        - severity_high
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.17.1(2)
    # Description: <VulnDiscussion>Without cryptographic integrity protections, information ca...
    # Fix Text: Configure the RHEL 9 SSH server to use only ciphers employing FIPS 140-3 ap...
    - name: 'SV-257989r1051240_rule | The RHEL 9 SSH server must be configured to use only DOD-approved encryption ciphers employing FIPS 140-3 validated cryptographic hash algorithms to protect the confidentiality of SSH server connections.'
      debug:
        msg: "Manual hardening required for SV-257989r1051240_rule: The RHEL 9 SSH server must be configured to use only DOD-approved encryption ciphers employing FIPS  - Configure the RHEL 9 SSH server to use only ciphers employing FIPS 140-3 approved algorithms.  Reins Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257989r1051240_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.17.1(2)
    # Description: <VulnDiscussion>Without cryptographic integrity protections, information ca...
    # Fix Text: Configure the RHEL 9 SSH server to use only MACs employing FIPS 140-3 appro...
    - name: 'SV-257991r1051246_rule | The RHEL 9 SSH server must be configured to use only Message Authentication Codes (MACs) employing FIPS 140-3 validated cryptographic hash algorithms to protect the confidentiality of SSH server connections.'
      debug:
        msg: "Manual hardening required for SV-257991r1051246_rule: The RHEL 9 SSH server must be configured to use only Message Authentication Codes (MACs) employing F - Configure the RHEL 9 SSH server to use only MACs employing FIPS 140-3 approved algorithms.  Reinstal Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257991r1051246_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>SSH trust relationships mean a compromise on one host can a...
    # Fix Text: To configure RHEL 9 to not allow a noncertificate trusted host SSH logon to...
    - name: 'SV-257992r1045047_rule | RHEL 9 must not allow a noncertificate trusted host SSH logon to the system.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257992r1045047_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>SSH environment options potentially allow users to bypass a...
    # Fix Text: Configure the RHEL 9 SSH daemon to not allow unattended or automatic logon ...
    - name: 'SV-257993r1045049_rule | RHEL 9 must not allow users to override SSH environment variables.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257993r1045049_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.17.1(2)
    # Description: <VulnDiscussion>Without protection of the transmitted information, confiden...
    # Fix Text: Configure RHEL 9 to force a frequent session key renegotiation for SSH conn...
    - name: 'SV-257994r1045051_rule | RHEL 9 must force a frequent session key renegotiation for SSH connections to the server.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257994r1045051_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SC.10.1(ii)
    # Description: <VulnDiscussion>Terminating an unresponsive SSH session within a short time...
    # Fix Text: Note - This setting must be applied in conjunction with RHEL-09-255100 to f...
    - name: 'SV-257995r1045053_rule | RHEL 9 must be configured so that all network connections associated with SSH traffic terminate after becoming unresponsive.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257995r1045053_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SC.10.1(ii)
    # Description: <VulnDiscussion>Terminating an unresponsive SSH session within a short time...
    # Fix Text: Note - This setting must be applied in conjunction with RHEL-09-255095 to f...
    - name: 'SV-257996r1134915_rule | RHEL 9 must be configured so that all network connections associated with SSH traffic are terminated after 10 minutes of becoming unresponsive.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-257996r1134915_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Service configuration files enable or disable features of t...
    # Fix Text: Configure the "/etc/ssh/sshd_config" file and the contents of "/etc/ssh/ssh...
    - name: 'SV-257997r1069370_rule | RHEL 9 SSH server configuration file must be group-owned by root.'
      shell: |
        chgrp root /etc/ssh/sshd_config /etc/ssh/sshd_config.d
      tags:
        - stig
        - SV-257997r1069370_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Service configuration files enable or disable features of t...
    # Fix Text: Configure the "/etc/ssh/sshd_config" file and the contents of "/etc/ssh/ssh...
    - name: 'SV-257998r1082181_rule | The RHEL 9 SSH server configuration file must be owned by root.'
      shell: |
        chown -R root /etc/ssh/sshd_config /etc/ssh/sshd_config.d
      tags:
        - stig
        - SV-257998r1082181_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Service configuration files enable or disable features of t...
    # Fix Text: Run the following commands to restore the correct permissions of OpenSSH se...
    - name: 'SV-257999r1134918_rule | RHEL 9 SSH server configuration files'' permissions must not be modified.'
      debug:
        msg: "Manual hardening required for SV-257999r1134918_rule: RHEL 9 SSH server configuration files' permissions must not be modified. - Run the following commands to restore the correct permissions of OpenSSH server configuration files: Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-257999r1134918_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>If an unauthorized user obtains the private SSH host key fi...
    # Fix Text: Configure the mode of SSH private host key files under "/etc/ssh" to "0640"...
    - name: 'SV-258000r1045063_rule | RHEL 9 SSH private host key files must have mode 0640 or less permissive.'
      file:
        path: /etc/ssh
        mode: '0640'
        state: file
      tags:
        - stig
        - SV-258000r1045063_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>If a public host key file is modified by an unauthorized us...
    # Fix Text: Change the mode of public host key files under "/etc/ssh" to "0644" with th...
    - name: 'SV-258001r991589_rule | RHEL 9 SSH public host key files must have mode 0644 or less permissive.'
      file:
        path: /etc/ssh
        mode: '0644'
        state: file
      tags:
        - stig
        - SV-258001r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>If compression is allowed in an SSH connection prior to aut...
    # Fix Text: Configure the SSH daemon to not allow compression. Uncomment the "Compressi...
    - name: 'SV-258002r991589_rule | RHEL 9 SSH daemon must not allow compression or must only allow compression after successful authentication.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-258002r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.05(1)
    # Description: <VulnDiscussion>Generic Security Service Application Program Interface (GSS...
    # Fix Text: Configure the SSH daemon to not allow GSSAPI authentication. Add or uncomme...
    - name: 'SV-258003r1045065_rule | RHEL 9 SSH daemon must not allow GSSAPI authentication.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-258003r1045065_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.05(1)
    # Description: <VulnDiscussion>Kerberos authentication for SSH is often implemented using ...
    # Fix Text: Configure the SSH daemon to not allow Kerberos authentication. Add the foll...
    - name: 'SV-258004r1045067_rule | RHEL 9 SSH daemon must not allow Kerberos authentication.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-258004r1045067_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>SSH trust relationships mean a compromise on one host can a...
    # Fix Text: Configure the SSH daemon to not allow rhosts authentication. Add the follow...
    - name: 'SV-258005r1045069_rule | RHEL 9 SSH daemon must not allow rhosts authentication.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-258005r1045069_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Configuring the IgnoreUserKnownHosts setting for the SSH da...
    # Fix Text: Configure the SSH daemon to not allow known hosts authentication. Add the f...
    - name: 'SV-258006r1045071_rule | RHEL 9 SSH daemon must not allow known hosts authentication.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-258006r1045071_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>When X11 forwarding is enabled, there may be additional exp...
    # Fix Text: Configure the SSH daemon to not allow X11 forwarding. Add the following lin...
    - name: 'SV-258007r1045073_rule | RHEL 9 SSH daemon must disable remote X connections for interactive users.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-258007r1045073_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>If other users have access to modify user-specific SSH conf...
    # Fix Text: Configure the SSH daemon to perform strict mode checking of home directory ...
    - name: 'SV-258008r1045075_rule | RHEL 9 SSH daemon must perform strict mode checking of home directory configuration files.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-258008r1045075_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Providing users feedback on when account accesses last occu...
    # Fix Text: Configure the SSH daemon to provide users with feedback on when account acc...
    - name: 'SV-258009r1045077_rule | RHEL 9 SSH daemon must display the date and time of the last successful account logon upon an SSH logon.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-258009r1045077_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>When X11 forwarding is enabled, there may be additional exp...
    # Fix Text: Configure the SSH daemon to prevent remote hosts from connecting to the pro...
    - name: 'SV-258011r1045079_rule | RHEL 9 SSH daemon must prevent remote hosts from connecting to the proxy display.'
      systemd:
        name: sshd.service
        state: restarted
      tags:
        - stig
        - SV-258011r1045079_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.08.1(ii)
    # Description: <VulnDiscussion>Display of a standardized and approved use notification bef...
    # Fix Text: Configure RHEL 9 to display the Standard Mandatory DOD Notice and Consent B...
    - name: 'SV-258012r1014855_rule | RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before granting local or remote access to the system via a graphical user logon.'
      shell: |
        touch /etc/dconf/db/local.d/01-banner-message
      tags:
        - stig
        - SV-258012r1014855_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.08.1(ii)
    # Description: <VulnDiscussion>Display of a standardized and approved use notification bef...
    # Fix Text: Configure RHEL 9 to prevent a user from overriding the banner setting for g...
    - name: 'SV-258013r1045082_rule | RHEL 9 must prevent a user from overriding the banner-message-enable setting for the graphical user interface.'
      shell: |
        touch /etc/dconf/db/local.d/locks/session
        /org/gnome/login-screen/banner-message-enable
      tags:
        - stig
        - SV-258013r1045082_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.03.1(ii)
    # Description: <VulnDiscussion>Automatically mounting file systems permits easy introducti...
    # Fix Text: Configure the GNOME desktop to disable automated mounting of removable medi...
    - name: 'SV-258014r1045084_rule | RHEL 9 must disable the graphical user interface automount function unless required.'
      debug:
        msg: "Manual hardening required for SV-258014r1045084_rule: RHEL 9 must disable the graphical user interface automount function unless required. - Configure the GNOME desktop to disable automated mounting of removable media.  The dconf settings ca Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258014r1045084_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.03.1(ii)
    # Description: <VulnDiscussion>A nonprivileged account is any operating system account wit...
    # Fix Text: Configure the GNOME desktop to not allow a user to change the setting that ...
    - name: 'SV-258015r1045086_rule | RHEL 9 must prevent a user from overriding the disabling of the graphical user interface automount function.'
      debug:
        msg: "Manual hardening required for SV-258015r1045086_rule: RHEL 9 must prevent a user from overriding the disabling of the graphical user interface automount f - Configure the GNOME desktop to not allow a user to change the setting that disables automated mounti Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258015r1045086_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>Allowing autorun commands to execute may introduce maliciou...
    # Fix Text: Configure the GNOME desktop to disable the autorun function on removable me...
    - name: 'SV-258016r958804_rule | RHEL 9 must disable the graphical user interface autorun function unless required.'
      debug:
        msg: "Manual hardening required for SV-258016r958804_rule: RHEL 9 must disable the graphical user interface autorun function unless required. - Configure the GNOME desktop to disable the autorun function on removable media.  The dconf settings  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258016r958804_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.03.1(ii)
    # Description: <VulnDiscussion>Techniques used to address this include protocols using non...
    # Fix Text: Configure the GNOME desktop to not allow a user to change the setting that ...
    - name: 'SV-258017r1045088_rule | RHEL 9 must prevent a user from overriding the disabling of the graphical user interface autorun function.'
      debug:
        msg: "Manual hardening required for SV-258017r1045088_rule: RHEL 9 must prevent a user from overriding the disabling of the graphical user interface autorun fun - Configure the GNOME desktop to not allow a user to change the setting that disables autorun on remov Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258017r1045088_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: high
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Failure to restrict system access to authenticated users ne...
    # Fix Text: Configure the GNOME desktop display manager to disable automatic login. Set...
    - name: 'SV-258018r1045090_rule | RHEL 9 must not allow unattended or automatic logon via the graphical user interface.'
      debug:
        msg: "Manual hardening required for SV-258018r1045090_rule: RHEL 9 must not allow unattended or automatic logon via the graphical user interface. - Configure the GNOME desktop display manager to disable automatic login.  Set AutomaticLoginEnable to Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258018r1045090_rule
        - other
        - severity_high
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.11.1(iii)
    # Description: <VulnDiscussion>A session lock is a temporary action taken when a user stop...
    # Fix Text: Configure RHEL 9 to enable a user's session lock until that user re-establi...
    - name: 'SV-258019r1045092_rule | RHEL 9 must be able to initiate directly a session lock for all connection types using smart card when the smart card is removed.'
      debug:
        msg: "Manual hardening required for SV-258019r1045092_rule: RHEL 9 must be able to initiate directly a session lock for all connection types using smart card wh - Configure RHEL 9 to enable a user's session lock until that user re-establishes access using establi Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258019r1045092_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.11.1(iii)
    # Description: <VulnDiscussion>A session lock is a temporary action taken when a user stop...
    # Fix Text: Add the following line to "/etc/dconf/db/local.d/locks/00-security-settings...
    - name: 'SV-258020r1045094_rule | RHEL 9 must prevent a user from overriding the disabling of the graphical user smart card removal action.'
      shell: |
        /org/gnome/settings-daemon/peripherals/smartcard/removal-action
      tags:
        - stig
        - SV-258020r1045094_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.11.1(iii)
    # Description: <VulnDiscussion>A session lock is a temporary action taken when a user stop...
    # Fix Text: Configure RHEL 9 to enable a user's session lock until that user re-establi...
    - name: 'SV-258021r1015088_rule | RHEL 9 must enable a user session lock until that user re-establishes access using established identification and authentication procedures for graphical user sessions.'
      shell: |
        vi /etc/dconf/db/local.d/00-screensaver
      tags:
        - stig
        - SV-258021r1015088_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.11.1(iii)
    # Description: <VulnDiscussion>A session time-out lock is a temporary action taken when a ...
    # Fix Text: Configure RHEL 9 to prevent a user from overriding settings for graphical u...
    - name: 'SV-258022r1045097_rule | RHEL 9 must prevent a user from overriding the screensaver lock-enabled setting for the graphical user interface.'
      shell: |
        touch /etc/dconf/db/local.d/locks/session
        /org/gnome/desktop/screensaver/lock-enabled
      tags:
        - stig
        - SV-258022r1045097_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.11.1(ii)
    # Description: <VulnDiscussion>A session time-out lock is a temporary action taken when a ...
    # Fix Text: Configure RHEL 9 to initiate a screensaver after a 15-minute period of inac...
    - name: 'SV-258023r958402_rule | RHEL 9 must automatically lock graphical user sessions after 15 minutes of inactivity.'
      shell: |
        touch /etc/dconf/db/local.d/00-screensaver
      tags:
        - stig
        - SV-258023r958402_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.11.1(ii)
    # Description: <VulnDiscussion>A session time-out lock is a temporary action taken when a ...
    # Fix Text: Configure RHEL 9 to prevent a user from overriding settings for graphical u...
    - name: 'SV-258024r1045100_rule | RHEL 9 must prevent a user from overriding the session idle-delay setting for the graphical user interface.'
      shell: |
        touch /etc/dconf/db/local.d/locks/session
        /org/gnome/desktop/session/idle-delay
      tags:
        - stig
        - SV-258024r1045100_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.11.1(ii)
    # Description: <VulnDiscussion>A session lock is a temporary action taken when a user stop...
    # Fix Text: Configure RHEL 9 to initiate a session lock for graphical user interfaces w...
    - name: 'SV-258025r958402_rule | RHEL 9 must initiate a session lock for graphical user interfaces when the screensaver is activated.'
      shell: |
        touch /etc/dconf/db/local.d/00-screensaver
      tags:
        - stig
        - SV-258025r958402_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.11.1(ii)
    # Description: <VulnDiscussion>A session time-out lock is a temporary action taken when a ...
    # Fix Text: Configure RHEL 9 to prevent a user from overriding settings for graphical u...
    - name: 'SV-258026r1045103_rule | RHEL 9 must prevent a user from overriding the session lock-delay setting for the graphical user interface.'
      shell: |
        touch /etc/dconf/db/local.d/locks/session
        /org/gnome/desktop/screensaver/lock-delay
      tags:
        - stig
        - SV-258026r1045103_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.11.1(1)
    # Description: <VulnDiscussion>Setting the screensaver mode to blank-only conceals the con...
    # Fix Text: Configure RHEL 9 to prevent a user from overriding the picture-uri setting ...
    - name: 'SV-258027r1045106_rule | RHEL 9 must conceal, via the session lock, information previously visible on the display with a publicly viewable image.'
      shell: |
        /org/gnome/desktop/screensaver/picture-uri
      tags:
        - stig
        - SV-258027r1045106_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Unlike text-based keyfiles, the binary database is impossib...
    # Fix Text: Update the dconf databases by running the following command - $ sudo dconf ...
    - name: 'SV-258028r991589_rule | RHEL 9 effective dconf policy must match the policy keyfiles.'
      debug:
        msg: "Manual hardening required for SV-258028r991589_rule: RHEL 9 effective dconf policy must match the policy keyfiles. - Update the dconf databases by running the following command:  $ sudo dconf update Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258028r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>A user who is at the console can reboot the system at the l...
    # Fix Text: Configure RHEL 9 to disable a user's ability to restart the system. $ gsett...
    - name: 'SV-258029r1045109_rule | RHEL 9 must disable the ability of a user to restart the system from the login screen.'
      shell: |
        gsettings set org.gnome.login-screen disable-restart-buttons true
      tags:
        - stig
        - SV-258029r1045109_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>A user who is at the console can reboot the system at the l...
    # Fix Text: Configure RHEL 9 to prevent a user from overriding the disable-restart-butt...
    - name: 'SV-258030r1045112_rule | RHEL 9 must prevent a user from overriding the disable-restart-buttons setting for the graphical user interface.'
      shell: |
        touch /etc/dconf/db/local.d/locks/session
        /org/gnome/login-screen/disable-restart-buttons
      tags:
        - stig
        - SV-258030r1045112_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>A locally logged-in user who presses Ctrl-Alt-Del, when at ...
    # Fix Text: Configure RHEL 9 to ignore the Ctrl-Alt-Del sequence in the GNOME desktop. ...
    - name: 'SV-258031r1134920_rule | RHEL 9 must disable the ability of a user to accidentally press Ctrl-Alt-Del and cause a system to shut down or reboot.'
      debug:
        msg: "Manual hardening required for SV-258031r1134920_rule: RHEL 9 must disable the ability of a user to accidentally press Ctrl-Alt-Del and cause a system to s - Configure RHEL 9 to ignore the Ctrl-Alt-Del sequence in the GNOME desktop.  Run the following comman Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258031r1134920_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>A locally logged-in user who presses Ctrl-Alt-Del, when at ...
    # Fix Text: Configure RHEL 9 to disallow the user changing the Ctrl-Alt-Del sequence in...
    - name: 'SV-258032r1045117_rule | RHEL 9 must prevent a user from overriding the Ctrl-Alt-Del sequence settings for the graphical user interface.'
      shell: |
        touch /etc/dconf/db/local.d/locks/session
      tags:
        - stig
        - SV-258032r1045117_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Leaving the user list enabled is a security risk since it a...
    # Fix Text: Configure RHEL 9 to disable the user list at logon for graphical user inter...
    - name: 'SV-258033r1045120_rule | RHEL 9 must disable the user list at logon for graphical user interfaces.'
      shell: |
        touch /etc/dconf/db/local.d/02-login-screen
      tags:
        - stig
        - SV-258033r1045120_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.03.1(ii)
    # Description: <VulnDiscussion>USB mass storage permits easy introduction of unknown devic...
    # Fix Text: To configure the system to prevent the usb-storage kernel module from being...
    - name: 'SV-258034r1051267_rule | RHEL 9 must be configured to disable USB mass storage.'
      debug:
        msg: "Manual hardening required for SV-258034r1051267_rule: RHEL 9 must be configured to disable USB mass storage. - To configure the system to prevent the usb-storage kernel module from being loaded, add the followin Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258034r1051267_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.03
    # Description: <VulnDiscussion>The USBguard-daemon is the main component of the USBGuard s...
    # Fix Text: Install the usbguard package with the following command - $ sudo dnf instal...
    - name: 'SV-258035r1045125_rule | RHEL 9 must have the USBGuard package installed.'
      systemd:
        name: usbguard.service
        enabled: yes
      tags:
        - stig
        - SV-258035r1045125_rule
        - other
        - severity_medium
        - manual

    # Category: service
    # STIG Severity: medium
    # NIST: IA.03
    # Description: <VulnDiscussion>The USBguard-daemon is the main component of the USBGuard s...
    # Fix Text: To enable the USBGuard service run the following command - $ sudo systemctl...
    - name: 'SV-258036r1014861_rule | RHEL 9 must have the USBGuard package enabled.'
      debug:
        msg: "Manual hardening required for SV-258036r1014861_rule: RHEL 9 must have the USBGuard package enabled. - To enable the USBGuard service run the following command:  $ sudo systemctl enable --now usbguard Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258036r1014861_rule
        - service
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: low
    # NIST: AU.12.1(ii)
    # Description: <VulnDiscussion>Without the capability to generate audit records, it would ...
    # Fix Text: Configure RHEL 9 USBGuard AuditBackend to use the audit system. Add or edit...
    - name: 'SV-258037r1014863_rule | RHEL 9 must enable Linux audit logging for the USBGuard daemon.'
      debug:
        msg: "Manual hardening required for SV-258037r1014863_rule: RHEL 9 must enable Linux audit logging for the USBGuard daemon. - Configure RHEL 9 USBGuard AuditBackend to use the audit system.  Add or edit the following line in / Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258037r1014863_rule
        - other
        - severity_low
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.03
    # Description: <VulnDiscussion>The USBguard-daemon is the main component of the USBGuard s...
    # Fix Text: Configure the operating system to enable the blocking of unauthorized perip...
    - name: 'SV-258038r1045128_rule | RHEL 9 must block unauthorized peripherals before establishing a connection.'
      debug:
        msg: "Manual hardening required for SV-258038r1045128_rule: RHEL 9 must block unauthorized peripherals before establishing a connection. - Configure the operating system to enable the blocking of unauthorized peripherals with the following Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258038r1045128_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07.1(ii)
    # Description: <VulnDiscussion>This requirement applies to wireless peripheral technologie...
    # Fix Text: Configure RHEL 9 to disable the Bluetooth adapter when not in use. Create o...
    - name: 'SV-258039r1045131_rule | RHEL 9 Bluetooth must be disabled.'
      debug:
        msg: "Manual hardening required for SV-258039r1045131_rule: RHEL 9 Bluetooth must be disabled. - Configure RHEL 9 to disable the Bluetooth adapter when not in use.  Create or modify the '/etc/modpr Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258039r1045131_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.18.1(1)
    # Description: <VulnDiscussion>This requirement applies to wireless peripheral technologie...
    # Fix Text: Configure the system to disable all wireless network interfaces with the fo...
    - name: 'SV-258040r991568_rule | RHEL 9 wireless network adapters must be disabled.'
      debug:
        msg: "Manual hardening required for SV-258040r991568_rule: RHEL 9 wireless network adapters must be disabled. - Configure the system to disable all wireless network interfaces with the following command:  $ nmcli Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258040r991568_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>Any password, no matter how complex, can eventually be crac...
    # Fix Text: Configure RHEL 9 to enforce a 60-day maximum password lifetime. Add or modi...
    - name: 'SV-258041r1038967_rule | RHEL 9 user account passwords for new users or password changes must have a 60-day maximum password lifetime restriction in /etc/login.defs.'
      debug:
        msg: "Manual hardening required for SV-258041r1038967_rule: RHEL 9 user account passwords for new users or password changes must have a 60-day maximum password  - Configure RHEL 9 to enforce a 60-day maximum password lifetime.  Add or modify the following line in Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258041r1038967_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>Any password, no matter how complex, can eventually be crac...
    # Fix Text: Configure noncompliant accounts to enforce a 60-day maximum password lifeti...
    - name: 'SV-258042r1045133_rule | RHEL 9 user account passwords must have a 60-day maximum password lifetime restriction.'
      debug:
        msg: "Manual hardening required for SV-258042r1045133_rule: RHEL 9 user account passwords must have a 60-day maximum password lifetime restriction. - Configure noncompliant accounts to enforce a 60-day maximum password lifetime restriction.  passwd - Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258042r1045133_rule
        - other
        - severity_medium
        - manual

    # Category: service
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>If local interactive users are not assigned a valid home di...
    # Fix Text: Configure RHEL 9 to assign home directories to all new local interactive us...
    - name: 'SV-258043r991589_rule | All RHEL 9 local interactive user accounts must be assigned a home directory upon creation.'
      debug:
        msg: "Manual hardening required for SV-258043r991589_rule: All RHEL 9 local interactive user accounts must be assigned a home directory upon creation. - Configure RHEL 9 to assign home directories to all new local interactive users by setting the 'CREAT Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258043r991589_rule
        - service
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The umask controls the default access mode assigned to newl...
    # Fix Text: Remove the umask statement from all local interactive user's initialization...
    - name: 'SV-258044r1045135_rule | RHEL 9 must set the umask value to 077 for all local interactive user accounts.'
      debug:
        msg: "Manual hardening required for SV-258044r1045135_rule: RHEL 9 must set the umask value to 077 for all local interactive user accounts. - Remove the umask statement from all local interactive user's initialization files.   If the account  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258044r1045135_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1(1)(ii)
    # Description: <VulnDiscussion>To ensure accountability and prevent unauthenticated access...
    # Fix Text: Edit the file "/etc/passwd" and provide each interactive user account that ...
    - name: 'SV-258045r958482_rule | RHEL 9 duplicate User IDs (UIDs) must not exist for interactive users.'
      debug:
        msg: "Manual hardening required for SV-258045r958482_rule: RHEL 9 duplicate User IDs (UIDs) must not exist for interactive users. - Edit the file '/etc/passwd' and provide each interactive user account that has a duplicate UID with  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258045r958482_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Ensuring shells are not given to system accounts upon login...
    # Fix Text: Configure RHEL 9 so that all noninteractive accounts on the system do not h...
    - name: 'SV-258046r991589_rule | RHEL 9 system accounts must not have an interactive login shell.'
      debug:
        msg: "Manual hardening required for SV-258046r991589_rule: RHEL 9 system accounts must not have an interactive login shell. - Configure RHEL 9 so that all noninteractive accounts on the system do not have an interactive shell  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258046r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.02.1(2)(ii)
    # Description: <VulnDiscussion>Temporary accounts are privileged or nonprivileged accounts...
    # Fix Text: Configure the operating system to expire temporary accounts after 72 hours ...
    - name: 'SV-258047r1101951_rule | RHEL 9 must automatically expire temporary accounts within 72 hours.'
      debug:
        msg: "Manual hardening required for SV-258047r1101951_rule: RHEL 9 must automatically expire temporary accounts within 72 hours. - Configure the operating system to expire temporary accounts after 72 hours with the following comman Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258047r1101951_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.02.1
    # Description: <VulnDiscussion>If a user is assigned the Group Identifier (GID) of a group...
    # Fix Text: Configure the system so that all GIDs are referenced in "/etc/passwd" are d...
    - name: 'SV-258048r1069380_rule | All RHEL 9 interactive users must have a primary group that exists.'
      debug:
        msg: "Manual hardening required for SV-258048r1069380_rule: All RHEL 9 interactive users must have a primary group that exists. - Configure the system so that all GIDs are referenced in '/etc/passwd' are defined in '/etc/group'.   Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258048r1069380_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.04.1(iii)
    # Description: <VulnDiscussion>Inactive identifiers pose a risk to systems and application...
    # Fix Text: Configure RHEL 9 to disable account identifiers after 35 days of inactivity...
    - name: 'SV-258049r1015092_rule | RHEL 9 must disable account identifiers (individuals, groups, roles, and devices) after 35 days of inactivity.'
      debug:
        msg: "Manual hardening required for SV-258049r1015092_rule: RHEL 9 must disable account identifiers (individuals, groups, roles, and devices) after 35 days of i - Configure RHEL 9 to disable account identifiers after 35 days of inactivity after the password expir Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258049r1015092_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The executable search path (typically the PATH environment ...
    # Fix Text: Edit the local interactive user initialization files to change any PATH var...
    - name: 'SV-258050r1045137_rule | Executable search paths within the initialization files of all local interactive RHEL 9 users must only contain paths that resolve to the system default or the users home directory.'
      debug:
        msg: "Manual hardening required for SV-258050r1045137_rule: Executable search paths within the initialization files of all local interactive RHEL 9 users must o - Edit the local interactive user initialization files to change any PATH variable statements that ref Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258050r1045137_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>If local interactive users are not assigned a valid home di...
    # Fix Text: Create and assign home directories to all local interactive users on RHEL 9...
    - name: 'SV-258051r991589_rule | All RHEL 9 local interactive users must have a home directory assigned in the /etc/passwd file.'
      debug:
        msg: "Manual hardening required for SV-258051r991589_rule: All RHEL 9 local interactive users must have a home directory assigned in the /etc/passwd file. - Create and assign home directories to all local interactive users on RHEL 9 that currently do not ha Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258051r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>If a local interactive user has a home directory defined th...
    # Fix Text: Create home directories to all local interactive users that currently do no...
    - name: 'SV-258052r991589_rule | All RHEL 9 local interactive user home directories defined in the /etc/passwd file must exist.'
      file:
        path: /etc/passwd
        mode: '0750'
        owner: wadea
        group: Identifier
        state: file
      tags:
        - stig
        - SV-258052r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>If the Group Identifier (GID) of a local interactive users ...
    # Fix Text: Change the group owner of a local interactive user's home directory to the ...
    - name: 'SV-258053r991589_rule | All RHEL 9 local interactive user home directories must be group-owned by the home directory owner''s primary group.'
      debug:
        msg: "Manual hardening required for SV-258053r991589_rule: All RHEL 9 local interactive user home directories must be group-owned by the home directory owner's - Change the group owner of a local interactive user's home directory to the group found in '/etc/pass Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258053r991589_rule
        - other
        - severity_medium
        - manual

    # Category: config
    # STIG Severity: medium
    # NIST: AC.07.1(ii)
    # Description: <VulnDiscussion>By limiting the number of failed logon attempts, the risk o...
    # Fix Text: Configure RHEL 9 to lock an account when three unsuccessful logon attempts ...
    - name: 'SV-258054r958736_rule | RHEL 9 must automatically lock an account when three unsuccessful logon attempts occur.'
      lineinfile:
        path: /etc/security/faillock.conf
        line: 'deny = 3'
        regexp: '^#?\s*deny\s*='
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258054r958736_rule
        - config
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: AC.07.1(ii)
    # Description: <VulnDiscussion>By limiting the number of failed logon attempts, the risk o...
    # Fix Text: To configure RHEL 9 to lock out the "root" account after a number of incorr...
    - name: 'SV-258055r1045140_rule | RHEL 9 must automatically lock the root account until the root account is released by an administrator when three unsuccessful logon attempts occur during a 15-minute time period.'
      debug:
        msg: "Manual hardening required for SV-258055r1045140_rule: RHEL 9 must automatically lock the root account until the root account is released by an administrat - To configure RHEL 9 to lock out the 'root' account after a number of incorrect logon attempts using  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258055r1045140_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.07.1(ii)
    # Description: <VulnDiscussion>By limiting the number of failed logon attempts the risk of...
    # Fix Text: To configure RHEL 9 to lock out the "root" account after a number of incorr...
    - name: 'SV-258056r1045143_rule | RHEL 9 must automatically lock an account when three unsuccessful logon attempts occur during a 15-minute time period.'
      debug:
        msg: "Manual hardening required for SV-258056r1045143_rule: RHEL 9 must automatically lock an account when three unsuccessful logon attempts occur during a 15-m - To configure RHEL 9 to lock out the 'root' account after a number of incorrect logon attempts within Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258056r1045143_rule
        - other
        - severity_medium
        - manual

    # Category: config
    # STIG Severity: medium
    # NIST: AC.07.1(ii)
    # Description: <VulnDiscussion>By limiting the number of failed logon attempts the risk of...
    # Fix Text: Configure RHEL 9 to lock an account until released by an administrator afte...
    - name: 'SV-258057r1045146_rule | RHEL 9 must maintain an account lock until the locked account is released by an administrator.'
      lineinfile:
        path: /etc/security/faillock.conf
        line: 'unlock_time = 0'
        regexp: '^#?\s*unlock_time\s*='
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258057r1045146_rule
        - config
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Accounts providing no operational purpose provide additiona...
    # Fix Text: Remove unauthorized local interactive user accounts with the following comm...
    - name: 'SV-258058r1045148_rule | RHEL 9 must not have unauthorized accounts.'
      debug:
        msg: "Manual hardening required for SV-258058r1045148_rule: RHEL 9 must not have unauthorized accounts. - Remove unauthorized local interactive user accounts with the following command where <unauthorized_u Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258058r1045148_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: high
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>An account has root authority if it has a user identifier (...
    # Fix Text: Change the UID of any account on the system, other than root, that has a UI...
    - name: 'SV-258059r991589_rule | The root account must be the only account having unrestricted access to RHEL 9 system.'
      debug:
        msg: "Manual hardening required for SV-258059r991589_rule: The root account must be the only account having unrestricted access to RHEL 9 system. - Change the UID of any account on the system, other than root, that has a UID of '0'.   If the accoun Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258059r991589_rule
        - other
        - severity_high
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.07.1(ii)
    # Description: <VulnDiscussion>Having lockouts persist across reboots ensures that account...
    # Fix Text: Configure RHEL 9 maintain the contents of the faillock directory after a re...
    - name: 'SV-258060r1045150_rule | RHEL 9 must ensure account lockouts persist.'
      debug:
        msg: "Manual hardening required for SV-258060r1045150_rule: RHEL 9 must ensure account lockouts persist. - Configure RHEL 9 maintain the contents of the faillock directory after a reboot.  Add/modify the '/e Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258060r1045150_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.02.1
    # Description: <VulnDiscussion>To ensure accountability and prevent unauthenticated access...
    # Fix Text: Edit the file "/etc/group" and provide each group that has a duplicate GID ...
    - name: 'SV-258061r958482_rule | RHEL 9 groups must have unique Group ID (GID).'
      debug:
        msg: "Manual hardening required for SV-258061r958482_rule: RHEL 9 groups must have unique Group ID (GID). - Edit the file '/etc/group' and provide each group that has a duplicate GID with a unique GID. Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258061r958482_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>If user start-up files execute world-writable programs, esp...
    # Fix Text: Set the mode on files being executed by the local initialization files with...
    - name: 'SV-258062r991589_rule | Local RHEL 9 initialization files must not execute world-writable programs.'
      debug:
        msg: "Manual hardening required for SV-258062r991589_rule: Local RHEL 9 initialization files must not execute world-writable programs. - Set the mode on files being executed by the local initialization files with the following command:   Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258062r991589_rule
        - other
        - severity_medium
        - manual

    # Category: service
    # STIG Severity: medium
    # NIST: AC.11.1(ii)
    # Description: <VulnDiscussion>Terminating an idle interactive command shell user session ...
    # Fix Text: Configure RHEL 9 to exit interactive command shell user sessions after 10 m...
    - name: 'SV-258068r1101950_rule | RHEL 9 must automatically exit interactive command shell user sessions after 10 minutes of inactivity.'
      debug:
        msg: "Manual hardening required for SV-258068r1101950_rule: RHEL 9 must automatically exit interactive command shell user sessions after 10 minutes of inactivit - Configure RHEL 9 to exit interactive command shell user sessions after 10 minutes of inactivity.  Ad Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258068r1101950_rule
        - service
        - severity_medium
        - automatable

    # Category: config
    # STIG Severity: low
    # NIST: AC.10.1(ii)
    # Description: <VulnDiscussion>Operating system management includes the ability to control...
    # Fix Text: Configure RHEL 9 to limit the number of concurrent sessions to "10" for all...
    - name: 'SV-258069r958398_rule | RHEL 9 must limit the number of concurrent sessions to ten for all accounts and/or account types.'
      lineinfile:
        path: /etc/security/limits.conf
        line: 'Configure RHEL'
        regexp: '^#?\s*Configure\s+'
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258069r958398_rule
        - config
        - severity_low
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: AC.07.1(ii)
    # Description: <VulnDiscussion>Without auditing of these events, it may be harder or impos...
    # Fix Text: Configure RHEL 9 to log username information when unsuccessful logon attemp...
    - name: 'SV-258070r1045153_rule | RHEL 9 must log username information when unsuccessful logon attempts occur.'
      debug:
        msg: "Manual hardening required for SV-258070r1045153_rule: RHEL 9 must log username information when unsuccessful logon attempts occur. - Configure RHEL 9 to log username information when unsuccessful logon attempts occur.  Enable the fea Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258070r1045153_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Increasing the time between a failed authentication attempt...
    # Fix Text: Configure the RHEL 9 to enforce a delay of at least four seconds between lo...
    - name: 'SV-258071r991588_rule | RHEL 9 must enforce a delay of at least four seconds between logon prompts following a failed logon attempt.'
      debug:
        msg: "Manual hardening required for SV-258071r991588_rule: RHEL 9 must enforce a delay of at least four seconds between logon prompts following a failed logon  - Configure the RHEL 9 to enforce a delay of at least four seconds between logon prompts following a f Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258071r991588_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The umask controls the default access mode assigned to newl...
    # Fix Text: Configure RHEL 9 to define default permissions for all authenticated users ...
    - name: 'SV-258072r1045155_rule | RHEL 9 must define default permissions for the bash shell.'
      debug:
        msg: "Manual hardening required for SV-258072r1045155_rule: RHEL 9 must define default permissions for the bash shell. - Configure RHEL 9 to define default permissions for all authenticated users using the bash shell.  Ad Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258072r1045155_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The umask controls the default access mode assigned to newl...
    # Fix Text: Configure RHEL 9 to define default permissions for all authenticated users ...
    - name: 'SV-258073r1045157_rule | RHEL 9 must define default permissions for the c shell.'
      debug:
        msg: "Manual hardening required for SV-258073r1045157_rule: RHEL 9 must define default permissions for the c shell. - Configure RHEL 9 to define default permissions for all authenticated users using the c shell.  Add o Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258073r1045157_rule
        - other
        - severity_medium
        - manual

    # Category: file_permission
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Setting the most restrictive default permissions ensures th...
    # Fix Text: Configure RHEL 9 to define default permissions for all authenticated users ...
    - name: 'SV-258074r991590_rule | RHEL 9 must define default permissions for all authenticated users in such a way that the user can only read and modify their own files.'
      file:
        path: /etc/login.defs
        state: file
      tags:
        - stig
        - SV-258074r991590_rule
        - file_permission
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The umask controls the default access mode assigned to newl...
    # Fix Text: Configure RHEL 9 to define default permissions for all authenticated users ...
    - name: 'SV-258075r991590_rule | RHEL 9 must define default permissions for the system default profile.'
      debug:
        msg: "Manual hardening required for SV-258075r991590_rule: RHEL 9 must define default permissions for the system default profile. - Configure RHEL 9 to define default permissions for all authenticated users in such a way that the us Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258075r991590_rule
        - other
        - severity_medium
        - manual

    # Category: config
    # STIG Severity: low
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Users need to be aware of activity that occurs regarding th...
    # Fix Text: Configure RHEL 9 to provide users with feedback on when account accesses la...
    - name: 'SV-258076r991589_rule | RHEL 9 must display the date and time of the last successful account logon upon logon.'
      lineinfile:
        path: /etc/pam.d/postlogin
        line: 'Configure RHEL'
        regexp: '^#?\s*Configure\s+'
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258076r991589_rule
        - config
        - severity_low
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: SC.10.1(ii)
    # Description: <VulnDiscussion>Terminating an idle session within a short time period redu...
    # Fix Text: Configure RHEL 9 to log out idle sessions by editing the /etc/systemd/login...
    - name: 'SV-258077r1014874_rule | RHEL 9 must terminate idle user sessions.'
      systemd:
        name: systemd-logind.service
        state: restarted
      tags:
        - stig
        - SV-258077r1014874_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: high
    # NIST: SC.03.1(ii)
    # Description: <VulnDiscussion>Without verification of the security functions, security fu...
    # Fix Text: Configure RHEL 9 to verify correct operation of security functions. Edit th...
    - name: 'SV-258078r958944_rule | RHEL 9 must use a Linux Security Module configured to enforce limits on system services.'
      debug:
        msg: "Manual hardening required for SV-258078r958944_rule: RHEL 9 must use a Linux Security Module configured to enforce limits on system services. - Configure RHEL 9 to verify correct operation of security functions.  Edit the file '/etc/selinux/con Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258078r958944_rule
        - other
        - severity_high
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SI.06.a
    # Description: <VulnDiscussion>Setting the SELinux policy to "targeted" or a more speciali...
    # Fix Text: Configure RHEL 9 to use the targetd SELINUX policy. Edit the file "/etc/sel...
    - name: 'SV-258079r1045159_rule | RHEL 9 must enable the SELinux targeted policy.'
      debug:
        msg: "Manual hardening required for SV-258079r1045159_rule: RHEL 9 must enable the SELinux targeted policy. - Configure RHEL 9 to use the targetd SELINUX policy.  Edit the file '/etc/selinux/config' and add or  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258079r1045159_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.07.1(ii)
    # Description: <VulnDiscussion>Not having the correct SELinux context on the faillock dire...
    # Fix Text: Configure RHEL 9 to allow the use of a nondefault faillock tally directory ...
    - name: 'SV-258080r1045162_rule | RHEL 9 must configure SELinux context type to allow the use of a nondefault faillock tally directory.'
      shell: |
        semanage fcontext -a -t faillog_t "/var/log/faillock(/.*)?"
      tags:
        - stig
        - SV-258080r1045162_rule
        - other
        - severity_medium
        - manual

    # Category: package
    # STIG Severity: medium
    # NIST: SC.03.1(ii)
    # Description: <VulnDiscussion>Without verification of the security functions, security fu...
    # Fix Text: The policycoreutils package can be installed with the following command - $...
    - name: 'SV-258081r1045164_rule | RHEL 9 must have policycoreutils package installed.'
      package:
        name: policycoreutils
        state: present
      tags:
        - stig
        - SV-258081r1045164_rule
        - package
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The policycoreutils-python-utils package is required to ope...
    # Fix Text: Install the policycoreutils-python-utils service package (if the policycore...
    - name: 'SV-258082r1045166_rule | RHEL 9 policycoreutils-python-utils package must be installed.'
      package:
        name: policycoreutils-python-utils
        state: present
      tags:
        - stig
        - SV-258082r1045166_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.06(10)
    # Description: <VulnDiscussion>"sudo" is a program designed to allow a system administrato...
    # Fix Text: The sudo package can be installed with the following command - $ sudo dnf i...
    - name: 'SV-258083r1045168_rule | RHEL 9 must have the sudo package installed.'
      package:
        name: sudo
        state: present
      tags:
        - stig
        - SV-258083r1045168_rule
        - other
        - severity_medium
        - manual

    # Category: config
    # STIG Severity: medium
    # NIST: IA.11
    # Description: <VulnDiscussion>Without reauthentication, users may access resources or per...
    # Fix Text: Configure RHEL 9 to reauthenticate "sudo" commands after the specified time...
    - name: 'SV-258084r1050789_rule | RHEL 9 must require reauthentication when using the "sudo" command.'
      lineinfile:
        path: /etc/sudoers
        line: 'timestamp_timeout=0'
        regexp: '^#?\s*timestamp_timeout\s*='
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258084r1050789_rule
        - config
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>If the rootpw, targetpw, or runaspw flags are defined and n...
    # Fix Text: Define the following in the Defaults section of the /etc/sudoers file or a ...
    - name: 'SV-258085r1045173_rule | RHEL 9 must use the invoking user''s password for privilege escalation when using "sudo".'
      debug:
        msg: "Manual hardening required for SV-258085r1045173_rule: RHEL 9 must use the invoking user's password for privilege escalation when using 'sudo'. - Define the following in the Defaults section of the /etc/sudoers file or a single configuration file Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258085r1045173_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.11
    # Description: <VulnDiscussion>Without reauthentication, users may access resources or per...
    # Fix Text: Configure RHEL 9 to not allow users to execute privileged actions without a...
    - name: 'SV-258086r1102063_rule | RHEL 9 must require users to reauthenticate for privilege escalation.'
      shell: |
        sed -i '/\!authenticate/ s/^/# /g' /etc/sudoers /etc/sudoers.d/*
      tags:
        - stig
        - SV-258086r1102063_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>If the "sudoers" file is not configured correctly, any user...
    # Fix Text: Remove the following entries from the /etc/sudoers file or configuration fi...
    - name: 'SV-258087r1102071_rule | RHEL 9 must restrict privilege elevation to authorized personnel.'
      debug:
        msg: "Manual hardening required for SV-258087r1102071_rule: RHEL 9 must restrict privilege elevation to authorized personnel. - Remove the following entries from the /etc/sudoers file or configuration file under /etc/sudoers.d/: Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258087r1102071_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.03(4)
    # Description: <VulnDiscussion>The "su" program allows to run commands with a substitute u...
    # Fix Text: Configure RHEL 9 to require users to be in the "wheel" group to run "su" co...
    - name: 'SV-258088r1050789_rule | RHEL 9 must restrict the use of the "su" command.'
      shell: |
        sed '/^[[:space:]]*#[[:space:]]*auth[[:space:]]\+required[[:space:]]\+pam_wheel\.so[[:space:]]\+use_uid$/s/^[[:space:]]*#//' -i /etc/pam.d/su
      tags:
        - stig
        - SV-258088r1050789_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The organization must identify authorized software programs...
    # Fix Text: The fapolicyd package can be installed with the following command - $ sudo ...
    - name: 'SV-258089r1045179_rule | RHEL 9 fapolicy module must be installed.'
      package:
        name: fapolicyd
        state: present
      tags:
        - stig
        - SV-258089r1045179_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The organization must identify authorized software programs...
    # Fix Text: Enable the fapolicyd with the following command - $ systemctl enable --now ...
    - name: 'SV-258090r958808_rule | RHEL 9 fapolicy module must be enabled.'
      debug:
        msg: "Manual hardening required for SV-258090r958808_rule: RHEL 9 fapolicy module must be enabled. - Enable the fapolicyd with the following command:  $ systemctl enable --now fapolicyd Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258090r958808_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>Use of a complex password helps to increase the time and re...
    # Fix Text: Configure RHEL 9 to limit the "pwquality" retry option to "3". Add or updat...
    - name: 'SV-258091r1045185_rule | RHEL 9 must ensure the password complexity module in the system-auth file is configured for three retries or less.'
      debug:
        msg: "Manual hardening required for SV-258091r1045185_rule: RHEL 9 must ensure the password complexity module in the system-auth file is configured for three re - Configure RHEL 9 to limit the 'pwquality' retry option to '3'.  Add or update the following line in  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258091r1045185_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: high
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>If an account has an empty password, anyone could log in an...
    # Fix Text: If PAM is managed with authselect, use the following command to remove inst...
    - name: 'SV-258094r1045187_rule | RHEL 9 must not allow blank or null passwords.'
      debug:
        msg: "Manual hardening required for SV-258094r1045187_rule: RHEL 9 must not allow blank or null passwords. - If PAM is managed with authselect, use the following command to remove instances of 'nullok':   $ su Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258094r1045187_rule
        - other
        - severity_high
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.07.1(ii)
    # Description: <VulnDiscussion>If the pam_faillock.so module is not loaded, the system wil...
    # Fix Text: Configure RHEL 9 to include the use of the pam_faillock.so module in the /e...
    - name: 'SV-258095r1045189_rule | RHEL 9 must configure the use of the pam_faillock.so module in the /etc/pam.d/system-auth file.'
      debug:
        msg: "Manual hardening required for SV-258095r1045189_rule: RHEL 9 must configure the use of the pam_faillock.so module in the /etc/pam.d/system-auth file. - Configure RHEL 9 to include the use of the pam_faillock.so module in the /etc/pam.d/system-auth file Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258095r1045189_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.07.1(ii)
    # Description: <VulnDiscussion>If the pam_faillock.so module is not loaded, the system wil...
    # Fix Text: Configure RHEL 9 to include the use of the pam_faillock.so module in the /e...
    - name: 'SV-258096r1045191_rule | RHEL 9 must configure the use of the pam_faillock.so module in the /etc/pam.d/password-auth file.'
      debug:
        msg: "Manual hardening required for SV-258096r1045191_rule: RHEL 9 must configure the use of the pam_faillock.so module in the /etc/pam.d/password-auth file. - Configure RHEL 9 to include the use of the pam_faillock.so module in the /etc/pam.d/password-auth fi Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258096r1045191_rule
        - other
        - severity_medium
        - manual

    # Category: config
    # STIG Severity: medium
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>Enabling PAM password complexity permits enforcement of str...
    # Fix Text: Configure RHEL 9 to use "pwquality" to enforce password complexity rules. A...
    - name: 'SV-258097r1045193_rule | RHEL 9 must ensure the password complexity module is enabled in the password-auth file.'
      lineinfile:
        path: /etc/pam.d/password-auth
        line: 'Configure RHEL'
        regexp: '^#?\s*Configure\s+'
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258097r1045193_rule
        - config
        - severity_medium
        - automatable

    # Category: config
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Enabling PAM password complexity permits enforcement of str...
    # Fix Text: Configure RHEL 9 to use "pwquality" to enforce password complexity rules. A...
    - name: 'SV-258098r1045195_rule | RHEL 9 must ensure the password complexity module is enabled in the system-auth file.'
      lineinfile:
        path: /etc/pam.d/system-auth
        line: 'Configure RHEL'
        regexp: '^#?\s*Configure\s+'
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258098r1045195_rule
        - config
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: IA.07.1
    # Description: <VulnDiscussion>Passwords need to be protected at all times, and encryption...
    # Fix Text: Configure RHEL 9 to use 100000 hashing rounds for hashing passwords. Add or...
    - name: 'SV-258099r1045198_rule | RHEL 9 password-auth must be configured to use a sufficient number of hashing rounds.'
      debug:
        msg: "Manual hardening required for SV-258099r1045198_rule: RHEL 9 password-auth must be configured to use a sufficient number of hashing rounds. - Configure RHEL 9 to use 100000 hashing rounds for hashing passwords.  Add or modify the following li Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258099r1045198_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.07.1
    # Description: <VulnDiscussion>Passwords need to be protected at all times, and encryption...
    # Fix Text: Configure RHEL 9 to use 100000 hashing rounds for hashing passwords. Add or...
    - name: 'SV-258100r1045201_rule | RHEL 9 system-auth must be configured to use a sufficient number of hashing rounds.'
      debug:
        msg: "Manual hardening required for SV-258100r1045201_rule: RHEL 9 system-auth must be configured to use a sufficient number of hashing rounds. - Configure RHEL 9 to use 100000 hashing rounds for hashing passwords.  Add or modify the following li Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258100r1045201_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>Use of a complex password helps to increase the time and re...
    # Fix Text: Configure RHEL 9 to enforce password complexity on the root account. Add or...
    - name: 'SV-258101r1045204_rule | RHEL 9 must enforce password complexity rules for the root account.'
      debug:
        msg: "Manual hardening required for SV-258101r1045204_rule: RHEL 9 must enforce password complexity rules for the root account. - Configure RHEL 9 to enforce password complexity on the root account.  Add or update the following li Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258101r1045204_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>Use of a complex password helps to increase the time and re...
    # Fix Text: Configure RHEL 9 to enforce password complexity by requiring at least one l...
    - name: 'SV-258102r1045207_rule | RHEL 9 must enforce password complexity by requiring that at least one lowercase character be used.'
      debug:
        msg: "Manual hardening required for SV-258102r1045207_rule: RHEL 9 must enforce password complexity by requiring that at least one lowercase character be used. - Configure RHEL 9 to enforce password complexity by requiring at least one lowercase character be use Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258102r1045207_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>Use of a complex password helps to increase the time and re...
    # Fix Text: Configure RHEL 9 to enforce password complexity by requiring at least one n...
    - name: 'SV-258103r1045210_rule | RHEL 9 must enforce password complexity by requiring that at least one numeric character be used.'
      debug:
        msg: "Manual hardening required for SV-258103r1045210_rule: RHEL 9 must enforce password complexity by requiring that at least one numeric character be used. - Configure RHEL 9 to enforce password complexity by requiring at least one numeric character be used  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258103r1045210_rule
        - other
        - severity_medium
        - manual

    # Category: config
    # STIG Severity: medium
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>Enforcing a minimum password lifetime helps to prevent repe...
    # Fix Text: Configure RHEL 9 to enforce 24 hours as the minimum password lifetime. Add ...
    - name: 'SV-258104r1015104_rule | RHEL 9 passwords for new users or password changes must have a 24 hours minimum password lifetime restriction in /etc/login.defs.'
      lineinfile:
        path: /etc/login.defs
        line: 'PASS_MIN_DAYS 1'
        regexp: '^#?\s*PASS_MIN_DAYS\s+'
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258104r1015104_rule
        - config
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>Enforcing a minimum password lifetime helps to prevent repe...
    # Fix Text: Configure noncompliant accounts to enforce a 24 hour minimum password lifet...
    - name: 'SV-258105r1045212_rule | RHEL 9 passwords must have a 24 hours minimum password lifetime restriction in /etc/shadow.'
      debug:
        msg: "Manual hardening required for SV-258105r1045212_rule: RHEL 9 passwords must have a 24 hours minimum password lifetime restriction in /etc/shadow. - Configure noncompliant accounts to enforce a 24 hour minimum password lifetime:  $ sudo passwd -n 1  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258105r1045212_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.11
    # Description: <VulnDiscussion>Without reauthentication, users may access resources or per...
    # Fix Text: Configure RHEL 9 to not allow users to execute privileged actions without a...
    - name: 'SV-258106r1102061_rule | RHEL 9 must require users to provide a password for privilege escalation.'
      shell: |
        find /etc/sudoers /etc/sudoers.d -type f -exec sed -i '/NOPASSWD/ s/^/# /g' {} \
      tags:
        - stig
        - SV-258106r1102061_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05.1(1)(i)
    # Description: <VulnDiscussion>The shorter the password, the lower the number of possible ...
    # Fix Text: Configure RHEL 9 to enforce a minimum 15-character password length. Add or ...
    - name: 'SV-258107r1045218_rule | RHEL 9 passwords must be created with a minimum of 15 characters.'
      debug:
        msg: "Manual hardening required for SV-258107r1045218_rule: RHEL 9 passwords must be created with a minimum of 15 characters. - Configure RHEL 9 to enforce a minimum 15-character password length.  Add or update the following lin Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258107r1045218_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>Use of a complex password helps to increase the time and re...
    # Fix Text: Configure RHEL 9 to enforce password complexity by requiring at least one s...
    - name: 'SV-258109r1045220_rule | RHEL 9 must enforce password complexity by requiring that at least one special character be used.'
      debug:
        msg: "Manual hardening required for SV-258109r1045220_rule: RHEL 9 must enforce password complexity by requiring that at least one special character be used. - Configure RHEL 9 to enforce password complexity by requiring at least one special character be used  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258109r1045220_rule
        - other
        - severity_medium
        - manual

    # Category: config
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Use of a complex password helps to increase the time and re...
    # Fix Text: Configure RHEL 9 to prevent the use of dictionary words for passwords. Add ...
    - name: 'SV-258110r1045223_rule | RHEL 9 must prevent the use of dictionary words for passwords.'
      lineinfile:
        path: /etc/security/pwquality.conf
        line: 'dictcheck=1'
        regexp: '^#?\s*dictcheck\s*='
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258110r1045223_rule
        - config
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>Use of a complex password helps to increase the time and re...
    # Fix Text: Configure RHEL 9 to enforce password complexity by requiring that at least ...
    - name: 'SV-258111r1045226_rule | RHEL 9 must enforce password complexity by requiring that at least one uppercase character be used.'
      debug:
        msg: "Manual hardening required for SV-258111r1045226_rule: RHEL 9 must enforce password complexity by requiring that at least one uppercase character be used. - Configure RHEL 9 to enforce password complexity by requiring that at least one uppercase character b Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258111r1045226_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>Use of a complex password helps to increase the time and re...
    # Fix Text: Configure RHEL 9 to require the change of at least eight of the total numbe...
    - name: 'SV-258112r1045229_rule | RHEL 9 must require the change of at least eight characters when passwords are changed.'
      debug:
        msg: "Manual hardening required for SV-258112r1045229_rule: RHEL 9 must require the change of at least eight characters when passwords are changed. - Configure RHEL 9 to require the change of at least eight of the total number of characters when pass Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258112r1045229_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>Use of a complex password helps to increase the time and re...
    # Fix Text: Configure RHEL 9 to require the change of the number of repeating character...
    - name: 'SV-258113r1045232_rule | RHEL 9 must require the maximum number of repeating characters of the same character class be limited to four when passwords are changed.'
      debug:
        msg: "Manual hardening required for SV-258113r1045232_rule: RHEL 9 must require the maximum number of repeating characters of the same character class be limite - Configure RHEL 9 to require the change of the number of repeating characters of the same character c Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258113r1045232_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>Use of a complex password helps to increase the time and re...
    # Fix Text: Configure RHEL 9 to require the change of the number of repeating consecuti...
    - name: 'SV-258114r1045235_rule | RHEL 9 must require the maximum number of repeating characters be limited to three when passwords are changed.'
      debug:
        msg: "Manual hardening required for SV-258114r1045235_rule: RHEL 9 must require the maximum number of repeating characters be limited to three when passwords ar - Configure RHEL 9 to require the change of the number of repeating consecutive characters when passwo Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258114r1045235_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>Use of a complex password helps to increase the time and re...
    # Fix Text: Configure RHEL 9 to require the change of at least four character classes w...
    - name: 'SV-258115r1045238_rule | RHEL 9 must require the change of at least four character classes when passwords are changed.'
      debug:
        msg: "Manual hardening required for SV-258115r1045238_rule: RHEL 9 must require the change of at least four character classes when passwords are changed. - Configure RHEL 9 to require the change of at least four character classes when passwords are changed Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258115r1045238_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>Passwords need to be protected at all times, and encryption...
    # Fix Text: Configure RHEL 9 to use the SHA-512 algorithm for password hashing. Add or ...
    - name: 'SV-258116r1045240_rule | RHEL 9 must be configured so that user and group account administration utilities are configured to store only encrypted representations of passwords.'
      debug:
        msg: "Manual hardening required for SV-258116r1045240_rule: RHEL 9 must be configured so that user and group account administration utilities are configured to  - Configure RHEL 9 to use the SHA-512 algorithm for password hashing.  Add or change the following lin Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258116r1045240_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>Passwords need to be protected at all times, and encryption...
    # Fix Text: Configure RHEL 9 to store only SHA512 encrypted representations of password...
    - name: 'SV-258117r1015116_rule | RHEL 9 must be configured to use the shadow file to store only encrypted representations of passwords.'
      debug:
        msg: "Manual hardening required for SV-258117r1015116_rule: RHEL 9 must be configured to use the shadow file to store only encrypted representations of password - Configure RHEL 9 to store only SHA512 encrypted representations of passwords.  Add or update the fol Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258117r1015116_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.11
    # Description: <VulnDiscussion>Without reauthentication, users may access resources or per...
    # Fix Text: Configure the operating system to require users to supply a password for pr...
    - name: 'SV-258118r1050789_rule | RHEL 9 must not be configured to bypass password requirements for privilege escalation.'
      debug:
        msg: "Manual hardening required for SV-258118r1050789_rule: RHEL 9 must not be configured to bypass password requirements for privilege escalation. - Configure the operating system to require users to supply a password for privilege escalation.  Remo Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258118r1050789_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>If an account has an empty password, anyone could log in an...
    # Fix Text: Configure all accounts on RHEL 9 to have a password or lock the account wit...
    - name: 'SV-258120r991589_rule | RHEL 9 must not have accounts configured with blank or null passwords.'
      debug:
        msg: "Manual hardening required for SV-258120r991589_rule: RHEL 9 must not have accounts configured with blank or null passwords. - Configure all accounts on RHEL 9 to have a password or lock the account with the following commands: Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258120r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.02.1
    # Description: <VulnDiscussion>Smart card login provides two-factor authentication stronge...
    # Fix Text: Configure RHEL 9 to load the CAC driver. $ sudo opensc-tool --set-conf-entr...
    - name: 'SV-258121r1102086_rule | RHEL 9 must use the common access card (CAC) smart card driver.'
      systemd:
        name: pcscd.service
        state: restarted
      tags:
        - stig
        - SV-258121r1102086_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.02.1(1)
    # Description: <VulnDiscussion>Without the use of multifactor authentication, the ease of ...
    # Fix Text: Edit the file "/etc/sssd/sssd.conf" or a configuration file in "/etc/sssd/c...
    - name: 'SV-258122r1045246_rule | RHEL 9 must enable certificate based smart card authentication.'
      debug:
        msg: "Manual hardening required for SV-258122r1045246_rule: RHEL 9 must enable certificate based smart card authentication. - Edit the file '/etc/sssd/sssd.conf' or a configuration file in '/etc/sssd/conf.d' and add or edit th Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258122r1045246_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.02(12)
    # Description: <VulnDiscussion>Using an authentication device, such as a DOD common access...
    # Fix Text: Configure RHEL 9 to implement certificate status checking for multifactor a...
    - name: 'SV-258123r1134923_rule | RHEL 9 must implement certificate status checking for multifactor authentication.'
      file:
        path: /etc/sssd/conf.d/certificate_verification.conf
        mode: '600'
        owner: root
        group: root
        state: file
      tags:
        - stig
        - SV-258123r1134923_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.02(11)
    # Description: <VulnDiscussion>The pcsc-lite package must be installed if it is to be avai...
    # Fix Text: The pcsc-lite package can be installed with the following command - $ sudo ...
    - name: 'SV-258124r1045250_rule | RHEL 9 must have the pcsc-lite package installed.'
      package:
        name: pcsc-lite
        state: present
      tags:
        - stig
        - SV-258124r1045250_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.02(11)
    # Description: <VulnDiscussion>The information system ensures that even if the information...
    # Fix Text: To enable the pcscd socket, run the following command - $ sudo systemctl en...
    - name: 'SV-258125r1045253_rule | The pcscd service on RHEL 9 must be active.'
      debug:
        msg: "Manual hardening required for SV-258125r1045253_rule: The pcscd service on RHEL 9 must be active. - To enable the pcscd socket, run the following command:  $ sudo systemctl enable --now pcscd.socket Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258125r1045253_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.02(12)
    # Description: <VulnDiscussion>The use of PIV credentials facilitates standardization and ...
    # Fix Text: The opensc package can be installed with the following command - $ sudo dnf...
    - name: 'SV-258126r1045255_rule | RHEL 9 must have the opensc package installed.'
      package:
        name: opensc
        state: present
      tags:
        - stig
        - SV-258126r1045255_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05(2)(b)
    # Description: <VulnDiscussion>If the private key is discovered, an attacker can use the k...
    # Fix Text: Create a new private and public key pair that utilizes a passcode with the ...
    - name: 'SV-258127r1134925_rule | RHEL 9, for PKI-based authentication, must enforce authorized access to the corresponding private key.'
      debug:
        msg: "Manual hardening required for SV-258127r1134925_rule: RHEL 9, for PKI-based authentication, must enforce authorized access to the corresponding private ke - Create a new private and public key pair that utilizes a passcode with the following command:  $ sud Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258127r1134925_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.03.1
    # Description: <VulnDiscussion>To mitigate the risk of unauthorized access to sensitive in...
    # Fix Text: Configure RHEL 9 to require authentication for emergency mode. Add or modif...
    - name: 'SV-258128r1117265_rule | RHEL 9 must require authentication to access emergency mode.'
      debug:
        msg: "Manual hardening required for SV-258128r1117265_rule: RHEL 9 must require authentication to access emergency mode. - Configure RHEL 9 to require authentication for emergency mode.  Add or modify the following line in  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258128r1117265_rule
        - other
        - severity_medium
        - manual

    # Category: file_permission
    # STIG Severity: medium
    # NIST: AC.03.1
    # Description: <VulnDiscussion>To mitigate the risk of unauthorized access to sensitive in...
    # Fix Text: Configure RHEL 9 to require authentication for single-user mode. Create a d...
    - name: 'SV-258129r1117265_rule | RHEL 9 must require authentication to access single-user mode.'
      file:
        path: /etc/systemd/system/rescue.service.d/
        state: file
      tags:
        - stig
        - SV-258129r1117265_rule
        - file_permission
        - severity_medium
        - automatable

    # Category: package
    # STIG Severity: medium
    # NIST: IA.05(2)(a)
    # Description: <VulnDiscussion>Without path validation, an informed trust decision by the ...
    # Fix Text: Configure RHEL 9, for PKI-based authentication, to validate certificates by...
    - name: 'SV-258131r1134927_rule | RHEL 9, for PKI-based authentication, must validate certificates by constructing a certification path (which includes status information) to an accepted trust anchor.'
      debug:
        msg: "Manual hardening required for SV-258131r1134927_rule: RHEL 9, for PKI-based authentication, must validate certificates by constructing a certification pat - Configure RHEL 9, for PKI-based authentication, to validate certificates by constructing a certifica Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258131r1134927_rule
        - package
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05(2)(c)
    # Description: <VulnDiscussion>Without mapping the certificate used to authenticate to the...
    # Fix Text: Configure RHEL 9 to map the authenticated identity to the user or group acc...
    - name: 'SV-258132r1134929_rule | RHEL 9 must map the authenticated identity to the user or group account for PKI-based authentication.'
      systemd:
        name: sssd.service
        state: restarted
      tags:
        - stig
        - SV-258132r1134929_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05(13)
    # Description: <VulnDiscussion>If cached authentication information is out-of-date, the va...
    # Fix Text: Configure the SSSD to prohibit the use of cached authentications after one ...
    - name: 'SV-258133r1045263_rule | RHEL 9 must prohibit the use of cached authenticators after one day.'
      debug:
        msg: "Manual hardening required for SV-258133r1045263_rule: RHEL 9 must prohibit the use of cached authenticators after one day. - Configure the SSSD to prohibit the use of cached authentications after one day.  Edit the file '/etc Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258133r1045263_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.03(5)
    # Description: <VulnDiscussion>Without verification of the security functions, security fu...
    # Fix Text: Install AIDE, initialize it, and perform a manual check. Install AIDE - $ s...
    - name: 'SV-258134r1101983_rule | RHEL 9 must have the AIDE package installed.'
      package:
        name: aide
        state: present
      tags:
        - stig
        - SV-258134r1101983_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.03(5)
    # Description: <VulnDiscussion>Unauthorized changes to the baseline configuration could ma...
    # Fix Text: Configure the file integrity tool to run automatically on the system at lea...
    - name: 'SV-258135r1045267_rule | RHEL 9 must routinely check the baseline configuration for unauthorized changes and notify the system administrator when anomalies in the operation of any security functions are discovered.'
      debug:
        msg: "Manual hardening required for SV-258135r1045267_rule: RHEL 9 must routinely check the baseline configuration for unauthorized changes and notify the syste - Configure the file integrity tool to run automatically on the system at least weekly and to notify d Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258135r1045267_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>RHEL 9 installation media ships with an optional file integ...
    # Fix Text: Configure the file integrity tool to use FIPS 140-3 cryptographic hashes fo...
    - name: 'SV-258136r1045270_rule | RHEL 9 must use a file integrity tool that is configured to use FIPS 140-3-approved cryptographic hashes for validating file contents and directories.'
      debug:
        msg: "Manual hardening required for SV-258136r1045270_rule: RHEL 9 must use a file integrity tool that is configured to use FIPS 140-3-approved cryptographic ha - Configure the file integrity tool to use FIPS 140-3 cryptographic hashes for validating file and dir Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258136r1045270_rule
        - other
        - severity_medium
        - manual

    # Category: package
    # STIG Severity: medium
    # NIST: AU.09.1
    # Description: <VulnDiscussion>Protecting the integrity of the tools used for auditing pur...
    # Fix Text: Add or update the following lines to "/etc/aide.conf", to protect the integ...
    - name: 'SV-258137r1102081_rule | RHEL 9 must use cryptographic mechanisms to protect the integrity of audit tools.'
      debug:
        msg: "Manual hardening required for SV-258137r1102081_rule: RHEL 9 must use cryptographic mechanisms to protect the integrity of audit tools. - Add or update the following lines to '/etc/aide.conf', to protect the integrity of the audit tools.  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258137r1102081_rule
        - package
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: low
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>RHEL 9 installation media ships with an optional file integ...
    # Fix Text: Configure the file integrity tool to check file and directory ACLs. If AIDE...
    - name: 'SV-258138r1045274_rule | RHEL 9 must be configured so that the file integrity tool verifies Access Control Lists (ACLs).'
      debug:
        msg: "Manual hardening required for SV-258138r1045274_rule: RHEL 9 must be configured so that the file integrity tool verifies Access Control Lists (ACLs). - Configure the file integrity tool to check file and directory ACLs.   If AIDE is installed, ensure t Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258138r1045274_rule
        - other
        - severity_low
        - manual

    # Category: other
    # STIG Severity: low
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>RHEL 9 installation media ships with an optional file integ...
    # Fix Text: Configure the file integrity tool to check file and directory extended attr...
    - name: 'SV-258139r1045276_rule | RHEL 9 must be configured so that the file integrity tool verifies extended attributes.'
      debug:
        msg: "Manual hardening required for SV-258139r1045276_rule: RHEL 9 must be configured so that the file integrity tool verifies extended attributes. - Configure the file integrity tool to check file and directory extended attributes.   If AIDE is inst Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258139r1045276_rule
        - other
        - severity_low
        - manual

    # Category: package
    # STIG Severity: medium
    # NIST: AU.06.1(4)
    # Description: <VulnDiscussion>rsyslogd is a system utility providing support for message ...
    # Fix Text: Install the rsyslog package with the following command - $ sudo dnf install...
    - name: 'SV-258140r1106460_rule | RHEL 9 must have the rsyslog package installed.'
      package:
        name: rsyslog
        state: present
      tags:
        - stig
        - SV-258140r1106460_rule
        - package
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: IA.07.1
    # Description: <VulnDiscussion>The rsyslog-gnutls package provides Transport Layer Securit...
    # Fix Text: The rsyslog-gnutls package can be installed with the following command - $ ...
    - name: 'SV-258141r1045280_rule | RHEL 9 must have the packages required for encrypting offloaded audit logs installed.'
      package:
        name: rsyslog-gnutls
        state: present
      tags:
        - stig
        - SV-258141r1045280_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>The "rsyslog" service must be running to provide logging se...
    # Fix Text: To enable the rsyslog service, run the following command - $ sudo systemctl...
    - name: 'SV-258142r991589_rule | The rsyslog service on RHEL 9 must be active.'
      debug:
        msg: "Manual hardening required for SV-258142r991589_rule: The rsyslog service on RHEL 9 must be active. - To enable the rsyslog service, run the following command:  $ sudo systemctl enable --now rsyslog Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258142r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Unintentionally running a rsyslog server accepting remote m...
    # Fix Text: Configure RHEL 9 to not receive remote logs using rsyslog. Remove the lines...
    - name: 'SV-258143r1134931_rule | RHEL 9 must be configured so that the rsyslog daemon does not accept log messages from other servers unless the server is being used for log aggregation.'
      systemd:
        name: rsyslog.service
        state: restarted
      tags:
        - stig
        - SV-258143r1134931_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.17.1(1)
    # Description: <VulnDiscussion>Logging remote access methods can be used to trace the decr...
    # Fix Text: Add or update the following lines to the "/etc/rsyslog.conf" file or a file...
    - name: 'SV-258144r1045286_rule | All RHEL 9 remote access methods must be monitored.'
      systemd:
        name: rsyslog.service
        state: restarted
      tags:
        - stig
        - SV-258144r1045286_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.04(1)
    # Description: <VulnDiscussion>Information stored in one location is vulnerable to acciden...
    # Fix Text: Configure RHEL 9 to authenticate the remote logging server for offloading a...
    - name: 'SV-258146r1045288_rule | RHEL 9 must authenticate the remote logging server for offloading audit logs via rsyslog.'
      debug:
        msg: "Manual hardening required for SV-258146r1045288_rule: RHEL 9 must authenticate the remote logging server for offloading audit logs via rsyslog. - Configure RHEL 9 to authenticate the remote logging server for offloading audit logs by setting the  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258146r1045288_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.04(1)
    # Description: <VulnDiscussion>Information stored in one location is vulnerable to acciden...
    # Fix Text: Configure RHEL 9 to encrypt offloaded audit records via rsyslog by setting ...
    - name: 'SV-258147r1045290_rule | RHEL 9 must encrypt the transfer of audit records offloaded onto a different system or media from the system being audited via rsyslog.'
      debug:
        msg: "Manual hardening required for SV-258147r1045290_rule: RHEL 9 must encrypt the transfer of audit records offloaded onto a different system or media from th - Configure RHEL 9 to encrypt offloaded audit records via rsyslog by setting the following options in  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258147r1045290_rule
        - other
        - severity_medium
        - manual

    # Category: config
    # STIG Severity: medium
    # NIST: AU.04(1)
    # Description: <VulnDiscussion>Information stored in one location is vulnerable to acciden...
    # Fix Text: Configure RHEL 9 to use the gtls driver to encrypt offloaded audit records ...
    - name: 'SV-258148r1045292_rule | RHEL 9 must encrypt via the gtls driver the transfer of audit records offloaded onto a different system or media from the system being audited via rsyslog.'
      lineinfile:
        path: /etc/rsyslog.conf
        line: 'Configure RHEL'
        regexp: '^#?\s*Configure\s+'
        create: yes
        backup: yes
      tags:
        - stig
        - SV-258148r1045292_rule
        - config
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: AU.04(1)
    # Description: <VulnDiscussion>Information stored in one location is vulnerable to acciden...
    # Fix Text: Configure RHEL 9 to off-load audit records onto a different system or media...
    - name: 'SV-258149r1106462_rule | RHEL 9 must be configured to forward audit records via TCP to a different system or media from the system being audited via rsyslog.'
      debug:
        msg: "Manual hardening required for SV-258149r1106462_rule: RHEL 9 must be configured to forward audit records via TCP to a different system or media from the s - Configure RHEL 9 to off-load audit records onto a different system or media from the system being au Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258149r1106462_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Cron logging can be used to trace the successful or unsucce...
    # Fix Text: Configure "rsyslog" to log all cron messages by adding or updating the foll...
    - name: 'SV-258150r1045296_rule | RHEL 9 must use cron logging.'
      systemd:
        name: rsyslog.service
        state: restarted
      tags:
        - stig
        - SV-258150r1045296_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without establishing what type of events occurred, the sour...
    # Fix Text: Install the audit service package (if the audit service is not already inst...
    - name: 'SV-258151r1045298_rule | RHEL 9 audit package must be installed.'
      package:
        name: audit
        state: present
      tags:
        - stig
        - SV-258151r1045298_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without establishing what type of events occurred, it would...
    # Fix Text: To enable the auditd service run the following command - $ sudo systemctl e...
    - name: 'SV-258152r1015127_rule | RHEL 9 audit service must be enabled.'
      debug:
        msg: "Manual hardening required for SV-258152r1015127_rule: RHEL 9 audit service must be enabled. - To enable the auditd service run the following command:  $ sudo systemctl enable --now auditd Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258152r1015127_rule
        - other
        - severity_medium
        - manual

    # Category: audit
    # STIG Severity: medium
    # NIST: AU.05.1(iv)
    # Description: <VulnDiscussion>It is critical that when the operating system is at risk of...
    # Fix Text: Configure RHEL 9 to shut down by default upon audit failure (unless availab...
    - name: 'SV-258153r1038966_rule | RHEL 9 audit system must take appropriate action when an error writing to the audit storage volume occurs.'
      debug:
        msg: "Manual hardening required for SV-258153r1038966_rule: RHEL 9 audit system must take appropriate action when an error writing to the audit storage volume o - Configure RHEL 9 to shut down by default upon audit failure (unless availability is an overriding co Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258153r1038966_rule
        - audit
        - severity_medium
        - automatable

    # Category: audit
    # STIG Severity: medium
    # NIST: AU.05.1(iv)
    # Description: <VulnDiscussion>It is critical that when the operating system is at risk of...
    # Fix Text: Configure RHEL 9 to shut down by default upon audit failure (unless availab...
    - name: 'SV-258154r1038966_rule | RHEL 9 audit system must take appropriate action when the audit storage volume is full.'
      debug:
        msg: "Manual hardening required for SV-258154r1038966_rule: RHEL 9 audit system must take appropriate action when the audit storage volume is full. - Configure RHEL 9 to shut down by default upon audit failure (unless availability is an overriding co Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258154r1038966_rule
        - audit
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: AU.04
    # Description: <VulnDiscussion>To ensure RHEL 9 systems have a sufficient storage capacity...
    # Fix Text: Allocate enough storage capacity for at least one week of audit records whe...
    - name: 'SV-258155r1045300_rule | RHEL 9 must allocate audit record storage capacity to store at least one week''s worth of audit records.'
      debug:
        msg: "Manual hardening required for SV-258155r1045300_rule: RHEL 9 must allocate audit record storage capacity to store at least one week's worth of audit recor - Allocate enough storage capacity for at least one week of audit records when audit records are not i Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258155r1045300_rule
        - other
        - severity_medium
        - manual

    # Category: audit
    # STIG Severity: medium
    # NIST: AU.05(1)
    # Description: <VulnDiscussion>If security personnel are not notified immediately when sto...
    # Fix Text: Configure RHEL 9 to initiate an action to notify the SA and ISSO (at a mini...
    - name: 'SV-258156r1106364_rule | RHEL 9 must take action when allocated audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity.'
      debug:
        msg: "Manual hardening required for SV-258156r1106364_rule: RHEL 9 must take action when allocated audit record storage volume reaches 75 percent of the reposit - Configure RHEL 9 to initiate an action to notify the SA and ISSO (at a minimum) when allocated audit Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258156r1106364_rule
        - audit
        - severity_medium
        - automatable

    # Category: audit
    # STIG Severity: medium
    # NIST: AU.05(1)
    # Description: <VulnDiscussion>If security personnel are not notified immediately when sto...
    # Fix Text: Configure RHEL 9 to initiate an action to notify the SA and ISSO (at a mini...
    - name: 'SV-258157r1134932_rule | RHEL 9 must notify the system administrator (SA) and information system security officer (ISSO) (at a minimum) when allocated audit record storage volume reaches 75 percent utilization.'
      debug:
        msg: "Manual hardening required for SV-258157r1134932_rule: RHEL 9 must notify the system administrator (SA) and information system security officer (ISSO) (at  - Configure RHEL 9 to initiate an action to notify the SA and ISSO (at a minimum) when allocated audit Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258157r1134932_rule
        - audit
        - severity_medium
        - automatable

    # Category: audit
    # STIG Severity: medium
    # NIST: AU.05(1)
    # Description: <VulnDiscussion>If action is not taken when storage volume reaches 95 perce...
    # Fix Text: Configure RHEL 9 to initiate an action when allocated audit record storage ...
    - name: 'SV-258158r971542_rule | RHEL 9 must take action when allocated audit record storage volume reaches 95 percent of the audit record storage capacity.'
      debug:
        msg: "Manual hardening required for SV-258158r971542_rule: RHEL 9 must take action when allocated audit record storage volume reaches 95 percent of the audit r - Configure RHEL 9 to initiate an action when allocated audit record storage volume reaches 95 percent Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258158r971542_rule
        - audit
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: AU.05(1)
    # Description: <VulnDiscussion>If action is not taken when storage volume reaches 95 perce...
    # Fix Text: Configure "auditd" service to take action in the event of allocated audit r...
    - name: 'SV-258159r971542_rule | RHEL 9 must take action when allocated audit record storage volume reaches 95 percent of the repository maximum audit record storage capacity.'
      debug:
        msg: "Manual hardening required for SV-258159r971542_rule: RHEL 9 must take action when allocated audit record storage volume reaches 95 percent of the reposit - Configure 'auditd' service  to take action in the event of allocated audit record storage volume rea Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258159r971542_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.05.1(iv)
    # Description: <VulnDiscussion>It is critical that when the operating system is at risk of...
    # Fix Text: Configure RHEL 9 to rotate the audit log when it reaches maximum size. Add ...
    - name: 'SV-258160r1038966_rule | RHEL 9 audit system must take appropriate action when the audit files have reached maximum size.'
      debug:
        msg: "Manual hardening required for SV-258160r1038966_rule: RHEL 9 audit system must take appropriate action when the audit files have reached maximum size. - Configure RHEL 9 to rotate the audit log when it reaches maximum size.  Add or update the following  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258160r1038966_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Enriched logging is needed to determine who, what, and when...
    # Fix Text: Edit the /etc/audit/auditd.conf file and add or update the "name_format" op...
    - name: 'SV-258161r958416_rule | RHEL 9 must label all offloaded audit logs before sending them to the central log server.'
      debug:
        msg: "Manual hardening required for SV-258161r958416_rule: RHEL 9 must label all offloaded audit logs before sending them to the central log server. - Edit the /etc/audit/auditd.conf file and add or update the 'name_format' option:  name_format = host Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258161r958416_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.04(1)
    # Description: <VulnDiscussion>The audit system should have an action setup in the event t...
    # Fix Text: Edit the /etc/audit/auditd.conf file and add or update the "overflow_action...
    - name: 'SV-258162r958754_rule | RHEL 9 must take appropriate action when the internal event queue is full.'
      debug:
        msg: "Manual hardening required for SV-258162r958754_rule: RHEL 9 must take appropriate action when the internal event queue is full. - Edit the /etc/audit/auditd.conf file and add or update the 'overflow_action' option:  overflow_actio Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258162r958754_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.05.1(ii)
    # Description: <VulnDiscussion>It is critical for the appropriate personnel to be aware if...
    # Fix Text: Configure "auditd" service to notify the SA and ISSO in the event of an aud...
    - name: 'SV-258163r958424_rule | RHEL 9 System Administrator (SA) and/or information system security officer (ISSO) (at a minimum) must be alerted of an audit processing failure event.'
      debug:
        msg: "Manual hardening required for SV-258163r958424_rule: RHEL 9 System Administrator (SA) and/or information system security officer (ISSO) (at a minimum) mu - Configure 'auditd' service to notify the SA and ISSO in the event of an audit processing failure.  E Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258163r958424_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.12.1(ii)
    # Description: <VulnDiscussion>Without establishing what type of events occurred, the sour...
    # Fix Text: Configure RHEL 9 to generate audit records for local events by adding or up...
    - name: 'SV-258164r1045301_rule | RHEL 9 audit system must audit local events.'
      debug:
        msg: "Manual hardening required for SV-258164r1045301_rule: RHEL 9 audit system must audit local events. - Configure RHEL 9 to generate audit records for local events by adding or updating the following line Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258164r1045301_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.09.1
    # Description: <VulnDiscussion>Unauthorized disclosure of audit records can reveal system ...
    # Fix Text: Change the group of the directory of "/var/log/audit" to be owned by a corr...
    - name: 'SV-258165r958434_rule | RHEL 9 audit logs must be group-owned by root or by a restricted logging group to prevent unauthorized read access.'
      shell: |
        grep -P '^[ ]*log_group[ ]+=.*$' /etc/audit/auditd.conf
      tags:
        - stig
        - SV-258165r958434_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.09.1
    # Description: <VulnDiscussion>Unauthorized disclosure of audit records can reveal system ...
    # Fix Text: Configure the audit log to be protected from unauthorized read access by se...
    - name: 'SV-258166r1045303_rule | RHEL 9 audit log directory must be owned by root to prevent unauthorized read access.'
      shell: |
        chown root /var/log/audit
      tags:
        - stig
        - SV-258166r1045303_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.09.1
    # Description: <VulnDiscussion>Only authorized personnel should be aware of errors and the...
    # Fix Text: Configure the audit logs to have a mode of "0600" with the following comman...
    - name: 'SV-258167r1101918_rule | RHEL 9 audit logs file must have mode 0600 or less permissive to prevent unauthorized access to the audit log.'
      file:
        path: /etc/audit/auditd.conf
        mode: '0600'
        group: that
        state: file
      tags:
        - stig
        - SV-258167r1101918_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.06.1(4)
    # Description: <VulnDiscussion>If option "freq" is not set to a value that requires audit ...
    # Fix Text: Configure RHEL 9 to flush audit to disk by adding or updating the following...
    - name: 'SV-258168r958428_rule | RHEL 9 must periodically flush audit records to disk to prevent the loss of audit records.'
      debug:
        msg: "Manual hardening required for SV-258168r958428_rule: RHEL 9 must periodically flush audit records to disk to prevent the loss of audit records. - Configure RHEL 9 to flush audit to disk by adding or updating the following rule in '/etc/audit/audi Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258168r958428_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Without establishing what type of events occurred, the sour...
    # Fix Text: Edit the /etc/audit/auditd.conf file and add or update the "log_format" opt...
    - name: 'SV-258169r991556_rule | RHEL 9 must produce audit records containing information to establish the identity of any individual or process associated with the event.'
      debug:
        msg: "Manual hardening required for SV-258169r991556_rule: RHEL 9 must produce audit records containing information to establish the identity of any individual - Edit the /etc/audit/auditd.conf file and add or update the 'log_format' option:  log_format = ENRICH Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258169r991556_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.06.1(iv)
    # Description: <VulnDiscussion>Audit data should be synchronously written to disk to ensur...
    # Fix Text: Configure the audit system to write log files to the disk. Edit the /etc/au...
    - name: 'SV-258170r991589_rule | RHEL 9 must write audit records to disk.'
      debug:
        msg: "Manual hardening required for SV-258170r991589_rule: RHEL 9 must write audit records to disk. - Configure the audit system to write log files to the disk.  Edit the /etc/audit/auditd.conf file and Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258170r991589_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.12.1(iii)
    # Description: <VulnDiscussion>Without the capability to restrict the roles and individual...
    # Fix Text: Configure the files in directory "/etc/audit/rules.d/" and the "/etc/audit/...
    - name: 'SV-258171r1134934_rule | RHEL 9 must allow only the information system security manager (ISSM) (or individuals or roles appointed by the ISSM) to select which auditable events are to be audited.'
      file:
        path: /etc/audit/rules.d/
        mode: '0640'
        state: file
      tags:
        - stig
        - SV-258171r1134934_rule
        - other
        - severity_medium
        - manual

    # Category: config
    # STIG Severity: low
    # NIST: AU.14.1(1)
    # Description: <VulnDiscussion>Without the capability to generate audit records, it would ...
    # Fix Text: Configure RHEL 9 to allocate sufficient audit_backlog_limit to capture proc...
    - name: 'SV-258173r1101933_rule | RHEL 9 must allocate an audit_backlog_limit of sufficient size to capture processes that start prior to the audit daemon.'
      shell: |
        grubby --update-kernel=ALL --args=audit_backlog_limit=8192
      tags:
        - stig
        - SV-258173r1101933_rule
        - config
        - severity_low
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: AU.05.1(ii)
    # Description: <VulnDiscussion>It is critical for the appropriate personnel to be aware if...
    # Fix Text: Edit the aliases map file (by default /etc/aliases) used by Postfix and con...
    - name: 'SV-258174r958424_rule | RHEL 9 must have mail aliases to notify the information system security officer (ISSO) and system administrator (SA) (at a minimum) in the event of an audit processing failure.'
      debug:
        msg: "Manual hardening required for SV-258174r958424_rule: RHEL 9 must have mail aliases to notify the information system security officer (ISSO) and system ad - Edit the aliases map file (by default /etc/aliases) used by Postfix and configure a root alias (usin Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258174r958424_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.04(1)
    # Description: <VulnDiscussion>"audispd-plugins" provides plugins for the real-time interf...
    # Fix Text: The audispd-plugins package can be installed with the following command - $...
    - name: 'SV-258175r1045310_rule | RHEL 9 audispd-plugins package must be installed.'
      package:
        name: audispd-plugins
        state: present
      tags:
        - stig
        - SV-258175r1045310_rule
        - other
        - severity_medium
        - manual

    # Category: audit
    # STIG Severity: medium
    # NIST: AC.06(8)
    # Description: <VulnDiscussion>Misuse of privileged functions, either intentionally or uni...
    # Fix Text: Configure RHEL 9 to audit the execution of the "execve" system call. Add or...
    - name: 'SV-258176r1106366_rule | RHEL 9 must audit uses of the "execve" system call.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k execpriv'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258176r1106366_rule
        - audit
        - severity_medium
        - automatable

    # Category: file_permission
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records that are specific to the s...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258177r1106368_rule | RHEL 9 must audit all uses of the chmod, fchmod, and fchmodat system calls.'
      file:
        path: /etc/audit/rules.d/audit.rules
        state: file
      tags:
        - stig
        - SV-258177r1106368_rule
        - file_permission
        - severity_medium
        - automatable

    # Category: file_permission
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records that are specific to the s...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258178r1106370_rule | RHEL 9 must audit all uses of the chown, fchown, fchownat, and lchown system calls.'
      file:
        path: /etc/audit/rules.d/audit.rules
        state: file
      tags:
        - stig
        - SV-258178r1106370_rule
        - file_permission
        - severity_medium
        - automatable

    # Category: package
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to audit the execution of the "setxattr", "fsetxattr", "ls...
    - name: 'SV-258179r1106371_rule | RHEL 9 must audit all uses of the setxattr, fsetxattr, lsetxattr, removexattr, fremovexattr, and lremovexattr system calls.'
      debug:
        msg: "Manual hardening required for SV-258179r1106371_rule: RHEL 9 must audit all uses of the setxattr, fsetxattr, lsetxattr, removexattr, fremovexattr, and lre - Configure RHEL 9 to audit the execution of the 'setxattr', 'fsetxattr', 'lsetxattr', 'removexattr',  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258179r1106371_rule
        - package
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258180r1045325_rule | RHEL 9 must audit all uses of umount system calls.'
      debug:
        msg: "Manual hardening required for SV-258180r1045325_rule: RHEL 9 must audit all uses of umount system calls. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'umount' Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258180r1045325_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258181r1045328_rule | RHEL 9 must audit all uses of the chacl command.'
      debug:
        msg: "Manual hardening required for SV-258181r1045328_rule: RHEL 9 must audit all uses of the chacl command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'chacl'  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258181r1045328_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258182r1045331_rule | RHEL 9 must audit all uses of the setfacl command.'
      debug:
        msg: "Manual hardening required for SV-258182r1045331_rule: RHEL 9 must audit all uses of the setfacl command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'setfacl Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258182r1045331_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records that are specific to the s...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258183r1045334_rule | RHEL 9 must audit all uses of the chcon command.'
      debug:
        msg: "Manual hardening required for SV-258183r1045334_rule: RHEL 9 must audit all uses of the chcon command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'chcon'  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258183r1045334_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258184r1045337_rule | RHEL 9 must audit all uses of the semanage command.'
      debug:
        msg: "Manual hardening required for SV-258184r1045337_rule: RHEL 9 must audit all uses of the semanage command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'semanag Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258184r1045337_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258185r1045340_rule | RHEL 9 must audit all uses of the setfiles command.'
      debug:
        msg: "Manual hardening required for SV-258185r1045340_rule: RHEL 9 must audit all uses of the setfiles command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'setfile Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258185r1045340_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate an audit event for any successful/unsuccessful...
    - name: 'SV-258186r1045343_rule | RHEL 9 must audit all uses of the setsebool command.'
      debug:
        msg: "Manual hardening required for SV-258186r1045343_rule: RHEL 9 must audit all uses of the setsebool command. - Configure RHEL 9 to generate an audit event for any successful/unsuccessful use of the 'setsebool '  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258186r1045343_rule
        - other
        - severity_medium
        - manual

    # Category: audit
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate an audit event for any successful/unsuccessful...
    - name: 'SV-258187r1106373_rule | RHEL 9 must audit all uses of the rename, unlink, rmdir, renameat, and unlinkat system calls.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S rename,unlink,rmdir,renameat,unlinkat -F auid>=1000 -F auid!=unset -k delete'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258187r1106373_rule
        - audit
        - severity_medium
        - automatable

    # Category: audit
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate an audit event for any successful/unsuccessful...
    - name: 'SV-258188r1106375_rule | RHEL 9 must audit all uses of the truncate, ftruncate, creat, open, openat, and open_by_handle_at system calls.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S truncate,ftruncate,creat,open,openat,open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -k perm_access'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258188r1106375_rule
        - audit
        - severity_medium
        - automatable

    # Category: audit
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate an audit event for any successful/unsuccessful...
    - name: 'SV-258189r1106377_rule | RHEL 9 must audit all uses of the delete_module system call.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S delete_module -F auid>=1000 -F auid!=unset -k module_chng'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258189r1106377_rule
        - audit
        - severity_medium
        - automatable

    # Category: audit
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate an audit event for any successful/unsuccessful...
    - name: 'SV-258190r1106379_rule | RHEL 9 must audit all uses of the init_module and finit_module system calls.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S init_module,finit_module -F auid>=1000 -F auid!=unset -k module_chng'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258190r1106379_rule
        - audit
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258191r1045358_rule | RHEL 9 must audit all uses of the chage command.'
      debug:
        msg: "Manual hardening required for SV-258191r1045358_rule: RHEL 9 must audit all uses of the chage command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'chage'  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258191r1045358_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258192r1045361_rule | RHEL 9 must audit all uses of the chsh command.'
      debug:
        msg: "Manual hardening required for SV-258192r1045361_rule: RHEL 9 must audit all uses of the chsh command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'chsh' c Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258192r1045361_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258193r1045364_rule | RHEL 9 must audit all uses of the crontab command.'
      debug:
        msg: "Manual hardening required for SV-258193r1045364_rule: RHEL 9 must audit all uses of the crontab command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'crontab Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258193r1045364_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258194r1045367_rule | RHEL 9 must audit all uses of the gpasswd command.'
      debug:
        msg: "Manual hardening required for SV-258194r1045367_rule: RHEL 9 must audit all uses of the gpasswd command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'gpasswd Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258194r1045367_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records that are specific to the s...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258195r1045370_rule | RHEL 9 must audit all uses of the kmod command.'
      debug:
        msg: "Manual hardening required for SV-258195r1045370_rule: RHEL 9 must audit all uses of the kmod command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'kmod' c Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258195r1045370_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258196r1045373_rule | RHEL 9 must audit all uses of the newgrp command.'
      debug:
        msg: "Manual hardening required for SV-258196r1045373_rule: RHEL 9 must audit all uses of the newgrp command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'newgrp' Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258196r1045373_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258197r1045376_rule | RHEL 9 must audit all uses of the pam_timestamp_check command.'
      debug:
        msg: "Manual hardening required for SV-258197r1045376_rule: RHEL 9 must audit all uses of the pam_timestamp_check command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'pam_tim Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258197r1045376_rule
        - other
        - severity_medium
        - manual

    # Category: file_permission
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258198r1045379_rule | RHEL 9 must audit all uses of the passwd command.'
      file:
        path: /etc/audit/rules.d/audit.rules
        state: file
      tags:
        - stig
        - SV-258198r1045379_rule
        - file_permission
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258199r1045382_rule | RHEL 9 must audit all uses of the postdrop command.'
      debug:
        msg: "Manual hardening required for SV-258199r1045382_rule: RHEL 9 must audit all uses of the postdrop command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'postdro Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258199r1045382_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit record specific to the security an...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258200r1045385_rule | RHEL 9 must audit all uses of the postqueue command.'
      debug:
        msg: "Manual hardening required for SV-258200r1045385_rule: RHEL 9 must audit all uses of the postqueue command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'postque Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258200r1045385_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit record specific to the security an...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258201r1045388_rule | RHEL 9 must audit all uses of the ssh-agent command.'
      debug:
        msg: "Manual hardening required for SV-258201r1045388_rule: RHEL 9 must audit all uses of the ssh-agent command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'ssh-age Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258201r1045388_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit record specific to the security an...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258202r1045391_rule | RHEL 9 must audit all uses of the ssh-keysign command.'
      debug:
        msg: "Manual hardening required for SV-258202r1045391_rule: RHEL 9 must audit all uses of the ssh-keysign command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'ssh-key Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258202r1045391_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit record specific to the security an...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258203r1045394_rule | RHEL 9 must audit all uses of the su command.'
      debug:
        msg: "Manual hardening required for SV-258203r1045394_rule: RHEL 9 must audit all uses of the su command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'su' com Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258203r1045394_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit record specific to the security an...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258204r1045397_rule | RHEL 9 must audit all uses of the sudo command.'
      debug:
        msg: "Manual hardening required for SV-258204r1045397_rule: RHEL 9 must audit all uses of the sudo command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'sudo' c Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258204r1045397_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit record specific to the security an...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258205r1045400_rule | RHEL 9 must audit all uses of the sudoedit command.'
      debug:
        msg: "Manual hardening required for SV-258205r1045400_rule: RHEL 9 must audit all uses of the sudoedit command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'sudoedi Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258205r1045400_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit record specific to the security an...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258206r1045403_rule | RHEL 9 must audit all uses of the unix_chkpwd command.'
      debug:
        msg: "Manual hardening required for SV-258206r1045403_rule: RHEL 9 must audit all uses of the unix_chkpwd command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'unix_ch Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258206r1045403_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit record specific to the security an...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258207r1045406_rule | RHEL 9 must audit all uses of the unix_update command.'
      debug:
        msg: "Manual hardening required for SV-258207r1045406_rule: RHEL 9 must audit all uses of the unix_update command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'unix_up Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258207r1045406_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit record specific to the security an...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258208r1045409_rule | RHEL 9 must audit all uses of the userhelper command.'
      debug:
        msg: "Manual hardening required for SV-258208r1045409_rule: RHEL 9 must audit all uses of the userhelper command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'userhel Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258208r1045409_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit record specific to the security an...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258209r1045412_rule | RHEL 9 must audit all uses of the usermod command.'
      debug:
        msg: "Manual hardening required for SV-258209r1045412_rule: RHEL 9 must audit all uses of the usermod command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'usermod Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258209r1045412_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records that are specific to the s...
    # Fix Text: Configure RHEL 9 to generate audit records upon successful/unsuccessful att...
    - name: 'SV-258210r1045415_rule | RHEL 9 must audit all uses of the mount command.'
      debug:
        msg: "Manual hardening required for SV-258210r1045415_rule: RHEL 9 must audit all uses of the mount command. - Configure RHEL 9 to generate audit records upon successful/unsuccessful attempts to use the 'mount'  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258210r1045415_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.12.1(iv)
    # Description: <VulnDiscussion>Misuse of the init command may cause availability issues fo...
    # Fix Text: Configure the audit system to generate an audit event for any successful/un...
    - name: 'SV-258211r1045418_rule | Successful/unsuccessful uses of the init command in RHEL 9 must generate an audit record.'
      debug:
        msg: "Manual hardening required for SV-258211r1045418_rule: Successful/unsuccessful uses of the init command in RHEL 9 must generate an audit record. - Configure the audit system to generate an audit event for any successful/unsuccessful uses of the 'i Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258211r1045418_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.12.1(iv)
    # Description: <VulnDiscussion>Misuse of the poweroff command may cause availability issue...
    # Fix Text: Configure the audit system to generate an audit event for any successful/un...
    - name: 'SV-258212r1045421_rule | Successful/unsuccessful uses of the poweroff command in RHEL 9 must generate an audit record.'
      debug:
        msg: "Manual hardening required for SV-258212r1045421_rule: Successful/unsuccessful uses of the poweroff command in RHEL 9 must generate an audit record. - Configure the audit system to generate an audit event for any successful/unsuccessful uses of the 'p Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258212r1045421_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.12.1(iv)
    # Description: <VulnDiscussion>Misuse of the reboot command may cause availability issues ...
    # Fix Text: Configure the audit system to generate an audit event for any successful/un...
    - name: 'SV-258213r1045424_rule | Successful/unsuccessful uses of the reboot command in RHEL 9 must generate an audit record.'
      debug:
        msg: "Manual hardening required for SV-258213r1045424_rule: Successful/unsuccessful uses of the reboot command in RHEL 9 must generate an audit record. - Configure the audit system to generate an audit event for any successful/unsuccessful uses of the 'r Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258213r1045424_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.12.1(iv)
    # Description: <VulnDiscussion>Misuse of the shutdown command may cause availability issue...
    # Fix Text: Configure the audit system to generate an audit event for any successful/un...
    - name: 'SV-258214r1045427_rule | Successful/unsuccessful uses of the shutdown command in RHEL 9 must generate an audit record.'
      debug:
        msg: "Manual hardening required for SV-258214r1045427_rule: Successful/unsuccessful uses of the shutdown command in RHEL 9 must generate an audit record. - Configure the audit system to generate an audit event for any successful/unsuccessful uses of the 's Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258214r1045427_rule
        - other
        - severity_medium
        - manual

    # Category: audit
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>The changing of file permissions could indicate that a user...
    # Fix Text: Configure the audit system to generate an audit event for any successful/un...
    - name: 'SV-258215r1106381_rule | Successful/unsuccessful uses of the umount system call in RHEL 9 must generate an audit record.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S umount -F auid>=1000 -F auid!=unset -k privileged-umount'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258215r1106381_rule
        - audit
        - severity_medium
        - automatable

    # Category: audit
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>The changing of file permissions could indicate that a user...
    # Fix Text: Configure the audit system to generate an audit event for any successful/un...
    - name: 'SV-258216r1102090_rule | Successful/unsuccessful uses of the umount2 system call in RHEL 9 must generate an audit record.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S umount2 -F auid>=1000 -F auid!=unset -k privileged-umount'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258216r1102090_rule
        - audit
        - severity_medium
        - automatable

    # Category: audit
    # STIG Severity: medium
    # NIST: AC.02.1(4)(i and ii)
    # Description: <VulnDiscussion>The actions taken by system administrators must be audited ...
    # Fix Text: Configure RHEL 9 to generate audit records for all account creations, modif...
    - name: 'SV-258217r1045436_rule | RHEL 9 must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/sudoers.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/sudoers -p wa -k identity'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258217r1045436_rule
        - audit
        - severity_medium
        - automatable

    # Category: audit
    # STIG Severity: medium
    # NIST: AC.02.1(4)(i and ii)
    # Description: <VulnDiscussion>The actions taken by system administrators must be audited ...
    # Fix Text: Configure RHEL 9 to generate audit records for all account creations, modif...
    - name: 'SV-258218r1101981_rule | RHEL 9 must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/sudoers.d/ directory.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/sudoers.d/ -p wa -k identity'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258218r1101981_rule
        - audit
        - severity_medium
        - automatable

    # Category: file_permission
    # STIG Severity: medium
    # NIST: AC.02.1(4)(i and ii)
    # Description: <VulnDiscussion>In addition to auditing new user and group accounts, these ...
    # Fix Text: Configure RHEL 9 to generate audit records for all account creations, modif...
    - name: 'SV-258219r1015130_rule | RHEL 9 must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/group.'
      file:
        path: /etc/group
        state: file
      tags:
        - stig
        - SV-258219r1015130_rule
        - file_permission
        - severity_medium
        - automatable

    # Category: file_permission
    # STIG Severity: medium
    # NIST: AC.02.1(4)(i and ii)
    # Description: <VulnDiscussion>In addition to auditing new user and group accounts, these ...
    # Fix Text: Configure RHEL 9 to generate audit records for all account creations, modif...
    - name: 'SV-258220r1015131_rule | RHEL 9 must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/gshadow.'
      file:
        path: /etc/gshadow
        state: file
      tags:
        - stig
        - SV-258220r1015131_rule
        - file_permission
        - severity_medium
        - automatable

    # Category: audit
    # STIG Severity: medium
    # NIST: AC.02.1(4)(i and ii)
    # Description: <VulnDiscussion>In addition to auditing new user and group accounts, these ...
    # Fix Text: Configure RHEL 9 to generate audit records for all account creations, modif...
    - name: 'SV-258221r1015132_rule | RHEL 9 must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/opasswd.'
      lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/security/opasswd -p wa -k identity'
        create: yes
        mode: '0640'
      tags:
        - stig
        - SV-258221r1015132_rule
        - audit
        - severity_medium
        - automatable

    # Category: file_permission
    # STIG Severity: medium
    # NIST: AC.02.1(1)
    # Description: <VulnDiscussion>In addition to auditing new user and group accounts, these ...
    # Fix Text: Configure RHEL 9 to generate audit records for all account creations, modif...
    - name: 'SV-258222r1015133_rule | RHEL 9 must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/passwd.'
      file:
        path: /etc/passwd
        state: file
      tags:
        - stig
        - SV-258222r1015133_rule
        - file_permission
        - severity_medium
        - automatable

    # Category: file_permission
    # STIG Severity: medium
    # NIST: AC.02.1(4)(i and ii)
    # Description: <VulnDiscussion>In addition to auditing new user and group accounts, these ...
    # Fix Text: Configure RHEL 9 to generate audit records for all account creations, modif...
    - name: 'SV-258223r1015134_rule | RHEL 9 must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/shadow.'
      file:
        path: /etc/shadow
        state: file
      tags:
        - stig
        - SV-258223r1015134_rule
        - file_permission
        - severity_medium
        - automatable

    # Category: service
    # STIG Severity: medium
    # NIST: AU.12.1(iv)
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate audit records for all account creations, modif...
    - name: 'SV-258224r1014988_rule | RHEL 9 must generate audit records for all account creations, modifications, disabling, and termination events that affect /var/log/faillock.'
      systemd:
        name: auditd
        enabled: yes
        state: started
      tags:
        - stig
        - SV-258224r1014988_rule
        - service
        - severity_medium
        - automatable

    # Category: service
    # STIG Severity: medium
    # NIST: AU.03.1
    # Description: <VulnDiscussion>Without generating audit records specific to the security a...
    # Fix Text: Configure RHEL 9 to generate audit records for all account creations, modif...
    - name: 'SV-258225r1014990_rule | RHEL 9 must generate audit records for all account creations, modifications, disabling, and termination events that affect /var/log/lastlog.'
      systemd:
        name: auditd
        enabled: yes
        state: started
      tags:
        - stig
        - SV-258225r1014990_rule
        - service
        - severity_medium
        - automatable

    # Category: other
    # STIG Severity: medium
    # NIST: AU.05.1(ii)
    # Description: <VulnDiscussion>It is critical for the appropriate personnel to be aware if...
    # Fix Text: Configure RHEL 9 to shut down when auditing failures occur. Add the followi...
    - name: 'SV-258227r1014992_rule | RHEL 9 must take appropriate action when a critical audit processing failure occurs.'
      debug:
        msg: "Manual hardening required for SV-258227r1014992_rule: RHEL 9 must take appropriate action when a critical audit processing failure occurs. - Configure RHEL 9 to shut down when auditing failures occur.  Add the following line to the bottom of Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258227r1014992_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.09.1
    # Description: <VulnDiscussion>If modification of login user identifiers (UIDs) is not pre...
    # Fix Text: Configure RHEL 9 auditing to prevent modification of login UIDs once they a...
    - name: 'SV-258228r991572_rule | RHEL 9 audit system must protect logon UIDs from unauthorized change.'
      debug:
        msg: "Manual hardening required for SV-258228r991572_rule: RHEL 9 audit system must protect logon UIDs from unauthorized change. - Configure RHEL 9 auditing to prevent modification of login UIDs once they are set by adding the foll Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258228r991572_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.09.1
    # Description: <VulnDiscussion>Unauthorized disclosure of audit records can reveal system ...
    # Fix Text: Configure the audit system to set the audit rules to be immutable by adding...
    - name: 'SV-258229r958434_rule | RHEL 9 audit system must protect auditing rules from unauthorized change.'
      debug:
        msg: "Manual hardening required for SV-258229r958434_rule: RHEL 9 audit system must protect auditing rules from unauthorized change. - Configure the audit system to set the audit rules to be immutable by adding the following line to en Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258229r958434_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: high
    # NIST: AC.17.1(2)
    # Description: <VulnDiscussion>Use of weak or untested encryption algorithms undermines th...
    # Fix Text: Configure the operating system to implement FIPS mode with the following co...
    - name: 'SV-258230r1134936_rule | RHEL 9 must enable FIPS mode.'
      debug:
        msg: "Manual hardening required for SV-258230r1134936_rule: RHEL 9 must enable FIPS mode. - Configure the operating system to implement FIPS mode with the following command  $ sudo fips-mode-s Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258230r1134936_rule
        - other
        - severity_high
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.07.1
    # Description: <VulnDiscussion>The system must use a strong hashing algorithm to store the...
    # Fix Text: Lock all interactive user accounts not using SHA-512 hashing until the pass...
    - name: 'SV-258231r1069375_rule | RHEL 9 must employ FIPS 140-3 approved cryptographic hashing algorithms for all stored passwords.'
      debug:
        msg: "Manual hardening required for SV-258231r1069375_rule: RHEL 9 must employ FIPS 140-3 approved cryptographic hashing algorithms for all stored passwords. - Lock all interactive user accounts not using SHA-512 hashing until the passwords can be regenerated  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258231r1069375_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.17.1(2)
    # Description: <VulnDiscussion>Overriding the system crypto policy makes the behavior of t...
    # Fix Text: Configure Libreswan to use the system cryptographic policy. Add the followi...
    - name: 'SV-258232r1045440_rule | RHEL 9 IP tunnels must use FIPS 140-3 approved cryptographic algorithms.'
      debug:
        msg: "Manual hardening required for SV-258232r1045440_rule: RHEL 9 IP tunnels must use FIPS 140-3 approved cryptographic algorithms. - Configure Libreswan to use the system cryptographic policy.  Add the following line to '/etc/ipsec.c Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258232r1045440_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: IA.05.1(1)(v)
    # Description: <VulnDiscussion>Unapproved mechanisms that are used for authentication to t...
    # Fix Text: Configure RHEL 9 to use a FIPS 140-3 approved cryptographic hashing algorit...
    - name: 'SV-258233r1015136_rule | RHEL 9 pam_unix.so module must be configured in the password-auth file to use a FIPS 140-3 approved cryptographic hashing algorithm for system authentication.'
      debug:
        msg: "Manual hardening required for SV-258233r1015136_rule: RHEL 9 pam_unix.so module must be configured in the password-auth file to use a FIPS 140-3 approved  - Configure RHEL 9 to use a FIPS 140-3 approved cryptographic hashing algorithm for system authenticat Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258233r1015136_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SC.13
    # Description: <VulnDiscussion>Centralized cryptographic policies simplify applying secure...
    # Fix Text: Install the crypto-policies package (if the package is not already installe...
    - name: 'SV-258234r1051250_rule | RHEL 9 must have the crypto-policies package installed.'
      debug:
        msg: "Manual hardening required for SV-258234r1051250_rule: RHEL 9 must have the crypto-policies package installed. - Install the crypto-policies package (if the package is not already installed) with the following com Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258234r1051250_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: high
    # NIST: SC.13
    # Description: <VulnDiscussion>Centralized cryptographic policies simplify applying secure...
    # Fix Text: Configure RHEL 9 to correctly implement the systemwide cryptographic polici...
    - name: 'SV-258236r1101920_rule | RHEL 9 cryptographic policy must not be overridden.'
      debug:
        msg: "Manual hardening required for SV-258236r1101920_rule: RHEL 9 cryptographic policy must not be overridden. - Configure RHEL 9 to correctly implement the systemwide cryptographic policies by reinstalling the cr Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258236r1101920_rule
        - other
        - severity_high
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SC.13
    # Description: <VulnDiscussion>Centralized cryptographic policies simplify applying secure...
    # Fix Text: Configure RHEL 9 to use a FIPS 140-3-compliant systemwide cryptographic pol...
    - name: 'SV-258241r1106302_rule | RHEL 9 must implement a FIPS 140-3-compliant systemwide cryptographic policy.'
      debug:
        msg: "Manual hardening required for SV-258241r1106302_rule: RHEL 9 must implement a FIPS 140-3-compliant systemwide cryptographic policy. - Configure RHEL 9 to use a FIPS 140-3-compliant systemwide cryptographic policy.  Create a subpolicy  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258241r1106302_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: SC.08
    # Description: <VulnDiscussion>Without cryptographic integrity protections, information ca...
    # Fix Text: Configure BIND to use the system crypto policy. Add the following line to t...
    - name: 'SV-258242r958908_rule | RHEL 9 must implement DOD-approved encryption in the bind package.'
      debug:
        msg: "Manual hardening required for SV-258242r958908_rule: RHEL 9 must implement DOD-approved encryption in the bind package. - Configure BIND to use the system crypto policy.  Add the following line to the 'options' section in  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-258242r958908_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.08.1(ii)
    # Description: <VulnDiscussion>Display of a standardized and approved use notification bef...
    # Fix Text: Configure the operating system to display the Standard Mandatory DOD Notice...
    - name: 'SV-270174r1044831_rule | RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before granting local or remote access to the system via a graphical user logon.'
      debug:
        msg: "Manual hardening required for SV-270174r1044831_rule: RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before granting local or re - Configure the operating system to display the Standard Mandatory DOD Notice and Consent Banner befor Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-270174r1044831_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.09.1
    # Description: <VulnDiscussion>The "/etc/audit/" directory contains files that ensure the ...
    # Fix Text: Change the owner of the file "/etc/audit/" to "root" by running the followi...
    - name: 'SV-270175r1117265_rule | RHEL 9 "/etc/audit/" must be owned by root.'
      shell: |
        chown root /etc/audit/
      tags:
        - stig
        - SV-270175r1117265_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AU.09.1
    # Description: <VulnDiscussion>The "/etc/audit/" directory contains files that ensure the ...
    # Fix Text: Change the group of the file "/etc/audit/" to "root" by running the followi...
    - name: 'SV-270176r1117265_rule | RHEL 9 "/etc/audit/" must be group-owned by root.'
      debug:
        msg: "Manual hardening required for SV-270176r1117265_rule: RHEL 9 '/etc/audit/' must be group-owned by root. - Change the group of the file '/etc/audit/' to 'root' by running the following command:  $ sudo chgrp Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-270176r1117265_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.17.1(2)
    # Description: <VulnDiscussion>Without cryptographic integrity protections, information ca...
    # Fix Text: Configure the SSH client to use only ciphers employing FIPS 140-3 approved ...
    - name: 'SV-270177r1051237_rule | The RHEL 9 SSH client must be configured to use only DOD-approved encryption ciphers employing FIPS 140-3 validated cryptographic hash algorithms to protect the confidentiality of SSH client connections.'
      debug:
        msg: "Manual hardening required for SV-270177r1051237_rule: The RHEL 9 SSH client must be configured to use only DOD-approved encryption ciphers employing FIPS  - Configure the SSH client to use only ciphers employing FIPS 140-3 approved algorithms.  Reinstall cr Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-270177r1051237_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.17.1(2)
    # Description: <VulnDiscussion>Without cryptographic integrity protections, information ca...
    # Fix Text: Configure the SSH client to use only MACs employing FIPS 140-3 approved alg...
    - name: 'SV-270178r1051243_rule | The RHEL 9 SSH client must be configured to use only DOD-approved Message Authentication Codes (MACs) employing FIPS 140-3 validated cryptographic hash algorithms to protect the confidentiality of SSH client connections.'
      debug:
        msg: "Manual hardening required for SV-270178r1051243_rule: The RHEL 9 SSH client must be configured to use only DOD-approved Message Authentication Codes (MACs - Configure the SSH client to use only MACs employing FIPS 140-3 approved algorithms.  Reinstall crypt Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-270178r1051243_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: CM.07(2)
    # Description: <VulnDiscussion>The organization must identify authorized software programs...
    # Fix Text: Configure RHEL 9 to employ a deny-all, permit-by-exception application allo...
    - name: 'SV-270180r1045182_rule | The RHEL 9 fapolicy module must be configured to employ a deny-all, permit-by-exception policy to allow the execution of authorized software programs.'
      debug:
        msg: "Manual hardening required for SV-270180r1045182_rule: The RHEL 9 fapolicy module must be configured to employ a deny-all, permit-by-exception policy to al - Configure RHEL 9 to employ a deny-all, permit-by-exception application allow listing policy with 'fa Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-270180r1045182_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.02.1(1)
    # Description: <VulnDiscussion>Postfix is a free, open-source mail transfer agent (MTA) th...
    # Fix Text: Install the Postfix package with the following command - $ sudo dnf install...
    - name: 'SV-272488r1082178_rule | RHEL 9 must have the Postfix package installed.'
      package:
        name: postfix
        state: present
      tags:
        - stig
        - SV-272488r1082178_rule
        - other
        - severity_medium
        - manual

    # Category: other
    # STIG Severity: medium
    # NIST: AC.06(10)
    # Description: <VulnDiscussion>Without verification of the security functions, security fu...
    # Fix Text: Configure RHEL 9 to elevate the SELinux context when an administrator calls...
    - name: 'SV-272496r1134956_rule | RHEL 9 must elevate the SELinux context when an administrator calls the sudo command.'
      debug:
        msg: "Manual hardening required for SV-272496r1134956_rule: RHEL 9 must elevate the SELinux context when an administrator calls the sudo command. - Configure RHEL 9 to elevate the SELinux context when an administrator calls the sudo command.  Edit  Refer to STIG FixText for detailed steps."
      tags:
        - stig
        - SV-272496r1134956_rule
        - other
        - severity_medium
        - manual
