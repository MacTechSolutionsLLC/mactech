# Generated hardening playbook for rhel8
# Total Controls: 368
#   - Automated: 280 (76%)
#   - Manual-only: 88 (23%)

- name: "RHEL 8 STIG Hardening"
  hosts: all
  become: yes
  gather_facts: yes
  vars:
    # Place any tunable defaults here if needed later
  pre_tasks:
    - name: "Verify RHEL 8 OS family"
      ansible.builtin.assert:
        that:
          - ansible_facts['os_family'] == 'RedHat'
          - ansible_facts['distribution_major_version'] == '8'
        fail_msg: 'This playbook is designed for RHEL 8 only. Detected OS: { { ansible_facts[''os_family''] } } { { ansible_facts[''distribution_major_version''] } }'
        success_msg: 'OS verification passed: RHEL 8 detected'

  handlers:
    - name: "Regenerate grub configuration"
      ansible.builtin.command:
        cmd: grub2-mkconfig -o /boot/grub2/grub.cfg
      when: ansible_os_family == 'RedHat'

    - name: "Restart sshd"
      ansible.builtin.service:
        name: sshd
        state: restarted

    - name: "Reload systemd daemon"
      ansible.builtin.systemd:
        daemon_reload: yes

    - name: "Reload sysctl"
      ansible.builtin.command:
        cmd: sysctl -p
      ignore_errors: yes

    - name: "Reload firewalld"
      ansible.builtin.command:
        cmd: firewall-cmd --reload
      when: ansible_facts['os_family'] == 'RedHat'
      ignore_errors: yes

    - name: "Update dconf database"
      ansible.builtin.command:
        cmd: dconf update
      when: ansible_pkg_mgr == 'dnf' or ansible_pkg_mgr == 'yum'

  tasks:

    # STIG ID: SV-230221r1017040_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must be a vendor-supported release - (SV-230221r1017040_rule)"
      tags:
        - stig
        - SV-230221r1017040_rule
        - config
        - severity_high
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: 'Manual hardening required for SV-230221r1017040_rule: RHEL 8 must be a vendor-supported release - Upgrade to a supported version of RHEL 8. Refer to STIG FixText for detailed steps.'


    # STIG ID: SV-230222r1017041_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 vendor packaged system security patches and updates must be installed - (SV-230222r1017041_rule)"
      tags:
        - stig
        - SV-230222r1017041_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230222r1017041_rule: RHEL 8 vendor packaged system security patches and updates must be installed - Install the operating system patches or updated packages available from Red Hat within 30 days or sooner as local policy dictates. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230223r1069327_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must implement NIST FIPS-validated cryptography for the following - To - (SV-230223r1069327_rule)"
      tags:
        - stig
        - SV-230223r1069327_rule
        - other
        - severity_high
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230223r1069327_rule: RHEL 8 must implement NIST FIPS-validated cryptography for the following - To - Configure the operating system to implement DOD-approved encryption by following the steps below:  To enable strict FIPS compliance, the fips=1 kernel option needs to be added to the kernel boot param... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230224r1044787_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 8 local disk partitions must implement cryptographic mechanisms to - (SV-230224r1044787_rule)"
      tags:
        - stig
        - SV-230224r1044787_rule
        - other
        - severity_high
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230224r1044787_rule: All RHEL 8 local disk partitions must implement cryptographic mechanisms to - Configure RHEL 8 to prevent unauthorized modification of all information at rest by using disk encryption.   Encrypting a partition in an already installed system is more difficult, because existing p... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230225r1069297_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must display the Standard Mandatory DOD Notice and Consent Banner before - (SV-230225r1069297_rule)"
      tags:
        - stig
        - SV-230225r1069297_rule
        - ssh_config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230225r1069297_rule: RHEL 8 must display the Standard Mandatory DOD Notice and Consent Banner before - Configure the operating system to display the Standard Mandatory DOD Notice and Consent Banner before granting access to the system via the ssh.  Edit the "/etc/ssh/sshd_config" file to uncomment the ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230226r1069298_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must display the Standard Mandatory DoD Notice and Consent Banner before - (SV-230226r1069298_rule)"
      tags:
        - stig
        - SV-230226r1069298_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230226r1069298_rule: RHEL 8 must display the Standard Mandatory DoD Notice and Consent Banner before - Configure the operating system to display the Standard Mandatory DoD Notice and Consent Banner before granting access to the system.  Note: If the system does not have a graphical user interface insta... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230227r1017046_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must display the Standard Mandatory DoD Notice and Consent Banner before - (SV-230227r1017046_rule)"
      tags:
        - stig
        - SV-230227r1017046_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230227r1017046_rule: RHEL 8 must display the Standard Mandatory DoD Notice and Consent Banner before - Configure RHEL 8 to display the Standard Mandatory DoD Notice and Consent Banner before granting access to the system via command line logon.  Edit the "/etc/issue" file to replace the default text wi... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230228r1069299_rule | Automation: automated via SCAP
    - name: "Ensure rsyslog.service is restart - (SV-230228r1069299_rule)"
      tags:
        - stig
        - SV-230228r1069299_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: rsyslog.service
        state: restarted


    # STIG ID: SV-230229r1017048_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8, for PKI-based authentication, must validate certificates by - (SV-230229r1017048_rule)"
      tags:
        - stig
        - SV-230229r1017048_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230229r1017048_rule: RHEL 8, for PKI-based authentication, must validate certificates by - Configure RHEL 8, for PKI-based authentication, to validate certificates by constructing a certification path (which includes status information) to an accepted trust anchor.  Obtain a valid copy of t... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230230r1069287_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8, for certificate-based authentication, must enforce authorized access to - (SV-230230r1069287_rule)"
      tags:
        - stig
        - SV-230230r1069287_rule
        - other
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230230r1069287_rule: RHEL 8, for certificate-based authentication, must enforce authorized access to - Create a new private and public key pair that utilizes a passcode with the following command:  $ sudo ssh-keygen -p -f /path/to/file Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230231r1017050_rule | Automation: automated via SCAP
    - name: "RHEL 8 must encrypt all stored passwords with a FIPS 140-2 approved - (SV-230231r1017050_rule)"
      tags:
        - stig
        - SV-230231r1017050_rule
        - config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/login.defs
        line: 'ENCRYPT_METHOD SHA512'
        regexp: '^#?\s*ENCRYPT_METHOD\s+'
        create: yes
        backup: yes


    # STIG ID: SV-230232r1017051_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must employ FIPS 140-2 approved cryptographic hashing algorithms for all - (SV-230232r1017051_rule)"
      tags:
        - stig
        - SV-230232r1017051_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230232r1017051_rule: RHEL 8 must employ FIPS 140-2 approved cryptographic hashing algorithms for all - Lock all interactive user accounts not using SHA-512 hashing until the passwords can be regenerated with SHA-512. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230233r1044790_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 shadow password suite must be configured to use a sufficient number - (SV-230233r1044790_rule)"
      tags:
        - stig
        - SV-230233r1044790_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230233r1044790_rule: The RHEL 8 shadow password suite must be configured to use a sufficient number - Configure RHEL 8 to encrypt all stored passwords with a strong cryptographic hash.  Edit/modify the following line in the "/etc/login.defs" file and set "SHA_CRYPT_MIN_ROUNDS" to a value no lower than... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230234r1117265_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 operating systems booted with United Extensible Firmware Interface - (SV-230234r1117265_rule)"
      tags:
        - stig
        - SV-230234r1117265_rule
        - other
        - severity_high
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230234r1117265_rule: RHEL 8 operating systems booted with United Extensible Firmware Interface - Configure the system to require a grub bootloader password for the grub superusers account with the grub2-setpassword command, which creates/overwrites the /boot/efi/EFI/redhat/user.cfg file.  Generat... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230235r1117265_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 operating systems booted with a BIOS must require authentication upon - (SV-230235r1117265_rule)"
      tags:
        - stig
        - SV-230235r1117265_rule
        - other
        - severity_high
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230235r1117265_rule: RHEL 8 operating systems booted with a BIOS must require authentication upon - Configure the system to require a grub bootloader password for the grub superusers account with the grub2-setpassword command, which creates/overwrites the /boot/grub2/user.cfg file.  Generate an encr... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230236r1117265_rule | Automation: automated via SCAP
    - name: "Ensure ExecStart is enabled and running - (SV-230236r1117265_rule)"
      tags:
        - stig
        - SV-230236r1117265_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: ExecStart
        enabled: yes
        state: started


    # STIG ID: SV-230237r1017056_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 pam_unix.so module must be configured in the password-auth file to - (SV-230237r1017056_rule)"
      tags:
        - stig
        - SV-230237r1017056_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230237r1017056_rule: The RHEL 8 pam_unix.so module must be configured in the password-auth file to - Configure RHEL 8 to use a FIPS 140-2 approved cryptographic hashing algorithm for system authentication.  Edit/modify the following line in the "/etc/pam.d/password-auth" file to include the sha512 op... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230238r1017057_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must prevent system daemons from using Kerberos for authentication - (SV-230238r1017057_rule)"
      tags:
        - stig
        - SV-230238r1017057_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230238r1017057_rule: RHEL 8 must prevent system daemons from using Kerberos for authentication - Configure RHEL 8 to prevent system daemons from using Kerberos for authentication.  Remove any files with the .keytab extension from the operating system. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230239r1017058_rule | Automation: automated via SCAP
    - name: "The krb5-workstation package must not be installed on RHEL 8 - (SV-230239r1017058_rule)"
      tags:
        - stig
        - SV-230239r1017058_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: krb5-workstation
        state: absent


    # STIG ID: SV-230240r1017059_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must use a Linux Security Module configured to enforce limits on system - (SV-230240r1017059_rule)"
      tags:
        - stig
        - SV-230240r1017059_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230240r1017059_rule: RHEL 8 must use a Linux Security Module configured to enforce limits on system - Configure the operating system to verify correct operation of all security functions.  Set the "SELinux" status and the "Enforcing" mode by modifying the "/etc/selinux/config" file to have the followi... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230241r1017060_rule | Automation: automated via SCAP
    - name: "RHEL 8 must have policycoreutils package installed - (SV-230241r1017060_rule)"
      tags:
        - stig
        - SV-230241r1017060_rule
        - package_absent
        - severity_low
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: policycoreutils
        state: absent


    # STIG ID: SV-230243r1117267_rule | Automation: manual-only (not covered by scap)
    - name: "A sticky bit must be set on all RHEL 8 public directories to prevent - (SV-230243r1117267_rule)"
      tags:
        - stig
        - SV-230243r1117267_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230243r1117267_rule: A sticky bit must be set on all RHEL 8 public directories to prevent - Configure all world-writable directories to have the sticky bit set to prevent unauthorized and unintended information transferred via shared system resources.  Set the sticky bit on all world-writabl... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230244r1069300_rule | Automation: automated via SCAP
    - name: "RHEL 8 must be configured so that all network connections associated with SSH - (SV-230244r1069300_rule)"
      tags:
        - stig
        - SV-230244r1069300_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*ClientAliveCountMax\s+'
        line: 'ClientAliveCountMax 1'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-230245r1017063_rule | Automation: automated via SCAP
    - name: "The RHEL 8 /var/log/messages file must have mode 0640 or less permissive - (SV-230245r1017063_rule)"
      tags:
        - stig
        - SV-230245r1017063_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /var/log/messages
        mode: '0640'
        state: file


    # STIG ID: SV-230246r1017064_rule | Automation: automated via SCAP
    - name: "The RHEL 8 /var/log/messages file must be owned by root - (SV-230246r1017064_rule)"
      tags:
        - stig
        - SV-230246r1017064_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /var/log/messages
        owner: root
        state: file


    # STIG ID: SV-230247r1017065_rule | Automation: automated via SCAP
    - name: "The RHEL 8 /var/log/messages file must be group-owned by root - (SV-230247r1017065_rule)"
      tags:
        - stig
        - SV-230247r1017065_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /var/log/messages
        group: root
        state: file


    # STIG ID: SV-230248r1069291_rule | Automation: automated via SCAP
    - name: "The RHEL 8 /var/log directory must have mode 0755 or less permissive - (SV-230248r1069291_rule)"
      tags:
        - stig
        - SV-230248r1069291_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /var/log
        mode: '0755'
        state: directory


    # STIG ID: SV-230249r1017067_rule | Automation: automated via SCAP
    - name: "The RHEL 8 /var/log directory must be owned by root - (SV-230249r1017067_rule)"
      tags:
        - stig
        - SV-230249r1017067_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /var/log
        owner: root
        state: directory


    # STIG ID: SV-230250r1017068_rule | Automation: automated via SCAP
    - name: "The RHEL 8 /var/log directory must be group-owned by root - (SV-230250r1017068_rule)"
      tags:
        - stig
        - SV-230250r1017068_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /var/log
        group: root
        state: directory


    # STIG ID: SV-230251r1044814_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 SSH server must be configured to use only Message Authentication - (SV-230251r1044814_rule)"
      tags:
        - stig
        - SV-230251r1044814_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230251r1044814_rule: The RHEL 8 SSH server must be configured to use only Message Authentication - Configure the RHEL 8 SSH server to use only MACs employing FIPS 140-3 approved algorithms by updating the "/etc/crypto-policies/back-ends/opensshserver.config" file with the following commands.  To ma... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230252r1067104_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 operating system must implement DOD-approved encryption to protect - (SV-230252r1067104_rule)"
      tags:
        - stig
        - SV-230252r1067104_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230252r1067104_rule: The RHEL 8 operating system must implement DOD-approved encryption to protect - Configure the RHEL 8 SSH server to use only ciphers employing FIPS 140-3 approved algorithms by updating the "/etc/crypto-policies/back-ends/opensshserver.config" file with the following commands.  To... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230253r1044799_rule | Automation: automated via SCAP
    - name: "RHEL 8 must ensure the SSH server uses strong entropy - (SV-230253r1044799_rule)"
      tags:
        - stig
        - SV-230253r1044799_rule
        - ssh_config
        - severity_low
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*SSH_USE_STRONG_RNG=32\s+'
        line: 'SSH_USE_STRONG_RNG=32'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-230254r1017072_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 operating system must implement DoD-approved encryption in the - (SV-230254r1017072_rule)"
      tags:
        - stig
        - SV-230254r1017072_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230254r1017072_rule: The RHEL 8 operating system must implement DoD-approved encryption in the - Configure the RHEL 8 OpenSSL library to use only ciphers employing FIPS 140-2-approved algorithms with the following command:  $ sudo fips-mode-setup --enable  A reboot is required for the changes to ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230255r1017075_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 operating system must implement DoD-approved TLS encryption in the - (SV-230255r1017075_rule)"
      tags:
        - stig
        - SV-230255r1017075_rule
        - package_present
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230255r1017075_rule: The RHEL 8 operating system must implement DoD-approved TLS encryption in the - Configure the RHEL 8 OpenSSL library to use only DoD-approved TLS encryption by editing the following line in the "/etc/crypto-policies/back-ends/opensslcnf.config" file:  For versions prior to crypto... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230256r1017076_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 operating system must implement DoD-approved TLS encryption in the - (SV-230256r1017076_rule)"
      tags:
        - stig
        - SV-230256r1017076_rule
        - package_absent
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230256r1017076_rule: The RHEL 8 operating system must implement DoD-approved TLS encryption in the - Configure the RHEL 8 GnuTLS library to use only DoD-approved encryption by adding the following line to "/etc/crypto-policies/back-ends/gnutls.config":  +VERS-ALL:-VERS-DTLS0.9:-VERS-SSL3.0:-VERS-TLS1... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230257r1017077_rule | Automation: automated via SCAP
    - name: "RHEL 8 system commands must have mode 755 or less permissive - (SV-230257r1017077_rule)"
      tags:
        - stig
        - SV-230257r1017077_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /usr/bin
        mode: '755'
        state: directory


    # STIG ID: SV-230258r1017078_rule | Automation: automated via SCAP
    - name: "RHEL 8 system commands must be owned by root - (SV-230258r1017078_rule)"
      tags:
        - stig
        - SV-230258r1017078_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /usr/bin
        owner: root
        state: directory


    # STIG ID: SV-230259r1017079_rule | Automation: automated via SCAP
    - name: "RHEL 8 system commands must be group-owned by root or a system account - (SV-230259r1017079_rule)"
      tags:
        - stig
        - SV-230259r1017079_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /usr/bin
        group: root
        state: directory


    # STIG ID: SV-230260r1101888_rule | Automation: automated via SCAP
    - name: "RHEL 8 library files must have mode 755 or less permissive - (SV-230260r1101888_rule)"
      tags:
        - stig
        - SV-230260r1101888_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /usr/lib
        mode: '0755'
        state: file


    # STIG ID: SV-230261r1101891_rule | Automation: automated via SCAP
    - name: "RHEL 8 library files must be owned by root - (SV-230261r1101891_rule)"
      tags:
        - stig
        - SV-230261r1101891_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /usr/lib
        owner: root
        state: file


    # STIG ID: SV-230262r1101894_rule | Automation: automated via SCAP
    - name: "RHEL 8 library files must be group-owned by root or a system account - (SV-230262r1101894_rule)"
      tags:
        - stig
        - SV-230262r1101894_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /usr/lib
        group: root
        state: file


    # STIG ID: SV-230263r1017083_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 file integrity tool must notify the system administrator when - (SV-230263r1017083_rule)"
      tags:
        - stig
        - SV-230263r1017083_rule
        - package_present
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230263r1017083_rule: The RHEL 8 file integrity tool must notify the system administrator when - Configure the file integrity tool to run automatically on the system at least weekly and to notify designated personnel if baseline configurations are changed in an unauthorized manner. The AIDE tool ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230264r1017377_rule | Automation: automated via SCAP
    - name: "Ensure packs is enabled and running - (SV-230264r1017377_rule)"
      tags:
        - stig
        - SV-230264r1017377_rule
        - service_enabled
        - severity_high
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: packs
        enabled: yes
        state: started


    # STIG ID: SV-230265r1017378_rule | Automation: automated via SCAP
    - name: "Ensure packs is enabled and running - (SV-230265r1017378_rule)"
      tags:
        - stig
        - SV-230265r1017378_rule
        - service_enabled
        - severity_high
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: packs
        enabled: yes
        state: started


    # STIG ID: SV-230266r1017084_rule | Automation: automated via SCAP
    - name: "RHEL 8 must prevent the loading of a new kernel for later execution - (SV-230266r1017084_rule)"
      tags:
        - stig
        - SV-230266r1017084_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: kernel.kexec_load_disabled
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230267r1017085_rule | Automation: automated via SCAP
    - name: "RHEL 8 must enable kernel parameters to enforce discretionary access control on - (SV-230267r1017085_rule)"
      tags:
        - stig
        - SV-230267r1017085_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: fs.protected_symlinks
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230268r1017086_rule | Automation: automated via SCAP
    - name: "RHEL 8 must enable kernel parameters to enforce discretionary access control on - (SV-230268r1017086_rule)"
      tags:
        - stig
        - SV-230268r1017086_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: fs.protected_hardlinks
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230269r1117267_rule | Automation: automated via SCAP
    - name: "RHEL 8 must restrict access to the kernel message buffer - (SV-230269r1117267_rule)"
      tags:
        - stig
        - SV-230269r1117267_rule
        - sysctl
        - severity_low
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: kernel.dmesg_restrict
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230270r1117267_rule | Automation: automated via SCAP
    - name: "RHEL 8 must prevent kernel profiling by unprivileged users - (SV-230270r1117267_rule)"
      tags:
        - stig
        - SV-230270r1117267_rule
        - sysctl
        - severity_low
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: kernel.perf_event_paranoid
        value: '2'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230271r1101896_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must require users to provide a password for privilege escalation - (SV-230271r1101896_rule)"
      tags:
        - stig
        - SV-230271r1101896_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230271r1101896_rule: RHEL 8 must require users to provide a password for privilege escalation - Remove any occurrence of "NOPASSWD" found in "/etc/sudoers" file or files in the "/etc/sudoers.d" directory. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230272r1101898_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must require users to reauthenticate for privilege escalation - (SV-230272r1101898_rule)"
      tags:
        - stig
        - SV-230272r1101898_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230272r1101898_rule: RHEL 8 must require users to reauthenticate for privilege escalation - Remove any occurrence of "!authenticate" found in "/etc/sudoers" file or files in the "/etc/sudoers.d" directory. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230273r1017381_rule | Automation: automated via SCAP
    - name: "RHEL 8 must have the packages required for multifactor authentication installed - (SV-230273r1017381_rule)"
      tags:
        - stig
        - SV-230273r1017381_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: openssl-pkcs11
        state: absent


    # STIG ID: SV-230274r1017089_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must implement certificate status checking for multifactor authentication - (SV-230274r1017089_rule)"
      tags:
        - stig
        - SV-230274r1017089_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230274r1017089_rule: RHEL 8 must implement certificate status checking for multifactor authentication - Configure the operating system to implement certificate status checking for multifactor authentication.  Review the "/etc/sssd/sssd.conf" file to determine if the system is configured to prevent OCSP ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230275r958816_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must accept Personal Identity Verification (PIV) credentials - (SV-230275r958816_rule)"
      tags:
        - stig
        - SV-230275r958816_rule
        - package_absent
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230275r958816_rule: RHEL 8 must accept Personal Identity Verification (PIV) credentials - Configure RHEL 8 to accept PIV credentials.  Install the "opensc" package using the following command:  $ sudo yum install opensc Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230276r958928_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must implement non-executable data to protect its memory from - (SV-230276r958928_rule)"
      tags:
        - stig
        - SV-230276r958928_rule
        - other
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230276r958928_rule: RHEL 8 must implement non-executable data to protect its memory from - The NX bit execute protection must be enabled in the system BIOS. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230277r1017090_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must clear the page allocator to prevent use-after-free attacks - (SV-230277r1017090_rule)"
      tags:
        - stig
        - SV-230277r1017090_rule
        - grub_kernel_args
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230277r1017090_rule: RHEL 8 must clear the page allocator to prevent use-after-free attacks - Configure RHEL 8 to enable page poisoning with the following commands:  $ sudo grubby --update-kernel=ALL --args="page_poison=1"  Add or modify the following line in "/etc/default/grub" to ensure the ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230278r1017091_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must disable virtual syscalls - (SV-230278r1017091_rule)"
      tags:
        - stig
        - SV-230278r1017091_rule
        - grub_kernel_args
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230278r1017091_rule: RHEL 8 must disable virtual syscalls - Document the use of vsyscalls with the ISSO as an operational requirement or disable them with the following command:  $ sudo grubby --update-kernel=ALL --args="vsyscall=none"  Add or modify the follo... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230279r1069286_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must clear memory when it is freed to prevent use-after-free attacks - (SV-230279r1069286_rule)"
      tags:
        - stig
        - SV-230279r1069286_rule
        - grub_kernel_args
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230279r1069286_rule: RHEL 8 must clear memory when it is freed to prevent use-after-free attacks - Configure RHEL 8 to enable init_on_free with the following command: $ sudo grubby --update-kernel=ALL --args="init_on_free=1"  Regenerate the GRUB configuration: $ sudo grub2-mkconfig -o /boot/grub2/g... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230280r1017093_rule | Automation: automated via SCAP
    - name: "RHEL 8 must implement address space layout randomization (ASLR) to protect its - (SV-230280r1017093_rule)"
      tags:
        - stig
        - SV-230280r1017093_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: kernel.randomize_va_space
        value: '2'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230281r958936_rule | Automation: automated via SCAP
    - name: "YUM must remove all software components after updated versions have been - (SV-230281r958936_rule)"
      tags:
        - stig
        - SV-230281r958936_rule
        - config
        - severity_low
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: '*'
        state: latest
        update_cache: yes


    # STIG ID: SV-230282r958944_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must enable the SELinux targeted policy - (SV-230282r958944_rule)"
      tags:
        - stig
        - SV-230282r958944_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230282r958944_rule: RHEL 8 must enable the SELinux targeted policy - Configure the operating system to verify correct operation of all security functions.  Set the "SELinuxtype" to the "targeted" policy by modifying the "/etc/selinux/config" file to have the following ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230283r1017094_rule | Automation: manual-only (not covered by scap)
    - name: "There must be no shosts.equiv files on the RHEL 8 operating system - (SV-230283r1017094_rule)"
      tags:
        - stig
        - SV-230283r1017094_rule
        - config
        - severity_high
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230283r1017094_rule: There must be no shosts.equiv files on the RHEL 8 operating system - Remove any found "shosts.equiv" files from the system.  $ sudo rm /etc/ssh/shosts.equiv Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230284r1017095_rule | Automation: manual-only (not covered by scap)
    - name: "There must be no .shosts files on the RHEL 8 operating system - (SV-230284r1017095_rule)"
      tags:
        - stig
        - SV-230284r1017095_rule
        - other
        - severity_high
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230284r1017095_rule: There must be no .shosts files on the RHEL 8 operating system - Remove any found ".shosts" files from the system.  $ sudo rm /[path]/[to]/[file]/.shosts Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230285r1017096_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must enable the hardware random number generator entropy gatherer service - (SV-230285r1017096_rule)"
      tags:
        - stig
        - SV-230285r1017096_rule
        - service_enabled
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230285r1017096_rule: RHEL 8 must enable the hardware random number generator entropy gatherer service - Start the rngd service and enable the rngd service with the following commands:       $ sudo systemctl start rngd.service       $ sudo systemctl enable rngd.service Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230286r1017097_rule | Automation: automated via SCAP
    - name: "The RHEL 8 SSH public host key files must have mode 0644 or less permissive - (SV-230286r1017097_rule)"
      tags:
        - stig
        - SV-230286r1017097_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /etc/ssh
        mode: '0644'
        state: file


    # STIG ID: SV-230287r1017098_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 SSH private host key files must have mode 0640 or less permissive - (SV-230287r1017098_rule)"
      tags:
        - stig
        - SV-230287r1017098_rule
        - ssh_config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230287r1017098_rule: The RHEL 8 SSH private host key files must have mode 0640 or less permissive - Configure the mode of SSH private host key files under "/etc/ssh" to "0640" with the following command:       $ sudo chmod 0640 /etc/ssh/ssh_host*key  The SSH daemon must be restarted for the changes ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230288r1069301_rule | Automation: automated via SCAP
    - name: "The RHEL 8 SSH daemon must perform strict mode checking of home directory - (SV-230288r1069301_rule)"
      tags:
        - stig
        - SV-230288r1069301_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*StrictModes\s+'
        line: 'StrictModes yes'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-230290r1069302_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 SSH daemon must not allow authentication using known host’s - (SV-230290r1069302_rule)"
      tags:
        - stig
        - SV-230290r1069302_rule
        - ssh_config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230290r1069302_rule: The RHEL 8 SSH daemon must not allow authentication using known host’s - Configure the SSH daemon to not allow authentication using known host’s authentication.  Add the following line in "/etc/ssh/sshd_config", or uncomment the line and set the value to "yes":  IgnoreUser... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230291r1069303_rule | Automation: automated via SCAP
    - name: "The RHEL 8 SSH daemon must not allow Kerberos authentication, except to fulfill - (SV-230291r1069303_rule)"
      tags:
        - stig
        - SV-230291r1069303_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*KerberosAuthentication\s+'
        line: 'KerberosAuthentication no'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-230292r1017103_rule | Automation: automated via SCAP
    - name: "RHEL 8 must use a separate file system for /var - (SV-230292r1017103_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must use a separate file system for /var - (SV-230292r1017103_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230292r1017103_rule
        - mount_option
        - severity_low
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /var
        opts: "defaults,nodev"
        state: mounted
        fstype: auto


    # STIG ID: SV-230293r1017104_rule | Automation: automated via SCAP
    - name: "RHEL 8 must use a separate file system for /var/log - (SV-230293r1017104_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/log\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must use a separate file system for /var/log - (SV-230293r1017104_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230293r1017104_rule
        - mount_option
        - severity_low
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /var/log
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-230294r1017105_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must use a separate file system for the system audit data path - (SV-230294r1017105_rule)"
      tags:
        - stig
        - SV-230294r1017105_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230294r1017105_rule: RHEL 8 must use a separate file system for the system audit data path - Migrate the system audit data path onto a separate file system. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230295r1017106_rule | Automation: automated via SCAP
    - name: "A separate RHEL 8 filesystem must be used for the /tmp directory - (SV-230295r1017106_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/tmp\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "A separate RHEL 8 filesystem must be used for the /tmp directory - (SV-230295r1017106_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230295r1017106_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /tmp
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-230296r1069322_rule | Automation: automated via SCAP
    - name: "RHEL 8 must not permit direct logons to the root account using remote access - (SV-230296r1069322_rule)"
      tags:
        - stig
        - SV-230296r1069322_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*PermitRootLogin\s+'
        line: 'PermitRootLogin no'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-230298r1017108_rule | Automation: automated via SCAP
    - name: "Ensure rsyslog.service is start - (SV-230298r1017108_rule)"
      tags:
        - stig
        - SV-230298r1017108_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: rsyslog.service
        state: started


    # STIG ID: SV-230299r1017109_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must prevent files with the setuid and setgid bit set from being - (SV-230299r1017109_rule)"
      tags:
        - stig
        - SV-230299r1017109_rule
        - mount_option
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230299r1017109_rule: RHEL 8 must prevent files with the setuid and setgid bit set from being - Configure the "/etc/fstab" to use the "nosuid" option on file systems that contain user home directories for interactive users. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230300r1017110_rule | Automation: automated via SCAP
    - name: "RHEL 8 must prevent files with the setuid and setgid bit set from being - (SV-230300r1017110_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/boot\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nosuid\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must prevent files with the setuid and setgid bit set from being - (SV-230300r1017110_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230300r1017110_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /boot
        opts: "defaults,nosuid"
        state: mounted
        fstype: auto


    # STIG ID: SV-230301r1017111_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must prevent special devices on non-root local partitions - (SV-230301r1017111_rule)"
      tags:
        - stig
        - SV-230301r1017111_rule
        - mount_option
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230301r1017111_rule: RHEL 8 must prevent special devices on non-root local partitions - Configure the "/etc/fstab" to use the "nodev" option on all non-root local partitions. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230302r1017112_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must prevent code from being executed on file systems that contain user - (SV-230302r1017112_rule)"
      tags:
        - stig
        - SV-230302r1017112_rule
        - mount_option
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230302r1017112_rule: RHEL 8 must prevent code from being executed on file systems that contain user - Configure the "/etc/fstab" to use the "noexec" option on file systems that contain user home directories for interactive users. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230303r1017113_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must prevent special devices on file systems that are used with - (SV-230303r1017113_rule)"
      tags:
        - stig
        - SV-230303r1017113_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230303r1017113_rule: RHEL 8 must prevent special devices on file systems that are used with - Configure the "/etc/fstab" to use the "nodev" option on file systems that are associated with removable media. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230304r1017114_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must prevent code from being executed on file systems that are used with - (SV-230304r1017114_rule)"
      tags:
        - stig
        - SV-230304r1017114_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230304r1017114_rule: RHEL 8 must prevent code from being executed on file systems that are used with - Configure the "/etc/fstab" to use the "noexec" option on file systems that are associated with removable media. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230305r1017115_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must prevent files with the setuid and setgid bit set from being - (SV-230305r1017115_rule)"
      tags:
        - stig
        - SV-230305r1017115_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230305r1017115_rule: RHEL 8 must prevent files with the setuid and setgid bit set from being - Configure the "/etc/fstab" to use the "nosuid" option on file systems that are associated with removable media. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230306r1017116_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must prevent code from being executed on file systems that are imported - (SV-230306r1017116_rule)"
      tags:
        - stig
        - SV-230306r1017116_rule
        - mount_option
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230306r1017116_rule: RHEL 8 must prevent code from being executed on file systems that are imported - Configure the "/etc/fstab" to use the "noexec" option on file systems that are being imported via NFS. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230307r1017117_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must prevent special devices on file systems that are imported via - (SV-230307r1017117_rule)"
      tags:
        - stig
        - SV-230307r1017117_rule
        - mount_option
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230307r1017117_rule: RHEL 8 must prevent special devices on file systems that are imported via - Configure the "/etc/fstab" to use the "nodev" option on file systems that are being imported via NFS. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230308r1017118_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must prevent files with the setuid and setgid bit set from being - (SV-230308r1017118_rule)"
      tags:
        - stig
        - SV-230308r1017118_rule
        - mount_option
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230308r1017118_rule: RHEL 8 must prevent files with the setuid and setgid bit set from being - Configure the "/etc/fstab" to use the "nosuid" option on file systems that are being imported via NFS. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230309r1017119_rule | Automation: manual-only (not covered by scap)
    - name: "Local RHEL 8 initialization files must not execute world-writable programs - (SV-230309r1017119_rule)"
      tags:
        - stig
        - SV-230309r1017119_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230309r1017119_rule: Local RHEL 8 initialization files must not execute world-writable programs - Set the mode on files being executed by the local initialization files with the following command:  $ sudo chmod 0755 <file> Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230310r1017120_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must disable kernel dumps unless needed - (SV-230310r1017120_rule)"
      tags:
        - stig
        - SV-230310r1017120_rule
        - service_disabled
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230310r1017120_rule: RHEL 8 must disable kernel dumps unless needed - If kernel core dumps are not required, disable the "kdump" service with the following command:  # systemctl disable kdump.service  If kernel core dumps are required, document the need with the ISSO. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230311r1017121_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must disable the kernel.core_pattern - (SV-230311r1017121_rule)"
      tags:
        - stig
        - SV-230311r1017121_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230311r1017121_rule: RHEL 8 must disable the kernel.core_pattern - Configure RHEL 8 to disable storing core dumps.  Add or edit the following line in a system configuration file, in the "/etc/sysctl.d/" directory:  kernel.core_pattern = |/bin/false  Remove any config... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230312r1134877_rule | Automation: automated via SCAP
    - name: "Ensure systemd-coredump.socket is disable - (SV-230312r1134877_rule)"
      tags:
        - stig
        - SV-230312r1134877_rule
        - service_disabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: systemd-coredump.socket
        enabled: no
        state: stopped


    # STIG ID: SV-230313r1134879_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must disable core dumps for all users - (SV-230313r1134879_rule)"
      tags:
        - stig
        - SV-230313r1134879_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230313r1134879_rule: RHEL 8 must disable core dumps for all users - Configure the operating system to disable core dumps for all users.  Add the following line to the top of the /etc/security/limits.conf or in a ".conf" file defined in /etc/security/limits.d/:  * hard... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230314r1134881_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must disable storing core dumps - (SV-230314r1134881_rule)"
      tags:
        - stig
        - SV-230314r1134881_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230314r1134881_rule: RHEL 8 must disable storing core dumps - Configure the operating system to disable storing core dumps for all users.  Add or modify the following line in /etc/systemd/coredump.conf:  Storage=none Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230315r1134883_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must disable core dump backtraces - (SV-230315r1134883_rule)"
      tags:
        - stig
        - SV-230315r1134883_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230315r1134883_rule: RHEL 8 must disable core dump backtraces - Configure the operating system to disable core dump backtraces.  Add or modify the following line in /etc/systemd/coredump.conf:  ProcessSizeMax=0 Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230316r1044801_rule | Automation: manual-only (not covered by scap)
    - name: "For RHEL 8 systems using Domain Name Servers (DNS) resolution, at least two - (SV-230316r1044801_rule)"
      tags:
        - stig
        - SV-230316r1044801_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230316r1044801_rule: For RHEL 8 systems using Domain Name Servers (DNS) resolution, at least two - Configure the operating system to use two or more name servers for DNS resolution.  By default, "NetworkManager" on RHEL 8 dynamically updates the /etc/resolv.conf file with the DNS settings from acti... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230317r1069320_rule | Automation: manual-only (not covered by scap)
    - name: "Executable search paths within the initialization files of all local - (SV-230317r1069320_rule)"
      tags:
        - stig
        - SV-230317r1069320_rule
        - other
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230317r1069320_rule: Executable search paths within the initialization files of all local - Edit the local interactive user initialization files to change any PATH variable statements that reference directories other than their home directory.  If a local interactive user requires path varia... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230318r1017129_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 8 world-writable directories must be owned by root, sys, bin, or an - (SV-230318r1017129_rule)"
      tags:
        - stig
        - SV-230318r1017129_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230318r1017129_rule: All RHEL 8 world-writable directories must be owned by root, sys, bin, or an - All directories in local partitions which are world-writable should be owned by root or another system account. If any world-writable directories are not owned by a system account, this should be inve... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230319r1017130_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 8 world-writable directories must be group-owned by root, sys, bin, or - (SV-230319r1017130_rule)"
      tags:
        - stig
        - SV-230319r1017130_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230319r1017130_rule: All RHEL 8 world-writable directories must be group-owned by root, sys, bin, or - All directories in local partitions which are world-writable must be group-owned by root or another system account.  If any world-writable directories are not group-owned by a system account, this mus... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230320r1017131_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 8 local interactive users must have a home directory assigned in the - (SV-230320r1017131_rule)"
      tags:
        - stig
        - SV-230320r1017131_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230320r1017131_rule: All RHEL 8 local interactive users must have a home directory assigned in the - Assign home directories to all local interactive users on RHEL 8 that currently do not have a home directory assigned. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230321r1017132_rule | Automation: automated via SCAP
    - name: "All RHEL 8 local interactive user home directories must have mode 0750 or less - (SV-230321r1017132_rule)"
      tags:
        - stig
        - SV-230321r1017132_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /etc/passwd
        mode: '0750'
        state: directory


    # STIG ID: SV-230322r1017133_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 8 local interactive user home directories must be group-owned by the - (SV-230322r1017133_rule)"
      tags:
        - stig
        - SV-230322r1017133_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230322r1017133_rule: All RHEL 8 local interactive user home directories must be group-owned by the - Change the group owner of a local interactive user’s home directory to the group found in "/etc/passwd". To change the group owner of a local interactive user’s home directory, use the following comma... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230323r1017134_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 8 local interactive user home directories defined in the /etc/passwd - (SV-230323r1017134_rule)"
      tags:
        - stig
        - SV-230323r1017134_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230323r1017134_rule: All RHEL 8 local interactive user home directories defined in the /etc/passwd - Create home directories to all local interactive users that currently do not have a home directory assigned. Use the following commands to create the user home directory assigned in "/etc/ passwd":  N... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230324r1017135_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 8 local interactive user accounts must be assigned a home directory - (SV-230324r1017135_rule)"
      tags:
        - stig
        - SV-230324r1017135_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230324r1017135_rule: All RHEL 8 local interactive user accounts must be assigned a home directory - Configure RHEL 8 to assign home directories to all new local interactive users by setting the "CREATE_HOME" parameter in "/etc/login.defs" to "yes" as follows.  CREATE_HOME yes Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230325r1017136_rule | Automation: automated via SCAP
    - name: "All RHEL 8 local initialization files must have mode 0740 or less permissive - (SV-230325r1017136_rule)"
      tags:
        - stig
        - SV-230325r1017136_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /home/smithj
        mode: '0740'
        state: file


    # STIG ID: SV-230326r1069284_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 8 local files and directories must have a valid owner - (SV-230326r1069284_rule)"
      tags:
        - stig
        - SV-230326r1069284_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230326r1069284_rule: All RHEL 8 local files and directories must have a valid owner - Either remove all files and directories from the system that do not have a valid user, or assign a valid user to all unowned files and directories on RHEL 8 with the "chown" command:  $ sudo chown <us... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230327r1069285_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 8 local files and directories must have a valid group owner - (SV-230327r1069285_rule)"
      tags:
        - stig
        - SV-230327r1069285_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230327r1069285_rule: All RHEL 8 local files and directories must have a valid group owner - Either remove all files and directories from RHEL 8 that do not have a valid group, or assign a valid group to all files and directories on the system with the "chgrp" command:  $ sudo chgrp <group> <... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230328r1017139_rule | Automation: manual-only (not covered by scap)
    - name: "A separate RHEL 8 filesystem must be used for user home directories (such as - (SV-230328r1017139_rule)"
      tags:
        - stig
        - SV-230328r1017139_rule
        - mount_option
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230328r1017139_rule: A separate RHEL 8 filesystem must be used for user home directories (such as - Migrate the "/home" directory onto a separate file system. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230329r1017140_rule | Automation: manual-only (not covered by scap)
    - name: "Unattended or automatic logon via the RHEL 8 graphical user interface must not - (SV-230329r1017140_rule)"
      tags:
        - stig
        - SV-230329r1017140_rule
        - config
        - severity_high
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230329r1017140_rule: Unattended or automatic logon via the RHEL 8 graphical user interface must not - Configure the operating system to not allow an unattended or automatic logon to the system via a graphical user interface.  Add or edit the line for the "AutomaticLoginEnable" parameter in the [daemon... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230330r1069305_rule | Automation: automated via SCAP
    - name: "RHEL 8 must not allow users to override SSH environment variables - (SV-230330r1069305_rule)"
      tags:
        - stig
        - SV-230330r1069305_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*PermitUserEnvironment\s+'
        line: 'PermitUserEnvironment no'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-230332r1017144_rule | Automation: automated via SCAP
    - name: "Ensure sssd.service is restart - (SV-230332r1017144_rule)"
      tags:
        - stig
        - SV-230332r1017144_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: sssd.service
        state: restarted


    # STIG ID: SV-230333r1017145_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must automatically lock an account when three unsuccessful logon - (SV-230333r1017145_rule)"
      tags:
        - stig
        - SV-230333r1017145_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230333r1017145_rule: RHEL 8 must automatically lock an account when three unsuccessful logon - Configure the operating system to lock an account when three unsuccessful logon attempts occur.  Add/Modify the "/etc/security/faillock.conf" file to match the following line:  deny = 3 Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230334r1017146_rule | Automation: automated via SCAP
    - name: "Ensure sssd.service is restart - (SV-230334r1017146_rule)"
      tags:
        - stig
        - SV-230334r1017146_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: sssd.service
        state: restarted


    # STIG ID: SV-230335r1017147_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must automatically lock an account when three unsuccessful logon - (SV-230335r1017147_rule)"
      tags:
        - stig
        - SV-230335r1017147_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230335r1017147_rule: RHEL 8 must automatically lock an account when three unsuccessful logon - Configure the operating system to lock an account when three unsuccessful logon attempts occur in 15 minutes.  Add/Modify the "/etc/security/faillock.conf" file to match the following line:  fail_inte... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230336r1017148_rule | Automation: automated via SCAP
    - name: "Ensure sssd.service is restart - (SV-230336r1017148_rule)"
      tags:
        - stig
        - SV-230336r1017148_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: sssd.service
        state: restarted


    # STIG ID: SV-230337r1134885_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must automatically lock an account until the locked account is released - (SV-230337r1134885_rule)"
      tags:
        - stig
        - SV-230337r1134885_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230337r1134885_rule: RHEL 8 must automatically lock an account until the locked account is released - Configure the operating system to lock an account until released by an administrator when three unsuccessful logon attempts occur in 15 minutes.  Add/Modify the "/etc/security/faillock.conf" file to m... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230338r1017150_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must ensure account lockouts persist - (SV-230338r1017150_rule)"
      tags:
        - stig
        - SV-230338r1017150_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230338r1017150_rule: RHEL 8 must ensure account lockouts persist - Configure the operating system maintain the contents of the faillock directory after a reboot.  Add/Modify the appropriate sections of the "/etc/pam.d/system-auth" and "/etc/pam.d/password-auth" files... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230339r1017151_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must ensure account lockouts persist - (SV-230339r1017151_rule)"
      tags:
        - stig
        - SV-230339r1017151_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230339r1017151_rule: RHEL 8 must ensure account lockouts persist - Configure the operating system maintain the contents of the faillock directory after a reboot.  Add/Modify the "/etc/security/faillock.conf" file to match the following line:  dir = /var/log/faillock Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230340r1017152_rule | Automation: automated via SCAP
    - name: "Ensure sssd.service is restart - (SV-230340r1017152_rule)"
      tags:
        - stig
        - SV-230340r1017152_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: sssd.service
        state: restarted


    # STIG ID: SV-230341r1017153_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must prevent system messages from being presented when three - (SV-230341r1017153_rule)"
      tags:
        - stig
        - SV-230341r1017153_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230341r1017153_rule: RHEL 8 must prevent system messages from being presented when three - Configure the operating system to prevent informative messages from being presented at logon attempts.  Add/Modify the "/etc/security/faillock.conf" file to match the following line:  silent Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230342r1017154_rule | Automation: automated via SCAP
    - name: "Ensure sssd.service is restart - (SV-230342r1017154_rule)"
      tags:
        - stig
        - SV-230342r1017154_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: sssd.service
        state: restarted


    # STIG ID: SV-230343r1017155_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must log user name information when unsuccessful logon attempts occur - (SV-230343r1017155_rule)"
      tags:
        - stig
        - SV-230343r1017155_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230343r1017155_rule: RHEL 8 must log user name information when unsuccessful logon attempts occur - Configure the operating system to log user name information when unsuccessful logon attempts occur.  Add/Modify the "/etc/security/faillock.conf" file to match the following line:  audit Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230344r1017156_rule | Automation: automated via SCAP
    - name: "Ensure sssd.service is restart - (SV-230344r1017156_rule)"
      tags:
        - stig
        - SV-230344r1017156_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: sssd.service
        state: restarted


    # STIG ID: SV-230345r1017157_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must include root when automatically locking an account until the locked - (SV-230345r1017157_rule)"
      tags:
        - stig
        - SV-230345r1017157_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230345r1017157_rule: RHEL 8 must include root when automatically locking an account until the locked - Configure the operating system to include root when locking an account after three unsuccessful logon attempts occur in 15 minutes.  Add/Modify the "/etc/security/faillock.conf" file to match the foll... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230346r1069306_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must limit the number of concurrent sessions to ten for all accounts - (SV-230346r1069306_rule)"
      tags:
        - stig
        - SV-230346r1069306_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230346r1069306_rule: RHEL 8 must limit the number of concurrent sessions to ten for all accounts - Configure the operating system to limit the number of concurrent sessions to "10" for all accounts and/or account types.  Add the following line to the top of the /etc/security/limits.conf or in a ".c... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230347r1017160_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must enable a user session lock until that user re-establishes access - (SV-230347r1017160_rule)"
      tags:
        - stig
        - SV-230347r1017160_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230347r1017160_rule: RHEL 8 must enable a user session lock until that user re-establishes access - Configure the operating system to enable a user's session lock until that user re-establishes access using established identification and authentication procedures.  Create a database to contain the s... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230351r1017164_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must be able to initiate directly a session lock for all connection - (SV-230351r1017164_rule)"
      tags:
        - stig
        - SV-230351r1017164_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230351r1017164_rule: RHEL 8 must be able to initiate directly a session lock for all connection - Configure the operating system to enable a user's session lock until that user re-establishes access using established identification and authentication procedures.  Select/Create an authselect profil... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230352r1017165_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must automatically lock graphical user sessions after 15 minutes of - (SV-230352r1017165_rule)"
      tags:
        - stig
        - SV-230352r1017165_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230352r1017165_rule: RHEL 8 must automatically lock graphical user sessions after 15 minutes of - Configure the operating system to initiate a screensaver after a 15-minute period of inactivity for graphical user interfaces.  Create a database to contain the system-wide screensaver settings (if it... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230354r1069323_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must prevent a user from overriding the session lock-delay setting for - (SV-230354r1069323_rule)"
      tags:
        - stig
        - SV-230354r1069323_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230354r1069323_rule: RHEL 8 must prevent a user from overriding the session lock-delay setting for - Configure the operating system to prevent a user from overriding settings for graphical user interfaces.  Create a database to contain the system-wide screensaver settings (if it does not already exis... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230355r1017168_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must map the authenticated identity to the user or group account for - (SV-230355r1017168_rule)"
      tags:
        - stig
        - SV-230355r1017168_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230355r1017168_rule: RHEL 8 must map the authenticated identity to the user or group account for - Configure the operating system to map the authenticated identity to the user or group account by adding or modifying the certmap section of the "/etc/sssd/sssd.conf file based on the following example... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230356r982195_rule | Automation: automated via SCAP
    - name: "RHEL 8 must ensure the password complexity module is enabled in the - (SV-230356r982195_rule)"
      tags:
        - stig
        - SV-230356r982195_rule
        - config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.blockinfile:
        path: /etc/pam.d/password-auth
        block: |
          line to the "/etc/pam.d/password-auth" file (or mod
        marker: '# {mark} ANSIBLE MANAGED BLOCK'
        create: yes
        backup: yes


    # STIG ID: SV-230357r1017169_rule | Automation: automated via SCAP
    - name: "RHEL 8 must enforce password complexity by requiring that at least one - (SV-230357r1017169_rule)"
      tags:
        - stig
        - SV-230357r1017169_rule
        - config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.blockinfile:
        path: /etc/security/pwquality.conf
        block: |
          line to /etc/security/pwquality.conf (or mod
        marker: '# {mark} ANSIBLE MANAGED BLOCK'
        create: yes
        backup: yes


    # STIG ID: SV-230358r1017170_rule | Automation: automated via SCAP
    - name: "RHEL 8 must enforce password complexity by requiring that at least one - (SV-230358r1017170_rule)"
      tags:
        - stig
        - SV-230358r1017170_rule
        - config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.blockinfile:
        path: /etc/security/pwquality.conf
        block: |
          line to /etc/security/pwquality.conf (or mod
        marker: '# {mark} ANSIBLE MANAGED BLOCK'
        create: yes
        backup: yes


    # STIG ID: SV-230359r1017171_rule | Automation: automated via SCAP
    - name: "RHEL 8 must enforce password complexity by requiring that at least one numeric - (SV-230359r1017171_rule)"
      tags:
        - stig
        - SV-230359r1017171_rule
        - config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.blockinfile:
        path: /etc/security/pwquality.conf
        block: |
          line to /etc/security/pwquality.conf (or mod
        marker: '# {mark} ANSIBLE MANAGED BLOCK'
        create: yes
        backup: yes


    # STIG ID: SV-230360r1017172_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must require the maximum number of repeating characters of the same - (SV-230360r1017172_rule)"
      tags:
        - stig
        - SV-230360r1017172_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230360r1017172_rule: RHEL 8 must require the maximum number of repeating characters of the same - Configure the operating system to require the change of the number of repeating characters of the same character class when passwords are changed by setting the "maxclassrepeat" option.  Add the follo... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230361r1017173_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must require the maximum number of repeating characters be limited to - (SV-230361r1017173_rule)"
      tags:
        - stig
        - SV-230361r1017173_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230361r1017173_rule: RHEL 8 must require the maximum number of repeating characters be limited to - Configure the operating system to require the change of the number of repeating consecutive characters when passwords are changed by setting the "maxrepeat" option.  Add the following line to "/etc/se... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230362r1017174_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must require the change of at least four character classes when - (SV-230362r1017174_rule)"
      tags:
        - stig
        - SV-230362r1017174_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230362r1017174_rule: RHEL 8 must require the change of at least four character classes when - Configure the operating system to require the change of at least four character classes when passwords are changed by setting the "minclass" option.  Add the following line to "/etc/security/pwquality... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230363r1017175_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must require the change of at least 8 characters when passwords are - (SV-230363r1017175_rule)"
      tags:
        - stig
        - SV-230363r1017175_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230363r1017175_rule: RHEL 8 must require the change of at least 8 characters when passwords are - Configure the operating system to require the change of at least eight of the total number of characters when passwords are changed by setting the "difok" option.  Add the following line to "/etc/secu... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230364r1017176_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 passwords must have a 24 hours/1 day minimum password lifetime - (SV-230364r1017176_rule)"
      tags:
        - stig
        - SV-230364r1017176_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230364r1017176_rule: RHEL 8 passwords must have a 24 hours/1 day minimum password lifetime - Configure non-compliant accounts to enforce a 24 hours/1 day minimum password lifetime:  $ sudo chage -m 1 [user] Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230365r1017177_rule | Automation: automated via SCAP
    - name: "RHEL 8 passwords for new users or password changes must have a 24 hours/1 day - (SV-230365r1017177_rule)"
      tags:
        - stig
        - SV-230365r1017177_rule
        - config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/login.defs
        line: 'PASS_MIN_DAYS 1'
        regexp: '^#?\s*PASS_MIN_DAYS\s+'
        create: yes
        backup: yes


    # STIG ID: SV-230366r1038967_rule | Automation: automated via SCAP
    - name: "RHEL 8 user account passwords must have a 60-day maximum password lifetime - (SV-230366r1038967_rule)"
      tags:
        - stig
        - SV-230366r1038967_rule
        - config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/login.defs
        line: 'PASS_MAX_DAYS 60'
        regexp: '^#?\s*PASS_MAX_DAYS\s+'
        create: yes
        backup: yes


    # STIG ID: SV-230367r1038967_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 user account passwords must be configured so that existing passwords are - (SV-230367r1038967_rule)"
      tags:
        - stig
        - SV-230367r1038967_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230367r1038967_rule: RHEL 8 user account passwords must be configured so that existing passwords are - Configure non-compliant accounts to enforce a 60-day maximum password lifetime restriction.  $ sudo chage -M 60 [user] Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230369r1017181_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 passwords must have a minimum of 15 characters - (SV-230369r1017181_rule)"
      tags:
        - stig
        - SV-230369r1017181_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230369r1017181_rule: RHEL 8 passwords must have a minimum of 15 characters - Configure operating system to enforce a minimum 15-character password length.  Add the following line to "/etc/security/pwquality.conf" (or modify the line to have the required value):  minlen = 15  R... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230370r1017182_rule | Automation: automated via SCAP
    - name: "RHEL 8 passwords for new users must have a minimum of 15 characters - (SV-230370r1017182_rule)"
      tags:
        - stig
        - SV-230370r1017182_rule
        - config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/login.defs
        line: 'PASS_MIN_LEN 15'
        regexp: '^#?\s*PASS_MIN_LEN\s+'
        create: yes
        backup: yes


    # STIG ID: SV-230371r1017183_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 duplicate User IDs (UIDs) must not exist for interactive users - (SV-230371r1017183_rule)"
      tags:
        - stig
        - SV-230371r1017183_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230371r1017183_rule: RHEL 8 duplicate User IDs (UIDs) must not exist for interactive users - Edit the file "/etc/passwd" and provide each interactive user account that has a duplicate User ID (UID) with a unique UID. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230372r1017184_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must implement smart card logon for multifactor authentication for - (SV-230372r1017184_rule)"
      tags:
        - stig
        - SV-230372r1017184_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230372r1017184_rule: RHEL 8 must implement smart card logon for multifactor authentication for - Configure RHEL 8 to use multifactor authentication for local access to accounts.  Add or update the "pam_cert_auth" setting in the "/etc/sssd/sssd.conf" file to match the following line:       [pam]  ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230373r1017185_rule | Automation: automated via SCAP
    - name: "RHEL 8 account identifiers (individuals, groups, roles, and devices) must be - (SV-230373r1017185_rule)"
      tags:
        - stig
        - SV-230373r1017185_rule
        - config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/default/useradd
        line: 'INACTIVE=35'
        regexp: '^#?\s*INACTIVE\s*='
        create: yes
        backup: yes


    # STIG ID: SV-230374r1069293_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must automatically expire temporary accounts within 72 hours - (SV-230374r1069293_rule)"
      tags:
        - stig
        - SV-230374r1069293_rule
        - other
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230374r1069293_rule: RHEL 8 must automatically expire temporary accounts within 72 hours - Configure the operating system to expire temporary accounts after 72 hours with the following command:       $ sudo chage -E $(date -d +3days +%Y-%m-%d) <temporary_account_name> Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230375r1017187_rule | Automation: automated via SCAP
    - name: "All RHEL 8 passwords must contain at least one special character - (SV-230375r1017187_rule)"
      tags:
        - stig
        - SV-230375r1017187_rule
        - config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.blockinfile:
        path: /etc/security/pwquality.conf
        block: |
          line to /etc/security/pwquality.conf (or mod
        marker: '# {mark} ANSIBLE MANAGED BLOCK'
        create: yes
        backup: yes


    # STIG ID: SV-230376r1069307_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must prohibit the use of cached authentications after one day - (SV-230376r1069307_rule)"
      tags:
        - stig
        - SV-230376r1069307_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230376r1069307_rule: RHEL 8 must prohibit the use of cached authentications after one day - Configure the SSSD to prohibit the use of cached authentications after one day.  Add or change the following line in "/etc/sssd/sssd.conf" just below the line "[pam]".       offline_credentials_expira... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230377r1017188_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must prevent the use of dictionary words for passwords - (SV-230377r1017188_rule)"
      tags:
        - stig
        - SV-230377r1017188_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230377r1017188_rule: RHEL 8 must prevent the use of dictionary words for passwords - Configure RHEL 8 to prevent the use of dictionary words for passwords.  Add or update the following line in the "/etc/security/pwquality.conf" file or a configuration file in the /etc/pwquality.conf.d... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230378r1017189_rule | Automation: automated via SCAP
    - name: "RHEL 8 must enforce a delay of at least four seconds between logon prompts - (SV-230378r1017189_rule)"
      tags:
        - stig
        - SV-230378r1017189_rule
        - config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/login.defs
        line: 'FAIL_DELAY 4'
        regexp: '^#?\s*FAIL_DELAY\s+'
        create: yes
        backup: yes


    # STIG ID: SV-230379r1017190_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must not have unnecessary accounts - (SV-230379r1017190_rule)"
      tags:
        - stig
        - SV-230379r1017190_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230379r1017190_rule: RHEL 8 must not have unnecessary accounts - Remove unauthorized local interactive user accounts with the following command where <unauthorized_user> is the unauthorized account:  $ sudo userdel <unauthorized_user> Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230380r1069308_rule | Automation: automated via SCAP
    - name: "RHEL 8 must not allow accounts configured with blank or null passwords - (SV-230380r1069308_rule)"
      tags:
        - stig
        - SV-230380r1069308_rule
        - ssh_config
        - severity_high
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*PermitEmptyPasswords\s+'
        line: 'PermitEmptyPasswords no'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-230381r1069295_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must display the date and time of the last successful account logon upon - (SV-230381r1069295_rule)"
      tags:
        - stig
        - SV-230381r1069295_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230381r1069295_rule: RHEL 8 must display the date and time of the last successful account logon upon - Configure the operating system to provide users with feedback on when account accesses last occurred by setting the required configuration options in "/etc/pam.d/postlogin".   Add the following line t... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230382r1069309_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must display the date and time of the last successful account logon upon - (SV-230382r1069309_rule)"
      tags:
        - stig
        - SV-230382r1069309_rule
        - ssh_config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230382r1069309_rule: RHEL 8 must display the date and time of the last successful account logon upon - Configure SSH to provide users with feedback on when account accesses last occurred by setting the required configuration options in "/etc/pam.d/sshd" or in the "sshd_config" file used by the system (... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230383r1017192_rule | Automation: automated via SCAP
    - name: "RHEL 8 must define default permissions for all authenticated users in such a - (SV-230383r1017192_rule)"
      tags:
        - stig
        - SV-230383r1017192_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /etc/login.defs
        mode: '077'
        state: file


    # STIG ID: SV-230384r1017193_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must set the umask value to 077 for all local interactive user accounts - (SV-230384r1017193_rule)"
      tags:
        - stig
        - SV-230384r1017193_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230384r1017193_rule: RHEL 8 must set the umask value to 077 for all local interactive user accounts - Remove the umask statement from all local interactive user's initialization files.   If the account is for an application, the requirement for a umask less restrictive than "077" can be documented wit... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230385r1017194_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must define default permissions for logon and non-logon shells - (SV-230385r1017194_rule)"
      tags:
        - stig
        - SV-230385r1017194_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230385r1017194_rule: RHEL 8 must define default permissions for logon and non-logon shells - Configure the operating system to define default permissions for all authenticated users in such a way that the user can only read and modify their own files.  Add or edit the lines for the "UMASK" pa... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230386r958730_rule | Automation: automated via SCAP
    - name: "The RHEL 8 audit system must be configured to audit the execution of privileged - (SV-230386r958730_rule)"
      tags:
        - stig
        - SV-230386r958730_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k execpriv'
        regexp: '^\-a\ always,exit\ \-F\ arch=b32\ \-S\ execve\ \-C\ uid!=euid\ \-F\ euid=0\ \-k\ execpriv$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230387r1017195_rule | Automation: manual-only (not covered by scap)
    - name: "Cron logging must be implemented in RHEL 8 - (SV-230387r1017195_rule)"
      tags:
        - stig
        - SV-230387r1017195_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230387r1017195_rule: Cron logging must be implemented in RHEL 8 - Configure "rsyslog" to log all cron messages by adding or updating the following line to "/etc/rsyslog.conf" or a configuration file in the /etc/rsyslog.d/ directory:  cron.* /var/log/cron  The rsyslo... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230388r1017196_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 System Administrator (SA) and Information System Security Officer - (SV-230388r1017196_rule)"
      tags:
        - stig
        - SV-230388r1017196_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230388r1017196_rule: The RHEL 8 System Administrator (SA) and Information System Security Officer - Configure "auditd" service to notify the SA and ISSO in the event of an audit processing failure.   Edit the following line in "/etc/audit/auditd.conf" to ensure that administrators are notified via e... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230389r1017197_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 Information System Security Officer (ISSO) and System Administrator - (SV-230389r1017197_rule)"
      tags:
        - stig
        - SV-230389r1017197_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230389r1017197_rule: The RHEL 8 Information System Security Officer (ISSO) and System Administrator - Configure RHEL 8 to notify administrators in the event of an audit processing failure.  Add/update the following line in "/etc/aliases":  postmaster: root Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230390r1038966_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 System must take appropriate action when an audit processing failure - (SV-230390r1038966_rule)"
      tags:
        - stig
        - SV-230390r1038966_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230390r1038966_rule: The RHEL 8 System must take appropriate action when an audit processing failure - Configure RHEL 8 to shut down by default upon audit failure (unless availability is an overriding concern).  Add or update the following line (depending on configuration "disk_error_action" can be set... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230392r1038966_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 audit system must take appropriate action when the audit storage - (SV-230392r1038966_rule)"
      tags:
        - stig
        - SV-230392r1038966_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230392r1038966_rule: The RHEL 8 audit system must take appropriate action when the audit storage - Configure RHEL 8 to shut down by default upon audit failure (unless availability is an overriding concern).  Add or update the following line (depending on configuration "disk_full_action" can be set ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230393r1017200_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 audit system must audit local events - (SV-230393r1017200_rule)"
      tags:
        - stig
        - SV-230393r1017200_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230393r1017200_rule: The RHEL 8 audit system must audit local events - Configure RHEL 8 to audit local events on the system.  Add or update the following line in "/etc/audit/auditd.conf" file:  local_events = yes Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230394r958754_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must label all off-loaded audit logs before sending them to the central - (SV-230394r958754_rule)"
      tags:
        - stig
        - SV-230394r958754_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230394r958754_rule: RHEL 8 must label all off-loaded audit logs before sending them to the central - Edit the /etc/audit/auditd.conf file and add or update the "name_format" option:  name_format = hostname  The audit daemon must be restarted for changes to take effect. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230395r1017201_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must resolve audit information before writing to disk - (SV-230395r1017201_rule)"
      tags:
        - stig
        - SV-230395r1017201_rule
        - audit
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230395r1017201_rule: RHEL 8 must resolve audit information before writing to disk - Edit the /etc/audit/auditd.conf file and add or update the "log_format" option:  log_format = ENRICHED  The audit daemon must be restarted for changes to take effect. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230396r1017202_rule | Automation: automated via SCAP
    - name: "RHEL 8 audit logs must have a mode of 0600 or less permissive to prevent - (SV-230396r1017202_rule)"
      tags:
        - stig
        - SV-230396r1017202_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /etc/audit/auditd.conf
        mode: '0600'
        state: file


    # STIG ID: SV-230397r1017203_rule | Automation: automated via SCAP
    - name: "RHEL 8 audit logs must be owned by root to prevent unauthorized read access - (SV-230397r1017203_rule)"
      tags:
        - stig
        - SV-230397r1017203_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /etc/audit/auditd.conf
        owner: root
        state: file


    # STIG ID: SV-230398r1017204_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 audit logs must be group-owned by root to prevent unauthorized read - (SV-230398r1017204_rule)"
      tags:
        - stig
        - SV-230398r1017204_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230398r1017204_rule: RHEL 8 audit logs must be group-owned by root to prevent unauthorized read - Configure the audit log to be owned by root by configuring the log group in the /etc/audit/auditd.conf file:  log_group = root Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230399r1017205_rule | Automation: automated via SCAP
    - name: "RHEL 8 audit log directory must be owned by root to prevent unauthorized read - (SV-230399r1017205_rule)"
      tags:
        - stig
        - SV-230399r1017205_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /etc/audit/auditd.conf
        owner: root
        state: directory


    # STIG ID: SV-230400r1017206_rule | Automation: automated via SCAP
    - name: "RHEL 8 audit log directory must be group-owned by root to prevent unauthorized - (SV-230400r1017206_rule)"
      tags:
        - stig
        - SV-230400r1017206_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /etc/audit/auditd.conf
        group: root
        state: directory


    # STIG ID: SV-230401r1017207_rule | Automation: automated via SCAP
    - name: "RHEL 8 audit log directory must have a mode of 0700 or less permissive to - (SV-230401r1017207_rule)"
      tags:
        - stig
        - SV-230401r1017207_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /etc/audit/auditd.conf
        mode: '0700'
        state: directory


    # STIG ID: SV-230402r1017208_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 audit system must protect auditing rules from unauthorized change - (SV-230402r1017208_rule)"
      tags:
        - stig
        - SV-230402r1017208_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230402r1017208_rule: RHEL 8 audit system must protect auditing rules from unauthorized change - Configure the audit system to set the audit rules to be immutable by adding the following line to "/etc/audit/rules.d/audit.rules"  -e 2  Note: Once set, the system must be rebooted for auditing to be... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230403r1017209_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 audit system must protect logon UIDs from unauthorized change - (SV-230403r1017209_rule)"
      tags:
        - stig
        - SV-230403r1017209_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230403r1017209_rule: RHEL 8 audit system must protect logon UIDs from unauthorized change - Configure the audit system to set the logon UIDs to be immutable by adding the following line to "/etc/audit/rules.d/audit.rules"  --loginuid-immutable Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230404r1017210_rule | Automation: automated via SCAP
    - name: "RHEL 8 must generate audit records for all account creations, modifications, - (SV-230404r1017210_rule)"
      tags:
        - stig
        - SV-230404r1017210_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/shadow -p wa -k identity'
        regexp: '^\-w\ /etc/shadow\ \-p\ wa\ \-k\ identity$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230405r1017211_rule | Automation: automated via SCAP
    - name: "RHEL 8 must generate audit records for all account creations, modifications, - (SV-230405r1017211_rule)"
      tags:
        - stig
        - SV-230405r1017211_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/security/opasswd -p wa -k identity'
        regexp: '^\-w\ /etc/security/opasswd\ \-p\ wa\ \-k\ identity$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230406r1017212_rule | Automation: automated via SCAP
    - name: "RHEL 8 must generate audit records for all account creations, modifications, - (SV-230406r1017212_rule)"
      tags:
        - stig
        - SV-230406r1017212_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/passwd -p wa -k identity'
        regexp: '^\-w\ /etc/passwd\ \-p\ wa\ \-k\ identity$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230407r1017213_rule | Automation: automated via SCAP
    - name: "RHEL 8 must generate audit records for all account creations, modifications, - (SV-230407r1017213_rule)"
      tags:
        - stig
        - SV-230407r1017213_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/gshadow -p wa -k identity'
        regexp: '^\-w\ /etc/gshadow\ \-p\ wa\ \-k\ identity$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230408r1017214_rule | Automation: automated via SCAP
    - name: "RHEL 8 must generate audit records for all account creations, modifications, - (SV-230408r1017214_rule)"
      tags:
        - stig
        - SV-230408r1017214_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/group -p wa -k identity'
        regexp: '^\-w\ /etc/group\ \-p\ wa\ \-k\ identity$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230409r1017215_rule | Automation: automated via SCAP
    - name: "RHEL 8 must generate audit records for all account creations, modifications, - (SV-230409r1017215_rule)"
      tags:
        - stig
        - SV-230409r1017215_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/sudoers -p wa -k identity'
        regexp: '^\-w\ /etc/sudoers\ \-p\ wa\ \-k\ identity$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230410r1017216_rule | Automation: automated via SCAP
    - name: "RHEL 8 must generate audit records for all account creations, modifications, - (SV-230410r1017216_rule)"
      tags:
        - stig
        - SV-230410r1017216_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/sudoers.d/ -p wa -k identity'
        regexp: '^\-w\ /etc/sudoers\.d/\ \-p\ wa\ \-k\ identity$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230411r1017217_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 audit package must be installed - (SV-230411r1017217_rule)"
      tags:
        - stig
        - SV-230411r1017217_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230411r1017217_rule: The RHEL 8 audit package must be installed - Configure the audit service to produce audit records containing the information needed to establish when (date and time) an event occurred.  Install the audit service (if the audit service is not alre... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230412r1017218_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the su command in RHEL 8 must generate an audit - (SV-230412r1017218_rule)"
      tags:
        - stig
        - SV-230412r1017218_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=unset -k privileged-priv_change'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/su\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-priv_change$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230413r1017219_rule | Automation: automated via SCAP
    - name: "The RHEL 8 audit system must be configured to audit any usage of the setxattr, - (SV-230413r1017219_rule)"
      tags:
        - stig
        - SV-230413r1017219_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid>=1000 -F auid!=unset -k perm_mod'
        regexp: '^\-a\ always,exit\ \-F\ arch=b32\ \-S\ setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ perm_mod$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230418r1017220_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the chage command in RHEL 8 must generate an - (SV-230418r1017220_rule)"
      tags:
        - stig
        - SV-230418r1017220_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=unset -k privileged-chage'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/chage\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-chage$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230419r1017221_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the chcon command in RHEL 8 must generate an - (SV-230419r1017221_rule)"
      tags:
        - stig
        - SV-230419r1017221_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=unset -k perm_mod'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/chcon\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ perm_mod$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230421r1017222_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the ssh-agent in RHEL 8 must generate an audit - (SV-230421r1017222_rule)"
      tags:
        - stig
        - SV-230421r1017222_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/ssh-agent -F perm=x -F auid>=1000 -F auid!=unset -k privileged-ssh'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/ssh\-agent\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-ssh$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230422r1017223_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the passwd command in RHEL 8 must generate an - (SV-230422r1017223_rule)"
      tags:
        - stig
        - SV-230422r1017223_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/passwd -F perm=x -F auid>=1000 -F auid!=unset -k privileged-passwd'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/passwd\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-passwd$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230423r1017224_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the mount command in RHEL 8 must generate an - (SV-230423r1017224_rule)"
      tags:
        - stig
        - SV-230423r1017224_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/mount -F perm=x -F auid>=1000 -F auid!=unset -k privileged-mount'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/mount\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-mount$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230424r1017225_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the umount command in RHEL 8 must generate an - (SV-230424r1017225_rule)"
      tags:
        - stig
        - SV-230424r1017225_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/umount -F perm=x -F auid>=1000 -F auid!=unset -k privileged-mount'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/umount\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-mount$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230425r1017226_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the mount syscall in RHEL 8 must generate an - (SV-230425r1017226_rule)"
      tags:
        - stig
        - SV-230425r1017226_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=unset -k privileged-mount'
        regexp: '^\-a\ always,exit\ \-F\ arch=b32\ \-S\ mount\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-mount$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230426r1017227_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the unix_update in RHEL 8 must generate an - (SV-230426r1017227_rule)"
      tags:
        - stig
        - SV-230426r1017227_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/unix_update -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/unix_update\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-unix\-update$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230427r1017228_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of postdrop in RHEL 8 must generate an audit record - (SV-230427r1017228_rule)"
      tags:
        - stig
        - SV-230427r1017228_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/postdrop -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/postdrop\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-unix\-update$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230428r1017229_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of postqueue in RHEL 8 must generate an audit - (SV-230428r1017229_rule)"
      tags:
        - stig
        - SV-230428r1017229_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/postqueue -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/postqueue\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-unix\-update$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230429r1017230_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of semanage in RHEL 8 must generate an audit record - (SV-230429r1017230_rule)"
      tags:
        - stig
        - SV-230429r1017230_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/semanage -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/semanage\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-unix\-update$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230430r1017231_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of setfiles in RHEL 8 must generate an audit record - (SV-230430r1017231_rule)"
      tags:
        - stig
        - SV-230430r1017231_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/setfiles -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/setfiles\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-unix\-update$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230431r1017232_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of userhelper in RHEL 8 must generate an audit - (SV-230431r1017232_rule)"
      tags:
        - stig
        - SV-230431r1017232_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/userhelper\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-unix\-update$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230432r1017233_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of setsebool in RHEL 8 must generate an audit - (SV-230432r1017233_rule)"
      tags:
        - stig
        - SV-230432r1017233_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/setsebool -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/setsebool\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-unix\-update$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230433r1017234_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of unix_chkpwd in RHEL 8 must generate an audit - (SV-230433r1017234_rule)"
      tags:
        - stig
        - SV-230433r1017234_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/unix_chkpwd\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-unix\-update$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230434r1017235_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the ssh-keysign in RHEL 8 must generate an - (SV-230434r1017235_rule)"
      tags:
        - stig
        - SV-230434r1017235_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/libexec/openssh/ssh-keysign -F perm=x -F auid>=1000 -F auid!=unset -k privileged-ssh'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/libexec/openssh/ssh\-keysign\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-ssh$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230435r1017236_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the setfacl command in RHEL 8 must generate an - (SV-230435r1017236_rule)"
      tags:
        - stig
        - SV-230435r1017236_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/setfacl -F perm=x -F auid>=1000 -F auid!=unset -k perm_mod'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/setfacl\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ perm_mod$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230436r1017237_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the pam_timestamp_check command in RHEL 8 must - (SV-230436r1017237_rule)"
      tags:
        - stig
        - SV-230436r1017237_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/pam_timestamp_check -F perm=x -F auid>=1000 -F auid!=unset -k privileged-pam_timestamp_check'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/pam_timestamp_check\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-pam_timestamp_check$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230437r1017238_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the newgrp command in RHEL 8 must generate an - (SV-230437r1017238_rule)"
      tags:
        - stig
        - SV-230437r1017238_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/newgrp\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ priv_cmd$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230438r1017241_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the init_module and finit_module system calls - (SV-230438r1017241_rule)"
      tags:
        - stig
        - SV-230438r1017241_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S init_module,finit_module -F auid>=1000 -F auid!=unset -k module_chng'
        regexp: '^\-a\ always,exit\ \-F\ arch=b32\ \-S\ init_module,finit_module\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ module_chng$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230439r1017243_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the rename, unlink, rmdir, renameat, and - (SV-230439r1017243_rule)"
      tags:
        - stig
        - SV-230439r1017243_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S rename,unlink,rmdir,renameat,unlinkat -F auid>=1000 -F auid!=unset -k delete'
        regexp: '^\-a\ always,exit\ \-F\ arch=b32\ \-S\ rename,unlink,rmdir,renameat,unlinkat\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ delete$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230444r1017244_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the gpasswd command in RHEL 8 must generate an - (SV-230444r1017244_rule)"
      tags:
        - stig
        - SV-230444r1017244_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=unset -k privileged-gpasswd'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/gpasswd\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-gpasswd$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230446r1017245_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the delete_module command in RHEL 8 must - (SV-230446r1017245_rule)"
      tags:
        - stig
        - SV-230446r1017245_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S delete_module -F auid>=1000 -F auid!=unset -k module_chng'
        regexp: '^\-a\ always,exit\ \-F\ arch=b32\ \-S\ delete_module\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ module_chng$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230447r1017246_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the crontab command in RHEL 8 must generate an - (SV-230447r1017246_rule)"
      tags:
        - stig
        - SV-230447r1017246_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/crontab -F perm=x -F auid>=1000 -F auid!=unset -k privileged-crontab'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/crontab\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-crontab$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230448r1017247_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the chsh command in RHEL 8 must generate an - (SV-230448r1017247_rule)"
      tags:
        - stig
        - SV-230448r1017247_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/chsh\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ priv_cmd$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230449r1017249_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the truncate, ftruncate, creat, open, openat, - (SV-230449r1017249_rule)"
      tags:
        - stig
        - SV-230449r1017249_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S truncate,ftruncate,creat,open,openat,open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -k perm_access'
        regexp: '^\-a\ always,exit\ \-F\ arch=b32\ \-S\ truncate,ftruncate,creat,open,openat,open_by_handle_at\ \-F\ exit=\-EPERM\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ perm_access$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230455r1017251_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the chown, fchown, fchownat, and lchown system - (SV-230455r1017251_rule)"
      tags:
        - stig
        - SV-230455r1017251_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /etc/audit/rules.d/audit.rules
        state: file


    # STIG ID: SV-230456r1017253_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the chmod, fchmod, and fchmodat system calls in - (SV-230456r1017253_rule)"
      tags:
        - stig
        - SV-230456r1017253_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /etc/audit/rules.d/audit.rules
        state: file


    # STIG ID: SV-230462r1017254_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the sudo command in RHEL 8 must generate an - (SV-230462r1017254_rule)"
      tags:
        - stig
        - SV-230462r1017254_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/sudo\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ priv_cmd$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230463r1017255_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the usermod command in RHEL 8 must generate an - (SV-230463r1017255_rule)"
      tags:
        - stig
        - SV-230463r1017255_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/usermod -F perm=x -F auid>=1000 -F auid!=unset -k privileged-usermod'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/usermod\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-usermod$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230464r1017256_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the chacl command in RHEL 8 must generate an - (SV-230464r1017256_rule)"
      tags:
        - stig
        - SV-230464r1017256_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/chacl -F perm=x -F auid>=1000 -F auid!=unset -k perm_mod'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/chacl\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ perm_mod$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230465r1017257_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the kmod command in RHEL 8 must generate an - (SV-230465r1017257_rule)"
      tags:
        - stig
        - SV-230465r1017257_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/kmod -F perm=x -F auid>=1000 -F auid!=unset -k modules'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/kmod\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ modules$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230466r1017258_rule | Automation: manual-only (not covered by scap)
    - name: "Successful/unsuccessful modifications to the faillock log file in RHEL 8 must - (SV-230466r1017258_rule)"
      tags:
        - stig
        - SV-230466r1017258_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230466r1017258_rule: Successful/unsuccessful modifications to the faillock log file in RHEL 8 must - Configure the audit system to generate an audit event for any successful/unsuccessful modifications to the "faillock" file by adding or updating the following rules in the "/etc/audit/rules.d/audit.ru... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230467r1017259_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful modifications to the lastlog file in RHEL 8 must - (SV-230467r1017259_rule)"
      tags:
        - stig
        - SV-230467r1017259_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /var/log/lastlog -p wa -k logins'
        regexp: '^\-w\ /var/log/lastlog\ \-p\ wa\ \-k\ logins$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-230468r1017260_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must enable auditing of processes that start prior to the audit daemon - (SV-230468r1017260_rule)"
      tags:
        - stig
        - SV-230468r1017260_rule
        - grub_kernel_args
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230468r1017260_rule: RHEL 8 must enable auditing of processes that start prior to the audit daemon - Configure RHEL 8 to audit processes that start prior to the audit daemon with the following command:  $ sudo grubby --update-kernel=ALL --args="audit=1"  Add or modify the following line in "/etc/defa... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230469r958752_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must allocate an audit_backlog_limit of sufficient size to capture - (SV-230469r958752_rule)"
      tags:
        - stig
        - SV-230469r958752_rule
        - grub_kernel_args
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230469r958752_rule: RHEL 8 must allocate an audit_backlog_limit of sufficient size to capture - Configure RHEL 8 to allocate sufficient audit_backlog_limit to capture processes that start prior to the audit daemon with the following command:  $ sudo grubby --update-kernel=ALL --args="audit_backl... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230470r1017261_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must enable Linux audit logging for the USBGuard daemon - (SV-230470r1017261_rule)"
      tags:
        - stig
        - SV-230470r1017261_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230470r1017261_rule: RHEL 8 must enable Linux audit logging for the USBGuard daemon - Configure RHEL 8 to enable Linux audit logging of the USBGuard daemon by adding or modifying the following line in "/etc/usbguard/usbguard-daemon.conf":  AuditBackend=LinuxAudit Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230471r1069296_rule | Automation: automated via SCAP
    - name: "RHEL 8 must allow only the Information System Security Manager (ISSM) (or - (SV-230471r1069296_rule)"
      tags:
        - stig
        - SV-230471r1069296_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /etc/audit/rules.d/
        mode: '0640'
        state: directory


    # STIG ID: SV-230472r1017263_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 audit tools must have a mode of 0755 or less permissive - (SV-230472r1017263_rule)"
      tags:
        - stig
        - SV-230472r1017263_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230472r1017263_rule: RHEL 8 audit tools must have a mode of 0755 or less permissive - Configure the audit tools to be protected from unauthorized access by setting the correct permissive mode using the following command:  $ sudo chmod 0755 [audit_tool]  Replace "[audit_tool]" with the ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230473r1017264_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 audit tools must be owned by root - (SV-230473r1017264_rule)"
      tags:
        - stig
        - SV-230473r1017264_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230473r1017264_rule: RHEL 8 audit tools must be owned by root - Configure the audit tools to be owned by "root", by running the following command:  $ sudo chown root [audit_tool]  Replace "[audit_tool]" with each audit tool not owned by "root". Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230474r1017265_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 audit tools must be group-owned by root - (SV-230474r1017265_rule)"
      tags:
        - stig
        - SV-230474r1017265_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230474r1017265_rule: RHEL 8 audit tools must be group-owned by root - Configure the audit tools to be group-owned by "root", by running the following command:  $ sudo chgrp root [audit_tool]  Replace "[audit_tool]" with each audit tool not group-owned by "root". Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230475r1017266_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must use cryptographic mechanisms to protect the integrity of audit tools - (SV-230475r1017266_rule)"
      tags:
        - stig
        - SV-230475r1017266_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230475r1017266_rule: RHEL 8 must use cryptographic mechanisms to protect the integrity of audit tools - Add or update the following lines to "/etc/aide.conf", to protect the integrity of the audit tools.  # Audit Tools /usr/sbin/auditctl p+i+n+u+g+s+b+acl+xattrs+sha512 /usr/sbin/auditd p+i+n+u+g+s+b+acl... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230476r958752_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must allocate audit record storage capacity to store at least one week - (SV-230476r958752_rule)"
      tags:
        - stig
        - SV-230476r958752_rule
        - package_absent
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230476r958752_rule: RHEL 8 must allocate audit record storage capacity to store at least one week - Allocate enough storage capacity for at least one week of audit records when audit records are not immediately sent to a central audit record storage facility.  If audit records are stored on a partit... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230477r1017267_rule | Automation: automated via SCAP
    - name: "RHEL 8 must have the packages required for offloading audit logs installed - (SV-230477r1017267_rule)"
      tags:
        - stig
        - SV-230477r1017267_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: rsyslog
        state: absent


    # STIG ID: SV-230478r1017268_rule | Automation: automated via SCAP
    - name: "RHEL 8 must have the packages required for encrypting offloaded audit logs - (SV-230478r1017268_rule)"
      tags:
        - stig
        - SV-230478r1017268_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: rsyslog-gnutls
        state: absent


    # STIG ID: SV-230479r958754_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 audit records must be off-loaded onto a different system or storage - (SV-230479r958754_rule)"
      tags:
        - stig
        - SV-230479r958754_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230479r958754_rule: The RHEL 8 audit records must be off-loaded onto a different system or storage - Configure the operating system to offload audit records onto a different system or media from the system being audited by specifying the remote logging server in "/etc/rsyslog.conf" or "/etc/rsyslog.d... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230480r958754_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must take appropriate action when the internal event queue is full - (SV-230480r958754_rule)"
      tags:
        - stig
        - SV-230480r958754_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230480r958754_rule: RHEL 8 must take appropriate action when the internal event queue is full - Edit the /etc/audit/auditd.conf file and add or update the "overflow_action" option:  overflow_action = syslog  The audit daemon must be restarted for changes to take effect. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230481r958754_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must encrypt the transfer of audit records off-loaded onto a different - (SV-230481r958754_rule)"
      tags:
        - stig
        - SV-230481r958754_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230481r958754_rule: RHEL 8 must encrypt the transfer of audit records off-loaded onto a different - Configure the operating system to encrypt off-loaded audit records by setting the following options in "/etc/rsyslog.conf" or "/etc/rsyslog.d/[customfile].conf":  $DefaultNetstreamDriver gtls $ActionS... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230482r1069330_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must authenticate the remote logging server for off-loading audit logs - (SV-230482r1069330_rule)"
      tags:
        - stig
        - SV-230482r1069330_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230482r1069330_rule: RHEL 8 must authenticate the remote logging server for off-loading audit logs - Configure the operating system to authenticate the remote logging server for off-loading audit logs by setting the following option in "/etc/rsyslog.conf" or "/etc/rsyslog.d/[customfile].conf":  $Acti... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230483r971542_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must take action when allocated audit record storage volume reaches 75 - (SV-230483r971542_rule)"
      tags:
        - stig
        - SV-230483r971542_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230483r971542_rule: RHEL 8 must take action when allocated audit record storage volume reaches 75 - Configure the operating system to initiate an action to notify the SA and ISSO (at a minimum) when allocated audit record storage volume reaches 75 percent of the repository maximum audit record stora... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230484r1038944_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must securely compare internal information system clocks at least every - (SV-230484r1038944_rule)"
      tags:
        - stig
        - SV-230484r1038944_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230484r1038944_rule: RHEL 8 must securely compare internal information system clocks at least every - Configure the operating system to securely compare internal information system clocks at least every 24 hours with an NTP server by adding/modifying the following line in the /etc/chrony.conf file.  s... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230485r1017269_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must disable the chrony daemon from acting as a server - (SV-230485r1017269_rule)"
      tags:
        - stig
        - SV-230485r1017269_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230485r1017269_rule: RHEL 8 must disable the chrony daemon from acting as a server - Configure the operating system to disable the chrony daemon from acting as a server by adding or modifying the following line in the "/etc/chrony.conf" file:  port 0 Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230486r1017270_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must disable network management of the chrony daemon - (SV-230486r1017270_rule)"
      tags:
        - stig
        - SV-230486r1017270_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230486r1017270_rule: RHEL 8 must disable network management of the chrony daemon - Configure the operating system disable network management of the chrony daemon by adding or modifying the following line in the "/etc/chrony.conf" file.  cmdport 0 Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230487r1017271_rule | Automation: automated via SCAP
    - name: "RHEL 8 must not have the telnet-server package installed - (SV-230487r1017271_rule)"
      tags:
        - stig
        - SV-230487r1017271_rule
        - package_absent
        - severity_high
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: telnet-server
        state: absent


    # STIG ID: SV-230488r1017272_rule | Automation: automated via SCAP
    - name: "RHEL 8 must not have any automated bug reporting tools installed - (SV-230488r1017272_rule)"
      tags:
        - stig
        - SV-230488r1017272_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: abrt
        state: absent


    # STIG ID: SV-230489r1017273_rule | Automation: automated via SCAP
    - name: "RHEL 8 must not have the sendmail package installed - (SV-230489r1017273_rule)"
      tags:
        - stig
        - SV-230489r1017273_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: sendmail
        state: absent


    # STIG ID: SV-230491r1017274_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must enable mitigations against processor-based vulnerabilities - (SV-230491r1017274_rule)"
      tags:
        - stig
        - SV-230491r1017274_rule
        - grub_kernel_args
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230491r1017274_rule: RHEL 8 must enable mitigations against processor-based vulnerabilities - Configure RHEL 8 to enable kernel page-table isolation with the following command:  $ sudo grubby --update-kernel=ALL --args="pti=on"  Add or modify the following line in "/etc/default/grub" to ensure... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230492r1134888_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must not install packages from the Extra Packages for Enterprise Linux - (SV-230492r1134888_rule)"
      tags:
        - stig
        - SV-230492r1134888_rule
        - package_absent
        - severity_high
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230492r1134888_rule: RHEL 8 must not install packages from the Extra Packages for Enterprise Linux - The repo package can be manually removed with the following command:  $ sudo dnf remove epel-release  Configure the operating system to disable use of the EPEL repository with the following command:  ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230493r1017276_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must cover or disable the built-in or attached camera when not in use - (SV-230493r1017276_rule)"
      tags:
        - stig
        - SV-230493r1017276_rule
        - package_present
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230493r1017276_rule: RHEL 8 must cover or disable the built-in or attached camera when not in use - Configure the operating system to disable the built-in or attached camera when not in use.  Build or modify the "/etc/modprobe.d/blacklist.conf" file by using the following example:       install uvcv... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230494r1069310_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must disable the asynchronous transfer mode (ATM) protocol - (SV-230494r1069310_rule)"
      tags:
        - stig
        - SV-230494r1069310_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230494r1069310_rule: RHEL 8 must disable the asynchronous transfer mode (ATM) protocol - Configure the operating system to disable the ability to use the ATM protocol kernel module.  Add or update the following lines in the file "/etc/modprobe.d/blacklist.conf":       install atm /bin/fal... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230495r1069311_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must disable the controller area network (CAN) protocol - (SV-230495r1069311_rule)"
      tags:
        - stig
        - SV-230495r1069311_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230495r1069311_rule: RHEL 8 must disable the controller area network (CAN) protocol - Configure the operating system to disable the ability to use the CAN protocol kernel module.  Add or update the following lines in the file "/etc/modprobe.d/blacklist.conf":       install can /bin/fal... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230496r1069312_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must disable the stream control transmission protocol (SCTP) - (SV-230496r1069312_rule)"
      tags:
        - stig
        - SV-230496r1069312_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230496r1069312_rule: RHEL 8 must disable the stream control transmission protocol (SCTP) - Configure the operating system to disable the ability to use the SCTP kernel module.  Add or update the following lines in the file "/etc/modprobe.d/blacklist.conf":       install sctp /bin/false     ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230497r1069313_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must disable the transparent inter-process communication (TIPC) protocol - (SV-230497r1069313_rule)"
      tags:
        - stig
        - SV-230497r1069313_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230497r1069313_rule: RHEL 8 must disable the transparent inter-process communication (TIPC) protocol - Configure the operating system to disable the ability to use the TIPC protocol kernel module.  Add or update the following lines in the file "/etc/modprobe.d/blacklist.conf":       install tipc /bin/f... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230498r1069314_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must disable mounting of cramfs - (SV-230498r1069314_rule)"
      tags:
        - stig
        - SV-230498r1069314_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230498r1069314_rule: RHEL 8 must disable mounting of cramfs - Configure the operating system to disable the ability to use the cramfs kernel module.  Add or update the following lines in the file "/etc/modprobe.d/blacklist.conf":       install cramfs /bin/false ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230499r1069315_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must disable IEEE 1394 (FireWire) Support - (SV-230499r1069315_rule)"
      tags:
        - stig
        - SV-230499r1069315_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230499r1069315_rule: RHEL 8 must disable IEEE 1394 (FireWire) Support - Configure the operating system to disable the ability to use the firewire-core kernel module.  Add or update the following lines in the file "/etc/modprobe.d/blacklist.conf":       install firewire-co... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230500r1101900_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must be configured to prohibit or restrict the use of functions, ports, - (SV-230500r1101900_rule)"
      tags:
        - stig
        - SV-230500r1101900_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230500r1101900_rule: RHEL 8 must be configured to prohibit or restrict the use of functions, ports, - Update the host's firewall settings and/or running services to comply with the PPSM Component Local Service Assessment (CLSA) for the site or program and the PPSM CAL. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230502r1017284_rule | Automation: automated via SCAP
    - name: "Ensure autofs.service is stop - (SV-230502r1017284_rule)"
      tags:
        - stig
        - SV-230502r1017284_rule
        - service_disabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: autofs.service
        state: stopped


    # STIG ID: SV-230503r1069316_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must be configured to disable USB mass storage - (SV-230503r1069316_rule)"
      tags:
        - stig
        - SV-230503r1069316_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230503r1069316_rule: RHEL 8 must be configured to disable USB mass storage - Configure the operating system to disable the ability to use the USB Storage kernel module and the ability to use USB mass storage devices.  Add or update the following lines in the file "/etc/modprob... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230504r958672_rule | Automation: manual-only (not covered by scap)
    - name: "A RHEL 8 firewall must employ a deny-all, allow-by-exception policy for - (SV-230504r958672_rule)"
      tags:
        - stig
        - SV-230504r958672_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230504r958672_rule: A RHEL 8 firewall must employ a deny-all, allow-by-exception policy for - Configure the "firewalld" daemon to employ a deny-all, allow-by-exception with the following commands:       $ sudo firewall-cmd --permanent --new-zone=[custom]       $ sudo cp /usr/lib/firewalld/zone... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230505r958672_rule | Automation: automated via SCAP
    - name: "A firewall must be installed on RHEL 8 - (SV-230505r958672_rule)"
      tags:
        - stig
        - SV-230505r958672_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: firewalld.noarch
        state: absent


    # STIG ID: SV-230506r1017286_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 wireless network adapters must be disabled - (SV-230506r1017286_rule)"
      tags:
        - stig
        - SV-230506r1017286_rule
        - package_absent
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230506r1017286_rule: RHEL 8 wireless network adapters must be disabled - Configure the system to disable all wireless network interfaces with the following command:  $ sudo nmcli radio all off Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230507r1017287_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 Bluetooth must be disabled - (SV-230507r1017287_rule)"
      tags:
        - stig
        - SV-230507r1017287_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230507r1017287_rule: RHEL 8 Bluetooth must be disabled - Configure the operating system to disable the Bluetooth adapter when not in use.  Build or modify the "/etc/modprobe.d/bluetooth.conf" file with the following line:       install bluetooth /bin/false ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230508r958804_rule | Automation: automated via SCAP
    - name: "RHEL 8 must mount /dev/shm with the nodev option - (SV-230508r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/dev/shm\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must mount /dev/shm with the nodev option - (SV-230508r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230508r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /dev/shm
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-230509r958804_rule | Automation: automated via SCAP
    - name: "RHEL 8 must mount /dev/shm with the nosuid option - (SV-230509r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/dev/shm\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must mount /dev/shm with the nosuid option - (SV-230509r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230509r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /dev/shm
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-230510r958804_rule | Automation: automated via SCAP
    - name: "RHEL 8 must mount /dev/shm with the noexec option - (SV-230510r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/dev/shm\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must mount /dev/shm with the noexec option - (SV-230510r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230510r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /dev/shm
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-230511r958804_rule | Automation: automated via SCAP
    - name: "RHEL 8 must mount /tmp with the nodev option - (SV-230511r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/tmp\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must mount /tmp with the nodev option - (SV-230511r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230511r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /tmp
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-230512r958804_rule | Automation: automated via SCAP
    - name: "RHEL 8 must mount /tmp with the nosuid option - (SV-230512r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/tmp\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must mount /tmp with the nosuid option - (SV-230512r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230512r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /tmp
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-230513r958804_rule | Automation: automated via SCAP
    - name: "RHEL 8 must mount /tmp with the noexec option - (SV-230513r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/tmp\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must mount /tmp with the noexec option - (SV-230513r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230513r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /tmp
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-230514r958804_rule | Automation: automated via SCAP
    - name: "RHEL 8 must mount /var/log with the nodev option - (SV-230514r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/log\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must mount /var/log with the nodev option - (SV-230514r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230514r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /var/log
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-230515r958804_rule | Automation: automated via SCAP
    - name: "RHEL 8 must mount /var/log with the nosuid option - (SV-230515r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/log\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must mount /var/log with the nosuid option - (SV-230515r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230515r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /var/log
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-230516r958804_rule | Automation: automated via SCAP
    - name: "RHEL 8 must mount /var/log with the noexec option - (SV-230516r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/log\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must mount /var/log with the noexec option - (SV-230516r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230516r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /var/log
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-230517r958804_rule | Automation: automated via SCAP
    - name: "RHEL 8 must mount /var/log/audit with the nodev option - (SV-230517r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/log/audit\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must mount /var/log/audit with the nodev option - (SV-230517r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230517r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /var/log/audit
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-230518r958804_rule | Automation: automated via SCAP
    - name: "RHEL 8 must mount /var/log/audit with the nosuid option - (SV-230518r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/log/audit\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must mount /var/log/audit with the nosuid option - (SV-230518r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230518r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /var/log/audit
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-230519r958804_rule | Automation: automated via SCAP
    - name: "RHEL 8 must mount /var/log/audit with the noexec option - (SV-230519r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/log/audit\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must mount /var/log/audit with the noexec option - (SV-230519r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230519r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /var/log/audit
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-230520r958804_rule | Automation: automated via SCAP
    - name: "RHEL 8 must mount /var/tmp with the nodev option - (SV-230520r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/tmp\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must mount /var/tmp with the nodev option - (SV-230520r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230520r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /var/tmp
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-230521r958804_rule | Automation: automated via SCAP
    - name: "RHEL 8 must mount /var/tmp with the nosuid option - (SV-230521r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/tmp\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must mount /var/tmp with the nosuid option - (SV-230521r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230521r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /var/tmp
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-230522r958804_rule | Automation: automated via SCAP
    - name: "RHEL 8 must mount /var/tmp with the noexec option - (SV-230522r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/tmp\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must mount /var/tmp with the noexec option - (SV-230522r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-230522r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /var/tmp
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-230523r958804_rule | Automation: automated via SCAP
    - name: "The RHEL 8 fapolicy module must be installed - (SV-230523r958804_rule)"
      tags:
        - stig
        - SV-230523r958804_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: fapolicyd.x86_64
        state: absent


    # STIG ID: SV-230524r1014813_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must block unauthorized peripherals before establishing a connection - (SV-230524r1014813_rule)"
      tags:
        - stig
        - SV-230524r1014813_rule
        - package_absent
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230524r1014813_rule: RHEL 8 must block unauthorized peripherals before establishing a connection - Configure the operating system to enable the blocking of unauthorized peripherals with the following command: This command must be run from a root shell and will create an allow list for any usb devic... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230525r958902_rule | Automation: manual-only (not covered by scap)
    - name: "A firewall must be able to protect against or limit the effects of Denial of - (SV-230525r958902_rule)"
      tags:
        - stig
        - SV-230525r958902_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230525r958902_rule: A firewall must be able to protect against or limit the effects of Denial of - Configure "nftables" to be the default "firewallbackend" for "firewalld" by adding or editing the following line in "/etc/firewalld/firewalld.conf":  FirewallBackend=nftables  Establish rate-limiting ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230526r958908_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 8 networked systems must have and implement SSH to protect the - (SV-230526r958908_rule)"
      tags:
        - stig
        - SV-230526r958908_rule
        - ssh_config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230526r958908_rule: All RHEL 8 networked systems must have and implement SSH to protect the - Configure the SSH service to automatically start after reboot with the following command:  $ sudo systemctl enable sshd.service Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230527r1017288_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must force a frequent session key renegotiation for SSH connections to - (SV-230527r1017288_rule)"
      tags:
        - stig
        - SV-230527r1017288_rule
        - ssh_config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230527r1017288_rule: RHEL 8 must force a frequent session key renegotiation for SSH connections to - Configure the system to force a frequent session key renegotiation for SSH connections to the server by add or modifying the following line in the "/etc/ssh/sshd_config" file:  RekeyLimit 1G 1h  Resta... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230529r1017289_rule | Automation: automated via SCAP
    - name: "Ensure ctrl-alt-del.target is disable - (SV-230529r1017289_rule)"
      tags:
        - stig
        - SV-230529r1017289_rule
        - service_disabled
        - severity_high
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: ctrl-alt-del.target
        enabled: no
        state: stopped


    # STIG ID: SV-230530r1069317_rule | Automation: manual-only (not covered by scap)
    - name: "The x86 Ctrl-Alt-Delete key sequence in RHEL 8 must be disabled if a graphical - (SV-230530r1069317_rule)"
      tags:
        - stig
        - SV-230530r1069317_rule
        - dconf
        - severity_high
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230530r1069317_rule: The x86 Ctrl-Alt-Delete key sequence in RHEL 8 must be disabled if a graphical - Configure the system to disable the Ctrl-Alt-Delete sequence when using a graphical user interface by creating or editing the /etc/dconf/db/local.d/00-disable-CAD file.  Add the setting to disable the... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230531r1134890_rule | Automation: manual-only (not covered by scap)
    - name: "The systemd Ctrl-Alt-Delete burst key sequence in RHEL 8 must be disabled - (SV-230531r1134890_rule)"
      tags:
        - stig
        - SV-230531r1134890_rule
        - config
        - severity_high
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230531r1134890_rule: The systemd Ctrl-Alt-Delete burst key sequence in RHEL 8 must be disabled - Configure the system to disable the CtrlAltDelBurstAction by added or modifying the following line in the "/etc/systemd/system.conf" configuration file:  CtrlAltDelBurstAction=none  Reload the daemon ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230532r1017294_rule | Automation: automated via SCAP
    - name: "Ensure debug-shell.service is masked - (SV-230532r1017294_rule)"
      tags:
        - stig
        - SV-230532r1017294_rule
        - service_disabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: debug-shell.service
        masked: yes
        state: stopped


    # STIG ID: SV-230533r1017295_rule | Automation: automated via SCAP
    - name: "The Trivial File Transfer Protocol (TFTP) server package must not be installed - (SV-230533r1017295_rule)"
      tags:
        - stig
        - SV-230533r1017295_rule
        - package_absent
        - severity_high
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: tftp-server
        state: absent


    # STIG ID: SV-230534r1017296_rule | Automation: manual-only (not covered by scap)
    - name: "The root account must be the only account having unrestricted access to the - (SV-230534r1017296_rule)"
      tags:
        - stig
        - SV-230534r1017296_rule
        - config
        - severity_high
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230534r1017296_rule: The root account must be the only account having unrestricted access to the - Change the UID of any account on the system, other than root, that has a UID of "0".   If the account is associated with system commands or applications, the UID should be changed to one greater than ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230535r1017297_rule | Automation: automated via SCAP
    - name: "RHEL 8 must prevent IPv6 Internet Control Message Protocol (ICMP) redirect - (SV-230535r1017297_rule)"
      tags:
        - stig
        - SV-230535r1017297_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: net.ipv6.conf.default.accept_redirects
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230536r1017298_rule | Automation: automated via SCAP
    - name: "RHEL 8 must not send Internet Control Message Protocol (ICMP) redirects - (SV-230536r1017298_rule)"
      tags:
        - stig
        - SV-230536r1017298_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: net.ipv4.conf.all.send_redirects
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230537r1017299_rule | Automation: automated via SCAP
    - name: "RHEL 8 must not respond to Internet Control Message Protocol (ICMP) echoes sent - (SV-230537r1017299_rule)"
      tags:
        - stig
        - SV-230537r1017299_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: net.ipv4.icmp_echo_ignore_broadcasts
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230538r1017300_rule | Automation: automated via SCAP
    - name: "RHEL 8 must not forward IPv6 source-routed packets - (SV-230538r1017300_rule)"
      tags:
        - stig
        - SV-230538r1017300_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: net.ipv6.conf.all.accept_source_route
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230539r1017301_rule | Automation: automated via SCAP
    - name: "RHEL 8 must not forward IPv6 source-routed packets by default - (SV-230539r1017301_rule)"
      tags:
        - stig
        - SV-230539r1017301_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: net.ipv6.conf.default.accept_source_route
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230540r1017302_rule | Automation: automated via SCAP
    - name: "RHEL 8 must not enable IPv6 packet forwarding unless the system is a router - (SV-230540r1017302_rule)"
      tags:
        - stig
        - SV-230540r1017302_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: net.ipv6.conf.all.forwarding
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230541r1017303_rule | Automation: automated via SCAP
    - name: "RHEL 8 must not accept router advertisements on all IPv6 interfaces - (SV-230541r1017303_rule)"
      tags:
        - stig
        - SV-230541r1017303_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: net.ipv6.conf.all.accept_ra
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230542r1017304_rule | Automation: automated via SCAP
    - name: "RHEL 8 must not accept router advertisements on all IPv6 interfaces by default - (SV-230542r1017304_rule)"
      tags:
        - stig
        - SV-230542r1017304_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: net.ipv6.conf.default.accept_ra
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230543r1017305_rule | Automation: automated via SCAP
    - name: "RHEL 8 must not allow interfaces to perform Internet Control Message Protocol - (SV-230543r1017305_rule)"
      tags:
        - stig
        - SV-230543r1017305_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: net.ipv4.conf.default.send_redirects
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230544r1017306_rule | Automation: automated via SCAP
    - name: "RHEL 8 must ignore IPv6 Internet Control Message Protocol (ICMP) redirect - (SV-230544r1017306_rule)"
      tags:
        - stig
        - SV-230544r1017306_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: net.ipv6.conf.all.accept_redirects
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230545r1017307_rule | Automation: automated via SCAP
    - name: "RHEL 8 must disable access to network bpf syscall from unprivileged processes - (SV-230545r1017307_rule)"
      tags:
        - stig
        - SV-230545r1017307_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: kernel.unprivileged_bpf_disabled
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230546r1017308_rule | Automation: automated via SCAP
    - name: "RHEL 8 must restrict usage of ptrace to descendant  processes - (SV-230546r1017308_rule)"
      tags:
        - stig
        - SV-230546r1017308_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: kernel.yama.ptrace_scope
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230547r1017309_rule | Automation: automated via SCAP
    - name: "RHEL 8 must restrict exposed kernel pointer addresses access - (SV-230547r1017309_rule)"
      tags:
        - stig
        - SV-230547r1017309_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: kernel.kptr_restrict
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230548r1017310_rule | Automation: automated via SCAP
    - name: "RHEL 8 must disable the use of user namespaces - (SV-230548r1017310_rule)"
      tags:
        - stig
        - SV-230548r1017310_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: user.max_user_namespaces
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230549r1017311_rule | Automation: automated via SCAP
    - name: "RHEL 8 must use reverse path filtering on all IPv4 interfaces - (SV-230549r1017311_rule)"
      tags:
        - stig
        - SV-230549r1017311_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: net.ipv4.conf.all.rp_filter
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-230550r1017312_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must be configured to prevent unrestricted mail relaying - (SV-230550r1017312_rule)"
      tags:
        - stig
        - SV-230550r1017312_rule
        - package_absent
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230550r1017312_rule: RHEL 8 must be configured to prevent unrestricted mail relaying - If "postfix" is installed, modify the "/etc/postfix/main.cf" file to restrict client connections to the local network with the following command:  $ sudo postconf -e 'smtpd_client_restrictions = permi... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230551r1017313_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 file integrity tool must be configured to verify extended attributes - (SV-230551r1017313_rule)"
      tags:
        - stig
        - SV-230551r1017313_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230551r1017313_rule: The RHEL 8 file integrity tool must be configured to verify extended attributes - Configure the file integrity tool to check file and directory extended attributes.   If AIDE is installed, ensure the "xattrs" rule is present on all uncommented file and directory selection lists. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230552r1101902_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 file integrity tool must be configured to verify Access Control - (SV-230552r1101902_rule)"
      tags:
        - stig
        - SV-230552r1101902_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230552r1101902_rule: The RHEL 8 file integrity tool must be configured to verify Access Control - Configure the file integrity tool to check file and directory ACLs.   If AIDE is installed, ensure the "acl" rule is present on all file and directory selection lists. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230553r1017315_rule | Automation: automated via SCAP
    - name: "The graphical display manager must not be installed on RHEL 8 unless approved - (SV-230553r1017315_rule)"
      tags:
        - stig
        - SV-230553r1017315_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: xorg-x11-server-Xorg
        state: absent


    # STIG ID: SV-230554r1017316_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 network interfaces must not be in promiscuous mode - (SV-230554r1017316_rule)"
      tags:
        - stig
        - SV-230554r1017316_rule
        - other
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230554r1017316_rule: RHEL 8 network interfaces must not be in promiscuous mode - Configure network interfaces to turn off promiscuous mode unless approved by the ISSO and documented.  Set the promiscuous mode of an interface to off with the following command:  $ sudo ip link set d... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230555r1017317_rule | Automation: automated via SCAP
    - name: "RHEL 8 remote X connections for interactive users must be disabled unless to - (SV-230555r1017317_rule)"
      tags:
        - stig
        - SV-230555r1017317_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*X11Forwarding\s+'
        line: 'X11Forwarding no'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-230556r1017318_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 SSH daemon must prevent remote hosts from connecting to the proxy - (SV-230556r1017318_rule)"
      tags:
        - stig
        - SV-230556r1017318_rule
        - ssh_config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-230556r1017318_rule: The RHEL 8 SSH daemon must prevent remote hosts from connecting to the proxy - Configure the SSH daemon to prevent remote hosts from connecting to the proxy display.  Edit the "/etc/ssh/sshd_config" file to uncomment or add the line for the "X11UseLocalhost" keyword and set its ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-230557r1088855_rule | Automation: automated via SCAP
    - name: "Ensure tftp.service is restart - (SV-230557r1088855_rule)"
      tags:
        - stig
        - SV-230557r1088855_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: tftp.service
        state: restarted


    # STIG ID: SV-230558r1017320_rule | Automation: automated via SCAP
    - name: "A File Transfer Protocol (FTP) server package must not be installed unless - (SV-230558r1017320_rule)"
      tags:
        - stig
        - SV-230558r1017320_rule
        - package_absent
        - severity_high
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: vsftpd
        state: absent


    # STIG ID: SV-230559r1014820_rule | Automation: automated via SCAP
    - name: "The gssproxy package must not be installed unless mission essential on RHEL 8 - (SV-230559r1014820_rule)"
      tags:
        - stig
        - SV-230559r1014820_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: gssproxy
        state: absent


    # STIG ID: SV-230560r1017321_rule | Automation: automated via SCAP
    - name: "The iprutils package must not be installed unless mission essential on RHEL 8 - (SV-230560r1017321_rule)"
      tags:
        - stig
        - SV-230560r1017321_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: iprutils
        state: absent


    # STIG ID: SV-230561r1017322_rule | Automation: automated via SCAP
    - name: "The tuned package must not be installed unless mission essential on RHEL 8 - (SV-230561r1017322_rule)"
      tags:
        - stig
        - SV-230561r1017322_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: tuned
        state: absent


    # STIG ID: SV-237640r1017323_rule | Automation: automated via SCAP
    - name: "The krb5-server package must not be installed on RHEL 8 - (SV-237640r1017323_rule)"
      tags:
        - stig
        - SV-237640r1017323_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: krb5-server
        state: absent


    # STIG ID: SV-237641r1101904_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must restrict privilege elevation to authorized personnel - (SV-237641r1101904_rule)"
      tags:
        - stig
        - SV-237641r1101904_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-237641r1101904_rule: RHEL 8 must restrict privilege elevation to authorized personnel - Remove the following entries from the sudoers file: ALL     ALL=(ALL) ALL ALL     ALL=(ALL:ALL) ALL Refer to STIG FixText for detailed steps.


    # STIG ID: SV-237642r991589_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must use the invoking user's password for privilege escalation when - (SV-237642r991589_rule)"
      tags:
        - stig
        - SV-237642r991589_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-237642r991589_rule: RHEL 8 must use the invoking user's password for privilege escalation when - Define the following in the Defaults section of the /etc/sudoers file or a configuration file in the /etc/sudoers.d/ directory:      Defaults !targetpw      Defaults !rootpw      Defaults !runaspw  Re... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-237643r1050789_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must require re-authentication when using the \"sudo\" command - (SV-237643r1050789_rule)"
      tags:
        - stig
        - SV-237643r1050789_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-237643r1050789_rule: RHEL 8 must require re-authentication when using the "sudo" command - Configure the "sudo" command to require re-authentication. Edit the /etc/sudoers file: $ sudo visudo  Add or modify the following line: Defaults timestamp_timeout=[value] Note: The "[value]" must be a... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-244519r1017326_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must display a banner before granting local or remote access to the - (SV-244519r1017326_rule)"
      tags:
        - stig
        - SV-244519r1017326_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-244519r1017326_rule: RHEL 8 must display a banner before granting local or remote access to the - Configure the operating system to display a banner before granting access to the system.  Note: If the system does not have a graphical user interface installed, this requirement is Not Applicable.  C... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-244521r1117265_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 operating systems booted with United Extensible Firmware Interface - (SV-244521r1117265_rule)"
      tags:
        - stig
        - SV-244521r1117265_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-244521r1117265_rule: RHEL 8 operating systems booted with United Extensible Firmware Interface - Configure the system to have a unique name for the grub superusers account.  Edit the /etc/grub.d/01_users file and add or modify the following lines:  set superusers="[someuniquestringhere]" export s... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-244522r1117265_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 operating systems booted with a BIOS must require  a unique superusers - (SV-244522r1117265_rule)"
      tags:
        - stig
        - SV-244522r1117265_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-244522r1117265_rule: RHEL 8 operating systems booted with a BIOS must require  a unique superusers - Configure the system to have a unique name for the grub superusers account.  Edit the /etc/grub.d/01_users file and add or modify the following lines:  set superusers="[someuniquestringhere]" export s... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-244523r1117265_rule | Automation: automated via SCAP
    - name: "Ensure ExecStart is enabled and running - (SV-244523r1117265_rule)"
      tags:
        - stig
        - SV-244523r1117265_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: ExecStart
        enabled: yes
        state: started


    # STIG ID: SV-244524r1017330_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 pam_unix.so module must be configured in the system-auth file to use - (SV-244524r1017330_rule)"
      tags:
        - stig
        - SV-244524r1017330_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-244524r1017330_rule: The RHEL 8 pam_unix.so module must be configured in the system-auth file to use - Configure RHEL 8 to use a FIPS 140-2 approved cryptographic hashing algorithm for system authentication.  Edit/modify the following line in the "/etc/pam.d/system-auth" file to include the sha512 opti... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-244525r1017331_rule | Automation: automated via SCAP
    - name: "RHEL 8 must be configured so that all network connections associated with SSH - (SV-244525r1017331_rule)"
      tags:
        - stig
        - SV-244525r1017331_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*ClientAliveInterval\s+'
        line: 'ClientAliveInterval 600'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-244526r1017332_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 SSH daemon must be configured to use system-wide crypto policies - (SV-244526r1017332_rule)"
      tags:
        - stig
        - SV-244526r1017332_rule
        - ssh_config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-244526r1017332_rule: The RHEL 8 SSH daemon must be configured to use system-wide crypto policies - Configure the RHEL 8 SSH daemon to use system-wide crypto policies by adding the following line to /etc/sysconfig/sshd:  # CRYPTO_POLICY=  A reboot is required for the changes to take effect. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-244527r1017333_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must have the packages required to use the hardware random number - (SV-244527r1017333_rule)"
      tags:
        - stig
        - SV-244527r1017333_rule
        - service_enabled
        - severity_low
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-244527r1017333_rule: RHEL 8 must have the packages required to use the hardware random number - Install the packages required to enabled the hardware random number generator entropy gatherer service with the following command:  $ sudo yum install rng-tools Refer to STIG FixText for detailed steps.


    # STIG ID: SV-244528r1017335_rule | Automation: automated via SCAP
    - name: "The RHEL 8 SSH daemon must not allow GSSAPI authentication, except to fulfill - (SV-244528r1017335_rule)"
      tags:
        - stig
        - SV-244528r1017335_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*GSSAPIAuthentication\s+'
        line: 'GSSAPIAuthentication no'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-244529r1017336_rule | Automation: automated via SCAP
    - name: "RHEL 8 must use a separate file system for /var/tmp - (SV-244529r1017336_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/tmp\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 8 must use a separate file system for /var/tmp - (SV-244529r1017336_rule) - Remount with correct options"
      tags:
        - stig
        - SV-244529r1017336_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.mount:
        path: /var/tmp
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-244530r1017337_rule | Automation: automated via SCAP
    - name: "RHEL 8 must prevent files with the setuid and setgid bit set from being - (SV-244530r1017337_rule)"
      tags:
        - stig
        - SV-244530r1017337_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /boot/efi
        mode: '0077'
        state: file


    # STIG ID: SV-244531r1017338_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 8 local interactive user home directory files must have mode 0750 or - (SV-244531r1017338_rule)"
      tags:
        - stig
        - SV-244531r1017338_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-244531r1017338_rule: All RHEL 8 local interactive user home directory files must have mode 0750 or - Set the mode on files and directories in the local interactive user home directory with the following command:  Note: The example will be for the user smithj, who has a home directory of "/home/smithj... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-244532r1101906_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must be configured so that all files and directories contained in local - (SV-244532r1101906_rule)"
      tags:
        - stig
        - SV-244532r1101906_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-244532r1101906_rule: RHEL 8 must be configured so that all files and directories contained in local - Change the group of a local interactive user's files and directories to a group that the interactive user is a member. To change the group owner of a local interactive user's files and directories, us... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-244533r1069318_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must configure the use of the pam_faillock.so module in the - (SV-244533r1069318_rule)"
      tags:
        - stig
        - SV-244533r1069318_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-244533r1069318_rule: RHEL 8 must configure the use of the pam_faillock.so module in the - Configure the operating system to include the use of the pam_faillock.so module in the /etc/pam.d/system-auth file.  Add/Modify the appropriate sections of the "/etc/pam.d/system-auth" file to match t... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-244534r1069319_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must configure the use of the pam_faillock.so module in the - (SV-244534r1069319_rule)"
      tags:
        - stig
        - SV-244534r1069319_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-244534r1069319_rule: RHEL 8 must configure the use of the pam_faillock.so module in the - Configure the operating system to include the use of the pam_faillock.so module in the /etc/pam.d/password-auth file.  Add/Modify the appropriate sections of the "/etc/pam.d/password-auth" file to mat... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-244535r1017342_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must initiate a session lock for graphical user interfaces when the - (SV-244535r1017342_rule)"
      tags:
        - stig
        - SV-244535r1017342_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-244535r1017342_rule: RHEL 8 must initiate a session lock for graphical user interfaces when the - Configure the operating system to initiate a session lock for graphical user interfaces when a screensaver is activated.  Create a database to contain the system-wide screensaver settings (if it does ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-244536r1017343_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must disable the user list at logon for graphical user interfaces - (SV-244536r1017343_rule)"
      tags:
        - stig
        - SV-244536r1017343_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-244536r1017343_rule: RHEL 8 must disable the user list at logon for graphical user interfaces - Configure the operating system to disable the user list at logon for graphical user interfaces.  Create a database to contain the system-wide screensaver settings (if it does not already exist) with t... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-244538r1069324_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must prevent a user from overriding the session idle-delay setting for - (SV-244538r1069324_rule)"
      tags:
        - stig
        - SV-244538r1069324_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-244538r1069324_rule: RHEL 8 must prevent a user from overriding the session idle-delay setting for - Configure the operating system to prevent a user from overriding settings for graphical user interfaces.  Create a database to contain the system-wide screensaver settings (if it does not already exis... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-244539r1069325_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must prevent a user from overriding the screensaver lock-enabled setting - (SV-244539r1069325_rule)"
      tags:
        - stig
        - SV-244539r1069325_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-244539r1069325_rule: RHEL 8 must prevent a user from overriding the screensaver lock-enabled setting - Configure the operating system to prevent a user from overriding settings for graphical user interfaces.  Create a database to contain the system-wide screensaver settings (if it does not already exis... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-244541r1017347_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must not allow blank or null passwords in the password-auth file - (SV-244541r1017347_rule)"
      tags:
        - stig
        - SV-244541r1017347_rule
        - config
        - severity_high
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-244541r1017347_rule: RHEL 8 must not allow blank or null passwords in the password-auth file - Remove any instances of the "nullok" option in the "/etc/pam.d/password-auth" file to prevent logons with empty passwords.  Note: Manual changes to the listed file may be overwritten by the "authselec... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-244542r1017348_rule | Automation: automated via SCAP
    - name: "Ensure auditd.service is enable - (SV-244542r1017348_rule)"
      tags:
        - stig
        - SV-244542r1017348_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: auditd.service
        enabled: yes


    # STIG ID: SV-244543r971542_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must notify the System Administrator (SA) and Information System - (SV-244543r971542_rule)"
      tags:
        - stig
        - SV-244543r971542_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-244543r971542_rule: RHEL 8 must notify the System Administrator (SA) and Information System - Configure the operating system to initiate an action to notify the SA and ISSO (at a minimum) when allocated audit record storage volume reaches 75 percent of the repository maximum audit record stora... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-244544r958672_rule | Automation: automated via SCAP
    - name: "Ensure firewalld.service is enable - (SV-244544r958672_rule)"
      tags:
        - stig
        - SV-244544r958672_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: firewalld.service
        enabled: yes


    # STIG ID: SV-244545r958804_rule | Automation: automated via SCAP
    - name: "Ensure fapolicyd.service is enable_and_start - (SV-244545r958804_rule)"
      tags:
        - stig
        - SV-244545r958804_rule
        - service_disabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: fapolicyd.service
        enabled: yes
        state: started


    # STIG ID: SV-244546r1017349_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 fapolicy module must be configured to employ a deny-all, - (SV-244546r1017349_rule)"
      tags:
        - stig
        - SV-244546r1017349_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-244546r1017349_rule: The RHEL 8 fapolicy module must be configured to employ a deny-all, - Configure RHEL 8 to employ a deny-all, permit-by-exception application whitelisting policy with "fapolicyd".  With the "fapolicyd" installed and enabled, configure the daemon to function in permissive... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-244547r1014811_rule | Automation: automated via SCAP
    - name: "RHEL 8 must have the USBGuard installed - (SV-244547r1014811_rule)"
      tags:
        - stig
        - SV-244547r1014811_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: usbguard.x86_64
        state: absent


    # STIG ID: SV-244548r1014815_rule | Automation: automated via SCAP
    - name: "Ensure usbguard.service is enable - (SV-244548r1014815_rule)"
      tags:
        - stig
        - SV-244548r1014815_rule
        - service_disabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: usbguard.service
        enabled: yes


    # STIG ID: SV-244549r958908_rule | Automation: automated via SCAP
    - name: "All RHEL 8 networked systems must have SSH installed - (SV-244549r958908_rule)"
      tags:
        - stig
        - SV-244549r958908_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.dnf:
        name: openssh-server.x86_64
        state: absent


    # STIG ID: SV-244550r1017350_rule | Automation: automated via SCAP
    - name: "RHEL 8 must prevent IPv4 Internet Control Message Protocol (ICMP) redirect - (SV-244550r1017350_rule)"
      tags:
        - stig
        - SV-244550r1017350_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: net.ipv4.conf.default.accept_redirects
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-244551r1017351_rule | Automation: automated via SCAP
    - name: "RHEL 8 must not forward IPv4 source-routed packets - (SV-244551r1017351_rule)"
      tags:
        - stig
        - SV-244551r1017351_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: net.ipv4.conf.all.accept_source_route
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-244552r1017352_rule | Automation: automated via SCAP
    - name: "RHEL 8 must not forward IPv4 source-routed packets by default - (SV-244552r1017352_rule)"
      tags:
        - stig
        - SV-244552r1017352_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: net.ipv4.conf.default.accept_source_route
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-244553r1017353_rule | Automation: automated via SCAP
    - name: "RHEL 8 must ignore IPv4 Internet Control Message Protocol (ICMP) redirect - (SV-244553r1017353_rule)"
      tags:
        - stig
        - SV-244553r1017353_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: net.ipv4.conf.all.accept_redirects
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-244554r1017354_rule | Automation: automated via SCAP
    - name: "RHEL 8 must enable hardening for the Berkeley Packet Filter Just-in-time - (SV-244554r1017354_rule)"
      tags:
        - stig
        - SV-244554r1017354_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.sysctl:
        name: net.core.bpf_jit_harden
        value: '2'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-250315r1017356_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 systems, versions 8.2 and above, must configure SELinux context type to - (SV-250315r1017356_rule)"
      tags:
        - stig
        - SV-250315r1017356_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-250315r1017356_rule: RHEL 8 systems, versions 8.2 and above, must configure SELinux context type to - Configure RHEL 8 to allow the use of a non-default faillock tally directory while SELinux enforces a targeted policy.  Create a non-default faillock tally directory (if it does not already exist) with... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-250316r1017357_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 systems below version 8.2 must configure SELinux context type to allow - (SV-250316r1017357_rule)"
      tags:
        - stig
        - SV-250316r1017357_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-250316r1017357_rule: RHEL 8 systems below version 8.2 must configure SELinux context type to allow - Configure RHEL 8 to allow the use of a non-default faillock tally directory while SELinux enforces a targeted policy.  Update the /etc/selinux/targeted/contexts/files/file_contexts.local with "faillog... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-250317r1017358_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must not enable IPv4 packet forwarding unless the system is a router - (SV-250317r1017358_rule)"
      tags:
        - stig
        - SV-250317r1017358_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-250317r1017358_rule: RHEL 8 must not enable IPv4 packet forwarding unless the system is a router - Configure RHEL 8 to not allow IPv4 packet forwarding, unless the system is a router.  Add or edit the following line in a system configuration file, in the "/etc/sysctl.d/" directory:  net.ipv4.conf.a... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-251706r1017359_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 operating system must not have accounts configured with blank or - (SV-251706r1017359_rule)"
      tags:
        - stig
        - SV-251706r1017359_rule
        - config
        - severity_high
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-251706r1017359_rule: The RHEL 8 operating system must not have accounts configured with blank or - Configure all accounts on the system to have a password or lock the account with the following commands:  Perform a password reset: $ sudo passwd [username] Lock an account: $ sudo passwd -l [username... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-251707r1017360_rule | Automation: automated via SCAP
    - name: "RHEL 8 library directories must have mode 755 or less permissive - (SV-251707r1017360_rule)"
      tags:
        - stig
        - SV-251707r1017360_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /usr/lib
        mode: '755'
        state: directory


    # STIG ID: SV-251708r1017362_rule | Automation: automated via SCAP
    - name: "RHEL 8 library directories must be owned by root - (SV-251708r1017362_rule)"
      tags:
        - stig
        - SV-251708r1017362_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /usr/lib
        owner: root
        state: directory


    # STIG ID: SV-251709r1017364_rule | Automation: automated via SCAP
    - name: "RHEL 8 library directories must be group-owned by root or a system account - (SV-251709r1017364_rule)"
      tags:
        - stig
        - SV-251709r1017364_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.file:
        path: /usr/lib
        group: root
        state: directory


    # STIG ID: SV-251710r958944_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 operating system must use a file integrity tool to verify correct - (SV-251710r958944_rule)"
      tags:
        - stig
        - SV-251710r958944_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-251710r958944_rule: The RHEL 8 operating system must use a file integrity tool to verify correct - Install AIDE, initialize it, and perform a manual check.  Install AIDE:      $ sudo yum install aide  Initialize it:      $ sudo /usr/sbin/aide --init  Example output:      Number of entries:      486... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-251711r1017365_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must specify the default \"include\" directory for the /etc/sudoers file - (SV-251711r1017365_rule)"
      tags:
        - stig
        - SV-251711r1017365_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-251711r1017365_rule: RHEL 8 must specify the default "include" directory for the /etc/sudoers file - Configure the /etc/sudoers file to only include the /etc/sudoers.d directory.  Edit the /etc/sudoers file with the following command:  $ sudo visudo  Add or modify the following line: #includedir /etc... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-251712r1050789_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 8 operating system must not be configured to bypass password - (SV-251712r1050789_rule)"
      tags:
        - stig
        - SV-251712r1050789_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-251712r1050789_rule: The RHEL 8 operating system must not be configured to bypass password - Configure the operating system to require users to supply a password for privilege escalation.  Check the configuration of the "/etc/ pam.d/sudo" file with the following command: $ sudo vi /etc/pam.d/... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-251713r1017366_rule | Automation: automated via SCAP
    - name: "RHEL 8 must ensure the password complexity module is enabled in the system-auth - (SV-251713r1017366_rule)"
      tags:
        - stig
        - SV-251713r1017366_rule
        - config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.blockinfile:
        path: /etc/pam.d/system-auth
        block: |
          line to the "/etc/pam.d/system-auth" file (or mod
        marker: '# {mark} ANSIBLE MANAGED BLOCK'
        create: yes
        backup: yes


    # STIG ID: SV-251716r1069329_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 systems, version 8.4 and above, must ensure the password complexity - (SV-251716r1069329_rule)"
      tags:
        - stig
        - SV-251716r1069329_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-251716r1069329_rule: RHEL 8 systems, version 8.4 and above, must ensure the password complexity - Configure RHEL 8 to limit the "pwquality" retry option to "3".  Add or update the following line in the "/etc/security/pwquality.conf" file or a file in the "/etc/security/pwquality.conf.d/" directory... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-251718r1017371_rule | Automation: automated via SCAP
    - name: "The graphical display manager must not be the default target on RHEL 8 unless - (SV-251718r1017371_rule)"
      tags:
        - stig
        - SV-251718r1017371_rule
        - config
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.shell: |
        current=$(systemctl get-default)
        if [ "$current" != "multi-user.target" ]; then
          systemctl set-default multi-user.target
          echo changed
        fi
      register: default_target_result
      changed_when: default_target_result.stdout == 'changed'


    # STIG ID: SV-254520r1069331_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must prevent nonprivileged users from executing privileged functions, - (SV-254520r1069331_rule)"
      tags:
        - stig
        - SV-254520r1069331_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-254520r1069331_rule: RHEL 8 must prevent nonprivileged users from executing privileged functions, - Configure RHEL 8 to prevent nonprivileged users from executing privileged functions, including disabling, circumventing, or altering implemented security safeguards/countermeasures.    Use the followi... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-255924r1017372_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 SSH server must be configured to use only FIPS-validated key exchange - (SV-255924r1017372_rule)"
      tags:
        - stig
        - SV-255924r1017372_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-255924r1017372_rule: RHEL 8 SSH server must be configured to use only FIPS-validated key exchange - Configure the SSH server to use only FIPS-validated key exchange algorithms by adding or modifying the following line in "/etc/crypto-policies/back-ends/opensshserver.config":  -oKexAlgorithms=ecdh-sh... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-256973r1017373_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must ensure cryptographic verification of vendor software packages - (SV-256973r1017373_rule)"
      tags:
        - stig
        - SV-256973r1017373_rule
        - package_absent
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-256973r1017373_rule: RHEL 8 must ensure cryptographic verification of vendor software packages - Install Red Hat package-signing keys on the system and verify their fingerprints match vendor values.  Insert RHEL 8 installation disc or attach RHEL 8 installation image to the system. Mount the disc... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-256974r1069321_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must be configured to allow sending email notifications of unauthorized - (SV-256974r1069321_rule)"
      tags:
        - stig
        - SV-256974r1069321_rule
        - package_absent
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-256974r1069321_rule: RHEL 8 must be configured to allow sending email notifications of unauthorized - Install the "mailx" package on the system:       $ sudo yum install mailx Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257258r1069328_rule | Automation: automated via SCAP
    - name: "Ensure systemd-logind.service is restart - (SV-257258r1069328_rule)"
      tags:
        - stig
        - SV-257258r1069328_rule
        - service_disabled
        - severity_medium
        - automation_automated
        - rhel8
      ansible.builtin.systemd:
        name: systemd-logind.service
        state: restarted


    # STIG ID: SV-268322r1017568_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must not allow blank or null passwords in the system-auth file - (SV-268322r1017568_rule)"
      tags:
        - stig
        - SV-268322r1017568_rule
        - config
        - severity_high
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-268322r1017568_rule: RHEL 8 must not allow blank or null passwords in the system-auth file - Remove any instances of the "nullok" option in the "/etc/pam.d/system-auth" file to prevent logons with empty passwords.  Note: Manual changes to the listed file may be overwritten by the "authselect"... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-272482r1069414_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 SSH client must be configured to use only Message Authentication Codes - (SV-272482r1069414_rule)"
      tags:
        - stig
        - SV-272482r1069414_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-272482r1069414_rule: RHEL 8 SSH client must be configured to use only Message Authentication Codes - Configure the RHEL 8 SSH client to use only MACs employing FIPS 140-3 approved algorithms.  For RHEL 8.4 and newer, update the "/etc/crypto-policies/back-ends/openssh.config" file with the following c... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-272483r1069415_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 SSH client must be configured to use only ciphers employing FIPS 140-3 - (SV-272483r1069415_rule)"
      tags:
        - stig
        - SV-272483r1069415_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-272483r1069415_rule: RHEL 8 SSH client must be configured to use only ciphers employing FIPS 140-3 - Configure the RHEL 8 SSH client to use only ciphers employing FIPS 140-3 approved algorithms by updating the "/etc/crypto-policies/back-ends/openssh.config" file with the following commands.  To manua... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-272484r1134875_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must elevate the SELinux context when an administrator calls the sudo - (SV-272484r1134875_rule)"
      tags:
        - stig
        - SV-272484r1134875_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-272484r1134875_rule: RHEL 8 must elevate the SELinux context when an administrator calls the sudo - Configure the operating system to elevate the SELinux context when an administrator calls the sudo command.  Edit a file in the "/etc/sudoers.d" directory with the following command:  $ sudo visudo -f... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-274877r1106148_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 8 must audit any script or executable called by cron as root or by any - (SV-274877r1106148_rule)"
      tags:
        - stig
        - SV-274877r1106148_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel8
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-274877r1106148_rule: RHEL 8 must audit any script or executable called by cron as root or by any - Configure RHEL 8 to audit the execution of any system call made by cron as root or as any privileged user.  Add or update the following file system rules to "/etc/audit/rules.d/audit.rules": auditctl ... Refer to STIG FixText for detailed steps.

