# Generated hardening playbook for rhel9
# Total Controls: 447
#   - Automated: 367 (82%)
#   - Manual-only: 80 (17%)

- name: "RHEL 9 STIG Hardening"
  hosts: all
  become: yes
  gather_facts: yes
  vars:
    # Place any tunable defaults here if needed later
  pre_tasks:
    - name: "Verify RHEL 9 OS family"
      ansible.builtin.assert:
        that:
          - ansible_facts['os_family'] == 'RedHat'
          - ansible_facts['distribution_major_version'] == '9'
        fail_msg: 'This playbook is designed for RHEL 9 only. Detected OS: { { ansible_facts[''os_family''] } } { { ansible_facts[''distribution_major_version''] } }'
        success_msg: 'OS verification passed: RHEL 9 detected'

  handlers:
    - name: "Regenerate grub configuration"
      ansible.builtin.command:
        cmd: grub2-mkconfig -o /boot/grub2/grub.cfg
      when: ansible_os_family == 'RedHat'

    - name: "Restart sshd"
      ansible.builtin.service:
        name: sshd
        state: restarted

    - name: "Reload systemd daemon"
      ansible.builtin.systemd:
        daemon_reload: yes

    - name: "Reload sysctl"
      ansible.builtin.command:
        cmd: sysctl -p
      ignore_errors: yes

    - name: "Reload firewalld"
      ansible.builtin.command:
        cmd: firewall-cmd --reload
      when: ansible_facts['os_family'] == 'RedHat'
      ignore_errors: yes

    - name: "Update dconf database"
      ansible.builtin.command:
        cmd: dconf update
      when: ansible_pkg_mgr == 'dnf' or ansible_pkg_mgr == 'yum'

  tasks:

    # STIG ID: SV-257777r991589_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must be a vendor-supported release - (SV-257777r991589_rule)"
      tags:
        - stig
        - SV-257777r991589_rule
        - config
        - severity_high
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: 'Manual hardening required for SV-257777r991589_rule: RHEL 9 must be a vendor-supported release - Upgrade to a supported version of RHEL 9. Refer to STIG FixText for detailed steps.'


    # STIG ID: SV-257778r1134892_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 vendor packaged system security patches and updates must be installed - (SV-257778r1134892_rule)"
      tags:
        - stig
        - SV-257778r1134892_rule
        - package_absent
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257778r1134892_rule: RHEL 9 vendor packaged system security patches and updates must be installed - Install RHEL 9 security patches and updates at the organizationally defined frequency. If system updates are installed via a centralized repository that is configured on the system, all updates can be... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257779r958390_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before - (SV-257779r958390_rule)"
      tags:
        - stig
        - SV-257779r958390_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257779r958390_rule: RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before - Configure RHEL 9 to display the Standard Mandatory DOD Notice and Consent Banner before granting access to the system via command line logon.  Edit the "/etc/issue" file to replace the default text wi... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257781r991589_rule | Automation: automated via SCAP
    - name: "The graphical display manager must not be the default target on RHEL 9 unless - (SV-257781r991589_rule)"
      tags:
        - stig
        - SV-257781r991589_rule
        - config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.shell: |
        current=$(systemctl get-default)
        if [ "$current" != "multi-user.target" ]; then
          systemctl set-default multi-user.target
          echo changed
        fi
      register: default_target_result
      changed_when: default_target_result.stdout == 'changed'


    # STIG ID: SV-257782r991589_rule | Automation: automated via SCAP
    - name: "Ensure rngd.service is enable_and_start - (SV-257782r991589_rule)"
      tags:
        - stig
        - SV-257782r991589_rule
        - service_enabled
        - severity_low
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: rngd.service
        enabled: yes
        state: started


    # STIG ID: SV-257783r991562_rule | Automation: automated via SCAP
    - name: "Ensure systemd-journald.service is enable_and_start - (SV-257783r991562_rule)"
      tags:
        - stig
        - SV-257783r991562_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: systemd-journald.service
        enabled: yes
        state: started


    # STIG ID: SV-257784r1044832_rule | Automation: manual-only (not covered by scap)
    - name: "The systemd Ctrl-Alt-Delete burst key sequence in RHEL 9 must be disabled - (SV-257784r1044832_rule)"
      tags:
        - stig
        - SV-257784r1044832_rule
        - config
        - severity_high
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257784r1044832_rule: The systemd Ctrl-Alt-Delete burst key sequence in RHEL 9 must be disabled - Configure the system to disable the CtrlAltDelBurstAction by added or modifying the following line in the "/etc/systemd/system.conf" configuration file:  CtrlAltDelBurstAction=none  Reload the daemon ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257785r1044833_rule | Automation: automated via SCAP
    - name: "Ensure ctrl-alt-del.target is disable - (SV-257785r1044833_rule)"
      tags:
        - stig
        - SV-257785r1044833_rule
        - service_disabled
        - severity_high
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: ctrl-alt-del.target
        enabled: no
        state: stopped


    # STIG ID: SV-257786r1044834_rule | Automation: automated via SCAP
    - name: "Ensure debug-shell.service is disable - (SV-257786r1044834_rule)"
      tags:
        - stig
        - SV-257786r1044834_rule
        - service_disabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: debug-shell.service
        enabled: no
        state: stopped


    # STIG ID: SV-257787r1117265_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must require a boot loader superuser password - (SV-257787r1117265_rule)"
      tags:
        - stig
        - SV-257787r1117265_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257787r1117265_rule: RHEL 9 must require a boot loader superuser password - Configure RHEL 9 to require a grub bootloader password for the grub superuser account.  Generate an encrypted grub2 password for the grub superuser account with the following command:  $ sudo grub2-se... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257788r1044838_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must disable the ability of systemd to spawn an interactive boot process - (SV-257788r1044838_rule)"
      tags:
        - stig
        - SV-257788r1044838_rule
        - other
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257788r1044838_rule: RHEL 9 must disable the ability of systemd to spawn an interactive boot process - Configure the current GRUB 2 configuration to disable the ability of systemd to spawn an interactive boot process with the following command:  $ sudo grubby --update-kernel=ALL --remove-args="systemd.... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257789r1134895_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must require a unique superusers name upon booting into single-user and - (SV-257789r1134895_rule)"
      tags:
        - stig
        - SV-257789r1134895_rule
        - config
        - severity_high
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257789r1134895_rule: RHEL 9 must require a unique superusers name upon booting into single-user and - Configure RHEL 9 to have a unique username for the grub superuser account.  Edit the "/etc/grub.d/01_users" file and add or modify the following lines with a nondefault username for the superuser acco... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257790r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /boot/grub2/grub.cfg file must be group-owned by root - (SV-257790r991589_rule)"
      tags:
        - stig
        - SV-257790r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /boot/grub2/grub.cfg
        group: root
        state: file


    # STIG ID: SV-257791r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /boot/grub2/grub.cfg file must be owned by root - (SV-257791r991589_rule)"
      tags:
        - stig
        - SV-257791r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /boot/grub2/grub.cfg
        owner: root
        state: file


    # STIG ID: SV-257792r1044842_rule | Automation: automated via SCAP
    - name: "RHEL 9 must disable virtual system calls - (SV-257792r1044842_rule)"
      tags:
        - stig
        - SV-257792r1044842_rule
        - grub_kernel_args
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/default/grub
        regexp: '^GRUB_CMDLINE_LINUX="(.*)"$'
        line: 'GRUB_CMDLINE_LINUX="\1 vsyscall=none"'
        backrefs: yes
        create: yes
        backup: yes
      notify: Regenerate grub configuration


    # STIG ID: SV-257793r1044843_rule | Automation: automated via SCAP
    - name: "RHEL 9 must clear the page allocator to prevent use-after-free attacks - (SV-257793r1044843_rule)"
      tags:
        - stig
        - SV-257793r1044843_rule
        - grub_kernel_args
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/default/grub
        regexp: '^GRUB_CMDLINE_LINUX="(.*)"$'
        line: 'GRUB_CMDLINE_LINUX="\1 page_poison=1"'
        backrefs: yes
        create: yes
        backup: yes
      notify: Regenerate grub configuration


    # STIG ID: SV-257794r1069362_rule | Automation: automated via SCAP
    - name: "RHEL 9 must clear memory when it is freed to prevent use-after-free attacks - (SV-257794r1069362_rule)"
      tags:
        - stig
        - SV-257794r1069362_rule
        - grub_kernel_args
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/default/grub
        regexp: '^GRUB_CMDLINE_LINUX="(.*)"$'
        line: 'GRUB_CMDLINE_LINUX="\1 init_on_free=1"'
        backrefs: yes
        create: yes
        backup: yes
      notify: Regenerate grub configuration


    # STIG ID: SV-257795r1044845_rule | Automation: automated via SCAP
    - name: "RHEL 9 must enable mitigations against processor-based vulnerabilities - (SV-257795r1044845_rule)"
      tags:
        - stig
        - SV-257795r1044845_rule
        - grub_kernel_args
        - severity_low
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/default/grub
        regexp: '^GRUB_CMDLINE_LINUX="(.*)"$'
        line: 'GRUB_CMDLINE_LINUX="\1 pti=on"'
        backrefs: yes
        create: yes
        backup: yes
      notify: Regenerate grub configuration


    # STIG ID: SV-257796r1044847_rule | Automation: automated via SCAP
    - name: "RHEL 9 must enable auditing of processes that start prior to the audit daemon - (SV-257796r1044847_rule)"
      tags:
        - stig
        - SV-257796r1044847_rule
        - grub_kernel_args
        - severity_low
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/default/grub
        regexp: '^GRUB_CMDLINE_LINUX="(.*)"$'
        line: 'GRUB_CMDLINE_LINUX="\1 audit=1"'
        backrefs: yes
        create: yes
        backup: yes
      notify: Regenerate grub configuration


    # STIG ID: SV-257797r1117266_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must restrict access to the kernel message buffer - (SV-257797r1117266_rule)"
      tags:
        - stig
        - SV-257797r1117266_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257797r1117266_rule: RHEL 9 must restrict access to the kernel message buffer - Configure RHEL 9 to restrict access to the kernel message buffer.  Add or edit the following line in a system configuration file, in the "/etc/sysctl.d/" directory:  kernel.dmesg_restrict = 1  Remove ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257798r1117266_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent kernel profiling by nonprivileged users - (SV-257798r1117266_rule)"
      tags:
        - stig
        - SV-257798r1117266_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257798r1117266_rule: RHEL 9 must prevent kernel profiling by nonprivileged users - Configure RHEL 9 to prevent kernel profiling by nonprivileged users.  Add or edit the following line in a system configuration file, in the "/etc/sysctl.d/" directory:  kernel.perf_event_paranoid = 2 ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257799r1106273_rule | Automation: automated via SCAP
    - name: "RHEL 9 must prevent the loading of a new kernel for later execution - (SV-257799r1106273_rule)"
      tags:
        - stig
        - SV-257799r1106273_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.sysctl:
        name: kernel.kexec_load_disabled
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-257800r1117266_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must restrict exposed kernel pointer addresses access - (SV-257800r1117266_rule)"
      tags:
        - stig
        - SV-257800r1117266_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257800r1117266_rule: RHEL 9 must restrict exposed kernel pointer addresses access - Configure RHEL 9 to restrict exposed kernel pointer addresses access by adding the following line to a file in the "/etc/sysctl.d" directory:  kernel.kptr_restrict = 1  Remove any configurations that ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257801r1106279_rule | Automation: automated via SCAP
    - name: "RHEL 9 must enable kernel parameters to enforce discretionary access control on - (SV-257801r1106279_rule)"
      tags:
        - stig
        - SV-257801r1106279_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.sysctl:
        name: fs.protected_hardlinks
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-257802r1106282_rule | Automation: automated via SCAP
    - name: "RHEL 9 must enable kernel parameters to enforce discretionary access control on - (SV-257802r1106282_rule)"
      tags:
        - stig
        - SV-257802r1106282_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.sysctl:
        name: fs.protected_symlinks
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-257803r1106429_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must disable the kernel.core_pattern - (SV-257803r1106429_rule)"
      tags:
        - stig
        - SV-257803r1106429_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257803r1106429_rule: RHEL 9 must disable the kernel.core_pattern - Configure RHEL 9 to disable storing core dumps.  Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:  kernel.core_pattern = |/bin/false  Remove any configu... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257804r1044853_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must be configured to disable the Asynchronous Transfer Mode kernel - (SV-257804r1044853_rule)"
      tags:
        - stig
        - SV-257804r1044853_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257804r1044853_rule: RHEL 9 must be configured to disable the Asynchronous Transfer Mode kernel - To configure the system to prevent the atm kernel module from being loaded, add the following line to the file  /etc/modprobe.d/atm.conf (or create atm.conf if it does not exist):  install atm /bin/fa... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257805r1044856_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must be configured to disable the Controller Area Network kernel module - (SV-257805r1044856_rule)"
      tags:
        - stig
        - SV-257805r1044856_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257805r1044856_rule: RHEL 9 must be configured to disable the Controller Area Network kernel module - To configure the system to prevent the can kernel module from being loaded, add the following lines to the file  /etc/modprobe.d/can.conf (or create can.conf if it does not exist):  install can /bin/f... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257806r1044859_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must be configured to disable the FireWire kernel module - (SV-257806r1044859_rule)"
      tags:
        - stig
        - SV-257806r1044859_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257806r1044859_rule: RHEL 9 must be configured to disable the FireWire kernel module - To configure the system to prevent the firewire-core kernel module from being loaded, add the following lines to the file /etc/modprobe.d/firewire-core.conf (or create firewire-core.conf if it does no... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257807r1044862_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must disable the Stream Control Transmission Protocol (SCTP) kernel - (SV-257807r1044862_rule)"
      tags:
        - stig
        - SV-257807r1044862_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257807r1044862_rule: RHEL 9 must disable the Stream Control Transmission Protocol (SCTP) kernel - To configure the system to prevent the sctp kernel module from being loaded, add the following lines to the file  /etc/modprobe.d/sctp.conf (or create sctp.conf if it does not exist):  install sctp /b... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257808r1044865_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must disable the Transparent Inter Process Communication (TIPC) kernel - (SV-257808r1044865_rule)"
      tags:
        - stig
        - SV-257808r1044865_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257808r1044865_rule: RHEL 9 must disable the Transparent Inter Process Communication (TIPC) kernel - To configure the system to prevent the tipc kernel module from being loaded, add the following lines to the file  /etc/modprobe.d/tipc.conf (or create tipc.conf if it does not exist):  install tipc /b... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257809r1106288_rule | Automation: automated via SCAP
    - name: "RHEL 9 must implement address space layout randomization (ASLR) to protect its - (SV-257809r1106288_rule)"
      tags:
        - stig
        - SV-257809r1106288_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.sysctl:
        name: kernel.randomize_va_space
        value: '2'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-257810r1117266_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must disable access to network bpf system call from nonprivileged - (SV-257810r1117266_rule)"
      tags:
        - stig
        - SV-257810r1117266_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257810r1117266_rule: RHEL 9 must disable access to network bpf system call from nonprivileged - Configure RHEL 9 to prevent privilege escalation through the kernel by disabling access to the bpf syscall by adding the following line to a file in the "/etc/sysctl.d" directory:  kernel.unprivileged... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257811r1117266_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must restrict usage of ptrace to descendant processes - (SV-257811r1117266_rule)"
      tags:
        - stig
        - SV-257811r1117266_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257811r1117266_rule: RHEL 9 must restrict usage of ptrace to descendant processes - Configure RHEL 9 to restrict usage of ptrace to descendant processes by adding the following line to a file in the "/etc/sysctl.d" directory:  kernel.yama.ptrace_scope = 1  Remove any configurations t... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257812r1134897_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must disable core dump backtraces - (SV-257812r1134897_rule)"
      tags:
        - stig
        - SV-257812r1134897_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257812r1134897_rule: RHEL 9 must disable core dump backtraces - Configure the operating system to disable core dump backtraces.  Add or modify the following line in /etc/systemd/coredump.conf:  ProcessSizeMax=0 Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257813r1134899_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must disable storing core dumps - (SV-257813r1134899_rule)"
      tags:
        - stig
        - SV-257813r1134899_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257813r1134899_rule: RHEL 9 must disable storing core dumps - Configure the operating system to disable storing core dumps for all users.  Add or modify the following line in /etc/systemd/coredump.conf:  Storage=none Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257814r1134901_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must disable core dumps for all users - (SV-257814r1134901_rule)"
      tags:
        - stig
        - SV-257814r1134901_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257814r1134901_rule: RHEL 9 must disable core dumps for all users - Configure the operating system to disable core dumps for all users.  Add the following line to the top of the /etc/security/limits.conf or in a single ".conf" file defined in /etc/security/limits.d/: ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257815r1134903_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must disable acquiring, saving, and processing core dumps - (SV-257815r1134903_rule)"
      tags:
        - stig
        - SV-257815r1134903_rule
        - service_disabled
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257815r1134903_rule: RHEL 9 must disable acquiring, saving, and processing core dumps - Configure the system to disable the systemd-coredump.socket with the following command:  $ sudo systemctl mask --now systemd-coredump.socket  Created symlink /etc/systemd/system/systemd-coredump.socke... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257816r1106435_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must disable the use of user namespaces - (SV-257816r1106435_rule)"
      tags:
        - stig
        - SV-257816r1106435_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257816r1106435_rule: RHEL 9 must disable the use of user namespaces - Configure RHEL 9 to disable the use of user namespaces by adding the following line to a file in the "/etc/sysctl.d" directory:  user.max_user_namespaces = 0  Remove any configurations that conflict w... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257817r1069383_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must implement nonexecutable data to protect its memory from - (SV-257817r1069383_rule)"
      tags:
        - stig
        - SV-257817r1069383_rule
        - mount_option
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257817r1069383_rule: RHEL 9 must implement nonexecutable data to protect its memory from - If /proc/cpuinfo shows that one or more processors do not enable ExecShield (lack the "nx" feature flag), verify that the NX/XD feature is not disabled in the BIOS or UEFI. If it is disabled, enable i... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257818r1044876_rule | Automation: automated via SCAP
    - name: "Ensure kdump.service is disable - (SV-257818r1044876_rule)"
      tags:
        - stig
        - SV-257818r1044876_rule
        - service_disabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: kdump.service
        enabled: no
        state: stopped


    # STIG ID: SV-257819r1015075_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must ensure cryptographic verification of vendor software packages - (SV-257819r1015075_rule)"
      tags:
        - stig
        - SV-257819r1015075_rule
        - package_absent
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257819r1015075_rule: RHEL 9 must ensure cryptographic verification of vendor software packages - Install Red Hat package-signing keys on the system and verify their fingerprints match vendor values.  Insert RHEL 9 installation disc or attach RHEL 9 installation image to the system. Mount the disc... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257820r1044878_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must check the GPG signature of software packages originating from - (SV-257820r1044878_rule)"
      tags:
        - stig
        - SV-257820r1044878_rule
        - package_present
        - severity_high
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257820r1044878_rule: RHEL 9 must check the GPG signature of software packages originating from - Configure dnf to always check the GPG signature of software packages originating from external software repositories before installation.  Add or update the following line in the [main] section of the... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257821r1015077_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must check the GPG signature of locally installed software packages - (SV-257821r1015077_rule)"
      tags:
        - stig
        - SV-257821r1015077_rule
        - package_present
        - severity_high
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257821r1015077_rule: RHEL 9 must check the GPG signature of locally installed software packages - Configure dnf to always check the GPG signature of local software packages before installation.  Add or update the following line in the [main] section of the /etc/dnf/dnf.conf file:  localpkg_gpgchec... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257822r1044880_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must have GPG signature verification enabled for all software - (SV-257822r1044880_rule)"
      tags:
        - stig
        - SV-257822r1044880_rule
        - package_absent
        - severity_high
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257822r1044880_rule: RHEL 9 must have GPG signature verification enabled for all software - Configure all software repositories defined in "/etc/yum.repos.d/" to have "gpgcheck" enabled:  $ sudo sed -i 's/gpgcheck\s*=.*/gpgcheck=1/g' /etc/yum.repos.d/* Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257823r1051231_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must be configured so that the cryptographic hashes of system files - (SV-257823r1051231_rule)"
      tags:
        - stig
        - SV-257823r1051231_rule
        - package_present
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257823r1051231_rule: RHEL 9 must be configured so that the cryptographic hashes of system files - Configure RHEL 9 so that the cryptographic hashes of system files match vendor values.  Given output from the check command, identify the package that provides the output and reinstall it. The followi... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257824r1044886_rule | Automation: automated via SCAP
    - name: "RHEL 9 must remove all software components after updated versions have been - (SV-257824r1044886_rule)"
      tags:
        - stig
        - SV-257824r1044886_rule
        - package_absent
        - severity_low
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: '*'
        state: latest
        update_cache: yes


    # STIG ID: SV-257825r1044888_rule | Automation: automated via SCAP
    - name: "RHEL 9 subscription-manager package must be installed - (SV-257825r1044888_rule)"
      tags:
        - stig
        - SV-257825r1044888_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: subscription-manager
        state: absent


    # STIG ID: SV-257826r1106299_rule | Automation: automated via SCAP
    - name: "RHEL 9 must not have a File Transfer Protocol (FTP) server package installed - (SV-257826r1106299_rule)"
      tags:
        - stig
        - SV-257826r1106299_rule
        - package_absent
        - severity_high
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: vsftpd
        state: absent


    # STIG ID: SV-257827r1044892_rule | Automation: automated via SCAP
    - name: "RHEL 9 must not have the sendmail package installed - (SV-257827r1044892_rule)"
      tags:
        - stig
        - SV-257827r1044892_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: sendmail
        state: absent


    # STIG ID: SV-257828r1044894_rule | Automation: automated via SCAP
    - name: "RHEL 9 must not have the nfs-utils package installed - (SV-257828r1044894_rule)"
      tags:
        - stig
        - SV-257828r1044894_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: nfs-utils
        state: absent


    # STIG ID: SV-257829r1044896_rule | Automation: automated via SCAP
    - name: "RHEL 9 must not have the ypserv package installed - (SV-257829r1044896_rule)"
      tags:
        - stig
        - SV-257829r1044896_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: ypserv
        state: absent


    # STIG ID: SV-257830r1134906_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must not install packages from the Extra Packages for Enterprise Linux - (SV-257830r1134906_rule)"
      tags:
        - stig
        - SV-257830r1134906_rule
        - package_absent
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257830r1134906_rule: RHEL 9 must not install packages from the Extra Packages for Enterprise Linux - The repo package can be manually removed with the following command:  $ sudo dnf remove epel-release  Configure the operating system to disable use of the EPEL repository with the following command:  ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257831r1044898_rule | Automation: automated via SCAP
    - name: "RHEL 9 must not have the telnet-server package installed - (SV-257831r1044898_rule)"
      tags:
        - stig
        - SV-257831r1044898_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: telnet-server
        state: absent


    # STIG ID: SV-257832r1044900_rule | Automation: automated via SCAP
    - name: "RHEL 9 must not have the gssproxy package installed - (SV-257832r1044900_rule)"
      tags:
        - stig
        - SV-257832r1044900_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: gssproxy
        state: absent


    # STIG ID: SV-257833r1044902_rule | Automation: automated via SCAP
    - name: "RHEL 9 must not have the iprutils package installed - (SV-257833r1044902_rule)"
      tags:
        - stig
        - SV-257833r1044902_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: iprutils
        state: absent


    # STIG ID: SV-257834r1044904_rule | Automation: automated via SCAP
    - name: "RHEL 9 must not have the tuned package installed - (SV-257834r1044904_rule)"
      tags:
        - stig
        - SV-257834r1044904_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: tuned
        state: absent


    # STIG ID: SV-257835r1102037_rule | Automation: automated via SCAP
    - name: "RHEL 9 must not have a Trivial File Transfer Protocol (TFTP) server package - (SV-257835r1102037_rule)"
      tags:
        - stig
        - SV-257835r1102037_rule
        - package_absent
        - severity_high
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: tftp-server
        state: absent


    # STIG ID: SV-257836r1044908_rule | Automation: automated via SCAP
    - name: "RHEL 9 must not have the quagga package installed - (SV-257836r1044908_rule)"
      tags:
        - stig
        - SV-257836r1044908_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: quagga
        state: absent


    # STIG ID: SV-257837r1044910_rule | Automation: automated via SCAP
    - name: "A graphical display manager must not be installed on RHEL 9 unless approved - (SV-257837r1044910_rule)"
      tags:
        - stig
        - SV-257837r1044910_rule
        - config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.shell: |
        current=$(systemctl get-default)
        if [ "$current" != "multi-user.target" ]; then
          systemctl set-default multi-user.target
          echo changed
        fi
      register: default_target_result
      changed_when: default_target_result.stdout == 'changed'


    # STIG ID: SV-257838r1044912_rule | Automation: automated via SCAP
    - name: "RHEL 9 must have the openssl-pkcs11 package installed - (SV-257838r1044912_rule)"
      tags:
        - stig
        - SV-257838r1044912_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: openssl-pkcs11
        state: absent


    # STIG ID: SV-257839r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 must have the gnutls-utils package installed - (SV-257839r991589_rule)"
      tags:
        - stig
        - SV-257839r991589_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: gnutls-utils
        state: absent


    # STIG ID: SV-257840r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 must have the nss-tools package installed - (SV-257840r991589_rule)"
      tags:
        - stig
        - SV-257840r991589_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: nss-tools
        state: absent


    # STIG ID: SV-257841r1044914_rule | Automation: automated via SCAP
    - name: "RHEL 9 must have the rng-tools package installed - (SV-257841r1044914_rule)"
      tags:
        - stig
        - SV-257841r1044914_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: rng-tools
        state: absent


    # STIG ID: SV-257842r1044916_rule | Automation: automated via SCAP
    - name: "RHEL 9 must have the s-nail package installed - (SV-257842r1044916_rule)"
      tags:
        - stig
        - SV-257842r1044916_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: s-nail
        state: absent


    # STIG ID: SV-257843r991589_rule | Automation: manual-only (not covered by scap)
    - name: "A separate RHEL 9 file system must be used for user home directories (such as - (SV-257843r991589_rule)"
      tags:
        - stig
        - SV-257843r991589_rule
        - mount_option
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257843r991589_rule: A separate RHEL 9 file system must be used for user home directories (such as - Migrate the "/home" directory onto a separate file system/partition. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257844r1044918_rule | Automation: automated via SCAP
    - name: "RHEL 9 must use a separate file system for /tmp - (SV-257844r1044918_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/tmp\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must use a separate file system for /tmp - (SV-257844r1044918_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257844r1044918_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /tmp
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-257845r1044920_rule | Automation: automated via SCAP
    - name: "RHEL 9 must use a separate file system for /var - (SV-257845r1044920_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,defaults\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must use a separate file system for /var - (SV-257845r1044920_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257845r1044920_rule
        - mount_option
        - severity_low
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /var
        opts: "defaults,defaults"
        state: mounted
        fstype: auto


    # STIG ID: SV-257846r1044922_rule | Automation: automated via SCAP
    - name: "RHEL 9 must use a separate file system for /var/log - (SV-257846r1044922_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/log\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must use a separate file system for /var/log - (SV-257846r1044922_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257846r1044922_rule
        - mount_option
        - severity_low
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /var/log
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-257847r1044924_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must use a separate file system for the system audit data path - (SV-257847r1044924_rule)"
      tags:
        - stig
        - SV-257847r1044924_rule
        - mount_option
        - severity_low
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257847r1044924_rule: RHEL 9 must use a separate file system for the system audit data path - Migrate the system audit data path onto a separate file system. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257848r1044926_rule | Automation: automated via SCAP
    - name: "RHEL 9 must use a separate file system for /var/tmp - (SV-257848r1044926_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/tmp\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must use a separate file system for /var/tmp - (SV-257848r1044926_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257848r1044926_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /var/tmp
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-257849r1044928_rule | Automation: automated via SCAP
    - name: "Ensure autofs.service is masked - (SV-257849r1044928_rule)"
      tags:
        - stig
        - SV-257849r1044928_rule
        - service_disabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: autofs.service
        masked: yes
        state: stopped


    # STIG ID: SV-257850r1044930_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent device files from being interpreted on file systems that - (SV-257850r1044930_rule)"
      tags:
        - stig
        - SV-257850r1044930_rule
        - mount_option
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257850r1044930_rule: RHEL 9 must prevent device files from being interpreted on file systems that - Modify "/etc/fstab" to use the "nodev" option on the "/home" directory. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257851r1044932_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent files with the setuid and setgid bit set from being - (SV-257851r1044932_rule)"
      tags:
        - stig
        - SV-257851r1044932_rule
        - mount_option
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257851r1044932_rule: RHEL 9 must prevent files with the setuid and setgid bit set from being - Modify "/etc/fstab" to use the "nosuid" option on the "/home" directory. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257852r991589_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent code from being executed on file systems that contain user - (SV-257852r991589_rule)"
      tags:
        - stig
        - SV-257852r991589_rule
        - mount_option
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257852r991589_rule: RHEL 9 must prevent code from being executed on file systems that contain user - Modify "/etc/fstab" to use the "noexec" option on the "/home" directory. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257854r1044934_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent special devices on file systems that are imported via - (SV-257854r1044934_rule)"
      tags:
        - stig
        - SV-257854r1044934_rule
        - mount_option
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257854r1044934_rule: RHEL 9 must prevent special devices on file systems that are imported via - Update each NFS mounted file system to use the "nodev" option on file systems that are being imported via NFS. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257855r1044936_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9  must prevent code from being executed on file systems that are imported - (SV-257855r1044936_rule)"
      tags:
        - stig
        - SV-257855r1044936_rule
        - mount_option
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257855r1044936_rule: RHEL 9  must prevent code from being executed on file systems that are imported - Update each NFS mounted file system to use the "noexec" option on file systems that are being imported via NFS. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257856r1044938_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent files with the setuid and setgid bit set from being - (SV-257856r1044938_rule)"
      tags:
        - stig
        - SV-257856r1044938_rule
        - mount_option
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257856r1044938_rule: RHEL 9 must prevent files with the setuid and setgid bit set from being - Update each NFS mounted file system to use the "nosuid" option on file systems that are being imported via NFS. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257857r991589_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent code from being executed on file systems that are used with - (SV-257857r991589_rule)"
      tags:
        - stig
        - SV-257857r991589_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257857r991589_rule: RHEL 9 must prevent code from being executed on file systems that are used with - Configure the "/etc/fstab" to use the "noexec" option on file systems that are associated with removable media. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257858r991589_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent special devices on file systems that are used with - (SV-257858r991589_rule)"
      tags:
        - stig
        - SV-257858r991589_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257858r991589_rule: RHEL 9 must prevent special devices on file systems that are used with - Configure the "/etc/fstab" to use the "nodev" option on file systems that are associated with removable media. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257859r991589_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent files with the setuid and setgid bit set from being - (SV-257859r991589_rule)"
      tags:
        - stig
        - SV-257859r991589_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257859r991589_rule: RHEL 9 must prevent files with the setuid and setgid bit set from being - Configure the "/etc/fstab" to use the "nosuid" option on file systems that are associated with removable media. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257860r1044940_rule | Automation: automated via SCAP
    - name: "RHEL 9 must mount /boot with the nodev option - (SV-257860r1044940_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/boot\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must mount /boot with the nodev option - (SV-257860r1044940_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257860r1044940_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /boot
        opts: "defaults,nodev"
        state: mounted
        fstype: auto


    # STIG ID: SV-257861r1044941_rule | Automation: automated via SCAP
    - name: "RHEL 9 must prevent files with the setuid and setgid bit set from being - (SV-257861r1044941_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/boot\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nosuid\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must prevent files with the setuid and setgid bit set from being - (SV-257861r1044941_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257861r1044941_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /boot
        opts: "defaults,nosuid"
        state: mounted
        fstype: auto


    # STIG ID: SV-257862r1134908_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent files with the setuid and setgid bit set from being - (SV-257862r1134908_rule)"
      tags:
        - stig
        - SV-257862r1134908_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257862r1134908_rule: RHEL 9 must prevent files with the setuid and setgid bit set from being - Modify "/etc/fstab" to use the "nosuid" option on the "/boot/efi" directory. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257863r958804_rule | Automation: automated via SCAP
    - name: "RHEL 9 must mount /dev/shm with the nodev option - (SV-257863r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/dev/shm\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must mount /dev/shm with the nodev option - (SV-257863r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257863r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /dev/shm
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-257864r1106304_rule | Automation: automated via SCAP
    - name: "Ensure tmp.mount is masked - (SV-257864r1106304_rule)"
      tags:
        - stig
        - SV-257864r1106304_rule
        - service_disabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: tmp.mount
        masked: yes
        state: stopped


    # STIG ID: SV-257865r1044946_rule | Automation: automated via SCAP
    - name: "RHEL 9 must mount /dev/shm with the nosuid option - (SV-257865r1044946_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/dev/shm\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must mount /dev/shm with the nosuid option - (SV-257865r1044946_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257865r1044946_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /dev/shm
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-257866r958804_rule | Automation: automated via SCAP
    - name: "RHEL 9 must mount /tmp with the nodev option - (SV-257866r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/tmp\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must mount /tmp with the nodev option - (SV-257866r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257866r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /tmp
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-257867r958804_rule | Automation: automated via SCAP
    - name: "RHEL 9 must mount /tmp with the noexec option - (SV-257867r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/tmp\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must mount /tmp with the noexec option - (SV-257867r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257867r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /tmp
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-257868r958804_rule | Automation: automated via SCAP
    - name: "RHEL 9 must mount /tmp with the nosuid option - (SV-257868r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/tmp\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must mount /tmp with the nosuid option - (SV-257868r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257868r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /tmp
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-257869r1102009_rule | Automation: automated via SCAP
    - name: "RHEL 9 must mount /var with the nodev option - (SV-257869r1102009_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must mount /var with the nodev option - (SV-257869r1102009_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257869r1102009_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /var
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-257870r958804_rule | Automation: automated via SCAP
    - name: "RHEL 9 must mount /var/log with the nodev option - (SV-257870r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/log\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must mount /var/log with the nodev option - (SV-257870r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257870r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /var/log
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-257871r958804_rule | Automation: automated via SCAP
    - name: "RHEL 9 must mount /var/log with the noexec option - (SV-257871r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/log\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must mount /var/log with the noexec option - (SV-257871r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257871r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /var/log
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-257872r958804_rule | Automation: automated via SCAP
    - name: "RHEL 9 must mount /var/log with the nosuid option - (SV-257872r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/log\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must mount /var/log with the nosuid option - (SV-257872r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257872r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /var/log
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-257873r958804_rule | Automation: automated via SCAP
    - name: "RHEL 9 must mount /var/log/audit with the nodev option - (SV-257873r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/log/audit\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must mount /var/log/audit with the nodev option - (SV-257873r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257873r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /var/log/audit
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-257874r958804_rule | Automation: automated via SCAP
    - name: "RHEL 9 must mount /var/log/audit with the noexec option - (SV-257874r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/log/audit\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must mount /var/log/audit with the noexec option - (SV-257874r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257874r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /var/log/audit
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-257875r958804_rule | Automation: automated via SCAP
    - name: "RHEL 9 must mount /var/log/audit with the nosuid option - (SV-257875r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/log/audit\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must mount /var/log/audit with the nosuid option - (SV-257875r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257875r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /var/log/audit
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-257876r958804_rule | Automation: automated via SCAP
    - name: "RHEL 9 must mount /var/tmp with the nodev option - (SV-257876r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/tmp\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must mount /var/tmp with the nodev option - (SV-257876r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257876r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /var/tmp
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-257877r958804_rule | Automation: automated via SCAP
    - name: "RHEL 9 must mount /var/tmp with the noexec option - (SV-257877r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/tmp\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must mount /var/tmp with the noexec option - (SV-257877r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257877r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /var/tmp
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-257878r958804_rule | Automation: automated via SCAP
    - name: "RHEL 9 must mount /var/tmp with the nosuid option - (SV-257878r958804_rule) - Ensure mount options in fstab"
      ansible.builtin.lineinfile:
        path: /etc/fstab
        regexp: '^([^#]\S+\s+/var/tmp\s+\S+\s+)([^\s]+)(.*)$'
        line: '\1\2,nodev,nosuid,noexec\3'
        backrefs: yes
        state: present
        backup: yes

    - name: "RHEL 9 must mount /var/tmp with the nosuid option - (SV-257878r958804_rule) - Remount with correct options"
      tags:
        - stig
        - SV-257878r958804_rule
        - mount_option
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.mount:
        path: /var/tmp
        opts: "defaults,nodev,nosuid,noexec"
        state: mounted
        fstype: auto


    # STIG ID: SV-257879r1045454_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 local disk partitions must implement cryptographic mechanisms to prevent - (SV-257879r1045454_rule)"
      tags:
        - stig
        - SV-257879r1045454_rule
        - config
        - severity_high
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257879r1045454_rule: RHEL 9 local disk partitions must implement cryptographic mechanisms to prevent - Configure RHEL 9 to prevent unauthorized modification of all information at rest by using disk encryption.  Encrypting a partition in an already installed system is more difficult, because existing pa... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257880r1044951_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must disable mounting of cramfs - (SV-257880r1044951_rule)"
      tags:
        - stig
        - SV-257880r1044951_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257880r1044951_rule: RHEL 9 must disable mounting of cramfs - To configure the system to prevent the cramfs kernel module from being loaded, add the following lines to the file /etc/modprobe.d/blacklist.conf (or create blacklist.conf if it does not exist):  inst... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257881r991589_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent special devices on non-root local partitions - (SV-257881r991589_rule)"
      tags:
        - stig
        - SV-257881r991589_rule
        - mount_option
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257881r991589_rule: RHEL 9 must prevent special devices on non-root local partitions - Configure the "/etc/fstab" to use the "nodev" option on all non-root local partitions. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257882r991560_rule | Automation: automated via SCAP
    - name: "RHEL 9 system commands must have mode 755 or less permissive - (SV-257882r991560_rule)"
      tags:
        - stig
        - SV-257882r991560_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /usr/bin
        mode: '755'
        state: directory


    # STIG ID: SV-257883r991560_rule | Automation: automated via SCAP
    - name: "RHEL 9 library directories must have mode 755 or less permissive - (SV-257883r991560_rule)"
      tags:
        - stig
        - SV-257883r991560_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /usr/lib
        mode: '755'
        state: directory


    # STIG ID: SV-257884r1106306_rule | Automation: automated via SCAP
    - name: "RHEL 9 library files must have mode 755 or less permissive - (SV-257884r1106306_rule)"
      tags:
        - stig
        - SV-257884r1106306_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /usr/lib
        mode: '0755'
        state: file


    # STIG ID: SV-257885r1044953_rule | Automation: automated via SCAP
    - name: "RHEL 9 /var/log directory must have mode 0755 or less permissive - (SV-257885r1044953_rule)"
      tags:
        - stig
        - SV-257885r1044953_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /var/log
        mode: '0755'
        state: directory


    # STIG ID: SV-257886r1044955_rule | Automation: automated via SCAP
    - name: "RHEL 9 /var/log/messages file must have mode 0640 or less permissive - (SV-257886r1044955_rule)"
      tags:
        - stig
        - SV-257886r1044955_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /var/log/messages
        mode: '0640'
        state: file


    # STIG ID: SV-257887r991557_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 audit tools must have a mode of 0755 or less permissive - (SV-257887r991557_rule)"
      tags:
        - stig
        - SV-257887r991557_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257887r991557_rule: RHEL 9 audit tools must have a mode of 0755 or less permissive - Configure the audit tools to have a mode of "0755" by running the following command:  $ sudo chmod 0755 [audit_tool]  Replace "[audit_tool]" with each audit tool that has a more permissive mode than 0... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257888r1134910_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 permissions of cron configuration files and directories must not be - (SV-257888r1134910_rule)"
      tags:
        - stig
        - SV-257888r1134910_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257888r1134910_rule: RHEL 9 permissions of cron configuration files and directories must not be - Run the following commands to restore the permissions of cron configuration files and directories to the operating system defaults:  $ sudo dnf reinstall cronie crontabs $ rpm --setugids cronie cronta... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257889r1044959_rule | Automation: automated via SCAP
    - name: "All RHEL 9 local initialization files must have mode 0740 or less permissive - (SV-257889r1044959_rule)"
      tags:
        - stig
        - SV-257889r1044959_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /home/wadea
        mode: '0740'
        state: file


    # STIG ID: SV-257890r1044961_rule | Automation: automated via SCAP
    - name: "All RHEL 9 local interactive user home directories must have mode 0750 or less - (SV-257890r1044961_rule)"
      tags:
        - stig
        - SV-257890r1044961_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/passwd
        mode: '0750'
        state: directory


    # STIG ID: SV-257891r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/group file must have mode 0644 or less permissive to prevent - (SV-257891r991589_rule)"
      tags:
        - stig
        - SV-257891r991589_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/group
        mode: '0644'
        state: file


    # STIG ID: SV-257892r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/group- file must have mode 0644 or less permissive to prevent - (SV-257892r991589_rule)"
      tags:
        - stig
        - SV-257892r991589_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/group-
        mode: '0644'
        state: file


    # STIG ID: SV-257893r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/gshadow file must have mode 0000 or less permissive to prevent - (SV-257893r991589_rule)"
      tags:
        - stig
        - SV-257893r991589_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/gshadow
        mode: '0000'
        state: file


    # STIG ID: SV-257894r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/gshadow- file must have mode 0000 or less permissive to prevent - (SV-257894r991589_rule)"
      tags:
        - stig
        - SV-257894r991589_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/gshadow-
        mode: '0000'
        state: file


    # STIG ID: SV-257895r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/passwd file must have mode 0644 or less permissive to prevent - (SV-257895r991589_rule)"
      tags:
        - stig
        - SV-257895r991589_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/passwd
        mode: '0644'
        state: file


    # STIG ID: SV-257896r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/passwd- file must have mode 0644 or less permissive to prevent - (SV-257896r991589_rule)"
      tags:
        - stig
        - SV-257896r991589_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/passwd-
        mode: '0644'
        state: file


    # STIG ID: SV-257897r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/shadow- file must have mode 0000 or less permissive to prevent - (SV-257897r991589_rule)"
      tags:
        - stig
        - SV-257897r991589_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/shadow-
        mode: '0000'
        state: file


    # STIG ID: SV-257898r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/group file must be owned by root - (SV-257898r991589_rule)"
      tags:
        - stig
        - SV-257898r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/group
        state: file


    # STIG ID: SV-257899r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/group file must be group-owned by root - (SV-257899r991589_rule)"
      tags:
        - stig
        - SV-257899r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/group
        group: root
        state: file


    # STIG ID: SV-257900r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/group- file must be owned by root - (SV-257900r991589_rule)"
      tags:
        - stig
        - SV-257900r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/group-
        state: file


    # STIG ID: SV-257901r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/group- file must be group-owned by root - (SV-257901r991589_rule)"
      tags:
        - stig
        - SV-257901r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/group-
        group: root
        state: file


    # STIG ID: SV-257902r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/gshadow file must be owned by root - (SV-257902r991589_rule)"
      tags:
        - stig
        - SV-257902r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/gshadow
        owner: root
        state: file


    # STIG ID: SV-257903r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/gshadow file must be group-owned by root - (SV-257903r991589_rule)"
      tags:
        - stig
        - SV-257903r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/gshadow
        group: root
        state: file


    # STIG ID: SV-257904r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/gshadow- file must be owned by root - (SV-257904r991589_rule)"
      tags:
        - stig
        - SV-257904r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/gshadow-
        owner: root
        state: file


    # STIG ID: SV-257905r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/gshadow- file must be group-owned by root - (SV-257905r991589_rule)"
      tags:
        - stig
        - SV-257905r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/gshadow-
        group: root
        state: file


    # STIG ID: SV-257906r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/passwd file must be owned by root - (SV-257906r991589_rule)"
      tags:
        - stig
        - SV-257906r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/passwd
        owner: root
        state: file


    # STIG ID: SV-257907r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/passwd file must be group-owned by root - (SV-257907r991589_rule)"
      tags:
        - stig
        - SV-257907r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/passwd
        group: root
        state: file


    # STIG ID: SV-257908r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/passwd- file must be owned by root - (SV-257908r991589_rule)"
      tags:
        - stig
        - SV-257908r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/passwd-
        owner: root
        state: file


    # STIG ID: SV-257909r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/passwd- file must be group-owned by root - (SV-257909r991589_rule)"
      tags:
        - stig
        - SV-257909r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/passwd-
        group: root
        state: file


    # STIG ID: SV-257910r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/shadow file must be owned by root - (SV-257910r991589_rule)"
      tags:
        - stig
        - SV-257910r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/shadow
        owner: root
        state: file


    # STIG ID: SV-257911r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/shadow file must be group-owned by root - (SV-257911r991589_rule)"
      tags:
        - stig
        - SV-257911r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/shadow
        group: root
        state: file


    # STIG ID: SV-257912r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/shadow- file must be owned by root - (SV-257912r991589_rule)"
      tags:
        - stig
        - SV-257912r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/shadow-
        owner: root
        state: file


    # STIG ID: SV-257913r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/shadow- file must be group-owned by root - (SV-257913r991589_rule)"
      tags:
        - stig
        - SV-257913r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/shadow-
        group: root
        state: file


    # STIG ID: SV-257914r1044969_rule | Automation: automated via SCAP
    - name: "RHEL 9 /var/log directory must be owned by root - (SV-257914r1044969_rule)"
      tags:
        - stig
        - SV-257914r1044969_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /var/log
        owner: root
        state: directory


    # STIG ID: SV-257915r1044971_rule | Automation: automated via SCAP
    - name: "RHEL 9 /var/log directory must be group-owned by root - (SV-257915r1044971_rule)"
      tags:
        - stig
        - SV-257915r1044971_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /var/log
        group: root
        state: directory


    # STIG ID: SV-257916r1101916_rule | Automation: automated via SCAP
    - name: "RHEL 9 /var/log/messages file must be owned by root - (SV-257916r1101916_rule)"
      tags:
        - stig
        - SV-257916r1101916_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /var/log/messages
        owner: root
        state: file


    # STIG ID: SV-257917r1101914_rule | Automation: automated via SCAP
    - name: "RHEL 9 /var/log/messages file must be group-owned by root - (SV-257917r1101914_rule)"
      tags:
        - stig
        - SV-257917r1101914_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /var/log/messages
        group: root
        state: file


    # STIG ID: SV-257918r1044977_rule | Automation: automated via SCAP
    - name: "RHEL 9 system commands must be owned by root - (SV-257918r1044977_rule)"
      tags:
        - stig
        - SV-257918r1044977_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /usr/bin
        owner: root
        state: directory


    # STIG ID: SV-257919r1044979_rule | Automation: automated via SCAP
    - name: "RHEL 9 system commands must be group-owned by root or a system account - (SV-257919r1044979_rule)"
      tags:
        - stig
        - SV-257919r1044979_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /usr/bin
        group: root
        state: directory


    # STIG ID: SV-257920r1101926_rule | Automation: automated via SCAP
    - name: "RHEL 9 library files must be owned by root - (SV-257920r1101926_rule)"
      tags:
        - stig
        - SV-257920r1101926_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /usr/lib
        owner: root
        state: file


    # STIG ID: SV-257921r1106308_rule | Automation: automated via SCAP
    - name: "RHEL 9 library files must be group-owned by root or a system account - (SV-257921r1106308_rule)"
      tags:
        - stig
        - SV-257921r1106308_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /usr/lib
        group: root
        state: file


    # STIG ID: SV-257922r1044988_rule | Automation: automated via SCAP
    - name: "RHEL 9 library directories must be owned by root - (SV-257922r1044988_rule)"
      tags:
        - stig
        - SV-257922r1044988_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /usr/lib
        owner: root
        state: directory


    # STIG ID: SV-257923r1044991_rule | Automation: automated via SCAP
    - name: "RHEL 9 library directories must be group-owned by root or a system account - (SV-257923r1044991_rule)"
      tags:
        - stig
        - SV-257923r1044991_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /usr/lib
        group: root
        state: directory


    # STIG ID: SV-257924r991557_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 audit tools must be owned by root - (SV-257924r991557_rule)"
      tags:
        - stig
        - SV-257924r991557_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257924r991557_rule: RHEL 9 audit tools must be owned by root - Configure the audit tools to be owned by "root" by running the following command:  $ sudo chown root [audit_tool]  Replace "[audit_tool]" with each audit tool not owned by "root". Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257925r991557_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 audit tools must be group-owned by root - (SV-257925r991557_rule)"
      tags:
        - stig
        - SV-257925r991557_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257925r991557_rule: RHEL 9 audit tools must be group-owned by root - Configure the audit tools to be group-owned by "root" by running the following command:  $ sudo chgrp root [audit_tool]  Replace "[audit_tool]" with each audit tool not group-owned by "root". Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257926r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 cron configuration files directory must be owned by root - (SV-257926r991589_rule)"
      tags:
        - stig
        - SV-257926r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/cron
        owner: root
        state: directory


    # STIG ID: SV-257927r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 cron configuration files directory must be group-owned by root - (SV-257927r991589_rule)"
      tags:
        - stig
        - SV-257927r991589_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/cron
        group: root
        state: directory


    # STIG ID: SV-257928r1044992_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 9 world-writable directories must be owned by root, sys, bin, or an - (SV-257928r1044992_rule)"
      tags:
        - stig
        - SV-257928r1044992_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257928r1044992_rule: All RHEL 9 world-writable directories must be owned by root, sys, bin, or an - Configure all public directories to be owned by root or a system account to prevent unauthorized and unintended information transferred via shared system resources.  Set the owner of all public direct... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257929r1117267_rule | Automation: manual-only (not covered by scap)
    - name: "A sticky bit must be set on all RHEL 9 public directories - (SV-257929r1117267_rule)"
      tags:
        - stig
        - SV-257929r1117267_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257929r1117267_rule: A sticky bit must be set on all RHEL 9 public directories - Configure all world-writable directories to have the sticky bit set to prevent unauthorized and unintended information transferred via shared system resources.  Set the sticky bit on all world-writabl... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257930r991589_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 9 local files and directories must have a valid group owner - (SV-257930r991589_rule)"
      tags:
        - stig
        - SV-257930r991589_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257930r991589_rule: All RHEL 9 local files and directories must have a valid group owner - Either remove all files and directories from RHEL 9 that do not have a valid group, or assign a valid group to all files and directories on the system with the "chgrp" command:  $ sudo chgrp <group> <... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257931r991589_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 9 local files and directories must have a valid owner - (SV-257931r991589_rule)"
      tags:
        - stig
        - SV-257931r991589_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257931r991589_rule: All RHEL 9 local files and directories must have a valid owner - Either remove all files and directories from the system that do not have a valid user, or assign a valid user to all unowned files and directories on RHEL 9 with the "chown" command:  $ sudo chown <us... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257932r1014838_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must be configured so that all system device files are correctly labeled - (SV-257932r1014838_rule)"
      tags:
        - stig
        - SV-257932r1014838_rule
        - package_present
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257932r1014838_rule: RHEL 9 must be configured so that all system device files are correctly labeled - Restore the SELinux policy for the affected device file from the system policy database using the following command:  $ sudo restorecon -v <device_path>  Substitute "<device_path>" with the path to th... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257934r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 /etc/shadow file must have mode 0000 to prevent unauthorized access - (SV-257934r991589_rule)"
      tags:
        - stig
        - SV-257934r991589_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/shadow
        mode: '0000'
        state: file


    # STIG ID: SV-257935r1044994_rule | Automation: automated via SCAP
    - name: "RHEL 9 must have the firewalld package installed - (SV-257935r1044994_rule)"
      tags:
        - stig
        - SV-257935r1044994_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: firewalld
        state: absent


    # STIG ID: SV-257936r1044995_rule | Automation: automated via SCAP
    - name: "Ensure firewalld.service is enable_and_start - (SV-257936r1044995_rule)"
      tags:
        - stig
        - SV-257936r1044995_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: firewalld.service
        enabled: yes
        state: started


    # STIG ID: SV-257937r1106310_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 9 firewall must employ a deny-all, allow-by-exception policy for - (SV-257937r1106310_rule)"
      tags:
        - stig
        - SV-257937r1106310_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257937r1106310_rule: The RHEL 9 firewall must employ a deny-all, allow-by-exception policy for - Configure the "firewalld" daemon to employ a deny-all, allow-by-exception policy with the following commands:  Start by adding the exceptions that are required for mission functionality to the "drop" ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257939r1044997_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must protect against or limit the effects of denial-of-service (DoS) - (SV-257939r1044997_rule)"
      tags:
        - stig
        - SV-257939r1044997_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257939r1044997_rule: RHEL 9 must protect against or limit the effects of denial-of-service (DoS) - Configure "nftables" to be the default "firewallbackend" for "firewalld" by adding or editing the following line in "/etc/firewalld/firewalld.conf":  FirewallBackend=nftables  Establish rate-limiting ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257940r1106312_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must be configured to prohibit or restrict the use of functions, ports, - (SV-257940r1106312_rule)"
      tags:
        - stig
        - SV-257940r1106312_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257940r1106312_rule: RHEL 9 must be configured to prohibit or restrict the use of functions, ports, - Update the host's firewall settings and/or running services to comply with the PPSM CLSA for the site or program and the PPSM CAL.  Then run the following command to load the newly created rule(s):  $... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257941r991589_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 network interfaces must not be in promiscuous mode - (SV-257941r991589_rule)"
      tags:
        - stig
        - SV-257941r991589_rule
        - other
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257941r991589_rule: RHEL 9 network interfaces must not be in promiscuous mode - Configure network interfaces to turn off promiscuous mode unless approved by the ISSO and documented.  Set the promiscuous mode of an interface to off with the following command:  $ sudo ip link set d... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257942r1106314_rule | Automation: automated via SCAP
    - name: "RHEL 9 must enable hardening for the Berkeley Packet Filter just-in-time - (SV-257942r1106314_rule)"
      tags:
        - stig
        - SV-257942r1106314_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.sysctl:
        name: net.core.bpf_jit_harden
        value: '2'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-257943r1045001_rule | Automation: automated via SCAP
    - name: "RHEL 9 must have the chrony package installed - (SV-257943r1045001_rule)"
      tags:
        - stig
        - SV-257943r1045001_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: chrony
        state: absent


    # STIG ID: SV-257944r1038944_rule | Automation: automated via SCAP
    - name: "Ensure chronyd.service is enable_and_start - (SV-257944r1038944_rule)"
      tags:
        - stig
        - SV-257944r1038944_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: chronyd.service
        enabled: yes
        state: started


    # STIG ID: SV-257945r1038944_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must securely compare internal information system clocks at least every - (SV-257945r1038944_rule)"
      tags:
        - stig
        - SV-257945r1038944_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257945r1038944_rule: RHEL 9 must securely compare internal information system clocks at least every - Configure RHEL 9 to securely compare internal information system clocks at least every 24 hours with an NTP server by adding/modifying the following line in the /etc/chrony.conf file.  server [ntp.ser... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257946r958480_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must disable the chrony daemon from acting as a server - (SV-257946r958480_rule)"
      tags:
        - stig
        - SV-257946r958480_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257946r958480_rule: RHEL 9 must disable the chrony daemon from acting as a server - Configure RHEL 9 to disable the chrony daemon from acting as a server by adding/modifying the following line in the /etc/chrony.conf file:  port 0 Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257947r958480_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must disable network management of the chrony daemon - (SV-257947r958480_rule)"
      tags:
        - stig
        - SV-257947r958480_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257947r958480_rule: RHEL 9 must disable network management of the chrony daemon - Configure RHEL 9 to disable network management of the chrony daemon by adding/modifying the following line in the /etc/chrony.conf file:  cmdport 0 Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257948r1045004_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 systems using Domain Name Servers (DNS) resolution must have at least - (SV-257948r1045004_rule)"
      tags:
        - stig
        - SV-257948r1045004_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257948r1045004_rule: RHEL 9 systems using Domain Name Servers (DNS) resolution must have at least - Configure the operating system to use two or more name servers for DNS resolution based on the DNS mode of the system. 	 If the NetworkManager DNS mode is set to "none", add the following lines to "/e... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257949r1134947_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must configure a DNS processing mode in Network Manager - (SV-257949r1134947_rule)"
      tags:
        - stig
        - SV-257949r1134947_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257949r1134947_rule: RHEL 9 must configure a DNS processing mode in Network Manager - Configure NetworkManager in RHEL 9 to use a DNS mode.  In "/etc/NetworkManager/NetworkManager.conf", add the following line in the "[main]" section:  dns = <dns processing mode>  Where <dns processing... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257950r1045006_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must not have unauthorized IP tunnels configured - (SV-257950r1045006_rule)"
      tags:
        - stig
        - SV-257950r1045006_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257950r1045006_rule: RHEL 9 must not have unauthorized IP tunnels configured - Remove all unapproved tunnels from the system, or document them with the ISSO. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257951r1014843_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must be configured to prevent unrestricted mail relaying - (SV-257951r1014843_rule)"
      tags:
        - stig
        - SV-257951r1014843_rule
        - other
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257951r1014843_rule: RHEL 9 must be configured to prevent unrestricted mail relaying - Modify the postfix configuration file to restrict client connections to the local network with the following command:  $ sudo postconf -e 'smtpd_client_restrictions = permit_mynetworks,reject' Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257953r958424_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must forward mail from postmaster to the root account using a postfix - (SV-257953r958424_rule)"
      tags:
        - stig
        - SV-257953r958424_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257953r958424_rule: RHEL 9 must forward mail from postmaster to the root account using a postfix - Configure a valid email address as an alias for the root account.  Append the following line to "/etc/aliases":  postmaster: root  Then, run the following command:  $ sudo newaliases Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257954r1106315_rule | Automation: automated via SCAP
    - name: "Ensure package is enabled and running - (SV-257954r1106315_rule)"
      tags:
        - stig
        - SV-257954r1106315_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: package
        enabled: yes
        state: started


    # STIG ID: SV-257955r991589_rule | Automation: manual-only (not covered by scap)
    - name: "There must be no shosts.equiv files on RHEL 9 - (SV-257955r991589_rule)"
      tags:
        - stig
        - SV-257955r991589_rule
        - other
        - severity_high
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257955r991589_rule: There must be no shosts.equiv files on RHEL 9 - Remove any found "shosts.equiv" files from the system.  $ sudo rm /[path]/[to]/[file]/shosts.equiv Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257956r991589_rule | Automation: manual-only (not covered by scap)
    - name: "There must be no .shosts files on RHEL 9 - (SV-257956r991589_rule)"
      tags:
        - stig
        - SV-257956r991589_rule
        - other
        - severity_high
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257956r991589_rule: There must be no .shosts files on RHEL 9 - Remove any found ".shosts" files from the system.  $ sudo rm /[path]/[to]/[file]/.shosts Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257957r1106317_rule | Automation: automated via SCAP
    - name: "RHEL 9 must be configured to use TCP syncookies - (SV-257957r1106317_rule)"
      tags:
        - stig
        - SV-257957r1106317_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.sysctl:
        name: net.ipv4.tcp_syncookies
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-257958r1106319_rule | Automation: automated via SCAP
    - name: "RHEL 9 must ignore Internet Protocol version 4 (IPv4) Internet Control Message - (SV-257958r1106319_rule)"
      tags:
        - stig
        - SV-257958r1106319_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.sysctl:
        name: net.ipv4.conf.all.accept_redirects
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-257959r1102024_rule | Automation: automated via SCAP
    - name: "RHEL 9 must not forward Internet Protocol version 4 (IPv4) source-routed packets - (SV-257959r1102024_rule)"
      tags:
        - stig
        - SV-257959r1102024_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.sysctl:
        name: net.ipv4.conf.all.accept_source_route
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-257960r1106321_rule | Automation: automated via SCAP
    - name: "RHEL 9 must log IPv4 packets with impossible addresses - (SV-257960r1106321_rule)"
      tags:
        - stig
        - SV-257960r1106321_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.sysctl:
        name: net.ipv4.conf.all.log_martians
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-257961r1106323_rule | Automation: automated via SCAP
    - name: "RHEL 9 must log IPv4 packets with impossible addresses by default - (SV-257961r1106323_rule)"
      tags:
        - stig
        - SV-257961r1106323_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.sysctl:
        name: net.ipv4.conf.default.log_martians
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-257962r1106437_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must use reverse path filtering on all IPv4 interfaces - (SV-257962r1106437_rule)"
      tags:
        - stig
        - SV-257962r1106437_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257962r1106437_rule: RHEL 9 must use reverse path filtering on all IPv4 interfaces - Configure RHEL 9 to use reverse path filtering on all IPv4 interfaces by adding the following line to a file in the "/etc/sysctl.d" directory:  net.ipv4.conf.all.rp_filter = 1  Remove any configuratio... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257963r1106328_rule | Automation: automated via SCAP
    - name: "RHEL 9 must prevent IPv4 Internet Control Message Protocol (ICMP) redirect - (SV-257963r1106328_rule)"
      tags:
        - stig
        - SV-257963r1106328_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.sysctl:
        name: net.ipv4.conf.default.accept_redirects
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-257964r1106438_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must not forward IPv4 source-routed packets by default - (SV-257964r1106438_rule)"
      tags:
        - stig
        - SV-257964r1106438_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257964r1106438_rule: RHEL 9 must not forward IPv4 source-routed packets by default - Configure RHEL 9 to not forward IPv4 source-routed packets by default.  Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:  net.ipv4.conf.default.accept_s... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257965r1106333_rule | Automation: automated via SCAP
    - name: "RHEL 9 must use a reverse-path filter for IPv4 network traffic when possible by - (SV-257965r1106333_rule)"
      tags:
        - stig
        - SV-257965r1106333_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.sysctl:
        name: net.ipv4.conf.default.rp_filter
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-257966r1106440_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must not respond to Internet Control Message Protocol (ICMP) echoes sent - (SV-257966r1106440_rule)"
      tags:
        - stig
        - SV-257966r1106440_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257966r1106440_rule: RHEL 9 must not respond to Internet Control Message Protocol (ICMP) echoes sent - Configure RHEL 9 to not respond to IPv4 ICMP echoes sent to a broadcast address.  Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:  net.ipv4.icmp_echo_i... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257967r1106337_rule | Automation: automated via SCAP
    - name: "RHEL 9 must limit the number of bogus Internet Control Message Protocol (ICMP) - (SV-257967r1106337_rule)"
      tags:
        - stig
        - SV-257967r1106337_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.sysctl:
        name: net.ipv4.icmp_ignore_bogus_error_responses
        value: '1'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-257968r1106339_rule | Automation: automated via SCAP
    - name: "RHEL 9 must not send Internet Control Message Protocol (ICMP) redirects - (SV-257968r1106339_rule)"
      tags:
        - stig
        - SV-257968r1106339_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.sysctl:
        name: net.ipv4.conf.all.send_redirects
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-257969r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 must not allow interfaces to perform Internet Control Message Protocol - (SV-257969r991589_rule)"
      tags:
        - stig
        - SV-257969r991589_rule
        - sysctl
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.sysctl:
        name: net.ipv4.conf.default.send_redirects
        value: '0'
        state: present
        sysctl_set: yes
        reload: yes
      notify: Reload sysctl


    # STIG ID: SV-257970r1106442_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must not enable IPv4 packet forwarding unless the system is a router - (SV-257970r1106442_rule)"
      tags:
        - stig
        - SV-257970r1106442_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257970r1106442_rule: RHEL 9 must not enable IPv4 packet forwarding unless the system is a router - Configure RHEL 9 to not allow IPv4 packet forwarding, unless the system is a router.  Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:  net.ipv4.conf.al... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257971r1106444_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must not accept router advertisements on all IPv6 interfaces - (SV-257971r1106444_rule)"
      tags:
        - stig
        - SV-257971r1106444_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257971r1106444_rule: RHEL 9 must not accept router advertisements on all IPv6 interfaces - Configure RHEL 9 to not accept router advertisements on all IPv6 interfaces unless the system is a router.  Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" direct... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257972r1106446_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must ignore IPv6 Internet Control Message Protocol (ICMP) redirect - (SV-257972r1106446_rule)"
      tags:
        - stig
        - SV-257972r1106446_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257972r1106446_rule: RHEL 9 must ignore IPv6 Internet Control Message Protocol (ICMP) redirect - Configure RHEL 9 to ignore IPv6 ICMP redirect messages.  Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:  net.ipv6.conf.all.accept_redirects = 0  Remov... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257973r1106448_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must not forward IPv6 source-routed packets - (SV-257973r1106448_rule)"
      tags:
        - stig
        - SV-257973r1106448_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257973r1106448_rule: RHEL 9 must not forward IPv6 source-routed packets - Configure RHEL 9 to not forward IPv6 source-routed packets.  Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:  net.ipv6.conf.all.accept_source_route=0  ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257974r1106450_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must not enable IPv6 packet forwarding unless the system is a router - (SV-257974r1106450_rule)"
      tags:
        - stig
        - SV-257974r1106450_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257974r1106450_rule: RHEL 9 must not enable IPv6 packet forwarding unless the system is a router - Configure RHEL 9 to not allow IPv6 packet forwarding, unless the system is a router.  Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:  net.ipv6.conf.al... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257975r1106452_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must not accept router advertisements on all IPv6 interfaces by default - (SV-257975r1106452_rule)"
      tags:
        - stig
        - SV-257975r1106452_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257975r1106452_rule: RHEL 9 must not accept router advertisements on all IPv6 interfaces by default - Configure RHEL 9 to not accept router advertisements on all IPv6 interfaces by default unless the system is a router.  Add or edit the following line in a system configuration file in the "/etc/sysctl... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257976r1106454_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent IPv6 Internet Control Message Protocol (ICMP) redirect - (SV-257976r1106454_rule)"
      tags:
        - stig
        - SV-257976r1106454_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257976r1106454_rule: RHEL 9 must prevent IPv6 Internet Control Message Protocol (ICMP) redirect - Configure RHEL 9 to prevent IPv6 ICMP redirect messages from being accepted.  Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:  net.ipv6.conf.default.ac... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257977r1106456_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must not forward IPv6 source-routed packets by default - (SV-257977r1106456_rule)"
      tags:
        - stig
        - SV-257977r1106456_rule
        - sysctl
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257977r1106456_rule: RHEL 9 must not forward IPv6 source-routed packets by default - Configure RHEL 9 to not forward IPv6 source-routed packets by default.  Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:  net.ipv6.conf.default.accept_s... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257978r1045013_rule | Automation: automated via SCAP
    - name: "All RHEL 9 networked systems must have SSH installed - (SV-257978r1045013_rule)"
      tags:
        - stig
        - SV-257978r1045013_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: openssh-server
        state: absent


    # STIG ID: SV-257979r958908_rule | Automation: automated via SCAP
    - name: "Ensure sshd.service is enable_and_start - (SV-257979r958908_rule)"
      tags:
        - stig
        - SV-257979r958908_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: sshd.service
        enabled: yes
        state: started


    # STIG ID: SV-257980r1045016_rule | Automation: automated via SCAP
    - name: "RHEL 9 must have the openssh-clients package installed - (SV-257980r1045016_rule)"
      tags:
        - stig
        - SV-257980r1045016_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: openssh-clients
        state: absent


    # STIG ID: SV-257981r1101970_rule | Automation: automated via SCAP
    - name: "RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before - (SV-257981r1101970_rule)"
      tags:
        - stig
        - SV-257981r1101970_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*Banner\s+'
        line: 'Banner /etc/issue'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-257982r1045021_rule | Automation: automated via SCAP
    - name: "RHEL 9 must log SSH connection attempts and failures to the server - (SV-257982r1045021_rule)"
      tags:
        - stig
        - SV-257982r1045021_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*LogLevel\s+'
        line: 'LogLevel VERBOSE'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-257983r1045024_rule | Automation: automated via SCAP
    - name: "RHEL 9 SSHD must accept public key authentication - (SV-257983r1045024_rule)"
      tags:
        - stig
        - SV-257983r1045024_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*PubkeyAuthentication\s+'
        line: 'PubkeyAuthentication yes'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-257984r1045026_rule | Automation: automated via SCAP
    - name: "RHEL 9 SSHD must not allow blank passwords - (SV-257984r1045026_rule)"
      tags:
        - stig
        - SV-257984r1045026_rule
        - ssh_config
        - severity_high
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*PermitEmptyPasswords\s+'
        line: 'PermitEmptyPasswords no'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-257985r1069364_rule | Automation: automated via SCAP
    - name: "RHEL 9 must not permit direct logons to the root account using remote access - (SV-257985r1069364_rule)"
      tags:
        - stig
        - SV-257985r1069364_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*PermitRootLogin\s+'
        line: 'PermitRootLogin no'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-257986r1045030_rule | Automation: automated via SCAP
    - name: "RHEL 9 must enable the Pluggable Authentication Module (PAM) interface for SSHD - (SV-257986r1045030_rule)"
      tags:
        - stig
        - SV-257986r1045030_rule
        - ssh_config
        - severity_high
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*UsePAM\s+'
        line: 'UsePAM yes'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-257989r1051240_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 9 SSH server must be configured to use only DOD-approved encryption - (SV-257989r1051240_rule)"
      tags:
        - stig
        - SV-257989r1051240_rule
        - package_present
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257989r1051240_rule: The RHEL 9 SSH server must be configured to use only DOD-approved encryption - Configure the RHEL 9 SSH server to use only ciphers employing FIPS 140-3 approved algorithms.  Reinstall crypto-policies with the following command:  $ sudo dnf -y reinstall crypto-policies  Set the c... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257991r1051246_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 9 SSH server must be configured to use only Message Authentication - (SV-257991r1051246_rule)"
      tags:
        - stig
        - SV-257991r1051246_rule
        - package_present
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257991r1051246_rule: The RHEL 9 SSH server must be configured to use only Message Authentication - Configure the RHEL 9 SSH server to use only MACs employing FIPS 140-3 approved algorithms.  Reinstall crypto-policies with the following command:  $ sudo dnf -y reinstall crypto-policies  Set the cryp... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257992r1045047_rule | Automation: automated via SCAP
    - name: "RHEL 9 must not allow a noncertificate trusted host SSH logon to the system - (SV-257992r1045047_rule)"
      tags:
        - stig
        - SV-257992r1045047_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*HostbasedAuthentication\s+'
        line: 'HostbasedAuthentication no'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-257993r1045049_rule | Automation: automated via SCAP
    - name: "RHEL 9 must not allow users to override SSH environment variables - (SV-257993r1045049_rule)"
      tags:
        - stig
        - SV-257993r1045049_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*PermitUserEnvironment\s+'
        line: 'PermitUserEnvironment no'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-257994r1045051_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must force a frequent session key renegotiation for SSH connections to - (SV-257994r1045051_rule)"
      tags:
        - stig
        - SV-257994r1045051_rule
        - ssh_config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257994r1045051_rule: RHEL 9 must force a frequent session key renegotiation for SSH connections to - Configure RHEL 9 to force a frequent session key renegotiation for SSH connections to the server by adding or modifying the following line in the "/etc/ssh/sshd_config" or in a file in "/etc/ssh/sshd_... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257995r1045053_rule | Automation: automated via SCAP
    - name: "RHEL 9 must be configured so that all network connections associated with SSH - (SV-257995r1045053_rule)"
      tags:
        - stig
        - SV-257995r1045053_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*ClientAliveCountMax\s+'
        line: 'ClientAliveCountMax 1'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-257996r1134915_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must be configured so that all network connections associated with SSH - (SV-257996r1134915_rule)"
      tags:
        - stig
        - SV-257996r1134915_rule
        - ssh_config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257996r1134915_rule: RHEL 9 must be configured so that all network connections associated with SSH - Note: This setting must be applied in conjunction with RHEL-09-255095 to function correctly.  Configure the SSH server to terminate a user session automatically after the SSH client has been unrespons... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257997r1069370_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 SSH server configuration file must be group-owned by root - (SV-257997r1069370_rule)"
      tags:
        - stig
        - SV-257997r1069370_rule
        - ssh_config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257997r1069370_rule: RHEL 9 SSH server configuration file must be group-owned by root - Configure the "/etc/ssh/sshd_config" file and the contents of "/etc/ssh/sshd_config.d" to be group-owned by root with the following command:  $ sudo chgrp root /etc/ssh/sshd_config /etc/ssh/sshd_confi... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257998r1082181_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 9 SSH server configuration file must be owned by root - (SV-257998r1082181_rule)"
      tags:
        - stig
        - SV-257998r1082181_rule
        - ssh_config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257998r1082181_rule: The RHEL 9 SSH server configuration file must be owned by root - Configure  the "/etc/ssh/sshd_config" file and the contents of "/etc/ssh/sshd_config.d" to be owned by root with the following command:  $ sudo chown -R root /etc/ssh/sshd_config /etc/ssh/sshd_config.... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-257999r1134918_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 SSH server configuration files' permissions must not be modified - (SV-257999r1134918_rule)"
      tags:
        - stig
        - SV-257999r1134918_rule
        - ssh_config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-257999r1134918_rule: RHEL 9 SSH server configuration files' permissions must not be modified - Run the following commands to restore the correct permissions of OpenSSH server configuration files:  $ rpm --setugids openssh-server $ rpm --setperms openssh-server Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258000r1045063_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 SSH private host key files must have mode 0640 or less permissive - (SV-258000r1045063_rule)"
      tags:
        - stig
        - SV-258000r1045063_rule
        - ssh_config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258000r1045063_rule: RHEL 9 SSH private host key files must have mode 0640 or less permissive - Configure the mode of SSH private host key files under "/etc/ssh" to "0640" with the following command:  $ sudo chmod 0640 /etc/ssh/ssh_host*key  Restart the SSH daemon for the changes to take effect:... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258001r991589_rule | Automation: automated via SCAP
    - name: "RHEL 9 SSH public host key files must have mode 0644 or less permissive - (SV-258001r991589_rule)"
      tags:
        - stig
        - SV-258001r991589_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/ssh
        mode: '0644'
        state: file


    # STIG ID: SV-258002r991589_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 SSH daemon must not allow compression or must only allow compression - (SV-258002r991589_rule)"
      tags:
        - stig
        - SV-258002r991589_rule
        - ssh_config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258002r991589_rule: RHEL 9 SSH daemon must not allow compression or must only allow compression - Configure the SSH daemon to not allow compression.  Uncomment the "Compression" keyword in "/etc/ssh/sshd_config" on the system and set the value to "delayed" or "no":  Compression no  The SSH service... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258003r1045065_rule | Automation: automated via SCAP
    - name: "RHEL 9 SSH daemon must not allow GSSAPI authentication - (SV-258003r1045065_rule)"
      tags:
        - stig
        - SV-258003r1045065_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*GSSAPIAuthentication\s+'
        line: 'GSSAPIAuthentication no'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-258004r1045067_rule | Automation: automated via SCAP
    - name: "RHEL 9 SSH daemon must not allow Kerberos authentication - (SV-258004r1045067_rule)"
      tags:
        - stig
        - SV-258004r1045067_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*KerberosAuthentication\s+'
        line: 'KerberosAuthentication no'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-258005r1045069_rule | Automation: automated via SCAP
    - name: "RHEL 9 SSH daemon must not allow rhosts authentication - (SV-258005r1045069_rule)"
      tags:
        - stig
        - SV-258005r1045069_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*IgnoreRhosts\s+'
        line: 'IgnoreRhosts yes'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-258006r1045071_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 SSH daemon must not allow known hosts authentication - (SV-258006r1045071_rule)"
      tags:
        - stig
        - SV-258006r1045071_rule
        - ssh_config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258006r1045071_rule: RHEL 9 SSH daemon must not allow known hosts authentication - Configure the SSH daemon to not allow known hosts authentication.  Add the following line to "/etc/ssh/sshd_config" or to a file in "/etc/ssh/sshd_config.d", or uncomment the line and set the value to... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258007r1045073_rule | Automation: automated via SCAP
    - name: "RHEL 9 SSH daemon must disable remote X connections for interactive users - (SV-258007r1045073_rule)"
      tags:
        - stig
        - SV-258007r1045073_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*X11Forwarding\s+'
        line: 'X11Forwarding no'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-258008r1045075_rule | Automation: automated via SCAP
    - name: "RHEL 9 SSH daemon must perform strict mode checking of home directory - (SV-258008r1045075_rule)"
      tags:
        - stig
        - SV-258008r1045075_rule
        - ssh_config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/ssh/sshd_config.d/99-stig-hardening.conf
        regexp: '^#?\s*StrictModes\s+'
        line: 'StrictModes yes'
        create: yes
        backup: yes
      notify: Restart sshd


    # STIG ID: SV-258009r1045077_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 SSH daemon must display the date and time of the last successful account - (SV-258009r1045077_rule)"
      tags:
        - stig
        - SV-258009r1045077_rule
        - ssh_config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258009r1045077_rule: RHEL 9 SSH daemon must display the date and time of the last successful account - Configure the SSH daemon to provide users with feedback on when account accesses last occurred.  Add the following line to "/etc/ssh/sshd_config" or to a file in "/etc/ssh/sshd_config.d", or uncomment... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258011r1045079_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 SSH daemon must prevent remote hosts from connecting to the proxy display - (SV-258011r1045079_rule)"
      tags:
        - stig
        - SV-258011r1045079_rule
        - ssh_config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258011r1045079_rule: RHEL 9 SSH daemon must prevent remote hosts from connecting to the proxy display - Configure the SSH daemon to prevent remote hosts from connecting to the proxy display.  Add the following line to "/etc/ssh/sshd_config" or to a file in "/etc/ssh/sshd_config.d", or uncomment the line... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258012r1014855_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before - (SV-258012r1014855_rule)"
      tags:
        - stig
        - SV-258012r1014855_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258012r1014855_rule: RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before - Configure RHEL 9 to display the Standard Mandatory DOD Notice and Consent Banner before granting access to the system via a graphical user logon.  Create a database to contain the system-wide graphica... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258013r1045082_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent a user from overriding the banner-message-enable setting - (SV-258013r1045082_rule)"
      tags:
        - stig
        - SV-258013r1045082_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258013r1045082_rule: RHEL 9 must prevent a user from overriding the banner-message-enable setting - Configure RHEL 9 to prevent a user from overriding the banner setting for graphical user interfaces.   Create a database to contain the systemwide graphical user logon settings (if it does not already... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258014r1045084_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must disable the graphical user interface automount function unless - (SV-258014r1045084_rule)"
      tags:
        - stig
        - SV-258014r1045084_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258014r1045084_rule: RHEL 9 must disable the graphical user interface automount function unless - Configure the GNOME desktop to disable automated mounting of removable media.  The dconf settings can be edited in the /etc/dconf/db/* location.  Update the [org/gnome/desktop/media-handling] section ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258015r1045086_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent a user from overriding the disabling of the graphical user - (SV-258015r1045086_rule)"
      tags:
        - stig
        - SV-258015r1045086_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258015r1045086_rule: RHEL 9 must prevent a user from overriding the disabling of the graphical user - Configure the GNOME desktop to not allow a user to change the setting that disables automated mounting of removable media.  Add the following line to "/etc/dconf/db/local.d/locks/00-security-settings-... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258016r958804_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must disable the graphical user interface autorun function unless - (SV-258016r958804_rule)"
      tags:
        - stig
        - SV-258016r958804_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258016r958804_rule: RHEL 9 must disable the graphical user interface autorun function unless - Configure the GNOME desktop to disable the autorun function on removable media.  The dconf settings can be edited in the /etc/dconf/db/* location.  Update the [org/gnome/desktop/media-handling] sectio... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258017r1045088_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent a user from overriding the disabling of the graphical user - (SV-258017r1045088_rule)"
      tags:
        - stig
        - SV-258017r1045088_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258017r1045088_rule: RHEL 9 must prevent a user from overriding the disabling of the graphical user - Configure the GNOME desktop to not allow a user to change the setting that disables autorun on removable media.  Add the following line to "/etc/dconf/db/local.d/locks/00-security-settings-lock" to pr... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258018r1045090_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must not allow unattended or automatic logon via the graphical user - (SV-258018r1045090_rule)"
      tags:
        - stig
        - SV-258018r1045090_rule
        - config
        - severity_high
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258018r1045090_rule: RHEL 9 must not allow unattended or automatic logon via the graphical user - Configure the GNOME desktop display manager to disable automatic login.  Set AutomaticLoginEnable to false in the [daemon] section in /etc/gdm/custom.conf. For example:  [daemon] AutomaticLoginEnable=... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258019r1045092_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must be able to initiate directly a session lock for all connection - (SV-258019r1045092_rule)"
      tags:
        - stig
        - SV-258019r1045092_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258019r1045092_rule: RHEL 9 must be able to initiate directly a session lock for all connection - Configure RHEL 9 to enable a user's session lock until that user re-establishes access using established identification and authentication procedures.  Select or create an authselect profile and incor... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258020r1045094_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent a user from overriding the disabling of the graphical user - (SV-258020r1045094_rule)"
      tags:
        - stig
        - SV-258020r1045094_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258020r1045094_rule: RHEL 9 must prevent a user from overriding the disabling of the graphical user - Add the following line to "/etc/dconf/db/local.d/locks/00-security-settings-lock" to prevent user override of the smart card removal action:  /org/gnome/settings-daemon/peripherals/smartcard/removal-a... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258021r1015088_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must enable a user session lock until that user re-establishes access - (SV-258021r1015088_rule)"
      tags:
        - stig
        - SV-258021r1015088_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258021r1015088_rule: RHEL 9 must enable a user session lock until that user re-establishes access - Configure RHEL 9 to enable a user's session lock until that user re-establishes access using established identification and authentication procedures.  Create a database to contain the system-wide scr... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258022r1045097_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent a user from overriding the screensaver lock-enabled setting - (SV-258022r1045097_rule)"
      tags:
        - stig
        - SV-258022r1045097_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258022r1045097_rule: RHEL 9 must prevent a user from overriding the screensaver lock-enabled setting - Configure RHEL 9 to prevent a user from overriding settings for graphical user interfaces.  Create a database to contain the systemwide screensaver settings (if it does not already exist) with the fol... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258023r958402_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must automatically lock graphical user sessions after 15 minutes of - (SV-258023r958402_rule)"
      tags:
        - stig
        - SV-258023r958402_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258023r958402_rule: RHEL 9 must automatically lock graphical user sessions after 15 minutes of - Configure RHEL 9 to initiate a screensaver after a 15-minute period of inactivity for graphical user interfaces.  Create a database to contain the system-wide screensaver settings (if it does not alre... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258024r1045100_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent a user from overriding the session idle-delay setting for - (SV-258024r1045100_rule)"
      tags:
        - stig
        - SV-258024r1045100_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258024r1045100_rule: RHEL 9 must prevent a user from overriding the session idle-delay setting for - Configure RHEL 9 to prevent a user from overriding settings for graphical user interfaces.  Create a database to contain the systemwide screensaver settings (if it does not already exist) with the fol... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258025r958402_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must initiate a session lock for graphical user interfaces when the - (SV-258025r958402_rule)"
      tags:
        - stig
        - SV-258025r958402_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258025r958402_rule: RHEL 9 must initiate a session lock for graphical user interfaces when the - Configure RHEL 9 to initiate a session lock for graphical user interfaces when a screensaver is activated.  Create a database to contain the system-wide screensaver settings (if it does not already ex... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258026r1045103_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent a user from overriding the session lock-delay setting for - (SV-258026r1045103_rule)"
      tags:
        - stig
        - SV-258026r1045103_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258026r1045103_rule: RHEL 9 must prevent a user from overriding the session lock-delay setting for - Configure RHEL 9 to prevent a user from overriding settings for graphical user interfaces.  Create a database to contain the systemwide screensaver settings (if it does not already exist) with the fol... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258027r1045106_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must conceal, via the session lock, information previously visible on - (SV-258027r1045106_rule)"
      tags:
        - stig
        - SV-258027r1045106_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258027r1045106_rule: RHEL 9 must conceal, via the session lock, information previously visible on - Configure RHEL 9 to prevent a user from overriding the picture-uri setting for graphical user interfaces.  In the file "/etc/dconf/db/local.d/00-security-settings", add or update the following lines: ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258028r991589_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 effective dconf policy must match the policy keyfiles - (SV-258028r991589_rule)"
      tags:
        - stig
        - SV-258028r991589_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258028r991589_rule: RHEL 9 effective dconf policy must match the policy keyfiles - Update the dconf databases by running the following command:  $ sudo dconf update Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258029r1045109_rule | Automation: automated via SCAP
    - name: "RHEL 9 must disable the ability of a user to restart the system from the login - (SV-258029r1045109_rule) - Configure dconf setting"
      ansible.builtin.copy:
        dest: /etc/dconf/db/local.d/00-stig-disable_restart_buttons
        content: |
          [org.gnome.login-screen]
          disable-restart-buttons=true
        mode: '0644'
      notify: Update dconf database

    - name: "RHEL 9 must disable the ability of a user to restart the system from the login - (SV-258029r1045109_rule) - Lock dconf setting"
      tags:
        - stig
        - SV-258029r1045109_rule
        - dconf
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.copy:
        dest: /etc/dconf/db/local.d/locks/disable_restart_buttons
        content: |
          /org.gnome.login-screen/disable-restart-buttons
        mode: '0644'
      notify: Update dconf database


    # STIG ID: SV-258030r1045112_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent a user from overriding the disable-restart-buttons setting - (SV-258030r1045112_rule)"
      tags:
        - stig
        - SV-258030r1045112_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258030r1045112_rule: RHEL 9 must prevent a user from overriding the disable-restart-buttons setting - Configure RHEL 9 to prevent a user from overriding the disable-restart-buttons setting for graphical user interfaces.   Create a database to contain the systemwide graphical user logon settings (if it... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258031r1134920_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must disable the ability of a user to accidentally press Ctrl-Alt-Del - (SV-258031r1134920_rule)"
      tags:
        - stig
        - SV-258031r1134920_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258031r1134920_rule: RHEL 9 must disable the ability of a user to accidentally press Ctrl-Alt-Del - Configure RHEL 9 to ignore the Ctrl-Alt-Del sequence in the GNOME desktop.  Run the following command to set the media-keys logout setting:  $ gsettings set org.gnome.settings-daemon.plugins.media-key... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258032r1045117_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent a user from overriding the Ctrl-Alt-Del sequence settings - (SV-258032r1045117_rule)"
      tags:
        - stig
        - SV-258032r1045117_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258032r1045117_rule: RHEL 9 must prevent a user from overriding the Ctrl-Alt-Del sequence settings - Configure RHEL 9 to disallow the user changing the Ctrl-Alt-Del sequence in the GNOME desktop.  Create a database to contain the systemwide graphical user logon settings (if it does not already exist)... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258033r1045120_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must disable the user list at logon for graphical user interfaces - (SV-258033r1045120_rule)"
      tags:
        - stig
        - SV-258033r1045120_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258033r1045120_rule: RHEL 9 must disable the user list at logon for graphical user interfaces - Configure RHEL 9 to disable the user list at logon for graphical user interfaces.  Create a database to contain the systemwide screensaver settings (if it does not already exist) with the following co... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258034r1051267_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must be configured to disable USB mass storage - (SV-258034r1051267_rule)"
      tags:
        - stig
        - SV-258034r1051267_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258034r1051267_rule: RHEL 9 must be configured to disable USB mass storage - To configure the system to prevent the usb-storage kernel module from being loaded, add the following lines to the file "/etc/modprobe.d/usb-storage.conf" (or create "usb-storage.conf" if it does not ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258035r1045125_rule | Automation: automated via SCAP
    - name: "Ensure usbguard.service is enable - (SV-258035r1045125_rule)"
      tags:
        - stig
        - SV-258035r1045125_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: usbguard.service
        enabled: yes


    # STIG ID: SV-258036r1014861_rule | Automation: automated via SCAP
    - name: "Ensure usbguard.service is enable_and_start - (SV-258036r1014861_rule)"
      tags:
        - stig
        - SV-258036r1014861_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: usbguard.service
        enabled: yes
        state: started


    # STIG ID: SV-258037r1014863_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must enable Linux audit logging for the USBGuard daemon - (SV-258037r1014863_rule)"
      tags:
        - stig
        - SV-258037r1014863_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258037r1014863_rule: RHEL 9 must enable Linux audit logging for the USBGuard daemon - Configure RHEL 9 USBGuard AuditBackend to use the audit system.  Add or edit the following line in /etc/usbguard/usbguard-daemon.conf   AuditBackend=LinuxAudit Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258038r1045128_rule | Automation: automated via SCAP
    - name: "RHEL 9 must block unauthorized peripherals before establishing a connection - (SV-258038r1045128_rule)"
      tags:
        - stig
        - SV-258038r1045128_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/usbguard/rules.conf
        mode: '0001'
        state: file


    # STIG ID: SV-258039r1045131_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 Bluetooth must be disabled - (SV-258039r1045131_rule)"
      tags:
        - stig
        - SV-258039r1045131_rule
        - package_present
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258039r1045131_rule: RHEL 9 Bluetooth must be disabled - Configure RHEL 9 to disable the Bluetooth adapter when not in use.  Create or modify the "/etc/modprobe.d/bluetooth.conf" file with the following lines:  install bluetooth /bin/false blacklist bluetoo... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258040r991568_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 wireless network adapters must be disabled - (SV-258040r991568_rule)"
      tags:
        - stig
        - SV-258040r991568_rule
        - package_absent
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258040r991568_rule: RHEL 9 wireless network adapters must be disabled - Configure the system to disable all wireless network interfaces with the following command:  $ nmcli radio all off Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258041r1038967_rule | Automation: automated via SCAP
    - name: "RHEL 9 user account passwords for new users or password changes must have a - (SV-258041r1038967_rule)"
      tags:
        - stig
        - SV-258041r1038967_rule
        - config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/login.defs
        line: 'PASS_MAX_DAYS 60'
        regexp: '^#?\s*PASS_MAX_DAYS\s+'
        create: yes
        backup: yes


    # STIG ID: SV-258042r1045133_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 user account passwords must have a 60-day maximum password lifetime - (SV-258042r1045133_rule)"
      tags:
        - stig
        - SV-258042r1045133_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258042r1045133_rule: RHEL 9 user account passwords must have a 60-day maximum password lifetime - Configure noncompliant accounts to enforce a 60-day maximum password lifetime restriction.  passwd -x 60 [user] Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258043r991589_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 9 local interactive user accounts must be assigned a home directory - (SV-258043r991589_rule)"
      tags:
        - stig
        - SV-258043r991589_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258043r991589_rule: All RHEL 9 local interactive user accounts must be assigned a home directory - Configure RHEL 9 to assign home directories to all new local interactive users by setting the "CREATE_HOME" parameter in "/etc/login.defs" to "yes" as follows.  CREATE_HOME yes Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258044r1045135_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must set the umask value to 077 for all local interactive user accounts - (SV-258044r1045135_rule)"
      tags:
        - stig
        - SV-258044r1045135_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258044r1045135_rule: RHEL 9 must set the umask value to 077 for all local interactive user accounts - Remove the umask statement from all local interactive user's initialization files.   If the account is for an application, the requirement for a umask less restrictive than "077" can be documented wit... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258045r958482_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 duplicate User IDs (UIDs) must not exist for interactive users - (SV-258045r958482_rule)"
      tags:
        - stig
        - SV-258045r958482_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258045r958482_rule: RHEL 9 duplicate User IDs (UIDs) must not exist for interactive users - Edit the file "/etc/passwd" and provide each interactive user account that has a duplicate UID with a unique UID. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258046r991589_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 system accounts must not have an interactive login shell - (SV-258046r991589_rule)"
      tags:
        - stig
        - SV-258046r991589_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258046r991589_rule: RHEL 9 system accounts must not have an interactive login shell - Configure RHEL 9 so that all noninteractive accounts on the system do not have an interactive shell assigned to them.  If the system account needs a shell assigned for mission operations, document the... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258047r1101951_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must automatically expire temporary accounts within 72 hours - (SV-258047r1101951_rule)"
      tags:
        - stig
        - SV-258047r1101951_rule
        - other
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258047r1101951_rule: RHEL 9 must automatically expire temporary accounts within 72 hours - Configure the operating system to expire temporary accounts after 72 hours with the following command:  $ sudo chage -E $(date -d +3days +%Y-%m-%d) <temporary_account_name> Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258048r1069380_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 9 interactive users must have a primary group that exists - (SV-258048r1069380_rule)"
      tags:
        - stig
        - SV-258048r1069380_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258048r1069380_rule: All RHEL 9 interactive users must have a primary group that exists - Configure the system so that all GIDs are referenced in "/etc/passwd" are defined in "/etc/group".  Edit the file "/etc/passwd" and ensure that every user's GID is a valid GID. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258049r1015092_rule | Automation: automated via SCAP
    - name: "RHEL 9 must disable account identifiers (individuals, groups, roles, and - (SV-258049r1015092_rule)"
      tags:
        - stig
        - SV-258049r1015092_rule
        - config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/default/useradd
        line: 'INACTIVE=35'
        regexp: '^#?\s*INACTIVE\s*='
        create: yes
        backup: yes


    # STIG ID: SV-258050r1045137_rule | Automation: manual-only (not covered by scap)
    - name: "Executable search paths within the initialization files of all local - (SV-258050r1045137_rule)"
      tags:
        - stig
        - SV-258050r1045137_rule
        - other
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258050r1045137_rule: Executable search paths within the initialization files of all local - Edit the local interactive user initialization files to change any PATH variable statements that reference directories other than their home directory.  If a local interactive user requires path varia... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258051r991589_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 9 local interactive users must have a home directory assigned in the - (SV-258051r991589_rule)"
      tags:
        - stig
        - SV-258051r991589_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258051r991589_rule: All RHEL 9 local interactive users must have a home directory assigned in the - Create and assign home directories to all local interactive users on RHEL 9 that currently do not have a home directory assigned. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258052r991589_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 9 local interactive user home directories defined in the /etc/passwd - (SV-258052r991589_rule)"
      tags:
        - stig
        - SV-258052r991589_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258052r991589_rule: All RHEL 9 local interactive user home directories defined in the /etc/passwd - Create home directories to all local interactive users that currently do not have a home directory assigned. Use the following commands to create the user home directory assigned in "/etc/ passwd":  N... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258053r991589_rule | Automation: manual-only (not covered by scap)
    - name: "All RHEL 9 local interactive user home directories must be group-owned by the - (SV-258053r991589_rule)"
      tags:
        - stig
        - SV-258053r991589_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258053r991589_rule: All RHEL 9 local interactive user home directories must be group-owned by the - Change the group owner of a local interactive user's home directory to the group found in "/etc/passwd". To change the group owner of a local interactive user's home directory, use the following comma... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258054r958736_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must automatically lock an account when three unsuccessful logon - (SV-258054r958736_rule)"
      tags:
        - stig
        - SV-258054r958736_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258054r958736_rule: RHEL 9 must automatically lock an account when three unsuccessful logon - Configure RHEL 9 to lock an account when three unsuccessful logon attempts occur.  Add/modify the "/etc/security/faillock.conf" file to match the following line:  deny = 3 Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258055r1045140_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must automatically lock the root account until the root account is - (SV-258055r1045140_rule)"
      tags:
        - stig
        - SV-258055r1045140_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258055r1045140_rule: RHEL 9 must automatically lock the root account until the root account is - To configure RHEL 9 to lock out the "root" account after a number of incorrect logon attempts using "pam_faillock.so", first enable the feature using the following command:   $ sudo authselect enable-... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258056r1045143_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must automatically lock an account when three unsuccessful logon - (SV-258056r1045143_rule)"
      tags:
        - stig
        - SV-258056r1045143_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258056r1045143_rule: RHEL 9 must automatically lock an account when three unsuccessful logon - To configure RHEL 9 to lock out the "root" account after a number of incorrect logon attempts within 15 minutes using "pam_faillock.so", enable the feature using the following command:   $ sudo authse... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258057r1045146_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must maintain an account lock until the locked account is released by an - (SV-258057r1045146_rule)"
      tags:
        - stig
        - SV-258057r1045146_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258057r1045146_rule: RHEL 9 must maintain an account lock until the locked account is released by an - Configure RHEL 9 to lock an account until released by an administrator after three unsuccessful logon attempts with the command:   $ sudo authselect enable-feature with-faillock    Edit the "/etc/secu... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258058r1045148_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must not have unauthorized accounts - (SV-258058r1045148_rule)"
      tags:
        - stig
        - SV-258058r1045148_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258058r1045148_rule: RHEL 9 must not have unauthorized accounts - Remove unauthorized local interactive user accounts with the following command where <unauthorized_user> is the unauthorized account:  $ sudo userdel  <unauthorized_user> Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258059r991589_rule | Automation: manual-only (not covered by scap)
    - name: "The root account must be the only account having unrestricted access to RHEL 9 - (SV-258059r991589_rule)"
      tags:
        - stig
        - SV-258059r991589_rule
        - config
        - severity_high
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258059r991589_rule: The root account must be the only account having unrestricted access to RHEL 9 - Change the UID of any account on the system, other than root, that has a UID of "0".   If the account is associated with system commands or applications, the UID should be changed to one greater than ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258060r1045150_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must ensure account lockouts persist - (SV-258060r1045150_rule)"
      tags:
        - stig
        - SV-258060r1045150_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258060r1045150_rule: RHEL 9 must ensure account lockouts persist - Configure RHEL 9 maintain the contents of the faillock directory after a reboot.  Add/modify the "/etc/security/faillock.conf" file to match the following line:  dir = /var/log/faillock Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258061r958482_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 groups must have unique Group ID (GID) - (SV-258061r958482_rule)"
      tags:
        - stig
        - SV-258061r958482_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258061r958482_rule: RHEL 9 groups must have unique Group ID (GID) - Edit the file "/etc/group" and provide each group that has a duplicate GID with a unique GID. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258062r991589_rule | Automation: manual-only (not covered by scap)
    - name: "Local RHEL 9 initialization files must not execute world-writable programs - (SV-258062r991589_rule)"
      tags:
        - stig
        - SV-258062r991589_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258062r991589_rule: Local RHEL 9 initialization files must not execute world-writable programs - Set the mode on files being executed by the local initialization files with the following command:  $ sudo chmod 0755 <file> Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258068r1101950_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must automatically exit interactive command shell user sessions after 10 - (SV-258068r1101950_rule)"
      tags:
        - stig
        - SV-258068r1101950_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258068r1101950_rule: RHEL 9 must automatically exit interactive command shell user sessions after 10 - Configure RHEL 9 to exit interactive command shell user sessions after 10 minutes of inactivity.  Add or edit the following line in "/etc/profile.d/tmout.sh":  #!/bin/bash  declare -xr TMOUT=600 Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258069r958398_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must limit the number of concurrent sessions to ten for all accounts - (SV-258069r958398_rule)"
      tags:
        - stig
        - SV-258069r958398_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258069r958398_rule: RHEL 9 must limit the number of concurrent sessions to ten for all accounts - Configure RHEL 9 to limit the number of concurrent sessions to "10" for all accounts and/or account types.  Add the following line to the top of the /etc/security/limits.conf or in a ".conf" file defi... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258070r1045153_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must log username information when unsuccessful logon attempts occur - (SV-258070r1045153_rule)"
      tags:
        - stig
        - SV-258070r1045153_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258070r1045153_rule: RHEL 9 must log username information when unsuccessful logon attempts occur - Configure RHEL 9 to log username information when unsuccessful logon attempts occur.  Enable the feature using the following command:   $ sudo authselect enable-feature with-faillock    Add/modify the... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258071r991588_rule | Automation: automated via SCAP
    - name: "RHEL 9 must enforce a delay of at least four seconds between logon prompts - (SV-258071r991588_rule)"
      tags:
        - stig
        - SV-258071r991588_rule
        - config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/login.defs
        line: 'FAIL_DELAY 4'
        regexp: '^#?\s*FAIL_DELAY\s+'
        create: yes
        backup: yes


    # STIG ID: SV-258072r1045155_rule | Automation: automated via SCAP
    - name: "RHEL 9 must define default permissions for the bash shell - (SV-258072r1045155_rule)"
      tags:
        - stig
        - SV-258072r1045155_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/bashrc
        mode: '077'
        state: file


    # STIG ID: SV-258073r1045157_rule | Automation: automated via SCAP
    - name: "RHEL 9 must define default permissions for the c shell - (SV-258073r1045157_rule)"
      tags:
        - stig
        - SV-258073r1045157_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/csh.cshrc
        mode: '077'
        state: file


    # STIG ID: SV-258074r991590_rule | Automation: automated via SCAP
    - name: "RHEL 9 must define default permissions for all authenticated users in such a - (SV-258074r991590_rule)"
      tags:
        - stig
        - SV-258074r991590_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/login.defs
        mode: '077'
        state: file


    # STIG ID: SV-258075r991590_rule | Automation: automated via SCAP
    - name: "RHEL 9 must define default permissions for the system default profile - (SV-258075r991590_rule)"
      tags:
        - stig
        - SV-258075r991590_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/profile
        mode: '077'
        state: file


    # STIG ID: SV-258076r991589_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must display the date and time of the last successful account logon upon - (SV-258076r991589_rule)"
      tags:
        - stig
        - SV-258076r991589_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258076r991589_rule: RHEL 9 must display the date and time of the last successful account logon upon - Configure RHEL 9 to provide users with feedback on when account accesses last occurred by setting the required configuration options in "/etc/pam.d/postlogin".   Add the following line to the top of "... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258077r1014874_rule | Automation: automated via SCAP
    - name: "Ensure systemd-logind.service is restart - (SV-258077r1014874_rule)"
      tags:
        - stig
        - SV-258077r1014874_rule
        - service_disabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: systemd-logind.service
        state: restarted


    # STIG ID: SV-258078r958944_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must use a Linux Security Module configured to enforce limits on system - (SV-258078r958944_rule)"
      tags:
        - stig
        - SV-258078r958944_rule
        - service_disabled
        - severity_high
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258078r958944_rule: RHEL 9 must use a Linux Security Module configured to enforce limits on system - Configure RHEL 9 to verify correct operation of security functions.  Edit the file "/etc/selinux/config" and add or modify the following line:   SELINUX=enforcing   A reboot is required for the change... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258079r1045159_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must enable the SELinux targeted policy - (SV-258079r1045159_rule)"
      tags:
        - stig
        - SV-258079r1045159_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258079r1045159_rule: RHEL 9 must enable the SELinux targeted policy - Configure RHEL 9 to use the targetd SELINUX policy.  Edit the file "/etc/selinux/config" and add or modify the following line:   SELINUXTYPE=targeted   A reboot is required for the changes to take eff... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258080r1045162_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must configure SELinux context type to allow the use of a nondefault - (SV-258080r1045162_rule)"
      tags:
        - stig
        - SV-258080r1045162_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258080r1045162_rule: RHEL 9 must configure SELinux context type to allow the use of a nondefault - Configure RHEL 9 to allow the use of a nondefault faillock tally directory while SELinux enforces a targeted policy.   First enable the feature using the following command:   $ sudo authselect enable-... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258081r1045164_rule | Automation: automated via SCAP
    - name: "RHEL 9 must have policycoreutils package installed - (SV-258081r1045164_rule)"
      tags:
        - stig
        - SV-258081r1045164_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: policycoreutils
        state: absent


    # STIG ID: SV-258082r1045166_rule | Automation: automated via SCAP
    - name: "Ensure package is enabled and running - (SV-258082r1045166_rule)"
      tags:
        - stig
        - SV-258082r1045166_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: package
        enabled: yes
        state: started


    # STIG ID: SV-258083r1045168_rule | Automation: automated via SCAP
    - name: "RHEL 9 must have the sudo package installed - (SV-258083r1045168_rule)"
      tags:
        - stig
        - SV-258083r1045168_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: sudo
        state: absent


    # STIG ID: SV-258084r1050789_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must require reauthentication when using the \"sudo\" command - (SV-258084r1050789_rule)"
      tags:
        - stig
        - SV-258084r1050789_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258084r1050789_rule: RHEL 9 must require reauthentication when using the "sudo" command - Configure RHEL 9 to reauthenticate "sudo" commands after the specified timeout:  Add the following line to "/etc/sudoers" or a file in "/etc/sudoers.d":  Defaults timestamp_timeout=0 Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258085r1045173_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must use the invoking user's password for privilege escalation when - (SV-258085r1045173_rule)"
      tags:
        - stig
        - SV-258085r1045173_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258085r1045173_rule: RHEL 9 must use the invoking user's password for privilege escalation when - Define the following in the Defaults section of the /etc/sudoers file or a single configuration file in the /etc/sudoers.d/ directory:  Defaults !targetpw Defaults !rootpw Defaults !runaspw Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258086r1102063_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must require users to reauthenticate for privilege escalation - (SV-258086r1102063_rule)"
      tags:
        - stig
        - SV-258086r1102063_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258086r1102063_rule: RHEL 9 must require users to reauthenticate for privilege escalation - Configure RHEL 9 to not allow users to execute privileged actions without authenticating.  Remove any occurrence of "!authenticate" found in "/etc/sudoers" file or files in the "/etc/sudoers.d" direct... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258087r1102071_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must restrict privilege elevation to authorized personnel - (SV-258087r1102071_rule)"
      tags:
        - stig
        - SV-258087r1102071_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258087r1102071_rule: RHEL 9 must restrict privilege elevation to authorized personnel - Remove the following entries from the /etc/sudoers file or configuration file under /etc/sudoers.d/:  ALL     ALL=(ALL) ALL ALL     ALL=(ALL:ALL) ALL Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258088r1050789_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must restrict the use of the \"su\" command - (SV-258088r1050789_rule)"
      tags:
        - stig
        - SV-258088r1050789_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258088r1050789_rule: RHEL 9 must restrict the use of the "su" command - Configure RHEL 9 to require users to be in the "wheel" group to run "su" command.  In file "/etc/pam.d/su", uncomment the following line:  "#auth    required    pam_wheel.so use_uid"  $ sed '/^[[:spac... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258089r1045179_rule | Automation: automated via SCAP
    - name: "RHEL 9 fapolicy module must be installed - (SV-258089r1045179_rule)"
      tags:
        - stig
        - SV-258089r1045179_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: fapolicyd
        state: absent


    # STIG ID: SV-258090r958808_rule | Automation: automated via SCAP
    - name: "Ensure fapolicyd.service is enable_and_start - (SV-258090r958808_rule)"
      tags:
        - stig
        - SV-258090r958808_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: fapolicyd.service
        enabled: yes
        state: started


    # STIG ID: SV-258091r1045185_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must ensure the password complexity module in the system-auth file is - (SV-258091r1045185_rule)"
      tags:
        - stig
        - SV-258091r1045185_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258091r1045185_rule: RHEL 9 must ensure the password complexity module in the system-auth file is - Configure RHEL 9 to limit the "pwquality" retry option to "3".  Add or update the following line in the "/etc/security/pwquality.conf" file or a file in the "/etc/security/pwquality.conf.d/" directory... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258094r1045187_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must not allow blank or null passwords - (SV-258094r1045187_rule)"
      tags:
        - stig
        - SV-258094r1045187_rule
        - config
        - severity_high
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258094r1045187_rule: RHEL 9 must not allow blank or null passwords - If PAM is managed with authselect, use the following command to remove instances of "nullok":   $ sudo authselect enable-feature without-nullok  Otherwise, remove any instances of the "nullok" option ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258095r1045189_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must configure the use of the pam_faillock.so module in the - (SV-258095r1045189_rule)"
      tags:
        - stig
        - SV-258095r1045189_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258095r1045189_rule: RHEL 9 must configure the use of the pam_faillock.so module in the - Configure RHEL 9 to include the use of the pam_faillock.so module in the /etc/pam.d/system-auth file.   If PAM is managed with authselect, enable the feature with the following command:   $ sudo auths... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258096r1045191_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must configure the use of the pam_faillock.so module in the - (SV-258096r1045191_rule)"
      tags:
        - stig
        - SV-258096r1045191_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258096r1045191_rule: RHEL 9 must configure the use of the pam_faillock.so module in the - Configure RHEL 9 to include the use of the pam_faillock.so module in the /etc/pam.d/password-auth file. If PAM is managed with authselect, enable the feature with the following command:   $ sudo auths... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258097r1045193_rule | Automation: automated via SCAP
    - name: "RHEL 9 must ensure the password complexity module is enabled in the - (SV-258097r1045193_rule)"
      tags:
        - stig
        - SV-258097r1045193_rule
        - config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.blockinfile:
        path: /etc/pam.d/password-auth
        block: |
          line to the "/etc/pam.d/password-auth" file (or mod
        marker: '# {mark} ANSIBLE MANAGED BLOCK'
        create: yes
        backup: yes


    # STIG ID: SV-258098r1045195_rule | Automation: automated via SCAP
    - name: "RHEL 9 must ensure the password complexity module is enabled in the system-auth - (SV-258098r1045195_rule)"
      tags:
        - stig
        - SV-258098r1045195_rule
        - config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.blockinfile:
        path: /etc/pam.d/system-auth
        block: |
          line to the "/etc/pam.d/system-auth" file(or mod
        marker: '# {mark} ANSIBLE MANAGED BLOCK'
        create: yes
        backup: yes


    # STIG ID: SV-258099r1045198_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 password-auth must be configured to use a sufficient number of hashing - (SV-258099r1045198_rule)"
      tags:
        - stig
        - SV-258099r1045198_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258099r1045198_rule: RHEL 9 password-auth must be configured to use a sufficient number of hashing - Configure RHEL 9 to use 100000 hashing rounds for hashing passwords.  Add or modify the following line in "/etc/pam.d/password-auth" and set "rounds" to "100000".  password sufficient pam_unix.so sha5... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258100r1045201_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 system-auth must be configured to use a sufficient number of hashing - (SV-258100r1045201_rule)"
      tags:
        - stig
        - SV-258100r1045201_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258100r1045201_rule: RHEL 9 system-auth must be configured to use a sufficient number of hashing - Configure RHEL 9 to use 100000 hashing rounds for hashing passwords.  Add or modify the following line in "/etc/pam.d/system-auth" and set "rounds" to 100000.  password sufficient pam_unix.so sha512 r... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258101r1045204_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must enforce password complexity rules for the root account - (SV-258101r1045204_rule)"
      tags:
        - stig
        - SV-258101r1045204_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258101r1045204_rule: RHEL 9 must enforce password complexity rules for the root account - Configure RHEL 9 to enforce password complexity on the root account.  Add or update the following line in the "/etc/security/pwquality.conf" file or a configuration file in the "/etc/security/pwqualit... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258102r1045207_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must enforce password complexity by requiring that at least one - (SV-258102r1045207_rule)"
      tags:
        - stig
        - SV-258102r1045207_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258102r1045207_rule: RHEL 9 must enforce password complexity by requiring that at least one - Configure RHEL 9 to enforce password complexity by requiring at least one lowercase character be used by setting the "lcredit" option.  Add or update the following line in the "/etc/security/pwquality... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258103r1045210_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must enforce password complexity by requiring that at least one numeric - (SV-258103r1045210_rule)"
      tags:
        - stig
        - SV-258103r1045210_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258103r1045210_rule: RHEL 9 must enforce password complexity by requiring that at least one numeric - Configure RHEL 9 to enforce password complexity by requiring at least one numeric character be used by setting the "dcredit" option.  Add or update the following line in the "/etc/security/pwquality.c... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258104r1015104_rule | Automation: automated via SCAP
    - name: "RHEL 9 passwords for new users or password changes must have a 24 hours minimum - (SV-258104r1015104_rule)"
      tags:
        - stig
        - SV-258104r1015104_rule
        - config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/login.defs
        line: 'PASS_MIN_DAYS 1'
        regexp: '^#?\s*PASS_MIN_DAYS\s+'
        create: yes
        backup: yes


    # STIG ID: SV-258105r1045212_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 passwords must have a 24 hours minimum password lifetime restriction in - (SV-258105r1045212_rule)"
      tags:
        - stig
        - SV-258105r1045212_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258105r1045212_rule: RHEL 9 passwords must have a 24 hours minimum password lifetime restriction in - Configure noncompliant accounts to enforce a 24 hour minimum password lifetime:  $ sudo passwd -n 1 [user] Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258106r1102061_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must require users to provide a password for privilege escalation - (SV-258106r1102061_rule)"
      tags:
        - stig
        - SV-258106r1102061_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258106r1102061_rule: RHEL 9 must require users to provide a password for privilege escalation - Configure RHEL 9 to not allow users to execute privileged actions without authenticating with a password.  Remove any occurrence of "NOPASSWD" found in "/etc/sudoers" file or files in the "/etc/sudoer... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258107r1045218_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 passwords must be created with a minimum of 15 characters - (SV-258107r1045218_rule)"
      tags:
        - stig
        - SV-258107r1045218_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258107r1045218_rule: RHEL 9 passwords must be created with a minimum of 15 characters - Configure RHEL 9 to enforce a minimum 15-character password length.  Add or update the following line in the "/etc/security/pwquality.conf" file or a configuration file in the "/etc/security/pwquality... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258109r1045220_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must enforce password complexity by requiring that at least one special - (SV-258109r1045220_rule)"
      tags:
        - stig
        - SV-258109r1045220_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258109r1045220_rule: RHEL 9 must enforce password complexity by requiring that at least one special - Configure RHEL 9 to enforce password complexity by requiring at least one special character be used by setting the "ocredit" option.  Add or update the following line in the "/etc/security/pwquality.c... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258110r1045223_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prevent the use of dictionary words for passwords - (SV-258110r1045223_rule)"
      tags:
        - stig
        - SV-258110r1045223_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258110r1045223_rule: RHEL 9 must prevent the use of dictionary words for passwords - Configure RHEL 9 to prevent the use of dictionary words for passwords.  Add or update the following line in the "/etc/security/pwquality.conf" file or a configuration file in the "/etc/security/pwqual... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258111r1045226_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must enforce password complexity by requiring that at least one - (SV-258111r1045226_rule)"
      tags:
        - stig
        - SV-258111r1045226_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258111r1045226_rule: RHEL 9 must enforce password complexity by requiring that at least one - Configure RHEL 9 to enforce password complexity by requiring that at least one uppercase character be used by setting the "ucredit" option.  Add or update the following line in the "/etc/security/pwqu... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258112r1045229_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must require the change of at least eight characters when passwords are - (SV-258112r1045229_rule)"
      tags:
        - stig
        - SV-258112r1045229_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258112r1045229_rule: RHEL 9 must require the change of at least eight characters when passwords are - Configure RHEL 9 to require the change of at least eight of the total number of characters when passwords are changed by setting the "difok" option.  Add or update the following line in the "/etc/secu... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258113r1045232_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must require the maximum number of repeating characters of the same - (SV-258113r1045232_rule)"
      tags:
        - stig
        - SV-258113r1045232_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258113r1045232_rule: RHEL 9 must require the maximum number of repeating characters of the same - Configure RHEL 9 to require the change of the number of repeating characters of the same character class when passwords are changed by setting the "maxclassrepeat" option.  Add or update the following... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258114r1045235_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must require the maximum number of repeating characters be limited to - (SV-258114r1045235_rule)"
      tags:
        - stig
        - SV-258114r1045235_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258114r1045235_rule: RHEL 9 must require the maximum number of repeating characters be limited to - Configure RHEL 9 to require the change of the number of repeating consecutive characters when passwords are changed by setting the "maxrepeat" option.  Add or update the following line in the "/etc/se... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258115r1045238_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must require the change of at least four character classes when - (SV-258115r1045238_rule)"
      tags:
        - stig
        - SV-258115r1045238_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258115r1045238_rule: RHEL 9 must require the change of at least four character classes when - Configure RHEL 9 to require the change of at least four character classes when passwords are changed by setting the "minclass" option.  Add or update the following line in the "/etc/security/pwquality... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258116r1045240_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must be configured so that user and group account administration - (SV-258116r1045240_rule)"
      tags:
        - stig
        - SV-258116r1045240_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258116r1045240_rule: RHEL 9 must be configured so that user and group account administration - Configure RHEL 9 to use the SHA-512 algorithm for password hashing.  Add or change the following line in the "[defaults]" section of "/etc/libuser.conf" file:  crypt_style = sha512 Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258117r1015116_rule | Automation: automated via SCAP
    - name: "RHEL 9 must be configured to use the shadow file to store only encrypted - (SV-258117r1015116_rule)"
      tags:
        - stig
        - SV-258117r1015116_rule
        - config
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/login.defs
        line: 'ENCRYPT_METHOD SHA512'
        regexp: '^#?\s*ENCRYPT_METHOD\s+'
        create: yes
        backup: yes


    # STIG ID: SV-258118r1050789_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must not be configured to bypass password requirements for privilege - (SV-258118r1050789_rule)"
      tags:
        - stig
        - SV-258118r1050789_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258118r1050789_rule: RHEL 9 must not be configured to bypass password requirements for privilege - Configure the operating system to require users to supply a password for privilege escalation.  Remove any occurrences of " pam_succeed_if " in the  "/etc/pam.d/sudo" file. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258120r991589_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must not have accounts configured with blank or null passwords - (SV-258120r991589_rule)"
      tags:
        - stig
        - SV-258120r991589_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258120r991589_rule: RHEL 9 must not have accounts configured with blank or null passwords - Configure all accounts on RHEL 9 to have a password or lock the account with the following commands:  Perform a password reset:  $ sudo passwd [username]   To lock an account:  $ sudo passwd -l [usern... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258121r1102086_rule | Automation: automated via SCAP
    - name: "Ensure pcscd.service is restart - (SV-258121r1102086_rule)"
      tags:
        - stig
        - SV-258121r1102086_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: pcscd.service
        state: restarted


    # STIG ID: SV-258122r1045246_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must enable certificate based smart card authentication - (SV-258122r1045246_rule)"
      tags:
        - stig
        - SV-258122r1045246_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258122r1045246_rule: RHEL 9 must enable certificate based smart card authentication - Edit the file "/etc/sssd/sssd.conf" or a configuration file in "/etc/sssd/conf.d" and add or edit the following line:  pam_cert_auth = True Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258123r1134923_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must implement certificate status checking for multifactor authentication - (SV-258123r1134923_rule)"
      tags:
        - stig
        - SV-258123r1134923_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258123r1134923_rule: RHEL 9 must implement certificate status checking for multifactor authentication - Configure RHEL 9 to implement certificate status checking for multifactor authentication.  Review the "/etc/sssd/conf.d/certificate_verification.conf" file to determine if the system is configured to ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258124r1045250_rule | Automation: automated via SCAP
    - name: "RHEL 9 must have the pcsc-lite package installed - (SV-258124r1045250_rule)"
      tags:
        - stig
        - SV-258124r1045250_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: pcsc-lite
        state: absent


    # STIG ID: SV-258125r1045253_rule | Automation: automated via SCAP
    - name: "Ensure pcscd.socket is enable_and_start - (SV-258125r1045253_rule)"
      tags:
        - stig
        - SV-258125r1045253_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: pcscd.socket
        enabled: yes
        state: started


    # STIG ID: SV-258126r1045255_rule | Automation: automated via SCAP
    - name: "RHEL 9 must have the opensc package installed - (SV-258126r1045255_rule)"
      tags:
        - stig
        - SV-258126r1045255_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: opensc
        state: absent


    # STIG ID: SV-258127r1134925_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9, for PKI-based authentication, must enforce authorized access to the - (SV-258127r1134925_rule)"
      tags:
        - stig
        - SV-258127r1134925_rule
        - other
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258127r1134925_rule: RHEL 9, for PKI-based authentication, must enforce authorized access to the - Create a new private and public key pair that utilizes a passcode with the following command:  $ sudo ssh-keygen -n [passphrase] Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258128r1117265_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must require authentication to access emergency mode - (SV-258128r1117265_rule)"
      tags:
        - stig
        - SV-258128r1117265_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258128r1117265_rule: RHEL 9 must require authentication to access emergency mode - Configure RHEL 9 to require authentication for emergency mode.  Add or modify the following line in the "/usr/lib/systemd/system/emergency.service" file:  ExecStart=-/usr/lib/systemd/systemd-sulogin-s... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258129r1117265_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must require authentication to access single-user mode - (SV-258129r1117265_rule)"
      tags:
        - stig
        - SV-258129r1117265_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258129r1117265_rule: RHEL 9 must require authentication to access single-user mode - Configure RHEL 9 to require authentication for single-user mode.  Create a directory for supplementary configuration files at /etc/systemd/system/rescue.service.d/  Copy the original file rescue.servi... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258131r1134927_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9, for PKI-based authentication, must validate certificates by - (SV-258131r1134927_rule)"
      tags:
        - stig
        - SV-258131r1134927_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258131r1134927_rule: RHEL 9, for PKI-based authentication, must validate certificates by - Configure RHEL 9, for PKI-based authentication, to validate certificates by constructing a certification path (which includes status information) to an accepted trust anchor.  Obtain a valid copy of t... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258132r1134929_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must map the authenticated identity to the user or group account for - (SV-258132r1134929_rule)"
      tags:
        - stig
        - SV-258132r1134929_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258132r1134929_rule: RHEL 9 must map the authenticated identity to the user or group account for - Configure RHEL 9 to map the authenticated identity to the user or group account by adding or modifying the certmap section of the "/etc/sssd/sssd.conf" file based on the following example:  [certmap/t... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258133r1045263_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must prohibit the use of cached authenticators after one day - (SV-258133r1045263_rule)"
      tags:
        - stig
        - SV-258133r1045263_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258133r1045263_rule: RHEL 9 must prohibit the use of cached authenticators after one day - Configure the SSSD to prohibit the use of cached authentications after one day.  Edit the file "/etc/sssd/sssd.conf" or a configuration file in "/etc/sssd/conf.d" and add or edit the following line ju... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258134r1101983_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must have the AIDE package installed - (SV-258134r1101983_rule)"
      tags:
        - stig
        - SV-258134r1101983_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258134r1101983_rule: RHEL 9 must have the AIDE package installed - Install AIDE, initialize it, and perform a manual check.  Install AIDE:  $ sudo dnf install aide  Initialize AIDE:       $ sudo /usr/sbin/aide --init  Example output:  Start timestamp: 2023-06-05 10:0... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258135r1045267_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must routinely check the baseline configuration for unauthorized changes - (SV-258135r1045267_rule)"
      tags:
        - stig
        - SV-258135r1045267_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258135r1045267_rule: RHEL 9 must routinely check the baseline configuration for unauthorized changes - Configure the file integrity tool to run automatically on the system at least weekly and to notify designated personnel if baseline configurations are changed in an unauthorized manner. The AIDE tool ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258136r1045270_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must use a file integrity tool that is configured to use FIPS - (SV-258136r1045270_rule)"
      tags:
        - stig
        - SV-258136r1045270_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258136r1045270_rule: RHEL 9 must use a file integrity tool that is configured to use FIPS - Configure the file integrity tool to use FIPS 140-3 cryptographic hashes for validating file and directory contents.   If AIDE is installed, ensure the "sha512" rule is present on all uncommented file... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258137r1102081_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must use cryptographic mechanisms to protect the integrity of audit tools - (SV-258137r1102081_rule)"
      tags:
        - stig
        - SV-258137r1102081_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258137r1102081_rule: RHEL 9 must use cryptographic mechanisms to protect the integrity of audit tools - Add or update the following lines to "/etc/aide.conf", to protect the integrity of the audit tools.   /usr/sbin/auditctl p+i+n+u+g+s+b+acl+xattrs+sha512 /usr/sbin/auditd p+i+n+u+g+s+b+acl+xattrs+sha51... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258138r1045274_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must be configured so that the file integrity tool verifies Access - (SV-258138r1045274_rule)"
      tags:
        - stig
        - SV-258138r1045274_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258138r1045274_rule: RHEL 9 must be configured so that the file integrity tool verifies Access - Configure the file integrity tool to check file and directory ACLs.   If AIDE is installed, ensure the "acl" rule is present on all uncommented file and directory selection lists. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258139r1045276_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must be configured so that the file integrity tool verifies extended - (SV-258139r1045276_rule)"
      tags:
        - stig
        - SV-258139r1045276_rule
        - config
        - severity_low
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258139r1045276_rule: RHEL 9 must be configured so that the file integrity tool verifies extended - Configure the file integrity tool to check file and directory extended attributes.   If AIDE is installed, ensure the "xattrs" rule is present on all uncommented file and directory selection lists. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258140r1106460_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must have the rsyslog package installed - (SV-258140r1106460_rule)"
      tags:
        - stig
        - SV-258140r1106460_rule
        - package_absent
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258140r1106460_rule: RHEL 9 must have the rsyslog package installed - Install the rsyslog package with the following command:   $ sudo dnf install rsyslog Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258141r1045280_rule | Automation: automated via SCAP
    - name: "RHEL 9 must have the packages required for encrypting offloaded audit logs - (SV-258141r1045280_rule)"
      tags:
        - stig
        - SV-258141r1045280_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: rsyslog-gnutls
        state: absent


    # STIG ID: SV-258142r991589_rule | Automation: automated via SCAP
    - name: "Ensure rsyslog.service is enable_and_start - (SV-258142r991589_rule)"
      tags:
        - stig
        - SV-258142r991589_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: rsyslog.service
        enabled: yes
        state: started


    # STIG ID: SV-258143r1134931_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must be configured so that the rsyslog daemon does not accept log - (SV-258143r1134931_rule)"
      tags:
        - stig
        - SV-258143r1134931_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258143r1134931_rule: RHEL 9 must be configured so that the rsyslog daemon does not accept log - Configure RHEL 9 to not receive remote logs using rsyslog.  Remove the lines in /etc/rsyslog.conf and any files in the /etc/rsyslog.d directory that match any of the following: module(load="imtcp") mo... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258144r1045286_rule | Automation: automated via SCAP
    - name: "Ensure rsyslog.service is restart - (SV-258144r1045286_rule)"
      tags:
        - stig
        - SV-258144r1045286_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: rsyslog.service
        state: restarted


    # STIG ID: SV-258146r1045288_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must authenticate the remote logging server for offloading audit logs - (SV-258146r1045288_rule)"
      tags:
        - stig
        - SV-258146r1045288_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258146r1045288_rule: RHEL 9 must authenticate the remote logging server for offloading audit logs - Configure RHEL 9 to authenticate the remote logging server for offloading audit logs by setting the following option in "/etc/rsyslog.conf" or "/etc/rsyslog.d/[customfile].conf":  $ActionSendStreamDri... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258147r1045290_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must encrypt the transfer of audit records offloaded onto a different - (SV-258147r1045290_rule)"
      tags:
        - stig
        - SV-258147r1045290_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258147r1045290_rule: RHEL 9 must encrypt the transfer of audit records offloaded onto a different - Configure RHEL 9 to encrypt offloaded audit records via rsyslog by setting the following options in "/etc/rsyslog.conf" or "/etc/rsyslog.d/[customfile].conf":  $ActionSendStreamDriverMode 1 Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258148r1045292_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must encrypt via the gtls driver the transfer of audit records offloaded - (SV-258148r1045292_rule)"
      tags:
        - stig
        - SV-258148r1045292_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258148r1045292_rule: RHEL 9 must encrypt via the gtls driver the transfer of audit records offloaded - Configure RHEL 9 to use the gtls driver to encrypt offloaded audit records by setting the following options in "/etc/rsyslog.conf" or "/etc/rsyslog.d/[customfile].conf":  $DefaultNetstreamDriver gtls Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258149r1106462_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must be configured to forward audit records via TCP to a different - (SV-258149r1106462_rule)"
      tags:
        - stig
        - SV-258149r1106462_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258149r1106462_rule: RHEL 9 must be configured to forward audit records via TCP to a different - Configure RHEL 9 to off-load audit records onto a different system or media from the system being audited via TCP using rsyslog by specifying the remote logging server in "/etc/rsyslog.conf" or "/etc/... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258150r1045296_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must use cron logging - (SV-258150r1045296_rule)"
      tags:
        - stig
        - SV-258150r1045296_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258150r1045296_rule: RHEL 9 must use cron logging - Configure "rsyslog" to log all cron messages by adding or updating the following line to "/etc/rsyslog.conf" or a configuration file in the /etc/rsyslog.d/ directory:  cron.* /var/log/cron  The rsyslo... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258151r1045298_rule | Automation: automated via SCAP
    - name: "Ensure package is enabled and running - (SV-258151r1045298_rule)"
      tags:
        - stig
        - SV-258151r1045298_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: package
        enabled: yes
        state: started


    # STIG ID: SV-258152r1015127_rule | Automation: automated via SCAP
    - name: "Ensure auditd.service is enable_and_start - (SV-258152r1015127_rule)"
      tags:
        - stig
        - SV-258152r1015127_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: auditd.service
        enabled: yes
        state: started


    # STIG ID: SV-258153r1038966_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 audit system must take appropriate action when an error writing to the - (SV-258153r1038966_rule)"
      tags:
        - stig
        - SV-258153r1038966_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258153r1038966_rule: RHEL 9 audit system must take appropriate action when an error writing to the - Configure RHEL 9 to shut down by default upon audit failure (unless availability is an overriding concern).  Add or update the following line (depending on configuration "disk_error_action" can be set... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258154r1038966_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 audit system must take appropriate action when the audit storage volume - (SV-258154r1038966_rule)"
      tags:
        - stig
        - SV-258154r1038966_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258154r1038966_rule: RHEL 9 audit system must take appropriate action when the audit storage volume - Configure RHEL 9 to shut down by default upon audit failure (unless availability is an overriding concern).  Add or update the following line (depending on configuration "disk_full_action" can be set ... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258155r1045300_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must allocate audit record storage capacity to store at least one week's - (SV-258155r1045300_rule)"
      tags:
        - stig
        - SV-258155r1045300_rule
        - package_absent
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258155r1045300_rule: RHEL 9 must allocate audit record storage capacity to store at least one week's - Allocate enough storage capacity for at least one week of audit records when audit records are not immediately sent to a central audit record storage facility.  If audit records are stored on a partit... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258156r1106364_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must take action when allocated audit record storage volume reaches 75 - (SV-258156r1106364_rule)"
      tags:
        - stig
        - SV-258156r1106364_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258156r1106364_rule: RHEL 9 must take action when allocated audit record storage volume reaches 75 - Configure RHEL 9 to initiate an action to notify the SA and ISSO (at a minimum) when allocated audit record storage volume reaches (at most) 75 percent of the repository maximum audit record storage c... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258157r1134932_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must notify the system administrator (SA) and information system - (SV-258157r1134932_rule)"
      tags:
        - stig
        - SV-258157r1134932_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258157r1134932_rule: RHEL 9 must notify the system administrator (SA) and information system - Configure RHEL 9 to initiate an action to notify the SA and ISSO (at a minimum) when allocated audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity by... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258158r971542_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must take action when allocated audit record storage volume reaches 95 - (SV-258158r971542_rule)"
      tags:
        - stig
        - SV-258158r971542_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258158r971542_rule: RHEL 9 must take action when allocated audit record storage volume reaches 95 - Configure RHEL 9 to initiate an action when allocated audit record storage volume reaches 95 percent of the repository maximum audit record storage capacity by adding/modifying the following line in t... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258159r971542_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must take action when allocated audit record storage volume reaches 95 - (SV-258159r971542_rule)"
      tags:
        - stig
        - SV-258159r971542_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258159r971542_rule: RHEL 9 must take action when allocated audit record storage volume reaches 95 - Configure "auditd" service  to take action in the event of allocated audit record storage volume reaches 95 percent of the repository maximum audit record storage capacity.  Edit the following line in... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258160r1038966_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 audit system must take appropriate action when the audit files have - (SV-258160r1038966_rule)"
      tags:
        - stig
        - SV-258160r1038966_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258160r1038966_rule: RHEL 9 audit system must take appropriate action when the audit files have - Configure RHEL 9 to rotate the audit log when it reaches maximum size.  Add or update the following line in "/etc/audit/auditd.conf" file:  max_log_file_action = ROTATE Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258161r958416_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must label all offloaded audit logs before sending them to the central - (SV-258161r958416_rule)"
      tags:
        - stig
        - SV-258161r958416_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258161r958416_rule: RHEL 9 must label all offloaded audit logs before sending them to the central - Edit the /etc/audit/auditd.conf file and add or update the "name_format" option:  name_format = hostname  The audit daemon must be restarted for changes to take effect. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258162r958754_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must take appropriate action when the internal event queue is full - (SV-258162r958754_rule)"
      tags:
        - stig
        - SV-258162r958754_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258162r958754_rule: RHEL 9 must take appropriate action when the internal event queue is full - Edit the /etc/audit/auditd.conf file and add or update the "overflow_action" option:  overflow_action = syslog  The audit daemon must be restarted for changes to take effect. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258163r958424_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 System Administrator (SA) and/or information system security officer - (SV-258163r958424_rule)"
      tags:
        - stig
        - SV-258163r958424_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258163r958424_rule: RHEL 9 System Administrator (SA) and/or information system security officer - Configure "auditd" service to notify the SA and ISSO in the event of an audit processing failure.  Edit the following line in "/etc/audit/auditd.conf" to ensure that administrators are notified via em... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258164r1045301_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 audit system must audit local events - (SV-258164r1045301_rule)"
      tags:
        - stig
        - SV-258164r1045301_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258164r1045301_rule: RHEL 9 audit system must audit local events - Configure RHEL 9 to generate audit records for local events by adding or updating the following line in "/etc/audit/auditd.conf":  local_events = yes   The audit daemon must be restarted for the chang... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258165r958434_rule | Automation: automated via SCAP
    - name: "RHEL 9 audit logs must be group-owned by root or by a restricted logging group - (SV-258165r958434_rule)"
      tags:
        - stig
        - SV-258165r958434_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/audit/auditd.conf
        state: file


    # STIG ID: SV-258166r1045303_rule | Automation: automated via SCAP
    - name: "RHEL 9 audit log directory must be owned by root to prevent unauthorized read - (SV-258166r1045303_rule)"
      tags:
        - stig
        - SV-258166r1045303_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/audit/auditd.conf
        owner: root
        state: directory


    # STIG ID: SV-258167r1101918_rule | Automation: automated via SCAP
    - name: "RHEL 9 audit logs file must have mode 0600 or less permissive to prevent - (SV-258167r1101918_rule)"
      tags:
        - stig
        - SV-258167r1101918_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/audit/auditd.conf
        mode: '0600'
        state: file


    # STIG ID: SV-258168r958428_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must periodically flush audit records to disk to prevent the loss of - (SV-258168r958428_rule)"
      tags:
        - stig
        - SV-258168r958428_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258168r958428_rule: RHEL 9 must periodically flush audit records to disk to prevent the loss of - Configure RHEL 9 to flush audit to disk by adding or updating the following rule in "/etc/audit/auditd.conf":  freq = 100  The audit daemon must be restarted for the changes to take effect. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258169r991556_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must produce audit records containing information to establish the - (SV-258169r991556_rule)"
      tags:
        - stig
        - SV-258169r991556_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258169r991556_rule: RHEL 9 must produce audit records containing information to establish the - Edit the /etc/audit/auditd.conf file and add or update the "log_format" option:  log_format = ENRICHED  The audit daemon must be restarted for changes to take effect. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258170r991589_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must write audit records to disk - (SV-258170r991589_rule)"
      tags:
        - stig
        - SV-258170r991589_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258170r991589_rule: RHEL 9 must write audit records to disk - Configure the audit system to write log files to the disk.  Edit the /etc/audit/auditd.conf file and add or update the "write_logs" option to "yes":  write_logs = yes   The audit daemon must be restar... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258171r1134934_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must allow only the information system security manager (ISSM) (or - (SV-258171r1134934_rule)"
      tags:
        - stig
        - SV-258171r1134934_rule
        - file_permissions
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258171r1134934_rule: RHEL 9 must allow only the information system security manager (ISSM) (or - Configure the files in directory "/etc/audit/rules.d/" and the "/etc/audit/auditd.conf" file to have a mode of "0640" with the following commands:  $ sudo chmod 0640 /etc/audit/rules.d/audit.rules $ s... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258173r1101933_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must allocate an audit_backlog_limit of sufficient size to capture - (SV-258173r1101933_rule)"
      tags:
        - stig
        - SV-258173r1101933_rule
        - package_present
        - severity_low
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258173r1101933_rule: RHEL 9 must allocate an audit_backlog_limit of sufficient size to capture - Configure RHEL 9 to allocate sufficient audit_backlog_limit to capture processes that start prior to the audit daemon with the following command:  $ sudo grubby --update-kernel=ALL --args=audit_backlo... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258174r958424_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must have mail aliases to notify the information system security officer - (SV-258174r958424_rule)"
      tags:
        - stig
        - SV-258174r958424_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258174r958424_rule: RHEL 9 must have mail aliases to notify the information system security officer - Edit the aliases map file (by default /etc/aliases) used by Postfix and configure a root alias (using the user ISSO as an example):  root:    ISSO  and then update the aliases database with the comman... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258175r1045310_rule | Automation: automated via SCAP
    - name: "RHEL 9 audispd-plugins package must be installed - (SV-258175r1045310_rule)"
      tags:
        - stig
        - SV-258175r1045310_rule
        - package_absent
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: audispd-plugins
        state: absent


    # STIG ID: SV-258176r1106366_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit uses of the \"execve\" system call - (SV-258176r1106366_rule)"
      tags:
        - stig
        - SV-258176r1106366_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k execpriv'
        regexp: '^\-a\ always,exit\ \-F\ arch=b32\ \-S\ execve\ \-C\ uid!=euid\ \-F\ euid=0\ \-k\ execpriv$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258177r1106368_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the chmod, fchmod, and fchmodat system calls - (SV-258177r1106368_rule)"
      tags:
        - stig
        - SV-258177r1106368_rule
        - file_permissions
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/audit/rules.d/audit.rules
        state: file


    # STIG ID: SV-258178r1106370_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the chown, fchown, fchownat, and lchown system - (SV-258178r1106370_rule)"
      tags:
        - stig
        - SV-258178r1106370_rule
        - file_owner
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.file:
        path: /etc/audit/rules.d/audit.rules
        state: file


    # STIG ID: SV-258179r1106371_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the setxattr, fsetxattr, lsetxattr, removexattr, - (SV-258179r1106371_rule)"
      tags:
        - stig
        - SV-258179r1106371_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid>=1000 -F auid!=unset -k perm_mod'
        regexp: '^\-a\ always,exit\ \-F\ arch=b32\ \-S\ setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ perm_mod$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258180r1045325_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of umount system calls - (SV-258180r1045325_rule)"
      tags:
        - stig
        - SV-258180r1045325_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/umount -F perm=x -F auid>=1000 -F auid!=unset -k privileged-mount'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/umount\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-mount$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258181r1045328_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the chacl command - (SV-258181r1045328_rule)"
      tags:
        - stig
        - SV-258181r1045328_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/chacl -F perm=x -F auid>=1000 -F auid!=unset -k perm_mod'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/chacl\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ perm_mod$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258182r1045331_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the setfacl command - (SV-258182r1045331_rule)"
      tags:
        - stig
        - SV-258182r1045331_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/setfacl -F perm=x -F auid>=1000 -F auid!=unset -k perm_mod'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/setfacl\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ perm_mod$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258183r1045334_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the chcon command - (SV-258183r1045334_rule)"
      tags:
        - stig
        - SV-258183r1045334_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=unset -k perm_mod'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/chcon\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ perm_mod$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258184r1045337_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the semanage command - (SV-258184r1045337_rule)"
      tags:
        - stig
        - SV-258184r1045337_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/semanage -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/semanage\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-unix\-update$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258185r1045340_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the setfiles command - (SV-258185r1045340_rule)"
      tags:
        - stig
        - SV-258185r1045340_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/setfiles -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/setfiles\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-unix\-update$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258186r1045343_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the setsebool command - (SV-258186r1045343_rule)"
      tags:
        - stig
        - SV-258186r1045343_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/setsebool -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/setsebool\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-F\ key=privileged$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258187r1106373_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the rename, unlink, rmdir, renameat, and unlinkat - (SV-258187r1106373_rule)"
      tags:
        - stig
        - SV-258187r1106373_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S rename,unlink,rmdir,renameat,unlinkat -F auid>=1000 -F auid!=unset -k delete'
        regexp: '^\-a\ always,exit\ \-F\ arch=b32\ \-S\ rename,unlink,rmdir,renameat,unlinkat\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ delete$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258188r1106375_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the truncate, ftruncate, creat, open, openat, and - (SV-258188r1106375_rule)"
      tags:
        - stig
        - SV-258188r1106375_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S truncate,ftruncate,creat,open,openat,open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -k perm_access'
        regexp: '^\-a\ always,exit\ \-F\ arch=b32\ \-S\ truncate,ftruncate,creat,open,openat,open_by_handle_at\ \-F\ exit=\-EPERM\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ perm_access$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258189r1106377_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the delete_module system call - (SV-258189r1106377_rule)"
      tags:
        - stig
        - SV-258189r1106377_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S delete_module -F auid>=1000 -F auid!=unset -k module_chng'
        regexp: '^\-a\ always,exit\ \-F\ arch=b32\ \-S\ delete_module\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ module_chng$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258190r1106379_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the init_module and finit_module system calls - (SV-258190r1106379_rule)"
      tags:
        - stig
        - SV-258190r1106379_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S init_module,finit_module -F auid>=1000 -F auid!=unset -k module_chng'
        regexp: '^\-a\ always,exit\ \-F\ arch=b32\ \-S\ init_module,finit_module\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ module_chng$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258191r1045358_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the chage command - (SV-258191r1045358_rule)"
      tags:
        - stig
        - SV-258191r1045358_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=unset -k privileged-chage'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/chage\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-chage$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258192r1045361_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the chsh command - (SV-258192r1045361_rule)"
      tags:
        - stig
        - SV-258192r1045361_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/chsh\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ priv_cmd$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258193r1045364_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the crontab command - (SV-258193r1045364_rule)"
      tags:
        - stig
        - SV-258193r1045364_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/crontab -F perm=x -F auid>=1000 -F auid!=unset -k privileged-crontab'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/crontab\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-crontab$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258194r1045367_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the gpasswd command - (SV-258194r1045367_rule)"
      tags:
        - stig
        - SV-258194r1045367_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=unset -k privileged-gpasswd'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/gpasswd\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-gpasswd$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258195r1045370_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the kmod command - (SV-258195r1045370_rule)"
      tags:
        - stig
        - SV-258195r1045370_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/kmod -F perm=x -F auid>=1000 -F auid!=unset -k modules'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/kmod\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ modules$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258196r1045373_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the newgrp command - (SV-258196r1045373_rule)"
      tags:
        - stig
        - SV-258196r1045373_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/newgrp\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ priv_cmd$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258197r1045376_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the pam_timestamp_check command - (SV-258197r1045376_rule)"
      tags:
        - stig
        - SV-258197r1045376_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/pam_timestamp_check -F perm=x -F auid>=1000 -F auid!=unset -k privileged-pam_timestamp_check'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/pam_timestamp_check\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-pam_timestamp_check$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258198r1045379_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the passwd command - (SV-258198r1045379_rule)"
      tags:
        - stig
        - SV-258198r1045379_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/passwd -F perm=x -F auid>=1000 -F auid!=unset -k privileged-passwd'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/passwd\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-passwd$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258199r1045382_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the postdrop command - (SV-258199r1045382_rule)"
      tags:
        - stig
        - SV-258199r1045382_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/postdrop -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/postdrop\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-unix\-update$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258200r1045385_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the postqueue command - (SV-258200r1045385_rule)"
      tags:
        - stig
        - SV-258200r1045385_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/postqueue -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/postqueue\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-unix\-update$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258201r1045388_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the ssh-agent command - (SV-258201r1045388_rule)"
      tags:
        - stig
        - SV-258201r1045388_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/ssh-agent -F perm=x -F auid>=1000 -F auid!=unset -k privileged-ssh'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/ssh\-agent\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-ssh$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258202r1045391_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the ssh-keysign command - (SV-258202r1045391_rule)"
      tags:
        - stig
        - SV-258202r1045391_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/libexec/openssh/ssh-keysign -F perm=x -F auid>=1000 -F auid!=unset -k privileged-ssh'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/libexec/openssh/ssh\-keysign\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-ssh$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258203r1045394_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the su command - (SV-258203r1045394_rule)"
      tags:
        - stig
        - SV-258203r1045394_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=unset -k privileged-priv_change'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/su\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-priv_change$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258204r1045397_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the sudo command - (SV-258204r1045397_rule)"
      tags:
        - stig
        - SV-258204r1045397_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/sudo\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ priv_cmd$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258205r1045400_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the sudoedit command - (SV-258205r1045400_rule)"
      tags:
        - stig
        - SV-258205r1045400_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/sudoedit -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/sudoedit\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ priv_cmd$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258206r1045403_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the unix_chkpwd command - (SV-258206r1045403_rule)"
      tags:
        - stig
        - SV-258206r1045403_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/unix_chkpwd\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-unix\-update$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258207r1045406_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the unix_update command - (SV-258207r1045406_rule)"
      tags:
        - stig
        - SV-258207r1045406_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/unix_update -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/unix_update\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-unix\-update$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258208r1045409_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the userhelper command - (SV-258208r1045409_rule)"
      tags:
        - stig
        - SV-258208r1045409_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/userhelper\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-unix\-update$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258209r1045412_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the usermod command - (SV-258209r1045412_rule)"
      tags:
        - stig
        - SV-258209r1045412_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/usermod -F perm=x -F auid>=1000 -F auid!=unset -k privileged-usermod'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/usermod\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-usermod$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258210r1045415_rule | Automation: automated via SCAP
    - name: "RHEL 9 must audit all uses of the mount command - (SV-258210r1045415_rule)"
      tags:
        - stig
        - SV-258210r1045415_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/bin/mount -F perm=x -F auid>=1000 -F auid!=unset -k privileged-mount'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/bin/mount\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-mount$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258211r1045418_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the init command in RHEL 9 must generate an - (SV-258211r1045418_rule)"
      tags:
        - stig
        - SV-258211r1045418_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/init -F perm=x -F auid>=1000 -F auid!=unset -k privileged-init'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/init\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-init$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258212r1045421_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the poweroff command in RHEL 9 must generate an - (SV-258212r1045421_rule)"
      tags:
        - stig
        - SV-258212r1045421_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/poweroff -F perm=x -F auid>=1000 -F auid!=unset -k privileged-poweroff'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/poweroff\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-poweroff$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258213r1045424_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the reboot command in RHEL 9 must generate an - (SV-258213r1045424_rule)"
      tags:
        - stig
        - SV-258213r1045424_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/reboot -F perm=x -F auid>=1000 -F auid!=unset -k privileged-reboot'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/reboot\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-reboot$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258214r1045427_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the shutdown command in RHEL 9 must generate an - (SV-258214r1045427_rule)"
      tags:
        - stig
        - SV-258214r1045427_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F path=/usr/sbin/shutdown -F perm=x -F auid>=1000 -F auid!=unset -k privileged-shutdown'
        regexp: '^\-a\ always,exit\ \-F\ path=/usr/sbin/shutdown\ \-F\ perm=x\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-shutdown$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258215r1106381_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the umount system call in RHEL 9 must generate - (SV-258215r1106381_rule)"
      tags:
        - stig
        - SV-258215r1106381_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S umount -F auid>=1000 -F auid!=unset -k privileged-umount'
        regexp: '^\-a\ always,exit\ \-F\ arch=b32\ \-S\ umount\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-umount$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258216r1102090_rule | Automation: automated via SCAP
    - name: "Successful/unsuccessful uses of the umount2 system call in RHEL 9 must generate - (SV-258216r1102090_rule)"
      tags:
        - stig
        - SV-258216r1102090_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-a always,exit -F arch=b32 -S umount2 -F auid>=1000 -F auid!=unset -k privileged-umount'
        regexp: '^\-a\ always,exit\ \-F\ arch=b32\ \-S\ umount2\ \-F\ auid>=1000\ \-F\ auid!=unset\ \-k\ privileged\-umount$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258217r1045436_rule | Automation: automated via SCAP
    - name: "RHEL 9 must generate audit records for all account creations, modifications, - (SV-258217r1045436_rule)"
      tags:
        - stig
        - SV-258217r1045436_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/sudoers -p wa -k identity'
        regexp: '^\-w\ /etc/sudoers\ \-p\ wa\ \-k\ identity$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258218r1101981_rule | Automation: automated via SCAP
    - name: "RHEL 9 must generate audit records for all account creations, modifications, - (SV-258218r1101981_rule)"
      tags:
        - stig
        - SV-258218r1101981_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/sudoers.d/ -p wa -k identity'
        regexp: '^\-w\ /etc/sudoers\.d/\ \-p\ wa\ \-k\ identity$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258219r1015130_rule | Automation: automated via SCAP
    - name: "RHEL 9 must generate audit records for all account creations, modifications, - (SV-258219r1015130_rule)"
      tags:
        - stig
        - SV-258219r1015130_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/group -p wa -k identity'
        regexp: '^\-w\ /etc/group\ \-p\ wa\ \-k\ identity$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258220r1015131_rule | Automation: automated via SCAP
    - name: "RHEL 9 must generate audit records for all account creations, modifications, - (SV-258220r1015131_rule)"
      tags:
        - stig
        - SV-258220r1015131_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/gshadow -p wa -k identity'
        regexp: '^\-w\ /etc/gshadow\ \-p\ wa\ \-k\ identity$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258221r1015132_rule | Automation: automated via SCAP
    - name: "RHEL 9 must generate audit records for all account creations, modifications, - (SV-258221r1015132_rule)"
      tags:
        - stig
        - SV-258221r1015132_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/security/opasswd -p wa -k identity'
        regexp: '^\-w\ /etc/security/opasswd\ \-p\ wa\ \-k\ identity$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258222r1015133_rule | Automation: automated via SCAP
    - name: "RHEL 9 must generate audit records for all account creations, modifications, - (SV-258222r1015133_rule)"
      tags:
        - stig
        - SV-258222r1015133_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/passwd -p wa -k identity'
        regexp: '^\-w\ /etc/passwd\ \-p\ wa\ \-k\ identity$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258223r1015134_rule | Automation: automated via SCAP
    - name: "RHEL 9 must generate audit records for all account creations, modifications, - (SV-258223r1015134_rule)"
      tags:
        - stig
        - SV-258223r1015134_rule
        - audit
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.lineinfile:
        path: /etc/audit/rules.d/audit.rules
        line: '-w /etc/shadow -p wa -k identity'
        regexp: '^\-w\ /etc/shadow\ \-p\ wa\ \-k\ identity$'
        create: yes
        mode: '0640'
        owner: root
        group: root


    # STIG ID: SV-258224r1014988_rule | Automation: automated via SCAP
    - name: "Ensure auditd is enabled and running - (SV-258224r1014988_rule)"
      tags:
        - stig
        - SV-258224r1014988_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: auditd
        enabled: yes
        state: started


    # STIG ID: SV-258225r1014990_rule | Automation: automated via SCAP
    - name: "Ensure auditd is enabled and running - (SV-258225r1014990_rule)"
      tags:
        - stig
        - SV-258225r1014990_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: auditd
        enabled: yes
        state: started


    # STIG ID: SV-258227r1014992_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must take appropriate action when a critical audit processing failure - (SV-258227r1014992_rule)"
      tags:
        - stig
        - SV-258227r1014992_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258227r1014992_rule: RHEL 9 must take appropriate action when a critical audit processing failure - Configure RHEL 9 to shut down when auditing failures occur.  Add the following line to the bottom of the /etc/audit/rules.d/audit.rules file:  -f 2 Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258228r991572_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 audit system must protect logon UIDs from unauthorized change - (SV-258228r991572_rule)"
      tags:
        - stig
        - SV-258228r991572_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258228r991572_rule: RHEL 9 audit system must protect logon UIDs from unauthorized change - Configure RHEL 9 auditing to prevent modification of login UIDs once they are set by adding the following line to /etc/audit/rules.d/audit.rules:  --loginuid-immutable  The audit daemon must be restar... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258229r958434_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 audit system must protect auditing rules from unauthorized change - (SV-258229r958434_rule)"
      tags:
        - stig
        - SV-258229r958434_rule
        - audit
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258229r958434_rule: RHEL 9 audit system must protect auditing rules from unauthorized change - Configure the audit system to set the audit rules to be immutable by adding the following line to end of "/etc/audit/rules.d/audit.rules"  -e 2  The audit daemon must be restarted for the changes to t... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258230r1134936_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must enable FIPS mode - (SV-258230r1134936_rule)"
      tags:
        - stig
        - SV-258230r1134936_rule
        - other
        - severity_high
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258230r1134936_rule: RHEL 9 must enable FIPS mode - Configure the operating system to implement FIPS mode with the following command  $ sudo fips-mode-setup --enable  Reboot the system for the changes to take effect. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258231r1069375_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must employ FIPS 140-3 approved cryptographic hashing algorithms for all - (SV-258231r1069375_rule)"
      tags:
        - stig
        - SV-258231r1069375_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258231r1069375_rule: RHEL 9 must employ FIPS 140-3 approved cryptographic hashing algorithms for all - Lock all interactive user accounts not using SHA-512 hashing until the passwords can be regenerated with SHA-512. Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258232r1045440_rule | Automation: automated via SCAP
    - name: "Ensure uses is enabled and running - (SV-258232r1045440_rule)"
      tags:
        - stig
        - SV-258232r1045440_rule
        - service_enabled
        - severity_medium
        - automation_automated
        - rhel9
      ansible.builtin.systemd:
        name: uses
        enabled: yes
        state: started


    # STIG ID: SV-258233r1015136_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 pam_unix.so module must be configured in the password-auth file to use a - (SV-258233r1015136_rule)"
      tags:
        - stig
        - SV-258233r1015136_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258233r1015136_rule: RHEL 9 pam_unix.so module must be configured in the password-auth file to use a - Configure RHEL 9 to use a FIPS 140-3 approved cryptographic hashing algorithm for system authentication.  Edit/modify the following line in the "/etc/pam.d/password-auth" file to include the sha512 op... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258234r1051250_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must have the crypto-policies package installed - (SV-258234r1051250_rule)"
      tags:
        - stig
        - SV-258234r1051250_rule
        - package_absent
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258234r1051250_rule: RHEL 9 must have the crypto-policies package installed - Install the crypto-policies package (if the package is not already installed) with the following command:  $ sudo dnf -y install crypto-policies Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258236r1101920_rule | Automation: automated via SCAP
    - name: "RHEL 9 cryptographic policy must not be overridden - (SV-258236r1101920_rule)"
      tags:
        - stig
        - SV-258236r1101920_rule
        - package_absent
        - severity_high
        - automation_automated
        - rhel9
      ansible.builtin.dnf:
        name: '*'
        state: latest
        update_cache: yes


    # STIG ID: SV-258241r1106302_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must implement a FIPS 140-3-compliant systemwide cryptographic policy - (SV-258241r1106302_rule)"
      tags:
        - stig
        - SV-258241r1106302_rule
        - service_enabled
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258241r1106302_rule: RHEL 9 must implement a FIPS 140-3-compliant systemwide cryptographic policy - Configure RHEL 9 to use a FIPS 140-3-compliant systemwide cryptographic policy.  Create a subpolicy for enhancements to the base systemwide crypto-policy by creating the file /etc/crypto-policies/poli... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-258242r958908_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must implement DOD-approved encryption in the bind package - (SV-258242r958908_rule)"
      tags:
        - stig
        - SV-258242r958908_rule
        - package_absent
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-258242r958908_rule: RHEL 9 must implement DOD-approved encryption in the bind package - Configure BIND to use the system crypto policy.  Add the following line to the "options" section in "/etc/named.conf":  include "/etc/crypto-policies/back-ends/bind.config"; Refer to STIG FixText for detailed steps.


    # STIG ID: SV-270174r1044831_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before - (SV-270174r1044831_rule)"
      tags:
        - stig
        - SV-270174r1044831_rule
        - dconf
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-270174r1044831_rule: RHEL 9 must display the Standard Mandatory DOD Notice and Consent Banner before - Configure the operating system to display the Standard Mandatory DOD Notice and Consent Banner before granting access to the system.  Add the following lines to the [org/gnome/login-screen] section of... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-270175r1117265_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 \"/etc/audit/\" must be owned by root - (SV-270175r1117265_rule)"
      tags:
        - stig
        - SV-270175r1117265_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-270175r1117265_rule: RHEL 9 "/etc/audit/" must be owned by root - Change the owner of the file "/etc/audit/" to "root" by running the following command:  $ sudo chown root /etc/audit/ Refer to STIG FixText for detailed steps.


    # STIG ID: SV-270176r1117265_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 \"/etc/audit/\" must be group-owned by root - (SV-270176r1117265_rule)"
      tags:
        - stig
        - SV-270176r1117265_rule
        - file_owner
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-270176r1117265_rule: RHEL 9 "/etc/audit/" must be group-owned by root - Change the group of the file "/etc/audit/" to "root" by running the following command:  $ sudo chgrp root /etc/audit/ Refer to STIG FixText for detailed steps.


    # STIG ID: SV-270177r1051237_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 9 SSH client must be configured to use only DOD-approved encryption - (SV-270177r1051237_rule)"
      tags:
        - stig
        - SV-270177r1051237_rule
        - package_present
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-270177r1051237_rule: The RHEL 9 SSH client must be configured to use only DOD-approved encryption - Configure the SSH client to use only ciphers employing FIPS 140-3 approved algorithms.  Reinstall crypto-policies with the following command:  $ sudo dnf -y reinstall crypto-policies  Set the crypto-p... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-270178r1051243_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 9 SSH client must be configured to use only DOD-approved Message - (SV-270178r1051243_rule)"
      tags:
        - stig
        - SV-270178r1051243_rule
        - package_present
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-270178r1051243_rule: The RHEL 9 SSH client must be configured to use only DOD-approved Message - Configure the SSH client to use only MACs employing FIPS 140-3 approved algorithms.  Reinstall crypto-policies with the following command:  $ sudo dnf -y reinstall crypto-policies  Set the crypto-poli... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-270180r1045182_rule | Automation: manual-only (not covered by scap)
    - name: "The RHEL 9 fapolicy module must be configured to employ a deny-all, - (SV-270180r1045182_rule)"
      tags:
        - stig
        - SV-270180r1045182_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-270180r1045182_rule: The RHEL 9 fapolicy module must be configured to employ a deny-all, - Configure RHEL 9 to employ a deny-all, permit-by-exception application allow listing policy with "fapolicyd".  With the "fapolicyd" installed and enabled, configure the daemon to function in permissiv... Refer to STIG FixText for detailed steps.


    # STIG ID: SV-272488r1082178_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must have the Postfix package installed - (SV-272488r1082178_rule)"
      tags:
        - stig
        - SV-272488r1082178_rule
        - package_absent
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-272488r1082178_rule: RHEL 9 must have the Postfix package installed - Install the Postfix package with the following command:   $ sudo dnf install postfix Refer to STIG FixText for detailed steps.


    # STIG ID: SV-272496r1134956_rule | Automation: manual-only (not covered by scap)
    - name: "RHEL 9 must elevate the SELinux context when an administrator calls the sudo - (SV-272496r1134956_rule)"
      tags:
        - stig
        - SV-272496r1134956_rule
        - config
        - severity_medium
        - automation_manual_only
        - rhel9
      ansible.builtin.debug:
        msg: >-
          Manual hardening required for SV-272496r1134956_rule: RHEL 9 must elevate the SELinux context when an administrator calls the sudo - Configure RHEL 9 to elevate the SELinux context when an administrator calls the sudo command.  Edit a file in the "/etc/sudoers.d" directory with the following command:  $ sudo visudo -f /etc/sudoers.... Refer to STIG FixText for detailed steps.

